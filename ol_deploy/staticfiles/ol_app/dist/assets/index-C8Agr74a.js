var mM=Object.defineProperty;var _M=(i,t,e)=>t in i?mM(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Vt=(i,t,e)=>_M(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();class os{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Rc={PROPERTYCHANGE:"propertychange"};class yf{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function yM(i,t,e){let n,s;e=e||no;let r=0,o=i.length,a=!1;for(;r<o;)n=r+(o-r>>1),s=+e(i[n],t),s<0?r=n+1:(o=n,a=!s);return a?r:~r}function no(i,t){return i>t?1:i<t?-1:0}function k0(i,t,e){if(i[0]<=t)return 0;const n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let s=1;s<n;++s){const r=i[s];if(r===t)return s;if(r<t)return e(t,i[s-1],r)>0?s-1:s}return n-1}if(e>0){for(let s=1;s<n;++s)if(i[s]<t)return s-1;return n-1}if(e<0){for(let s=1;s<n;++s)if(i[s]<=t)return s;return n-1}for(let s=1;s<n;++s){if(i[s]==t)return s;if(i[s]<t)return i[s-1]-t<t-i[s]?s-1:s}return n-1}function vM(i,t,e){for(;t<e;){const n=i[t];i[t]=i[e],i[e]=n,++t,--e}}function Ye(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let s=0;s<n;s++)i[i.length]=e[s]}function uo(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function xM(i,t,e){const n=t||no;return i.every(function(s,r){if(r===0)return!0;const o=n(i[r-1],s);return!(o>0||o===0)})}function Yo(){return!0}function $c(){return!1}function Nc(){}function $w(i){let t,e,n;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==n||!uo(s,e))&&(n=this,e=s,t=i.apply(this,arguments)),t}}function Kw(i){function t(){let e;try{e=i()}catch(n){return Promise.reject(n)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Kl(i){for(const t in i)delete i[t]}function Ul(i){let t;for(t in i)return!1;return!t}class vf extends yf{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),s=n[t]||(n[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const r=e?new os(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let l;for(let h=0,c=s.length;h<c;++h)if("handleEvent"in s[h]?l=s[h].handleEvent(r):l=s[h].call(this,r),l===!1||r.propagationStopped){l=!1;break}if(--o[n]===0){let h=a[n];for(delete a[n];h--;)this.removeEventListener(n,Nc);delete o[n]}return l}disposeInternal(){this.listeners_&&Kl(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const s=n.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[s]=Nc,++this.pendingRemovals_[t]):(n.splice(s,1),n.length===0&&delete this.listeners_[t]))}}const ce={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function ve(i,t,e,n,s){if(s){const o=e;e=function(){i.removeEventListener(t,e),o.apply(n??this,arguments)}}else n&&n!==i&&(e=e.bind(n));const r={target:i,type:t,listener:e};return i.addEventListener(t,e),r}function Gp(i,t,e,n){return ve(i,t,e,n,!0)}function Ke(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),Kl(i))}class xf extends vf{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ce.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ve(this,t[r],e);return s}return ve(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const s=t.length;n=new Array(s);for(let r=0;r<s;++r)n[r]=Gp(this,t[r],e)}else n=Gp(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)Ar(n);else if(Array.isArray(t))for(let s=0,r=t.length;s<r;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}xf.prototype.on;xf.prototype.once;xf.prototype.un;function Ar(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)Ke(i[t]);else Ke(i)}function de(){throw new Error("Unimplemented abstract method.")}let bM=0;function le(i){return i.ol_uid||(i.ol_uid=String(++bM))}class ax extends os{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class In extends xf{constructor(t){super(),this.on,this.once,this.un,le(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new ax(n,t,e)),n=Rc.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new ax(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const s=this.values_||(this.values_={});if(n)s[t]=e;else{const r=s[t];s[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],Ul(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}const an={ADD:"add",REMOVE:"remove"},lx={LENGTH:"length"};class Ag extends os{constructor(t,e,n){super(t),this.element=e,this.index=n}}class ns extends In{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,s=this.array_.length;n<s;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(lx.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ag(an.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ag(an.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const s=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ag(an.REMOVE,s,t)),this.dispatchEvent(new Ag(an.ADD,e,t))}updateLength_(){this.set(lx.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,s=this.array_.length;n<s;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}function De(i,t){if(!i)throw new Error(t)}class gi extends In{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new gi(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ke(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=ve(t,ce.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?wM(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function wM(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(De(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[i]),function(){return t}}const Zw=new Array(6);function hn(){return[1,0,0,1,0,0]}function hx(i){return Ay(i,1,0,0,1,0,0)}function F0(i,t){const e=i[0],n=i[1],s=i[2],r=i[3],o=i[4],a=i[5],l=t[0],h=t[1],c=t[2],u=t[3],f=t[4],d=t[5];return i[0]=e*l+s*h,i[1]=n*l+r*h,i[2]=e*c+s*u,i[3]=n*c+r*u,i[4]=e*f+s*d+o,i[5]=n*f+r*d+a,i}function Ay(i,t,e,n,s,r,o){return i[0]=t,i[1]=e,i[2]=n,i[3]=s,i[4]=r,i[5]=o,i}function SM(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function Vi(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function xp(i,t,e){return F0(i,Ay(Zw,t,0,0,e,0,0))}function Jw(i,t,e){return F0(i,Ay(Zw,1,0,0,1,t,e))}function or(i,t,e,n,s,r,o,a){const l=Math.sin(r),h=Math.cos(r);return i[0]=n*h,i[1]=s*l,i[2]=-n*l,i[3]=s*h,i[4]=o*n*h-a*n*l+t,i[5]=o*s*l+a*s*h+e,i}function Py(i,t){const e=EM(t);De(e!==0,"Transformation matrix cannot be inverted");const n=t[0],s=t[1],r=t[2],o=t[3],a=t[4],l=t[5];return i[0]=o/e,i[1]=-s/e,i[2]=-r/e,i[3]=n/e,i[4]=(r*l-o*a)/e,i[5]=-(n*l-s*a)/e,i}function EM(i){return i[0]*i[3]-i[1]*i[2]}const cx=[1e6,1e6,1e6,1e6,2,2];function CM(i){return"matrix("+i.map((e,n)=>Math.round(e*cx[n])/cx[n]).join(", ")+")"}const bn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function es(i){const t=Es();for(let e=0,n=i.length;e<n;++e)yd(t,i[e]);return t}function LM(i,t,e){const n=Math.min.apply(null,i),s=Math.min.apply(null,t),r=Math.max.apply(null,i),o=Math.max.apply(null,t);return ao(n,s,r,o,e)}function Xo(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function Qw(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function Zl(i,t,e){let n,s;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?s=i[1]-e:i[3]<e?s=e-i[3]:s=0,n*n+s*s}function Wl(i,t){return Iy(i,t[0],t[1])}function ir(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function Iy(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function y_(i,t){const e=i[0],n=i[1],s=i[2],r=i[3],o=t[0],a=t[1];let l=bn.UNKNOWN;return o<e?l=l|bn.LEFT:o>s&&(l=l|bn.RIGHT),a<n?l=l|bn.BELOW:a>r&&(l=l|bn.ABOVE),l===bn.UNKNOWN&&(l=bn.INTERSECTING),l}function Es(){return[1/0,1/0,-1/0,-1/0]}function ao(i,t,e,n,s){return s?(s[0]=i,s[1]=t,s[2]=e,s[3]=n,s):[i,t,e,n]}function Kc(i){return ao(1/0,1/0,-1/0,-1/0,i)}function _d(i,t){const e=i[0],n=i[1];return ao(e,n,e,n,t)}function Ry(i,t,e,n,s){const r=Kc(s);return tS(r,i,t,e,n)}function Ga(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function Ny(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function yd(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function tS(i,t,e,n,s){for(;e<n;e+=s)MM(i,t[e],t[e+1]);return i}function MM(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function ky(i,t){let e;return e=t(O0(i)),e||(e=t(D0(i)),e)||(e=t(B0(i)),e)||(e=t(Qa(i)),e)?e:!1}function Dd(i){let t=0;return Jl(i)||(t=Ie(i)*ln(i)),t}function O0(i){return[i[0],i[1]]}function D0(i){return[i[2],i[1]]}function lo(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function TM(i,t){let e;if(t==="bottom-left")e=O0(i);else if(t==="bottom-right")e=D0(i);else if(t==="top-left")e=Qa(i);else if(t==="top-right")e=B0(i);else throw new Error("Invalid corner");return e}function Bd(i,t,e,n,s){const[r,o,a,l,h,c,u,f]=AM(i,t,e,n);return ao(Math.min(r,a,h,u),Math.min(o,l,c,f),Math.max(r,a,h,u),Math.max(o,l,c,f),s)}function AM(i,t,e,n){const s=t*n[0]/2,r=t*n[1]/2,o=Math.cos(e),a=Math.sin(e),l=s*o,h=s*a,c=r*o,u=r*a,f=i[0],d=i[1];return[f-l+u,d-h-c,f-l-u,d-h+c,f+l-u,d+h+c,f+l+u,d+h-c,f-l+u,d-h-c]}function ln(i){return i[3]-i[1]}function Ss(i,t,e){const n=e||Es();return Ri(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):Kc(n),n}function Qa(i){return[i[0],i[3]]}function B0(i){return[i[2],i[3]]}function Ie(i){return i[2]-i[0]}function Ri(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function Jl(i){return i[2]<i[0]||i[3]<i[1]}function PM(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function IM(i,t,e){let n=!1;const s=y_(i,t),r=y_(i,e);if(s===bn.INTERSECTING||r===bn.INTERSECTING)n=!0;else{const o=i[0],a=i[1],l=i[2],h=i[3],c=t[0],u=t[1],f=e[0],d=e[1],g=(d-u)/(f-c);let p,y;r&bn.ABOVE&&!(s&bn.ABOVE)&&(p=f-(d-h)/g,n=p>=o&&p<=l),!n&&r&bn.RIGHT&&!(s&bn.RIGHT)&&(y=d-(f-l)*g,n=y>=a&&y<=h),!n&&r&bn.BELOW&&!(s&bn.BELOW)&&(p=f-(d-a)/g,n=p>=o&&p<=l),!n&&r&bn.LEFT&&!(s&bn.LEFT)&&(y=d-(f-o)*g,n=y>=a&&y<=h)}return n}function eS(i,t,e,n){if(Jl(i))return Kc(e);let s=[];s=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]],t(s,s,2);const r=[],o=[];for(let a=0,l=s.length;a<l;a+=2)r.push(s[a]),o.push(s[a+1]);return LM(r,o,e)}function iS(i,t){const e=t.getExtent(),n=lo(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const s=Ie(e),o=Math.floor((n[0]-e[0])/s)*s;i[0]-=o,i[2]-=o}return i}function Fy(i,t,e){if(t.canWrapX()){const n=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];iS(i,t);const s=Ie(n);if(Ie(i)>s&&!e)return[[n[0],i[1],n[2],i[3]]];if(i[0]<n[0])return[[i[0]+s,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-s,i[3]]]}return[i]}const kc={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Ql=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||kc[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const bf=6378137,lc=Math.PI*bf,RM=[-lc,-lc,lc,lc],NM=[-180,-85,180,85],Pg=bf*Math.log(Math.tan(Math.PI/2));class jh extends Ql{constructor(t){super({code:t,units:"m",extent:RM,global:!0,worldExtent:NM,getPointResolution:function(e,n){return e/Math.cosh(n[1]/bf)}})}}const ux=[new jh("EPSG:3857"),new jh("EPSG:102100"),new jh("EPSG:102113"),new jh("EPSG:900913"),new jh("http://www.opengis.net/def/crs/EPSG/0/3857"),new jh("http://www.opengis.net/gml/srs/epsg.xml#3857")];function kM(i,t,e,n){const s=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let r=0;r<s;r+=n){t[r]=lc*i[r]/180;let o=bf*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));o>Pg?o=Pg:o<-Pg&&(o=-Pg),t[r+1]=o}return t}function FM(i,t,e,n){const s=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let r=0;r<s;r+=n)t[r]=180*i[r]/lc,t[r+1]=360*Math.atan(Math.exp(i[r+1]/bf))/Math.PI-90;return t}const OM=6378137,dx=[-180,-90,180,90],DM=Math.PI*OM/180;class pl extends Ql{constructor(t,e){super({code:t,units:"degrees",extent:dx,axisOrientation:e,global:!0,metersPerUnit:DM,worldExtent:dx})}}const fx=[new pl("CRS:84"),new pl("EPSG:4326","neu"),new pl("urn:ogc:def:crs:OGC:1.3:CRS84"),new pl("urn:ogc:def:crs:OGC:2:84"),new pl("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new pl("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new pl("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let v_={};function BM(i){return v_[i]||v_[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function jM(i,t){v_[i]=t}let yc={};function Fc(i,t,e){const n=i.getCode(),s=t.getCode();n in yc||(yc[n]={}),yc[n][s]=e}function nS(i,t){let e;return i in yc&&t in yc[i]&&(e=yc[i][t]),e}function xi(i,t,e){return Math.min(Math.max(i,t),e)}function zM(i,t,e,n,s,r){const o=s-e,a=r-n;if(o!==0||a!==0){const l=((i-e)*o+(t-n)*a)/(o*o+a*a);l>1?(e=s,n=r):l>0&&(e+=o*l,n+=a*l)}return Wo(i,t,e,n)}function Wo(i,t,e,n){const s=e-i,r=n-t;return s*s+r*r}function GM(i){const t=i.length;for(let n=0;n<t;n++){let s=n,r=Math.abs(i[n][n]);for(let a=n+1;a<t;a++){const l=Math.abs(i[a][n]);l>r&&(r=l,s=a)}if(r===0)return null;const o=i[s];i[s]=i[n],i[n]=o;for(let a=n+1;a<t;a++){const l=-i[a][n]/i[n][n];for(let h=n;h<t+1;h++)n==h?i[a][h]=0:i[a][h]+=l*i[n][h]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let s=n-1;s>=0;s--)i[s][t]-=i[s][n]*e[n]}return e}function gx(i){return i*180/Math.PI}function Lr(i){return i*Math.PI/180}function Ol(i,t){const e=i%t;return e*t<0?e+t:e}function Ds(i,t,e){return i+e*(t-i)}function wf(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function px(i,t){return Math.round(wf(i,t))}function hc(i,t){return Math.floor(wf(i,t))}function La(i,t){return Math.ceil(wf(i,t))}function Ou(i,t,e){const n=e!==void 0?i.toFixed(e):""+i;let s=n.indexOf(".");return s=s===-1?n.length:s,s>t?n:new Array(1+t-s).join("0")+n}function Oy(i,t){const e=(""+i).split("."),n=(""+t).split(".");for(let s=0;s<Math.max(e.length,n.length);s++){const r=parseInt(e[s]||"0",10),o=parseInt(n[s]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}function UM(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function sS(i,t){const e=i[0],n=i[1],s=t[0],r=t[1],o=s[0],a=s[1],l=r[0],h=r[1],c=l-o,u=h-a,f=c===0&&u===0?0:(c*(e-o)+u*(n-a))/(c*c+u*u||0);let d,g;return f<=0?(d=o,g=a):f>=1?(d=l,g=h):(d=o+f*c,g=a+f*u),[d,g]}function WM(i,t,e){return i?t.replace("{x}",i[0].toFixed(e)).replace("{y}",i[1].toFixed(e)):""}function br(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function Dy(i,t){const e=Math.cos(t),n=Math.sin(t),s=i[0]*e-i[1]*n,r=i[1]*e+i[0]*n;return i[0]=s,i[1]=r,i}function qM(i,t){return i[0]*=t,i[1]*=t,i}function Oc(i,t){const e=i[0]-t[0],n=i[1]-t[1];return e*e+n*n}function Up(i,t){return Math.sqrt(Oc(i,t))}function VM(i,t){return Oc(i,sS(i,t))}function HM(i,t){return WM(i,"{x}, {y}",t)}function j0(i,t){if(t.canWrapX()){const e=Ie(t.getExtent()),n=rS(i,t,e);n&&(i[0]-=n*e)}return i}function rS(i,t,e){const n=t.getExtent();let s=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||Ie(n),s=Math.floor((i[0]-n[0])/e)),s}const z0=63710088e-1;function jd(i,t,e){e=e||z0;const n=Lr(i[1]),s=Lr(t[1]),r=(s-n)/2,o=Lr(t[0]-i[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function h1(i,t){let e=0;for(let n=0,s=i.length;n<s-1;++n)e+=jd(i[n],i[n+1],t);return e}function oS(i,t){t=t||{};const e=t.radius||z0,n=t.projection||"EPSG:3857",s=i.getType();s!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let r=0,o,a,l,h,c,u;switch(s){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{o=i.getCoordinates(),r=h1(o,e);break}case"MultiLineString":case"Polygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)r+=h1(o[l],e);break}case"MultiPolygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)for(a=o[l],c=0,u=a.length;c<u;++c)r+=h1(a[c],e);break}case"GeometryCollection":{const f=i.getGeometries();for(l=0,h=f.length;l<h;++l)r+=oS(f[l],t);break}default:throw new Error("Unsupported geometry type: "+s)}return r}function Ig(i,t){let e=0;const n=i.length;let s=i[n-1][0],r=i[n-1][1];for(let o=0;o<n;o++){const a=i[o][0],l=i[o][1];e+=Lr(a-s)*(2+Math.sin(Lr(r))+Math.sin(Lr(l))),s=a,r=l}return e*t*t/2}function aS(i,t){t=t||{};const e=t.radius||z0,n=t.projection||"EPSG:3857",s=i.getType();s!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let r=0,o,a,l,h,c,u;switch(s){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(o=i.getCoordinates(),r=Math.abs(Ig(o[0],e)),l=1,h=o.length;l<h;++l)r-=Math.abs(Ig(o[l],e));break}case"MultiPolygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)for(a=o[l],r+=Math.abs(Ig(a[0],e)),c=1,u=a.length;c<u;++c)r-=Math.abs(Ig(a[c],e));break}case"GeometryCollection":{const f=i.getGeometries();for(l=0,h=f.length;l<h;++l)r+=aS(f[l],t);break}default:throw new Error("Unsupported geometry type: "+s)}return r}function YM(i,t,e,n){n=n||z0;const s=Lr(i[1]),r=Lr(i[0]),o=t/n,a=Math.asin(Math.sin(s)*Math.cos(o)+Math.cos(s)*Math.sin(o)*Math.cos(e)),l=r+Math.atan2(Math.sin(e)*Math.sin(o)*Math.cos(s),Math.cos(o)-Math.sin(s)*Math.sin(a));return[gx(l),gx(a)]}function lS(...i){console.warn(...i)}let x_=!0;function hS(i){x_=!1}function By(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function G0(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function cS(i){jM(i.getCode(),i),Fc(i,i,By)}function XM(i){i.forEach(cS)}function xe(i){return typeof i=="string"?BM(i):i||null}function Wp(i,t,e,n){i=xe(i);let s;const r=i.getPointResolutionFunc();if(r){if(s=r(t,e),n&&n!==i.getUnits()){const o=i.getMetersPerUnit();o&&(s=s*o/kc[n])}}else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")s=t;else{const a=th(i,xe("EPSG:4326"));if(a===G0&&o!=="degrees")s=t*i.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2);const c=jd(h.slice(0,2),h.slice(2,4)),u=jd(h.slice(4,6),h.slice(6,8));s=(c+u)/2}const l=n?kc[n]:i.getMetersPerUnit();l!==void 0&&(s/=l)}}return s}function b_(i){XM(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Fc(t,e,By)})})}function $M(i,t,e,n){i.forEach(function(s){t.forEach(function(r){Fc(s,r,e),Fc(r,s,n)})})}function jy(i,t){return i?typeof i=="string"?xe(i):i:xe(t)}function mx(i){return function(t,e,n,s){const r=t.length;n=n!==void 0?n:2,s=s??n,e=e!==void 0?e:new Array(r);for(let o=0;o<r;o+=s){const a=i(t.slice(o,o+n)),l=a.length;for(let h=0,c=s;h<c;++h)e[o+h]=h>=l?t[o+h]:a[h]}return e}}function KM(i,t,e,n){const s=xe(i),r=xe(t);Fc(s,r,mx(e)),Fc(r,s,mx(n))}function ZM(i,t){return hS(),Zi(i,"EPSG:4326",t)}function Kr(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||th(i,t)===By)&&e}function th(i,t){const e=i.getCode(),n=t.getCode();let s=nS(e,n);return s||(s=G0),s}function Dc(i,t){const e=xe(i),n=xe(t);return th(e,n)}function Zi(i,t,e){return Dc(t,e)(i,void 0,i.length)}function JM(i,t,e,n){const s=Dc(t,e);return eS(i,s,void 0)}let QM=null;function uS(){return QM}function Bc(i,t){return i}function Hi(i,t){return x_&&!br(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(x_=!1,lS("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function U0(i,t){return i}function Er(i,t){return i}function _x(i,t,e){return function(n){let s,r;if(i.canWrapX()){const o=i.getExtent(),a=Ie(o);n=n.slice(0),r=rS(n,i,a),r&&(n[0]=n[0]-r*a),n[0]=xi(n[0],o[0],o[2]),n[1]=xi(n[1],o[1],o[3]),s=e(n)}else s=e(n);return r&&t.canWrapX()&&(s[0]+=r*Ie(t.getExtent())),s}}function tT(){b_(ux),b_(fx),$M(fx,ux,kM,FM)}tT();function Da(i,t,e,n,s,r,o){r=r||[],o=o||2;let a=0;for(let l=t;l<e;l+=n){const h=i[l],c=i[l+1];r[a++]=s[0]*h+s[2]*c+s[4],r[a++]=s[1]*h+s[3]*c+s[5];for(let u=2;u<o;u++)r[a++]=i[l+u]}return r&&r.length!=a&&(r.length=a),r}function zy(i,t,e,n,s,r,o){o=o||[];const a=Math.cos(s),l=Math.sin(s),h=r[0],c=r[1];let u=0;for(let f=t;f<e;f+=n){const d=i[f]-h,g=i[f+1]-c;o[u++]=h+d*a-g*l,o[u++]=c+d*l+g*a;for(let p=f+2;p<f+n;++p)o[u++]=i[p]}return o&&o.length!=u&&(o.length=u),o}function eT(i,t,e,n,s,r,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let u=t;u<e;u+=n){const f=i[u]-l,d=i[u+1]-h;a[c++]=l+s*f,a[c++]=h+r*d;for(let g=u+2;g<u+n;++g)a[c++]=i[g]}return a&&a.length!=c&&(a.length=c),a}function iT(i,t,e,n,s,r,o){o=o||[];let a=0;for(let l=t;l<e;l+=n){o[a++]=i[l]+s,o[a++]=i[l+1]+r;for(let h=l+2;h<l+n;++h)o[a++]=i[h]}return o&&o.length!=a&&(o.length=a),o}const yx=hn();class Gy extends In{constructor(){super(),this.extent_=Es(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=$w((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return de()}closestPointXY(t,e,n,s){return de()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return de()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Kc(e),this.extentRevision_=this.getRevision()}return PM(this.extent_,t)}rotate(t,e){de()}scale(t,e,n){de()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return de()}getType(){return de()}applyTransform(t){de()}intersectsExtent(t){return de()}translate(t,e){de()}transform(t,e){const n=xe(t),s=n.getUnits()=="tile-pixels"?function(r,o,a){const l=n.getExtent(),h=n.getWorldExtent(),c=ln(h)/ln(l);return or(yx,h[0],h[3],c,-c,0,0,0),Da(r,0,r.length,a,yx,o),Dc(n,e)(r,o,a)}:Dc(n,e);return this.applyTransform(s),this}}class tl extends Gy{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Ry(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return de()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=qp(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){de()}setLayout(t,e,n){let s;if(t)s=qp(t);else{for(let r=0;r<n;++r){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=eh(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();zy(n,0,n.length,s,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=lo(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();eT(s,0,s.length,r,t,e,n,s),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();iT(n,0,n.length,s,t,e,n),this.changed()}}}function eh(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function qp(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function nT(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const s=i.getStride();return Da(n,0,n.length,s,t,e)}function vx(i,t,e,n,s,r,o){const a=i[t],l=i[t+1],h=i[e]-a,c=i[e+1]-l;let u;if(h===0&&c===0)u=t;else{const f=((s-a)*h+(r-l)*c)/(h*h+c*c);if(f>1)u=e;else if(f>0){for(let d=0;d<n;++d)o[d]=Ds(i[t+d],i[e+d],f);o.length=n;return}else u=t}for(let f=0;f<n;++f)o[f]=i[u+f];o.length=n}function Uy(i,t,e,n,s){let r=i[t],o=i[t+1];for(t+=n;t<e;t+=n){const a=i[t],l=i[t+1],h=Wo(r,o,a,l);h>s&&(s=h),r=a,o=l}return s}function Wy(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];s=Uy(i,t,a,n,s),t=a}return s}function sT(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];s=Wy(i,t,a,n,s),t=a[a.length-1]}return s}function qy(i,t,e,n,s,r,o,a,l,h,c){if(t==e)return h;let u,f;if(s===0){if(f=Wo(o,a,i[t],i[t+1]),f<h){for(u=0;u<n;++u)l[u]=i[t+u];return l.length=n,f}return h}c=c||[NaN,NaN];let d=t+n;for(;d<e;)if(vx(i,d-n,d,n,o,a,c),f=Wo(o,a,c[0],c[1]),f<h){for(h=f,u=0;u<n;++u)l[u]=c[u];l.length=n,d+=n}else d+=n*Math.max((Math.sqrt(f)-Math.sqrt(h))/s|0,1);if(r&&(vx(i,e-n,t,n,o,a,c),f=Wo(o,a,c[0],c[1]),f<h)){for(h=f,u=0;u<n;++u)l[u]=c[u];l.length=n}return h}function Vy(i,t,e,n,s,r,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];h=qy(i,t,d,n,s,r,o,a,l,h,c),t=d}return h}function rT(i,t,e,n,s,r,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const d=e[u];h=Vy(i,t,d,n,s,r,o,a,l,h,c),t=d[d.length-1]}return h}function dS(i,t,e,n){for(let s=0,r=e.length;s<r;++s)i[t++]=e[s];return t}function W0(i,t,e,n){for(let s=0,r=e.length;s<r;++s){const o=e[s];for(let a=0;a<n;++a)i[t++]=o[a]}return t}function Sf(i,t,e,n,s){s=s||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=W0(i,t,e[o],n);s[r++]=l,t=l}return s.length=r,s}function fS(i,t,e,n,s){s=s||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=Sf(i,t,e[o],n,s[r]);l.length===0&&(l[0]=t),s[r++]=l,t=l[l.length-1]}return s.length=r,s}function q0(i,t,e,n,s,r,o){const a=(e-t)/n;if(a<3){for(;t<e;t+=n)r[o++]=i[t],r[o++]=i[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-n];let c=0;for(;h.length>0;){const u=h.pop(),f=h.pop();let d=0;const g=i[f],p=i[f+1],y=i[u],_=i[u+1];for(let x=f+n;x<u;x+=n){const b=i[x],L=i[x+1],M=zM(b,L,g,p,y,_);M>d&&(c=x,d=M)}d>s&&(l[(c-t)/n]=1,f+n<c&&h.push(f,c),c+n<u&&h.push(c,u))}for(let u=0;u<a;++u)l[u]&&(r[o++]=i[t+u*n],r[o++]=i[t+u*n+1]);return o}function gS(i,t,e,n,s,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=q0(i,t,c,n,s,r,o),a.push(o),t=c}return o}function bl(i,t){return t*Math.round(i/t)}function oT(i,t,e,n,s,r,o){if(t==e)return o;let a=bl(i[t],s),l=bl(i[t+1],s);t+=n,r[o++]=a,r[o++]=l;let h,c;do if(h=bl(i[t],s),c=bl(i[t+1],s),t+=n,t==e)return r[o++]=h,r[o++]=c,o;while(h==a&&c==l);for(;t<e;){const u=bl(i[t],s),f=bl(i[t+1],s);if(t+=n,u==h&&f==c)continue;const d=h-a,g=c-l,p=u-a,y=f-l;if(d*y==g*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(g<0&&y<g||g==y||g>0&&y>g)){h=u,c=f;continue}r[o++]=h,r[o++]=c,a=h,l=c,h=u,c=f}return r[o++]=h,r[o++]=c,o}function Hy(i,t,e,n,s,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=oT(i,t,c,n,s,r,o),a.push(o),t=c}return o}function aT(i,t,e,n,s,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l],u=[];o=Hy(i,t,c,n,s,r,o,u),a.push(u),t=c[c.length-1]}return o}function Ma(i,t,e,n,s){s=s!==void 0?s:[];let r=0;for(let o=t;o<e;o+=n)s[r++]=i.slice(o,o+n);return s.length=r,s}function zd(i,t,e,n,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];s[r++]=Ma(i,t,l,n,s[r]),t=l}return s.length=r,s}function w_(i,t,e,n,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];s[r++]=l.length===1&&l[0]===t?[]:zd(i,t,l,n,s[r]),t=l[l.length-1]}return s.length=r,s}function pS(i,t,e,n){let s=0;const r=i[e-n],o=i[e-n+1];let a=0,l=0;for(;t<e;t+=n){const h=i[t]-r,c=i[t+1]-o;s+=l*h-a*c,a=h,l=c}return s/2}function mS(i,t,e,n){let s=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];s+=pS(i,t,a,n),t=a}return s}function lT(i,t,e,n){let s=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];s+=mS(i,t,a,n),t=a[a.length-1]}return s}class Gd extends tl{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Gd(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,s){return s<Zl(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Uy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,s))}getArea(){return pS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ma(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=q0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Gd(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=W0(this.flatCoordinates,0,t,this.stride),this.changed()}}let Qi=class _S extends tl{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new _S(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const r=this.flatCoordinates,o=Wo(t,e,r[0],r[1]);if(o<s){const a=this.stride;for(let l=0;l<a;++l)n[l]=r[l];return n.length=a,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return _d(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Iy(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=dS(this.flatCoordinates,0,t,this.stride),this.changed()}};function hT(i,t,e,n,s){return!ky(s,function(o){return!Ml(i,t,e,n,o[0],o[1])})}function Ml(i,t,e,n,s,r){let o=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const h=i[t],c=i[t+1];l<=r?c>r&&(h-a)*(r-l)-(s-a)*(c-l)>0&&o++:c<=r&&(h-a)*(r-l)-(s-a)*(c-l)<0&&o--,a=h,l=c}return o!==0}function Yy(i,t,e,n,s,r){if(e.length===0||!Ml(i,t,e[0],n,s,r))return!1;for(let o=1,a=e.length;o<a;++o)if(Ml(i,e[o-1],e[o],n,s,r))return!1;return!0}function cT(i,t,e,n,s,r){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(Yy(i,t,l,n,s,r))return!0;t=l[l.length-1]}return!1}function Xy(i,t,e,n,s,r,o){let a,l,h,c,u,f,d;const g=s[r+1],p=[];for(let x=0,b=e.length;x<b;++x){const L=e[x];for(c=i[L-n],f=i[L-n+1],a=t;a<L;a+=n)u=i[a],d=i[a+1],(g<=f&&d<=g||f<=g&&g<=d)&&(h=(g-f)/(d-f)*(u-c)+c,p.push(h)),c=u,f=d}let y=NaN,_=-1/0;for(p.sort(no),c=p[0],a=1,l=p.length;a<l;++a){u=p[a];const x=Math.abs(u-c);x>_&&(h=(c+u)/2,Yy(i,t,e,n,h,g)&&(y=h,_=x)),c=u}return isNaN(y)&&(y=s[r]),o?(o.push(y,g,_),o):[y,g,_]}function yS(i,t,e,n,s){let r=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Xy(i,t,l,n,s,2*o,r),t=l[l.length-1]}return r}function vS(i,t,e,n,s){let r;for(t+=n;t<e;t+=n)if(r=s(i.slice(t-n,t),i.slice(t,t+n)),r)return r;return!1}function V0(i,t,e,n,s){const r=tS(Es(),i,t,e,n);return Ri(s,r)?ir(s,r)||r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]?!0:vS(i,t,e,n,function(o,a){return IM(s,o,a)}):!1}function uT(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){if(V0(i,t,e[r],n,s))return!0;t=e[r]}return!1}function xS(i,t,e,n,s){return!!(V0(i,t,e,n,s)||Ml(i,t,e,n,s[0],s[1])||Ml(i,t,e,n,s[0],s[3])||Ml(i,t,e,n,s[2],s[1])||Ml(i,t,e,n,s[2],s[3]))}function bS(i,t,e,n,s){if(!xS(i,t,e[0],n,s))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(hT(i,e[r-1],e[r],n,s)&&!V0(i,e[r-1],e[r],n,s))return!1;return!0}function dT(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(bS(i,t,a,n,s))return!0;t=a[a.length-1]}return!1}function fT(i,t,e,n){for(;t<e-n;){for(let s=0;s<n;++s){const r=i[t+s];i[t+s]=i[e-n+s],i[e-n+s]=r}t+=n,e-=n}}function $y(i,t,e,n){let s=0,r=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],l=i[t+1];s+=(a-r)*(l+o),r=a,o=l}return s===0?void 0:s>0}function Ky(i,t,e,n,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=$y(i,t,a,n);if(r===0){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;t=a}return!0}function wS(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(!Ky(i,t,a,n,s))return!1;a.length&&(t=a[a.length-1])}return!0}function Vp(i,t,e,n,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=$y(i,t,a,n);(r===0?s&&l||!s&&!l:s&&!l||!s&&l)&&fT(i,t,a,n),t=a}return t}function S_(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r)t=Vp(i,t,e[r],n,s);return t}function gT(i,t){const e=[];let n=0,s=0,r;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=$y(i,n,l,2);if(r===void 0&&(r=h),h===r)e.push(t.slice(s,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[s])}s=o+1,n=l}return e}class jc extends tl{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Ye(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new jc(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Zl(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wy(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vy(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return Yy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return mS(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Vp(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,zd(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=lo(this.getExtent());this.flatInteriorPoint_=Xy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Qi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Gd(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,s=[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],h=new Gd(e.slice(r,l),t);s.push(h),r=l}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ky(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Vp(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Hy(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new jc(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return bS(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Sf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}const sr=jc;function pT(i,t,e,n){e=e||32;const s=[];for(let r=0;r<e;++r)Ye(s,YM(i,t,2*Math.PI*r/e,n));return s.push(s[0],s[1]),new jc(s,"XY",[s.length])}function xx(i){if(Jl(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],s=i[3],r=[t,e,t,s,n,s,n,e,t,e];return new jc(r,"XY",[r.length])}const Pi={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},mT={ERROR:"error"};class _T extends os{constructor(t){super(mT.ERROR),this.code=t.code,this.message=t.message}}class SS extends In{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.position_=null,this.transform_=G0,this.watchId_=void 0,this.addChangeListener(Pi.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(Pi.TRACKING,this.handleTrackingChanged_),t.projection!==void 0&&this.setProjection(t.projection),t.trackingOptions!==void 0&&this.setTrackingOptions(t.trackingOptions),this.setTracking(t.tracking!==void 0?t.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const t=this.getProjection();t&&(this.transform_=th(xe("EPSG:4326"),t),this.position_&&this.set(Pi.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const t=this.getTracking();t&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!t&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(t){const e=t.coords;this.set(Pi.ACCURACY,e.accuracy),this.set(Pi.ALTITUDE,e.altitude===null?void 0:e.altitude),this.set(Pi.ALTITUDE_ACCURACY,e.altitudeAccuracy===null?void 0:e.altitudeAccuracy),this.set(Pi.HEADING,e.heading===null?void 0:Lr(e.heading)),this.position_?(this.position_[0]=e.longitude,this.position_[1]=e.latitude):this.position_=[e.longitude,e.latitude];const n=this.transform_(this.position_);this.set(Pi.POSITION,n.slice()),this.set(Pi.SPEED,e.speed===null?void 0:e.speed);const s=pT(this.position_,e.accuracy);s.applyTransform(this.transform_),this.set(Pi.ACCURACY_GEOMETRY,s),this.changed()}positionError_(t){this.dispatchEvent(new _T(t))}getAccuracy(){return this.get(Pi.ACCURACY)}getAccuracyGeometry(){return this.get(Pi.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(Pi.ALTITUDE)}getAltitudeAccuracy(){return this.get(Pi.ALTITUDE_ACCURACY)}getHeading(){return this.get(Pi.HEADING)}getPosition(){return this.get(Pi.POSITION)}getProjection(){return this.get(Pi.PROJECTION)}getSpeed(){return this.get(Pi.SPEED)}getTracking(){return this.get(Pi.TRACKING)}getTrackingOptions(){return this.get(Pi.TRACKING_OPTIONS)}setProjection(t){this.set(Pi.PROJECTION,xe(t))}setTracking(t){this.set(Pi.TRACKING,t)}setTrackingOptions(t){this.set(Pi.TRACKING_OPTIONS,t)}}const Sn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},re={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Ud={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var An={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};An.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};An.max=An.whitepoint[2].D65;An.rgb=function(i,t){t=t||An.whitepoint[2].E;var e=i[0]/t[0],n=i[1]/t[1],s=i[2]/t[2],r,o,a;return r=e*3.240969941904521+n*-1.537383177570093+s*-.498610760293,o=e*-.96924363628087+n*1.87596750150772+s*.041555057407175,a=e*.055630079696993+n*-.20397695888897+s*1.056971514242878,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=r*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,r=Math.min(Math.max(0,r),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[r*255,o*255,a*255]};Ud.xyz=function(i,t){var e=i[0]/255,n=i[1]/255,s=i[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;var r=e*.41239079926595+n*.35758433938387+s*.18048078840183,o=e*.21263900587151+n*.71516867876775+s*.072192315360733,a=e*.019330818715591+n*.11919477979462+s*.95053215224966;return t=t||An.whitepoint[2].E,[r*t[0],o*t[1],a*t[2]]};const Zy={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(i,t,e){var n,s,r,o,a,l,h,c,u,f,d,g,p;if(r=i[0],o=i[1],a=i[2],r===0)return[0,0,0];var y=.0011070564598794539;return t=t||"D65",e=e||2,u=An.whitepoint[e][t][0],f=An.whitepoint[e][t][1],d=An.whitepoint[e][t][2],g=4*u/(u+15*f+3*d),p=9*f/(u+15*f+3*d),n=o/(13*r)+g||0,s=a/(13*r)+p||0,h=r>8?f*Math.pow((r+16)/116,3):f*r*y,l=h*9*n/(4*s)||0,c=h*(12-3*n-20*s)/(4*s)||0,[l,h,c]}};An.luv=function(i,t,e){var n,s,r,o,a,l,h,c,u,f,d,g,p,y=.008856451679035631,_=903.2962962962961;t=t||"D65",e=e||2,u=An.whitepoint[e][t][0],f=An.whitepoint[e][t][1],d=An.whitepoint[e][t][2],g=4*u/(u+15*f+3*d),p=9*f/(u+15*f+3*d),l=i[0],h=i[1],c=i[2],n=4*l/(l+15*h+3*c)||0,s=9*h/(l+15*h+3*c)||0;var x=h/f;return r=x<=y?_*x:116*Math.pow(x,1/3)-16,o=13*r*(n-g),a=13*r*(s-p),[r,o,a]};var ES={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(i){var t=i[0],e=i[1],n=i[2],s,r,o;return o=n/360*2*Math.PI,s=e*Math.cos(o),r=e*Math.sin(o),[t,s,r]},xyz:function(i){return Zy.xyz(ES.luv(i))}};Zy.lchuv=function(i){var t=i[0],e=i[1],n=i[2],s=Math.sqrt(e*e+n*n),r=Math.atan2(n,e),o=r*360/2/Math.PI;return o<0&&(o+=360),[t,s,o]};An.lchuv=function(i){return Zy.lchuv(An.luv(i))};var Bo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CS(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var yT={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const bx=CS(yT);var wx={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function vT(i){var c,u;var t,e=[],n=1,s;if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(i=String(i).toLowerCase(),bx[i])e=bx[i].slice(),s="rgb";else if(i==="transparent")n=0,s="rgb",e=[0,0,0];else if(i[0]==="#"){var r=i.slice(1),o=r.length,a=o<=4;n=1,a?(e=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],o===4&&(n=parseInt(r[3]+r[3],16)/255)):(e=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],o===8&&(n=parseInt(r[6]+r[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(i)){var l=t[1];s=l.replace(/a$/,"");var h=s==="cmyk"?4:s==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=e.shift()),e=e.map(function(f,d){if(f[f.length-1]==="%")return f=parseFloat(f)/100,d===3?f:s==="rgb"?f*255:s[0]==="h"||s[0]==="l"&&!d?f*100:s==="lab"?f*125:s==="lch"?d<2?f*150:f*360:s[0]==="o"&&!d?f:s==="oklab"?f*.4:s==="oklch"?d<2?f*.4:f*360:f;if(s[d]==="h"||d===2&&s[s.length-1]==="h"){if(wx[f]!==void 0)return wx[f];if(f.endsWith("deg"))return parseFloat(f);if(f.endsWith("turn"))return parseFloat(f)*360;if(f.endsWith("grad"))return parseFloat(f)*360/400;if(f.endsWith("rad"))return parseFloat(f)*180/Math.PI}return f==="none"?0:parseFloat(f)}),n=e.length>h?e.pop():1}else/[0-9](?:\s|\/|,)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(f){return parseFloat(f)}),s=((u=(c=i.match(/([a-z])/ig))==null?void 0:c.join(""))==null?void 0:u.toLowerCase())||"rgb");return{space:s,values:e,alpha:n}}const c1={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(i){var t=i[0]/360,e=i[1]/100,n=i[2]/100,s,r,o,a,l,h=0;if(e===0)return l=n*255,[l,l,l];for(r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,a=[0,0,0];h<3;)o=t+1/3*-(h-1),o<0?o++:o>1&&o--,l=6*o<1?s+(r-s)*6*o:2*o<1?r:3*o<2?s+(r-s)*(2/3-o)*6:s,a[h++]=l*255;return a}};Ud.hsl=function(i){var t=i[0]/255,e=i[1]/255,n=i[2]/255,s=Math.min(t,e,n),r=Math.max(t,e,n),o=r-s,a,l,h;return r===s?a=0:t===r?a=(e-n)/o:e===r?a=2+(n-t)/o:n===r&&(a=4+(t-e)/o),a=Math.min(a*60,360),a<0&&(a+=360),h=(s+r)/2,r===s?l=0:h<=.5?l=o/(r+s):l=o/(2-r-s),[a,l*100,h*100]};function xT(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var t,e=vT(i);if(!e.space)return[];const n=e.space[0]==="h"?c1.min:Ud.min,s=e.space[0]==="h"?c1.max:Ud.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],n[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],n[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],n[2]),s[2]),e.space[0]==="h"&&(t=c1.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}const Jy=[NaN,NaN,NaN,0];function nr(i){return typeof i=="string"?i:t2(i)}const bT=1024,Du={};let u1=0;function wT(i){if(i.length===4)return i;const t=i.slice();return t[3]=1,t}function Sx(i){const t=An.lchuv(Ud.xyz(i));return t[3]=i[3],t}function ST(i){const t=An.rgb(ES.xyz(i));return t[3]=i[3],t}function Qy(i){if(i==="none")return Jy;if(Du.hasOwnProperty(i))return Du[i];if(u1>=bT){let e=0;for(const n in Du)e++&3||(delete Du[n],--u1)}const t=xT(i);if(t.length!==4)throw new Error('failed to parse "'+i+'" as color');for(const e of t)if(isNaN(e))throw new Error('failed to parse "'+i+'" as color');return LS(t),Du[i]=t,++u1,t}function ql(i){return Array.isArray(i)?i:Qy(i)}function LS(i){return i[0]=xi(i[0]+.5|0,0,255),i[1]=xi(i[1]+.5|0,0,255),i[2]=xi(i[2]+.5|0,0,255),i[3]=xi(i[3],0,1),i}function t2(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const s=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+t+","+e+","+n+","+s+")"}const Ua=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",ET=Ua.includes("firefox"),CT=Ua.includes("safari")&&!Ua.includes("chrom"),LT=CT&&(Ua.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ua)),MT=Ua.includes("webkit")&&!Ua.includes("edge"),e2=Ua.includes("macintosh"),Tl=typeof devicePixelRatio<"u"?devicePixelRatio:1,MS=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,i2=typeof Image<"u"&&Image.prototype.decode,TT=typeof createImageBitmap=="function",TS=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();function Bi(i,t,e,n){let s;return e&&e.length?s=e.shift():MS?s=new OffscreenCanvas(i||300,t||300):s=document.createElement("canvas"),i&&(s.width=i),t&&(s.height=t),s.getContext("2d",n)}let d1;function Hp(){return d1||(d1=Bi(1,1)),d1}function zc(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function AT(i){let t=i.offsetWidth;const e=getComputedStyle(i);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function PT(i){let t=i.offsetHeight;const e=getComputedStyle(i);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function Yp(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function AS(i){for(;i.lastChild;)i.lastChild.remove()}function IT(i,t){const e=i.childNodes;for(let n=0;;++n){const s=e[n],r=t[n];if(!s&&!r)break;if(s!==r){if(!s){i.appendChild(r);continue}if(!r){i.removeChild(s),--n;continue}i.insertBefore(r,s)}}}class PS extends vf{constructor(t,e,n,s){super(),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state=typeof s=="function"?re.IDLE:s,this.image_=null,this.loader=typeof s=="function"?s:null}changed(){this.dispatchEvent(ce.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==re.IDLE&&this.loader){this.state=re.LOADING,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;Kw(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(n=>{"image"in n&&(this.image_=n.image),"extent"in n&&(this.extent=n.extent),"resolution"in n&&(this.resolution=n.resolution),"pixelRatio"in n&&(this.pixelRatio_=n.pixelRatio),(n instanceof HTMLImageElement||n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement)&&(this.image_=n),this.state=re.LOADED}).catch(n=>{this.state=re.ERROR,console.error(n)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}}function RT(i,t,e){const n=i;let s=!0,r=!1,o=!1;const a=[Gp(n,ce.LOAD,function(){o=!0,r||t()})];return n.src&&i2?(r=!0,n.decode().then(function(){s&&t()}).catch(function(l){s&&(o?t():e())})):a.push(Gp(n,ce.ERROR,e)),function(){s=!1,a.forEach(Ke)}}function NT(i,t){return new Promise((e,n)=>{function s(){o(),e(i)}function r(){o(),n(new Error("Image load error"))}function o(){i.removeEventListener("load",s),i.removeEventListener("error",r)}i.addEventListener("load",s),i.addEventListener("error",r)})}function IS(i,t){return t&&(i.src=t),i.src&&i2?new Promise((e,n)=>i.decode().then(()=>e(i)).catch(s=>i.complete&&i.width?e(i):n(s))):NT(i)}function RS(i,t){return t&&(i.src=t),i.src&&i2&&TT?i.decode().then(()=>createImageBitmap(i)).catch(e=>{if(i.complete&&i.width)return i;throw e}):IS(i)}class kT{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const s=f1(t,e,n);return s in this.cache_?this.cache_[s]:null}getPattern(t,e,n){const s=f1(t,e,n);return s in this.patternCache_?this.patternCache_[s]:null}set(t,e,n,s,r){const o=f1(t,e,n),a=o in this.cache_;this.cache_[o]=s,r&&(s.getImageState()===re.IDLE&&s.load(),s.getImageState()===re.LOADING?s.ready().then(()=>{this.patternCache_[o]=Hp().createPattern(s.getImage(1),"repeat")}):this.patternCache_[o]=Hp().createPattern(s.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function f1(i,t,e){const n=e?ql(e):"null";return t+":"+i+":"+n}const Zr=new kT;let Bu=null;class FT extends vf{constructor(t,e,n,s,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=r,this.imageState_=s===void 0?re.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===re.LOADED){Bu||(Bu=Bi(1,1,void 0,{willReadFrequently:!0})),Bu.drawImage(this.image_,0,0);try{Bu.getImageData(0,0,1,1),this.tainted_=!1}catch{Bu=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ce.CHANGE)}handleImageError_(){this.imageState_=re.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=re.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Bi(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===re.IDLE){this.image_||this.initializeImage_(),this.imageState_=re.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&IS(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==re.LOADED)return;const e=this.image_,n=Bi(Math.ceil(e.width*t),Math.ceil(e.height*t)),s=n.canvas;n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=nr(this.color_),n.fillRect(0,0,s.width/t,s.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=s}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===re.LOADED||this.imageState_===re.ERROR)t();else{const e=()=>{(this.imageState_===re.LOADED||this.imageState_===re.ERROR)&&(this.removeEventListener(ce.CHANGE,e),t())};this.addEventListener(ce.CHANGE,e)}})),this.ready_}}function n2(i,t,e,n,s,r){let o=t===void 0?void 0:Zr.get(t,e,s);return o||(o=new FT(i,i&&"src"in i?i.src||void 0:t,e,n,s),Zr.set(t,e,s,o,r)),r&&o&&!Zr.getPattern(t,e,s)&&Zr.set(t,e,s,o,r),o}class ke{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new ke({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=n2(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===re.IDLE&&e.load(),e.getImageState()===re.LOADING&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function Xp(i,t,e,n,s,r,o){let a,l;const h=(e-t)/n;if(h===1)a=t;else if(h===2)a=t,l=s;else if(h!==0){let c=i[t],u=i[t+1],f=0;const d=[0];for(let y=t+n;y<e;y+=n){const _=i[y],x=i[y+1];f+=Math.sqrt((_-c)*(_-c)+(x-u)*(x-u)),d.push(f),c=_,u=x}const g=s*f,p=yM(d,g);p<0?(l=(g-d[-p-2])/(d[-p-1]-d[-p-2]),a=t+(-p-2)*n):a=t+p*n}o=o>1?o:2,r=r||new Array(o);for(let c=0;c<o;++c)r[c]=a===void 0?NaN:l===void 0?i[a+c]:Ds(i[a+c],i[a+n+c],l);return r}function E_(i,t,e,n,s,r){if(e==t)return null;let o;if(s<i[t+n-1])return r?(o=i.slice(t,t+n),o[n-1]=s,o):null;if(i[e-1]<s)return r?(o=i.slice(e-n,e),o[n-1]=s,o):null;if(s==i[t+n-1])return i.slice(t,t+n);let a=t/n,l=e/n;for(;a<l;){const f=a+l>>1;s<i[(f+1)*n-1]?l=f:a=f+1}const h=i[a*n-1];if(s==h)return i.slice((a-1)*n,(a-1)*n+n);const c=i[(a+1)*n-1],u=(s-h)/(c-h);o=[];for(let f=0;f<n-1;++f)o.push(Ds(i[(a-1)*n+f],i[a*n+f],u));return o.push(s),o}function OT(i,t,e,n,s,r,o){if(o)return E_(i,t,e[e.length-1],n,s,r);let a;if(s<i[n-1])return r?(a=i.slice(0,n),a[n-1]=s,a):null;if(i[i.length-1]<s)return r?(a=i.slice(i.length-n),a[n-1]=s,a):null;for(let l=0,h=e.length;l<h;++l){const c=e[l];if(t!=c){if(s<i[t+n-1])return null;if(s<=i[c-1])return E_(i,t,c,n,s,!1);t=c}}return null}function NS(i,t,e,n){let s=i[t],r=i[t+1],o=0;for(let a=t+n;a<e;a+=n){const l=i[a],h=i[a+1];o+=Math.sqrt((l-s)*(l-s)+(h-r)*(h-r)),s=l,r=h}return o}class cn extends tl{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){Ye(this.flatCoordinates,t),this.changed()}clone(){const t=new cn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Zl(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Uy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,s))}forEachSegment(t){return vS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,E_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Ma(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Xp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return NS(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=q0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new cn(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return V0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=W0(this.flatCoordinates,0,t,this.stride),this.changed()}}class si{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new si({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}function Ex(i){return i[0]>0&&i[1]>0}function DT(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function ss(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}class H0{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ss(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new H0({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return de()}getImage(t){return de()}getHitDetectionImage(){return de()}getPixelRatio(t){return 1}getImageState(){return de()}getImageSize(){return de()}getOrigin(){return de()}getSize(){return de()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ss(t)}listenImageChange(t){de()}load(){de()}unlistenImageChange(t){de()}ready(){return Promise.resolve()}}function Jr(i){return i?Array.isArray(i)?t2(i):typeof i=="object"&&"src"in i?BT(i):i:null}function BT(i){if(!i.offset||!i.size)return Zr.getPattern(i.src,"anonymous",i.color);const t=i.src+":"+i.offset,e=Zr.getPattern(t,void 0,i.color);if(e)return e;const n=Zr.get(i.src,"anonymous",null);if(n.getImageState()!==re.LOADED)return null;const s=Bi(i.size[0],i.size[1]);return s.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),n2(s.canvas,t,void 0,re.LOADED,i.color,!0),Zr.getPattern(t,void 0,i.color)}const Rg="ol-hidden",jT="ol-selectable",Zc="ol-unselectable",Cx="ol-unsupported",Y0="ol-control",Lx="ol-collapsed",zT=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Mx=["style","variant","weight","size","lineHeight","family"],kS=function(i){const t=i.match(zT);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,s=Mx.length;n<s;++n){const r=t[n+1];r!==void 0&&(e[Mx[n]]=r)}return e.families=e.family.split(/,\s?/),e},FS="10px sans-serif",ms="#000",Gc="round",qo=[],Vo=0,Uc="round",Wd=10,qd="#000",Vd="center",$p="middle",Al=[0,0,0,0],Hd=1,Ao=new In;let tc=null,C_;const L_={},GT=function(){const t="32px ",e=["monospace","serif"],n=e.length,s="wmytzilWMYTZIL@#/&?$%10";let r,o;function a(h,c,u){let f=!0;for(let d=0;d<n;++d){const g=e[d];if(o=Kp(h+" "+c+" "+t+g,s),u!=g){const p=Kp(h+" "+c+" "+t+u+","+g,s);f=f&&p!=o}}return!!f}function l(){let h=!0;const c=Ao.getKeys();for(let u=0,f=c.length;u<f;++u){const d=c[u];if(Ao.get(d)<100){const[g,p,y]=d.split(`
`);a(g,p,y)?(Kl(L_),tc=null,C_=void 0,Ao.set(d,100)):(Ao.set(d,Ao.get(d)+1,!0),h=!1)}}h&&(clearInterval(r),r=void 0)}return function(h){const c=kS(h);if(!c)return;const u=c.families;for(let f=0,d=u.length;f<d;++f){const g=u[f],p=c.style+`
`+c.weight+`
`+g;Ao.get(p)===void 0&&(Ao.set(p,100,!0),a(c.style,c.weight,g)||(Ao.set(p,0,!0),r===void 0&&(r=setInterval(l,32))))}}}(),UT=function(){let i;return function(t){let e=L_[t];if(e==null){if(MS){const n=kS(t),s=OS(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);L_[t]=e}return e}}();function OS(i,t){return tc||(tc=Bi(1,1)),i!=C_&&(tc.font=i,C_=tc.font),tc.measureText(t)}function Kp(i,t){return OS(i,t).width}function Tx(i,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((s,r)=>Math.max(s,Kp(i,r)),0);return e[t]=n,n}function WT(i,t){const e=[],n=[],s=[];let r=0,o=0,a=0,l=0;for(let h=0,c=t.length;h<=c;h+=2){const u=t[h];if(u===`
`||h===c){r=Math.max(r,o),s.push(o),o=0,a+=l,l=0;continue}const f=t[h+1]||i.font,d=Kp(f,u);e.push(d),o+=d;const g=UT(f);n.push(g),l=Math.max(l,g)}return{width:r,height:a,widths:e,heights:n,lineWidths:s}}function qT(i,t,e,n,s,r,o,a,l,h,c){i.save(),e!==1&&(i.globalAlpha===void 0?i.globalAlpha=u=>u.globalAlpha*=e:i.globalAlpha*=e),t&&i.transform.apply(i,t),n.contextInstructions?(i.translate(l,h),i.scale(c[0],c[1]),VT(n,i)):c[0]<0||c[1]<0?(i.translate(l,h),i.scale(c[0],c[1]),i.drawImage(n,s,r,o,a,0,0,o,a)):i.drawImage(n,s,r,o,a,l,h,o*c[0],a*c[1]),i.restore()}function VT(i,t){const e=i.contextInstructions;for(let n=0,s=e.length;n<s;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class Jc extends H0{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?re.LOADING:re.LOADED,this.imageState_===re.LOADING&&this.ready().then(()=>this.imageState_=re.LOADED),this.render()}clone(){const t=this.getScale(),e=new Jc({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,s=Bi(n.size*t,n.size*t);this.draw_(n,s,t),e=s.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius,r=this.radius2_===void 0?s:this.radius2_;if(s<r){const k=s;s=r,r=k}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=r*Math.sin(a),h=Math.sqrt(r*r-l*l),c=s-h,u=Math.sqrt(l*l+c*c),f=u/l;if(t==="miter"&&f<=n)return f*e;const d=e/2/f,g=e/2*(c/u),y=Math.sqrt((s+d)*(s+d)+g*g)-s;if(this.radius2_===void 0||t==="bevel")return y*2;const _=s*Math.sin(a),x=Math.sqrt(s*s-_*_),b=r-x,M=Math.sqrt(_*_+b*b)/_;if(M<=n){const k=M*e/2-r-s;return 2*Math.max(y,k)}return y*2}createRenderOptions(){let t=Gc,e=Uc,n=0,s=null,r=0,o,a=0;this.stroke_&&(o=Jr(this.stroke_.getColor()??qd),a=this.stroke_.getWidth()??Hd,s=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Uc,t=this.stroke_.getLineCap()??Gc,n=this.stroke_.getMiterLimit()??Wd);const l=this.calculateLineJoinSize_(e,a,n),h=Math.max(this.radius,this.radius2_||0),c=Math.ceil(2*h+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:t,lineDash:s,lineDashOffset:r,lineJoin:e,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=ms),e.fillStyle=Jr(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),s=0;typeof n=="string"&&(n=ql(n)),n===null?s=1:Array.isArray(n)&&(s=n.length===4?n[3]:1),s===0&&(e=Bi(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const s=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=r+a*o,h=a%2===0?n:s;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=ms,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Ir extends Jc{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Ir({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class Pe{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Ax,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Pe({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ax,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function HT(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(De(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[i]),t=function(){return e}}return t}let g1=null;function DS(i,t){if(!g1){const e=new ke({color:"rgba(255,255,255,0.4)"}),n=new si({color:"#3399CC",width:1.25});g1=[new Pe({image:new Ir({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return g1}function s2(){const i={},t=[255,255,255,1],e=[0,153,255,1],n=3;return i.Polygon=[new Pe({fill:new ke({color:[255,255,255,.5]})})],i.MultiPolygon=i.Polygon,i.LineString=[new Pe({stroke:new si({color:t,width:n+2})}),new Pe({stroke:new si({color:e,width:n})})],i.MultiLineString=i.LineString,i.Circle=i.Polygon.concat(i.LineString),i.Point=[new Pe({image:new Ir({radius:n*2,fill:new ke({color:e}),stroke:new si({color:t,width:n/2})}),zIndex:1/0})],i.MultiPoint=i.Point,i.GeometryCollection=i.Polygon.concat(i.LineString,i.Point),i}function Ax(i){return i.getGeometry()}const YT="#333";class qn{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=ss(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ke({color:YT}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new qn({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ss(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Qe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class BS extends In{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[Qe.OPACITY]=t.opacity!==void 0?t.opacity:1,De(typeof e[Qe.OPACITY]=="number","Layer opacity must be a number"),e[Qe.VISIBLE]=t.visible!==void 0?t.visible:!0,e[Qe.Z_INDEX]=t.zIndex,e[Qe.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[Qe.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[Qe.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[Qe.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=xi(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return de()}getLayerStatesArray(t){return de()}getExtent(){return this.get(Qe.EXTENT)}getMaxResolution(){return this.get(Qe.MAX_RESOLUTION)}getMinResolution(){return this.get(Qe.MIN_RESOLUTION)}getMinZoom(){return this.get(Qe.MIN_ZOOM)}getMaxZoom(){return this.get(Qe.MAX_ZOOM)}getOpacity(){return this.get(Qe.OPACITY)}getSourceState(){return de()}getVisible(){return this.get(Qe.VISIBLE)}getZIndex(){return this.get(Qe.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Qe.EXTENT,t)}setMaxResolution(t){this.set(Qe.MAX_RESOLUTION,t)}setMinResolution(t){this.set(Qe.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(Qe.MAX_ZOOM,t)}setMinZoom(t){this.set(Qe.MIN_ZOOM,t)}setOpacity(t){De(typeof t=="number","Layer opacity must be a number"),this.set(Qe.OPACITY,t)}setVisible(t){this.set(Qe.VISIBLE,t)}setZIndex(t){this.set(Qe.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const vi={ANIMATING:0,INTERACTING:1},pr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},XT=42,r2=256;function Px(i,t,e){return function(n,s,r,o,a){if(!n)return;if(!s&&!t)return n;const l=t?0:r[0]*s,h=t?0:r[1]*s,c=a?a[0]:0,u=a?a[1]:0;let f=i[0]+l/2+c,d=i[2]-l/2+c,g=i[1]+h/2+u,p=i[3]-h/2+u;f>d&&(f=(d+f)/2,d=f),g>p&&(g=(p+g)/2,p=g);let y=xi(n[0],f,d),_=xi(n[1],g,p);if(o&&e&&s){const x=30*s;y+=-x*Math.log(1+Math.max(0,f-n[0])/x)+x*Math.log(1+Math.max(0,n[0]-d)/x),_+=-x*Math.log(1+Math.max(0,g-n[1])/x)+x*Math.log(1+Math.max(0,n[1]-p)/x)}return[y,_]}}function $T(i){return i}function o2(i,t,e,n){const s=Ie(t)/e[0],r=ln(t)/e[1];return n?Math.min(i,Math.max(s,r)):Math.min(i,Math.min(s,r))}function a2(i,t,e){let n=Math.min(i,t);const s=50;return n*=Math.log(1+s*Math.max(0,i/t-1))/s+1,e&&(n=Math.max(n,e),n/=Math.log(1+s*Math.max(0,e/i-1))/s+1),xi(n,e/2,t*2)}function KT(i,t,e,n){return t=t!==void 0?t:!0,function(s,r,o,a){if(s!==void 0){const l=i[0],h=i[i.length-1],c=e?o2(l,e,o,n):l;if(a)return t?a2(s,c,h):xi(s,h,c);const u=Math.min(c,s),f=Math.floor(k0(i,u,r));return i[f]>c&&f<i.length-1?i[f+1]:i[f]}}}function ZT(i,t,e,n,s,r){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(o,a,l,h){if(o!==void 0){const c=s?o2(t,s,l,r):t;if(h)return n?a2(o,c,e):xi(o,e,c);const u=1e-9,f=Math.ceil(Math.log(t/c)/Math.log(i)-u),d=-a*(.5-u)+.5,g=Math.min(c,o),p=Math.floor(Math.log(t/g)/Math.log(i)+d),y=Math.max(f,p),_=t/Math.pow(i,y);return xi(_,e,c)}}}function Ix(i,t,e,n,s){return e=e!==void 0?e:!0,function(r,o,a,l){if(r!==void 0){const h=n?o2(i,n,a,s):i;return!e||!l?xi(r,t,h):a2(r,h,t)}}}function l2(i){if(i!==void 0)return 0}function Rx(i){if(i!==void 0)return i}function JT(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function QT(i){const t=Lr(5);return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function jS(i){return Math.pow(i,3)}function Qc(i){return 1-jS(1-i)}function tA(i){return 3*i*i-2*i*i*i}function eA(i){return i}const p1=0;class $r extends In{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=jy(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&hS(),t.center&&(t.center=Hi(t.center,this.projection_)),t.extent&&(t.extent=Er(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in pr)delete e[a];this.setProperties(e,!0);const n=nA(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const s=iA(t),r=n.constraint,o=sA(t);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const s=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(s[3]-e[3]+e[1]-s[1]),a=r/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let s=arguments[n];s.center&&(s=Object.assign({},s),s.center=Hi(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=Hi(s.anchor,this.getProjection())),e[n]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const c=arguments[s];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(s===e){n&&Ng(n,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;s<e;++s){const c=arguments[s],u={start:r,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||tA,callback:n};if(c.center&&(u.sourceCenter=o,u.targetCenter=c.center.slice(),o=u.targetCenter),c.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(c.zoom),a=u.targetResolution):c.resolution&&(u.sourceResolution=a,u.targetResolution=c.resolution,a=u.targetResolution),c.rotation!==void 0){u.sourceRotation=l;const f=Ol(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+f,l=u.targetRotation}rA(u)?u.complete=!0:r+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(vi.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[vi.ANIMATING]>0}getInteracting(){return this.hints_[vi.INTERACTING]>0}cancelAnimations(){this.setHint(vi.ANIMATING,-this.hints_[vi.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const s=this.animations_[e];if(s[0].callback&&Ng(s[0].callback,!1),!t)for(let r=0,o=s.length;r<o;++r){const a=s[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let r=!0;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.complete)continue;const h=t-l.start;let c=l.duration>0?h/l.duration:1;c>=1?(l.complete=!0,c=1):r=!1;const u=l.easing(c);if(l.sourceCenter){const f=l.sourceCenter[0],d=l.sourceCenter[1],g=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const y=f+u*(g-f),_=d+u*(p-d);this.targetCenter_=[y,_]}if(l.sourceResolution&&l.targetResolution){const f=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const d=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(f,0,d,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=u===1?Ol(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const d=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(d,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(r){this.animations_[n]=null,this.setHint(vi.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&Ng(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const s=this.getCenterInternal();return s!==void 0&&(n=[s[0]-e[0],s[1]-e[1]],Dy(n,t-this.getRotation()),UM(n,e)),n}calculateCenterZoom(t,e){let n;const s=this.getCenterInternal(),r=this.getResolution();if(s!==void 0&&r!==void 0){const o=e[0]-t*(e[0]-s[0])/r,a=e[1]-t*(e[1]-s[1])/r;n=[o,a]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],s=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Bc(t,this.getProjection())}getCenterInternal(){return this.get(pr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return U0(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();De(e,"The view center is not defined");const n=this.getResolution();De(n!==void 0,"The view resolution is not defined");const s=this.getRotation();return De(s!==void 0,"The view rotation is not defined"),Bd(e,n,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(pr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Er(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=Ie(t)/e[0],s=ln(t)/e[1];return Math.max(n,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(e/n)/Math.log(t);return function(r){return e/Math.pow(t,r*s)}}getRotation(){return this.get(pr.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,r=Math.log(n/s)/e;return function(o){return Math.log(n/o)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=m1(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,n)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,s;if(this.resolutions_){const r=k0(this.resolutions_,t,1);e=r,n=this.resolutions_[r],r==this.resolutions_.length-1?s=2:s=n/this.resolutions_[r+1]}else n=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(n/t)/Math.log(s)}getResolutionForZoom(t){var e;if((e=this.resolutions_)!=null&&e.length){if(this.resolutions_.length===1)return this.resolutions_[0];const n=xi(Math.floor(t),0,this.resolutions_.length-2),s=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(s,xi(t-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(De(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){De(!Jl(t),"Cannot fit empty extent provided as `geometry`");const s=Er(t,this.getProjection());n=xx(s)}else if(t.getType()==="Circle"){const s=Er(t.getExtent(),this.getProjection());n=xx(s),n.rotate(this.getRotation(),lo(s))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),s=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,c=-1/0;for(let u=0,f=r.length;u<f;u+=o){const d=r[u]*n-r[u+1]*s,g=r[u]*s+r[u+1]*n;a=Math.min(a,d),l=Math.min(l,g),h=Math.max(h,d),c=Math.max(c,g)}return[a,l,h,c]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,r?0:1);const h=this.getRotation(),c=Math.sin(h),u=Math.cos(h),f=lo(a);f[0]+=(s[1]-s[3])/2*l,f[1]+=(s[0]-s[2])/2*l;const d=f[0]*u-f[1]*c,g=f[1]*u+f[0]*c,p=this.getConstrainedCenter([d,g],l),y=e.callback?e.callback:Nc;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},y):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),Ng(y,!0))}centerOn(t,e,n){this.centerOnInternal(Hi(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(m1(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,s){let r;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-n),l=m1(t,s,[a[0]/2+o[3],a[1]/2+o[0]],e,n);r=[t[0]-l[0],t[1]-l[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Bc(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Hi(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,s,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Hi(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Hi(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,n),a=this.constraints_.center(this.targetCenter_,o,r,n,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(pr.ROTATION)!==s&&this.set(pr.ROTATION,s),this.get(pr.RESOLUTION)!==o&&(this.set(pr.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(pr.CENTER)||!br(this.get(pr.CENTER),a))&&this.set(pr.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const s=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,s,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!br(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:t,easing:Qc,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(vi.INTERACTING,1)}endInteraction(t,e,n){n=n&&Hi(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(vi.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function Ng(i,t){setTimeout(function(){i(t)},0)}function iA(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Px(i.extent,i.constrainOnlyCenter,e)}const t=jy(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Px(e,!1,!1)}return $T}function nA(i){let t,e,n,o=i.minZoom!==void 0?i.minZoom:p1,a=i.maxZoom!==void 0?i.maxZoom:28;const l=i.zoomFactor!==void 0?i.zoomFactor:2,h=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,u=i.showFullExtent!==void 0?i.showFullExtent:!1,f=jy(i.projection,"EPSG:3857"),d=f.getExtent();let g=i.constrainOnlyCenter,p=i.extent;if(!h&&!p&&f.isGlobal()&&(g=!1,p=d),i.resolutions!==void 0){const y=i.resolutions;e=y[o],n=y[a]!==void 0?y[a]:y[y.length-1],i.constrainResolution?t=KT(y,c,!g&&p,u):t=Ix(e,n,c,!g&&p,u)}else{const _=(d?Math.max(Ie(d),ln(d)):360*kc.degrees/f.getMetersPerUnit())/r2/Math.pow(2,p1),x=_/Math.pow(2,28-p1);e=i.maxResolution,e!==void 0?o=0:e=_/Math.pow(l,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(l,a):n=_/Math.pow(l,a):n=x),a=o+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,a-o),i.constrainResolution?t=ZT(l,e,n,c,!g&&p,u):t=Ix(e,n,c,!g&&p,u)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:o,zoomFactor:l}}function sA(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?QT():e===!1?Rx:typeof e=="number"?JT(e):Rx}return l2}function rA(i){return!(i.sourceCenter&&i.targetCenter&&!br(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function m1(i,t,e,n,s){const r=Math.cos(-s);let o=Math.sin(-s),a=i[0]*r-i[1]*o,l=i[1]*r+i[0]*o;a+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,o=-o;const h=a*r-l*o,c=l*r+a*o;return[h,c]}class Ef extends BS{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Qe.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(Qe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ke(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=ve(t,ce.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof $r?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;e.layerStatesArray?s=e.layerStatesArray.find(o=>o.layer===this):s=this.getLayerState();const r=this.getExtent();return h2(s,e.viewState)&&(!r||Ri(r,e.extent))}getAttributions(t){var r;if(!this.isVisible(t))return[];const e=(r=this.getSource())==null?void 0:r.getAttributions();if(!e)return[];const n=t instanceof $r?t.getViewStateAndExtent():t;let s=e(n);return Array.isArray(s)||(s=[s]),s}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(Qe.MAP,t)}getMapInternal(){return this.get(Qe.MAP)}setMap(t){this.mapPrecomposeKey_&&(Ke(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ke(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=ve(t,Sn.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ve(this,ce.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);De(!e.some(s=>s.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}setSource(t){this.set(Qe.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function h2(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}function oA(i,t,e,n,s){zS(i,t,e||0,n||i.length-1,s||aA)}function zS(i,t,e,n,s){for(;n>e;){if(n-e>600){var r=n-e+1,o=t-e+1,a=Math.log(r),l=.5*Math.exp(2*a/3),h=.5*Math.sqrt(a*l*(r-l)/r)*(o-r/2<0?-1:1),c=Math.max(e,Math.floor(t-o*l/r+h)),u=Math.min(n,Math.floor(t+(r-o)*l/r+h));zS(i,t,c,u,s)}var f=i[t],d=e,g=n;for(ju(i,e,t),s(i[n],f)>0&&ju(i,e,n);d<g;){for(ju(i,d,g),d++,g--;s(i[d],f)<0;)d++;for(;s(i[g],f)>0;)g--}s(i[e],f)===0?ju(i,e,g):(g++,ju(i,g,n)),g<=t&&(e=g+1),t<=g&&(n=g-1)}}function ju(i,t,e){var n=i[t];i[t]=i[e],i[e]=n}function aA(i,t){return i<t?-1:i>t?1:0}let GS=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!Fg(t,e))return n;const s=this.toBBox,r=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?s(a):a;Fg(t,l)&&(e.leaf?n.push(a):y1(t,l)?this._all(a,n):r.push(a))}e=r.pop()}return n}collides(t){let e=this.data;if(!Fg(t,e))return!1;const n=[];for(;e;){for(let s=0;s<e.children.length;s++){const r=e.children[s],o=e.leaf?this.toBBox(r):r;if(Fg(t,o)){if(e.leaf||y1(t,o))return!0;n.push(r)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=ec([]),this}remove(t,e){if(!t)return this;let n=this.data;const s=this.toBBox(t),r=[],o=[];let a,l,h;for(;n||r.length;){if(n||(n=r.pop(),l=r[r.length-1],a=o.pop(),h=!0),n.leaf){const c=lA(t,n.children,e);if(c!==-1)return n.children.splice(c,1),r.push(n),this._condense(r),this}!h&&!n.leaf&&y1(n,s)?(r.push(n),o.push(a),a=0,l=n,n=n.children[0]):l?(a++,n=l.children[a],h=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,s){const r=n-e+1;let o=this._maxEntries,a;if(r<=o)return a=ec(t.slice(e,n+1)),zh(a,this.toBBox),a;s||(s=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,s-1))),a=ec([]),a.leaf=!1,a.height=s;const l=Math.ceil(r/o),h=l*Math.ceil(Math.sqrt(o));Nx(t,e,n,h,this.compareMinX);for(let c=e;c<=n;c+=h){const u=Math.min(c+h-1,n);Nx(t,c,u,l,this.compareMinY);for(let f=c;f<=u;f+=l){const d=Math.min(f+l-1,u);a.children.push(this._build(t,f,d,s-1))}}return zh(a,this.toBBox),a}_chooseSubtree(t,e,n,s){for(;s.push(e),!(e.leaf||s.length-1===n);){let r=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const h=e.children[l],c=_1(h),u=uA(t,h)-c;u<o?(o=u,r=c<r?c:r,a=h):u===o&&c<r&&(r=c,a=h)}e=a||e.children[0]}return e}_insert(t,e,n){const s=n?t:this.toBBox(t),r=[],o=this._chooseSubtree(s,this.data,e,r);for(o.children.push(t),td(o,s);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(s,r,e)}_split(t,e){const n=t[e],s=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,s);const o=this._chooseSplitIndex(n,r,s),a=ec(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,zh(n,this.toBBox),zh(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)}_splitRoot(t,e){this.data=ec([t,e]),this.data.height=t.height+1,this.data.leaf=!1,zh(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let s,r=1/0,o=1/0;for(let a=e;a<=n-e;a++){const l=Qu(t,0,a,this.toBBox),h=Qu(t,a,n,this.toBBox),c=dA(l,h),u=_1(l)+_1(h);c<r?(r=c,s=a,o=u<o?u:o):c===r&&u<o&&(o=u,s=a)}return s||n-e}_chooseSplitAxis(t,e,n){const s=t.leaf?this.compareMinX:hA,r=t.leaf?this.compareMinY:cA,o=this._allDistMargin(t,e,n,s),a=this._allDistMargin(t,e,n,r);o<a&&t.children.sort(s)}_allDistMargin(t,e,n,s){t.children.sort(s);const r=this.toBBox,o=Qu(t,0,e,r),a=Qu(t,n-e,n,r);let l=kg(o)+kg(a);for(let h=e;h<n-e;h++){const c=t.children[h];td(o,t.leaf?r(c):c),l+=kg(o)}for(let h=n-e-1;h>=e;h--){const c=t.children[h];td(a,t.leaf?r(c):c),l+=kg(a)}return l}_adjustParentBBoxes(t,e,n){for(let s=n;s>=0;s--)td(e[s],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():zh(t[e],this.toBBox)}};function lA(i,t,e){if(!e)return t.indexOf(i);for(let n=0;n<t.length;n++)if(e(i,t[n]))return n;return-1}function zh(i,t){Qu(i,0,i.children.length,t,i)}function Qu(i,t,e,n,s){s||(s=ec(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r=t;r<e;r++){const o=i.children[r];td(s,i.leaf?n(o):o)}return s}function td(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function hA(i,t){return i.minX-t.minX}function cA(i,t){return i.minY-t.minY}function _1(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function kg(i){return i.maxX-i.minX+(i.maxY-i.minY)}function uA(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function dA(i,t){const e=Math.max(i.minX,t.minX),n=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),r=Math.min(i.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,r-n)}function y1(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Fg(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function ec(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Nx(i,t,e,n,s){const r=[t,e];for(;r.length;){if(e=r.pop(),t=r.pop(),e-t<=n)continue;const o=t+Math.ceil((e-t)/n/2)*n;oA(i,o,t,e,s),r.push(t,o,o,e)}}function kx(i,t,e,n){return e!==void 0&&n!==void 0?[e/i,n/t]:e!==void 0?e/i:n!==void 0?n/t:1}class Wa extends H0{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,r=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;De(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||le(o)),De(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),De(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=re.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?re.LOADED:re.IDLE:l=re.LOADING:l=re.LOADED),this.color_=t.color!==void 0?ql(t.color):null,this.iconImage_=n2(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let h,c;if(t.size)[h,c]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,c=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(kx(d[0],d[1],t.width,t.height))};this.listenImageChange(f);return}}h!==void 0&&this.setScale(kx(h,c,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Wa({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==re.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==re.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(ce.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(ce.CHANGE,t)}ready(){return this.iconImage_.ready()}}let ih=0;const is=1<<ih++,ze=1<<ih++,_s=1<<ih++,wr=1<<ih++,Vl=1<<ih++,ed=1<<ih++,Og=Math.pow(2,ih)-1,c2={[is]:"boolean",[ze]:"number",[_s]:"string",[wr]:"color",[Vl]:"number[]",[ed]:"size"},fA=Object.keys(c2).map(Number).sort(no);function gA(i){return i in c2}function id(i){const t=[];for(const e of fA)nd(i,e)&&t.push(c2[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function nd(i,t){return(i&t)===t}function ma(i,t){return i===t}class dn{constructor(t,e){if(!gA(t))throw new Error(`literal expressions must have a specific type, got ${id(t)}`);this.type=t,this.value=e}}class pA{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function US(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function Pn(i,t,e){switch(typeof i){case"boolean":{if(ma(t,_s))return new dn(_s,i?"true":"false");if(!nd(t,is))throw new Error(`got a boolean, but expected ${id(t)}`);return new dn(is,i)}case"number":{if(ma(t,ed))return new dn(ed,ss(i));if(ma(t,is))return new dn(is,!!i);if(ma(t,_s))return new dn(_s,i.toString());if(!nd(t,ze))throw new Error(`got a number, but expected ${id(t)}`);return new dn(ze,i)}case"string":{if(ma(t,wr))return new dn(wr,Qy(i));if(ma(t,is))return new dn(is,!!i);if(!nd(t,_s))throw new Error(`got a string, but expected ${id(t)}`);return new dn(_s,i)}}if(!Array.isArray(i))throw new Error("expression must be an array or a primitive value");if(i.length===0)throw new Error("empty expression");if(typeof i[0]=="string")return LA(i,t,e);for(const n of i)if(typeof n!="number")throw new Error("expected an array of numbers");if(ma(t,ed)){if(i.length!==2)throw new Error(`expected an array of two values for a size, got ${i.length}`);return new dn(ed,i)}if(ma(t,wr)){if(i.length===3)return new dn(wr,[...i,1]);if(i.length===4)return new dn(wr,i);throw new Error(`expected an array of 3 or 4 values for a color, got ${i.length}`)}if(!nd(t,Vl))throw new Error(`got an array of numbers, but expected ${id(t)}`);return new dn(Vl,i)}const At={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},mA={[At.Get]:ye(Ae(1,1/0),Fx),[At.Var]:ye(Ae(1,1),_A),[At.Has]:ye(Ae(1,1/0),Fx),[At.Id]:ye(yA,Gh),[At.Concat]:ye(Ae(2,1/0),Je(_s)),[At.GeometryType]:ye(vA,Gh),[At.LineMetric]:ye(Gh),[At.Resolution]:ye(Gh),[At.Zoom]:ye(Gh),[At.Time]:ye(Gh),[At.Any]:ye(Ae(2,1/0),Je(is)),[At.All]:ye(Ae(2,1/0),Je(is)),[At.Not]:ye(Ae(1,1),Je(is)),[At.Equal]:ye(Ae(2,2),Je(Og)),[At.NotEqual]:ye(Ae(2,2),Je(Og)),[At.GreaterThan]:ye(Ae(2,2),Je(ze)),[At.GreaterThanOrEqualTo]:ye(Ae(2,2),Je(ze)),[At.LessThan]:ye(Ae(2,2),Je(ze)),[At.LessThanOrEqualTo]:ye(Ae(2,2),Je(ze)),[At.Multiply]:ye(Ae(2,1/0),Ox),[At.Coalesce]:ye(Ae(2,1/0),Ox),[At.Divide]:ye(Ae(2,2),Je(ze)),[At.Add]:ye(Ae(2,1/0),Je(ze)),[At.Subtract]:ye(Ae(2,2),Je(ze)),[At.Clamp]:ye(Ae(3,3),Je(ze)),[At.Mod]:ye(Ae(2,2),Je(ze)),[At.Pow]:ye(Ae(2,2),Je(ze)),[At.Abs]:ye(Ae(1,1),Je(ze)),[At.Floor]:ye(Ae(1,1),Je(ze)),[At.Ceil]:ye(Ae(1,1),Je(ze)),[At.Round]:ye(Ae(1,1),Je(ze)),[At.Sin]:ye(Ae(1,1),Je(ze)),[At.Cos]:ye(Ae(1,1),Je(ze)),[At.Atan]:ye(Ae(1,2),Je(ze)),[At.Sqrt]:ye(Ae(1,1),Je(ze)),[At.Match]:ye(Ae(4,1/0),Dx,bA),[At.Between]:ye(Ae(3,3),Je(ze)),[At.Interpolate]:ye(Ae(6,1/0),Dx,wA),[At.Case]:ye(Ae(3,1/0),xA,SA),[At.In]:ye(Ae(2,2),EA),[At.Number]:ye(Ae(1,1/0),Je(Og)),[At.String]:ye(Ae(1,1/0),Je(Og)),[At.Array]:ye(Ae(1,1/0),Je(ze)),[At.Color]:ye(Ae(1,4),Je(ze)),[At.Band]:ye(Ae(1,3),Je(ze)),[At.Palette]:ye(Ae(2,2),CA),[At.ToString]:ye(Ae(1,1),Je(is|ze|_s|wr))};function Fx(i,t,e){const n=i.length-1,s=new Array(n);for(let r=0;r<n;++r){const o=i[r+1];switch(typeof o){case"number":{s[r]=new dn(ze,o);break}case"string":{s[r]=new dn(_s,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}r===0&&e.properties.add(String(o))}return s}function _A(i,t,e){const n=i[1];if(typeof n!="string")throw new Error("expected a string argument for var operation");return e.variables.add(n),[new dn(_s,n)]}function yA(i,t,e){e.featureId=!0}function vA(i,t,e){e.geometryType=!0}function Gh(i,t,e){const n=i[0];if(i.length!==1)throw new Error(`expected no arguments for ${n} operation`);return[]}function Ae(i,t){return function(e,n,s){const r=e[0],o=e.length-1;if(i===t){if(o!==i){const a=i===1?"":"s";throw new Error(`expected ${i} argument${a} for ${r}, got ${o}`)}}else if(o<i||o>t){const a=t===1/0?`${i} or more`:`${i} to ${t}`;throw new Error(`expected ${a} arguments for ${r}, got ${o}`)}}}function Ox(i,t,e){const n=i.length-1,s=new Array(n);for(let r=0;r<n;++r){const o=Pn(i[r+1],t,e);s[r]=o}return s}function Je(i){return function(t,e,n){const s=t.length-1,r=new Array(s);for(let o=0;o<s;++o){const a=Pn(t[o+1],i,n);r[o]=a}return r}}function xA(i,t,e){const n=i[0],s=i.length-1;if(s%2===0)throw new Error(`expected an odd number of arguments for ${n}, got ${s} instead`)}function Dx(i,t,e){const n=i[0],s=i.length-1;if(s%2===1)throw new Error(`expected an even number of arguments for operation ${n}, got ${s} instead`)}function bA(i,t,e){const n=i.length-1,s=_s|ze|is,r=Pn(i[1],s,e),o=Pn(i[i.length-1],t,e),a=new Array(n-2);for(let l=0;l<n-2;l+=2){try{const h=Pn(i[l+2],r.type,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+1} of match expression: ${h.message}`)}try{const h=Pn(i[l+3],o.type,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+2} of match expression: ${h.message}`)}}return[r,...a,o]}function wA(i,t,e){const n=i[1];let s;switch(n[0]){case"linear":s=1;break;case"exponential":const l=n[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);s=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const r=new dn(ze,s);let o;try{o=Pn(i[2],ze,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(i.length-3);for(let l=0;l<a.length;l+=2){try{const h=Pn(i[l+3],ze,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${h.message}`)}try{const h=Pn(i[l+4],t,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${h.message}`)}}return[r,o,...a]}function SA(i,t,e){const n=Pn(i[i.length-1],t,e),s=new Array(i.length-1);for(let r=0;r<s.length-1;r+=2){try{const o=Pn(i[r+1],is,e);s[r]=o}catch(o){throw new Error(`failed to parse argument ${r} of case expression: ${o.message}`)}try{const o=Pn(i[r+2],n.type,e);s[r+1]=o}catch(o){throw new Error(`failed to parse argument ${r+1} of case expression: ${o.message}`)}}return s[s.length-1]=n,s}function EA(i,t,e){let n=i[2];if(!Array.isArray(n))throw new Error('the second argument for the "in" operator must be an array');let s;if(typeof n[0]=="string"){if(n[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],s=_s}else s=ze;const r=new Array(n.length);for(let a=0;a<r.length;a++)try{const l=Pn(n[a],s,e);r[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Pn(i[1],s,e),...r]}function CA(i,t,e){let n;try{n=Pn(i[1],ze,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const s=i[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const r=new Array(s.length);for(let o=0;o<r.length;o++){let a;try{a=Pn(s[o],wr,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof dn))throw new Error(`the palette color at index ${o} must be a literal value`);r[o]=a}return[n,...r]}function ye(...i){return function(t,e,n){const s=t[0];let r;for(let o=0;o<i.length;o++){const a=i[o](t,e,n);if(o==i.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");r=a}}return new pA(e,s,...r)}}function LA(i,t,e){const n=i[0],s=mA[n];if(!s)throw new Error(`unknown operator: ${n}`);return s(i,t,e)}function WS(i){if(!i)return"";const t=i.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return WS(i.getGeometries()[0]);default:return""}}function qS(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ko(i,t,e){const n=Pn(i,t,e);return Pr(n)}function Pr(i,t){if(i instanceof dn){if(i.type===wr&&typeof i.value=="string"){const n=Qy(i.value);return function(){return n}}return function(){return i.value}}const e=i.operator;switch(e){case At.Number:case At.String:case At.Coalesce:return MA(i);case At.Get:case At.Var:case At.Has:return TA(i);case At.Id:return n=>n.featureId;case At.GeometryType:return n=>n.geometryType;case At.Concat:{const n=i.args.map(s=>Pr(s));return s=>"".concat(...n.map(r=>r(s).toString()))}case At.Resolution:return n=>n.resolution;case At.Any:case At.All:case At.Between:case At.In:case At.Not:return PA(i);case At.Equal:case At.NotEqual:case At.LessThan:case At.LessThanOrEqualTo:case At.GreaterThan:case At.GreaterThanOrEqualTo:return AA(i);case At.Multiply:case At.Divide:case At.Add:case At.Subtract:case At.Clamp:case At.Mod:case At.Pow:case At.Abs:case At.Floor:case At.Ceil:case At.Round:case At.Sin:case At.Cos:case At.Atan:case At.Sqrt:return IA(i);case At.Case:return RA(i);case At.Match:return NA(i);case At.Interpolate:return kA(i);case At.ToString:return FA(i);default:throw new Error(`Unsupported operator ${e}`)}}function MA(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=Pr(i.args[r]);switch(e){case At.Coalesce:return r=>{for(let o=0;o<n;++o){const a=s[o](r);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case At.Number:case At.String:return r=>{for(let o=0;o<n;++o){const a=s[o](r);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function TA(i,t){const n=i.args[0].value;switch(i.operator){case At.Get:return s=>{const r=i.args;let o=s.properties[n];for(let a=1,l=r.length;a<l;++a){const c=r[a].value;o=o[c]}return o};case At.Var:return s=>s.variables[n];case At.Has:return s=>{const r=i.args;if(!(n in s.properties))return!1;let o=s.properties[n];for(let a=1,l=r.length;a<l;++a){const c=r[a].value;if(!o||!Object.hasOwn(o,c))return!1;o=o[c]}return!0};default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function AA(i,t){const e=i.operator,n=Pr(i.args[0]),s=Pr(i.args[1]);switch(e){case At.Equal:return r=>n(r)===s(r);case At.NotEqual:return r=>n(r)!==s(r);case At.LessThan:return r=>n(r)<s(r);case At.LessThanOrEqualTo:return r=>n(r)<=s(r);case At.GreaterThan:return r=>n(r)>s(r);case At.GreaterThanOrEqualTo:return r=>n(r)>=s(r);default:throw new Error(`Unsupported comparison operator ${e}`)}}function PA(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=Pr(i.args[r]);switch(e){case At.Any:return r=>{for(let o=0;o<n;++o)if(s[o](r))return!0;return!1};case At.All:return r=>{for(let o=0;o<n;++o)if(!s[o](r))return!1;return!0};case At.Between:return r=>{const o=s[0](r),a=s[1](r),l=s[2](r);return o>=a&&o<=l};case At.In:return r=>{const o=s[0](r);for(let a=1;a<n;++a)if(o===s[a](r))return!0;return!1};case At.Not:return r=>!s[0](r);default:throw new Error(`Unsupported logical operator ${e}`)}}function IA(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=Pr(i.args[r]);switch(e){case At.Multiply:return r=>{let o=1;for(let a=0;a<n;++a)o*=s[a](r);return o};case At.Divide:return r=>s[0](r)/s[1](r);case At.Add:return r=>{let o=0;for(let a=0;a<n;++a)o+=s[a](r);return o};case At.Subtract:return r=>s[0](r)-s[1](r);case At.Clamp:return r=>{const o=s[0](r),a=s[1](r);if(o<a)return a;const l=s[2](r);return o>l?l:o};case At.Mod:return r=>s[0](r)%s[1](r);case At.Pow:return r=>Math.pow(s[0](r),s[1](r));case At.Abs:return r=>Math.abs(s[0](r));case At.Floor:return r=>Math.floor(s[0](r));case At.Ceil:return r=>Math.ceil(s[0](r));case At.Round:return r=>Math.round(s[0](r));case At.Sin:return r=>Math.sin(s[0](r));case At.Cos:return r=>Math.cos(s[0](r));case At.Atan:return n===2?r=>Math.atan2(s[0](r),s[1](r)):r=>Math.atan(s[0](r));case At.Sqrt:return r=>Math.sqrt(s[0](r));default:throw new Error(`Unsupported numeric operator ${e}`)}}function RA(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Pr(i.args[s]);return s=>{for(let r=0;r<e-1;r+=2)if(n[r](s))return n[r+1](s);return n[e-1](s)}}function NA(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Pr(i.args[s]);return s=>{const r=n[0](s);for(let o=1;o<e;o+=2)if(r===n[o](s))return n[o+1](s);return n[e-1](s)}}function kA(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Pr(i.args[s]);return s=>{const r=n[0](s),o=n[1](s);let a,l;for(let h=2;h<e;h+=2){const c=n[h](s);let u=n[h+1](s);const f=Array.isArray(u);if(f&&(u=wT(u)),c>=o)return h===2?u:f?OA(r,o,a,l,c,u):sd(r,o,a,l,c,u);a=c,l=u}return l}}function FA(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=Pr(i.args[r]);switch(e){case At.ToString:return r=>{const o=s[0](r);return i.args[0].type===wr?t2(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function sd(i,t,e,n,s,r){const o=s-e;if(o===0)return n;const a=t-e,l=i===1?a/o:(Math.pow(i,a)-1)/(Math.pow(i,o)-1);return n+l*(r-n)}function OA(i,t,e,n,s,r){if(s-e===0)return n;const a=Sx(n),l=Sx(r);let h=l[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const c=[sd(i,t,e,a[0],s,l[0]),sd(i,t,e,a[1],s,l[1]),a[2]+sd(i,t,e,0,s,h),sd(i,t,e,n[3],s,r[3])];return LS(ST(c))}function DA(i){return!0}function BA(i){const t=US(),e=jA(i,t),n=qS();return function(s,r){if(n.properties=s.getPropertiesInternal(),n.resolution=r,t.featureId){const o=s.getId();o!==void 0?n.featureId=o:n.featureId=null}return t.geometryType&&(n.geometryType=WS(s.getGeometry())),e(n)}}function Bx(i){const t=US(),e=i.length,n=new Array(e);for(let o=0;o<e;++o)n[o]=M_(i[o],t);const s=qS(),r=new Array(e);return function(o,a){if(s.properties=o.getPropertiesInternal(),s.resolution=a,t.featureId){const h=o.getId();h!==void 0?s.featureId=h:s.featureId=null}let l=0;for(let h=0;h<e;++h){const c=n[h](s);c&&(r[l]=c,l+=1)}return r.length=l,r}}function jA(i,t){const e=i.length,n=new Array(e);for(let s=0;s<e;++s){const r=i[s],o="filter"in r?Ko(r.filter,is,t):DA;let a;if(Array.isArray(r.style)){const l=r.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=M_(r.style[h],t)}else a=[M_(r.style,t)];n[s]={filter:o,styles:a}}return function(s){const r=[];let o=!1;for(let a=0;a<e;++a){const l=n[a].filter;if(l(s)&&!(i[a].else&&o)){o=!0;for(const h of n[a].styles){const c=h(s);c&&r.push(c)}}}return r}}function M_(i,t){const e=Yd(i,"",t),n=Xd(i,"",t),s=zA(i,t),r=GA(i,t),o=vs(i,"z-index",t);if(!e&&!n&&!s&&!r&&!Ul(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const a=new Pe;return function(l){let h=!0;if(e){const c=e(l);c&&(h=!1),a.setFill(c)}if(n){const c=n(l);c&&(h=!1),a.setStroke(c)}if(s){const c=s(l);c&&(h=!1),a.setText(c)}if(r){const c=r(l);c&&(h=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),h?null:a}}function Yd(i,t,e){let n;if(t+"fill-pattern-src"in i)n=VA(i,t+"fill-",e);else{if(i[t+"fill-color"]==="none")return r=>null;n=u2(i,t+"fill-color",e)}if(!n)return null;const s=new ke;return function(r){const o=n(r);return o===Jy?null:(s.setColor(o),s)}}function Xd(i,t,e){const n=vs(i,t+"stroke-width",e),s=u2(i,t+"stroke-color",e);if(!n&&!s)return null;const r=Oo(i,t+"stroke-line-cap",e),o=Oo(i,t+"stroke-line-join",e),a=VS(i,t+"stroke-line-dash",e),l=vs(i,t+"stroke-line-dash-offset",e),h=vs(i,t+"stroke-miter-limit",e),c=new si;return function(u){if(s){const f=s(u);if(f===Jy)return null;c.setColor(f)}if(n&&c.setWidth(n(u)),r){const f=r(u);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(f)}if(o){const f=o(u);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return a&&c.setLineDash(a(u)),l&&c.setLineDashOffset(l(u)),h&&c.setMiterLimit(h(u)),c}}function zA(i,t){const e="text-",n=Oo(i,e+"value",t);if(!n)return null;const s=Yd(i,e,t),r=Yd(i,e+"background-",t),o=Xd(i,e,t),a=Xd(i,e+"background-",t),l=Oo(i,e+"font",t),h=vs(i,e+"max-angle",t),c=vs(i,e+"offset-x",t),u=vs(i,e+"offset-y",t),f=$d(i,e+"overflow",t),d=Oo(i,e+"placement",t),g=vs(i,e+"repeat",t),p=X0(i,e+"scale",t),y=$d(i,e+"rotate-with-view",t),_=vs(i,e+"rotation",t),x=Oo(i,e+"align",t),b=Oo(i,e+"justify",t),L=Oo(i,e+"baseline",t),M=VS(i,e+"padding",t),k=$0(i,e+"declutter-mode"),A=new qn({declutterMode:k});return function(T){if(A.setText(n(T)),s&&A.setFill(s(T)),r&&A.setBackgroundFill(r(T)),o&&A.setStroke(o(T)),a&&A.setBackgroundStroke(a(T)),l&&A.setFont(l(T)),h&&A.setMaxAngle(h(T)),c&&A.setOffsetX(c(T)),u&&A.setOffsetY(u(T)),f&&A.setOverflow(f(T)),d){const F=d(T);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(F)}if(g&&A.setRepeat(g(T)),p&&A.setScale(p(T)),y&&A.setRotateWithView(y(T)),_&&A.setRotation(_(T)),x){const F=x(T);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(F)}if(b){const F=b(T);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(F)}if(L){const F=L(T);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(F)}return M&&A.setPadding(M(T)),A}}function GA(i,t){return"icon-src"in i?UA(i,t):"shape-points"in i?WA(i,t):"circle-radius"in i?qA(i,t):null}function UA(i,t){const e="icon-",n=e+"src",s=HS(i[n],n),r=Zp(i,e+"anchor",t),o=X0(i,e+"scale",t),a=vs(i,e+"opacity",t),l=Zp(i,e+"displacement",t),h=vs(i,e+"rotation",t),c=$d(i,e+"rotate-with-view",t),u=zx(i,e+"anchor-origin"),f=Gx(i,e+"anchor-x-units"),d=Gx(i,e+"anchor-y-units"),g=$A(i,e+"color"),p=YA(i,e+"cross-origin"),y=XA(i,e+"offset"),_=zx(i,e+"offset-origin"),x=Jp(i,e+"width"),b=Jp(i,e+"height"),L=HA(i,e+"size"),M=$0(i,e+"declutter-mode"),k=new Wa({src:s,anchorOrigin:u,anchorXUnits:f,anchorYUnits:d,color:g,crossOrigin:p,offset:y,offsetOrigin:_,height:b,width:x,size:L,declutterMode:M});return function(A){return a&&k.setOpacity(a(A)),l&&k.setDisplacement(l(A)),h&&k.setRotation(h(A)),c&&k.setRotateWithView(c(A)),o&&k.setScale(o(A)),r&&k.setAnchor(r(A)),k}}function WA(i,t){const e="shape-",n=e+"points",s=e+"radius",r=T_(i[n],n),o=T_(i[s],s),a=Yd(i,e,t),l=Xd(i,e,t),h=X0(i,e+"scale",t),c=Zp(i,e+"displacement",t),u=vs(i,e+"rotation",t),f=$d(i,e+"rotate-with-view",t),d=Jp(i,e+"radius2"),g=Jp(i,e+"angle"),p=$0(i,e+"declutter-mode"),y=new Jc({points:r,radius:o,radius2:d,angle:g,declutterMode:p});return function(_){return a&&y.setFill(a(_)),l&&y.setStroke(l(_)),c&&y.setDisplacement(c(_)),u&&y.setRotation(u(_)),f&&y.setRotateWithView(f(_)),h&&y.setScale(h(_)),y}}function qA(i,t){const e="circle-",n=Yd(i,e,t),s=Xd(i,e,t),r=vs(i,e+"radius",t),o=X0(i,e+"scale",t),a=Zp(i,e+"displacement",t),l=vs(i,e+"rotation",t),h=$d(i,e+"rotate-with-view",t),c=$0(i,e+"declutter-mode"),u=new Ir({radius:5,declutterMode:c});return function(f){return r&&u.setRadius(r(f)),n&&u.setFill(n(f)),s&&u.setStroke(s(f)),a&&u.setDisplacement(a(f)),l&&u.setRotation(l(f)),h&&u.setRotateWithView(h(f)),o&&u.setScale(o(f)),u}}function vs(i,t,e){if(!(t in i))return;const n=Ko(i[t],ze,e);return function(s){return T_(n(s),t)}}function Oo(i,t,e){if(!(t in i))return null;const n=Ko(i[t],_s,e);return function(s){return HS(n(s),t)}}function VA(i,t,e){const n=Oo(i,t+"pattern-src",e),s=jx(i,t+"pattern-offset",e),r=jx(i,t+"pattern-size",e),o=u2(i,t+"color",e);return function(a){return{src:n(a),offset:s&&s(a),size:r&&r(a),color:o&&o(a)}}}function $d(i,t,e){if(!(t in i))return null;const n=Ko(i[t],is,e);return function(s){const r=n(s);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${t}`);return r}}function u2(i,t,e){if(!(t in i))return null;const n=Ko(i[t],wr,e);return function(s){return YS(n(s),t)}}function VS(i,t,e){if(!(t in i))return null;const n=Ko(i[t],Vl,e);return function(s){return Cf(n(s),t)}}function Zp(i,t,e){if(!(t in i))return null;const n=Ko(i[t],Vl,e);return function(s){const r=Cf(n(s),t);if(r.length!==2)throw new Error(`Expected two numbers for ${t}`);return r}}function jx(i,t,e){if(!(t in i))return null;const n=Ko(i[t],Vl,e);return function(s){return XS(n(s),t)}}function X0(i,t,e){if(!(t in i))return null;const n=Ko(i[t],Vl|ze,e);return function(s){return KA(n(s),t)}}function Jp(i,t){const e=i[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function HA(i,t){const e=i[t];if(e!==void 0){if(typeof e=="number")return ss(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function YA(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function zx(i,t){const e=i[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Gx(i,t){const e=i[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function XA(i,t){const e=i[t];if(e!==void 0)return Cf(e,t)}function $0(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function $A(i,t){const e=i[t];if(e!==void 0)return YS(e,t)}function Cf(i,t){if(!Array.isArray(i))throw new Error(`Expected an array for ${t}`);const e=i.length;for(let n=0;n<e;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${t}`);return i}function HS(i,t){if(typeof i!="string")throw new Error(`Expected a string for ${t}`);return i}function T_(i,t){if(typeof i!="number")throw new Error(`Expected a number for ${t}`);return i}function YS(i,t){if(typeof i=="string")return i;const e=Cf(i,t),n=e.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function XS(i,t){const e=Cf(i,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function KA(i,t){return typeof i=="number"?i:XS(i,t)}const Ux={RENDER_ORDER:"renderOrder"};class Lf extends Ef{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Ux.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter||(t.declutter[n]=new GS(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Ux.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?DS:t;const e=ZA(t);this.styleFunction_=t===null?void 0:HT(e),this.changed()}}function ZA(i){if(i===void 0)return DS;if(!i)return null;if(typeof i=="function"||i instanceof Pe)return i;if(!Array.isArray(i))return Bx([i]);if(i.length===0)return[];const t=i.length,e=i[0];if(e instanceof Pe){const s=new Array(t);for(let r=0;r<t;++r){const o=i[r];if(!(o instanceof Pe))throw new Error("Expected a list of style instances");s[r]=o}return s}if("style"in e){const s=new Array(t);for(let r=0;r<t;++r){const o=i[r];if(!("style"in o))throw new Error("Expected a list of rules with a style property");s[r]=o}return BA(s)}return Bx(i)}const fe={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Dg=[fe.FILL],Ta=[fe.STROKE],Pl=[fe.BEGIN_PATH],Wx=[fe.CLOSE_PATH];class $S{drawCustom(t,e,n,s,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class Mf extends $S{constructor(t,e,n,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=t.length;a<l;a+=e)s[0]=t[a],s[1]=t[a+1],Wl(n,s)&&(r[o++]=s[0],r[o++]=s[1]);return o}appendFlatLineCoordinates(t,e,n,s,r,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=s);let c=t[e],u=t[e+1];const f=this.tmpCoordinate_;let d=!0,g,p,y;for(g=e+s;g<n;g+=s)f[0]=t[g],f[1]=t[g+1],y=y_(h,f),y!==p?(d&&(a[l++]=c,a[l++]=u,d=!1),a[l++]=f[0],a[l++]=f[1]):y===bn.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],d=!1):d=!0,c=f[0],u=f[1],p=y;return(r&&d||g===e+s)&&(a[l++]=c,a[l++]=u),l}drawCustomCoordinates_(t,e,n,s,r){for(let o=0,a=n.length;o<a;++o){const l=n[o],h=this.appendFlatLineCoordinates(t,e,l,s,!1,!1);r.push(h),e=l}return e}drawCustom(t,e,n,s,r){this.beginGeometry(t,e,r);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let h,c,u,f,d;switch(o){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),f=[];const g=t.getEndss();d=0;for(let p=0,y=g.length;p<y;++p){const _=[];d=this.drawCustomCoordinates_(h,d,g[p],a,_),f.push(_)}this.instructions.push([fe.CUSTOM,l,f,t,n,w_,r]),this.hitDetectionInstructions.push([fe.CUSTOM,l,f,t,s||n,w_,r]);break;case"Polygon":case"MultiLineString":u=[],h=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(h,0,t.getEnds(),a,u),this.instructions.push([fe.CUSTOM,l,u,t,n,zd,r]),this.hitDetectionInstructions.push([fe.CUSTOM,l,u,t,s||n,zd,r]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([fe.CUSTOM,l,c,t,n,Ma,r]),this.hitDetectionInstructions.push([fe.CUSTOM,l,c,t,s||n,Ma,r]);break;case"MultiPoint":h=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,a),c>l&&(this.instructions.push([fe.CUSTOM,l,c,t,n,Ma,r]),this.hitDetectionInstructions.push([fe.CUSTOM,l,c,t,s||n,Ma,r]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([fe.CUSTOM,l,c,t,n,void 0,r]),this.hitDetectionInstructions.push([fe.CUSTOM,l,c,t,s||n,void 0,r]);break}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[fe.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[fe.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let s,r,o=-1;for(e=0;e<n;++e)s=t[e],r=s[0],r==fe.END_GEOMETRY?o=e:r==fe.BEGIN_GEOMETRY&&(s[2]=e,vM(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const s=t.getColor();n.fillPatternScale=s&&typeof s=="object"&&"src"in s?this.pixelRatio:1,n.fillStyle=Jr(s||ms)}else n.fillStyle=void 0;if(e){const s=e.getColor();n.strokeStyle=Jr(s||qd);const r=e.getLineCap();n.lineCap=r!==void 0?r:Gc;const o=e.getLineDash();n.lineDash=o?o.slice():qo;const a=e.getLineDashOffset();n.lineDashOffset=a||Vo;const l=e.getLineJoin();n.lineJoin=l!==void 0?l:Uc;const h=e.getWidth();n.lineWidth=h!==void 0?h:Hd;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:Wd,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[fe.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[fe.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,s=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||r!=t.currentLineDash&&!uo(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(n!==void 0&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[fe.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Qw(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Xo(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class JA extends Mf{constructor(t,e,n,s){super(t,e,n,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!Wl(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const s=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,r);this.instructions.push([fe.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([fe.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const s=t.getFlatCoordinates(),r=[];for(let l=0,h=s.length;l<h;l+=t.getStride())(!this.maxExtent||Wl(this.maxExtent,s.slice(l,l+2)))&&r.push(s[l],s[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([fe.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([fe.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),s=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class QA extends Mf{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinates_(t,e,n,s){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,s,!1,!1),a=[fe.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}drawLineString(t,e,n){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([fe.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,qo,Vo],Pl);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Ta),this.endGeometry(e)}drawMultiLineString(t,e,n){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([fe.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,qo,Vo],Pl);const a=t.getEnds(),l=t.getFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,f=a.length;u<f;++u)c=this.drawFlatCoordinates_(l,c,a[u],h);this.hitDetectionInstructions.push(Ta),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ta),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ta),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Pl)}}class qx extends Mf{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinatess_(t,e,n,s){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=n.length;this.instructions.push(Pl),this.hitDetectionInstructions.push(Pl);for(let h=0;h<l;++h){const c=n[h],u=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,c,s,!0,!a),d=[fe.MOVE_TO_LINE_TO,u,f];this.instructions.push(d),this.hitDetectionInstructions.push(d),a&&(this.instructions.push(Wx),this.hitDetectionInstructions.push(Wx)),e=c}return o&&(this.instructions.push(Dg),this.hitDetectionInstructions.push(Dg)),a&&(this.instructions.push(Ta),this.hitDetectionInstructions.push(Ta)),e}drawCircle(t,e,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_FILL_STYLE,ms]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,qo,Vo]);const a=t.getFlatCoordinates(),l=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const c=[fe.CIRCLE,h];this.instructions.push(Pl,c),this.hitDetectionInstructions.push(Pl,c),s.fillStyle!==void 0&&(this.instructions.push(Dg),this.hitDetectionInstructions.push(Dg)),s.strokeStyle!==void 0&&(this.instructions.push(Ta),this.hitDetectionInstructions.push(Ta)),this.endGeometry(e)}drawPolygon(t,e,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_FILL_STYLE,ms]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,qo,Vo]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,a,h),this.endGeometry(e)}drawMultiPolygon(t,e,n){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_FILL_STYLE,ms]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([fe.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,qo,Vo]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,f=a.length;u<f;++u)c=this.drawFlatCoordinatess_(l,c,a[u],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,s=e.length;n<s;++n)e[n]=bl(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function tP(i,t,e,n,s){const r=[];let o=e,a=0,l=t.slice(e,2);for(;a<i&&o+s<n;){const[h,c]=l.slice(-2),u=t[o+s],f=t[o+s+1],d=Math.sqrt((u-h)*(u-h)+(f-c)*(f-c));if(a+=d,a>=i){const g=(i-a+d)/d,p=Ds(h,u,g),y=Ds(c,f,g);l.push(p,y),r.push(l),l=[p,y],a==i&&(o+=s),a=0}else if(a<i)l.push(t[o+s],t[o+s+1]),o+=s;else{const g=d-a,p=Ds(h,u,g/d),y=Ds(c,f,g/d);l.push(p,y),r.push(l),l=[p,y],a=0,o+=s}}return a>0&&r.push(l),r}function eP(i,t,e,n,s){let r=e,o=e,a=0,l=0,h=e,c,u,f,d,g,p,y,_,x,b;for(u=e;u<n;u+=s){const L=t[u],M=t[u+1];g!==void 0&&(x=L-g,b=M-p,d=Math.sqrt(x*x+b*b),y!==void 0&&(l+=f,c=Math.acos((y*x+_*b)/(f*d)),c>i&&(l>a&&(a=l,r=h,o=u),l=0,h=u-s)),f=d,y=x,_=b),g=L,p=M}return l+=d,l>a?[h,u]:[r,o]}const Qp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class iP extends Mf{constructor(t,e,n,s){super(t,e,n,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ms]={fillStyle:ms},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const s=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!s&&!r)return;const a=this.coordinates;let l=a.length;const h=t.getType();let c=null,u=t.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!Ri(this.maxExtent,t.getExtent()))return;let f;if(c=t.getFlatCoordinates(),h=="LineString")f=[c.length];else if(h=="MultiLineString")f=t.getEnds();else if(h=="Polygon")f=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const y=t.getEndss();f=[];for(let _=0,x=y.length;_<x;++_)f.push(y[_][0])}this.beginGeometry(t,e,n);const d=o.repeat,g=d?void 0:o.textAlign;let p=0;for(let y=0,_=f.length;y<_;++y){let x;d?x=tP(d*this.resolution,c,p,f[y],u):x=[c.slice(p,f[y])];for(let b=0,L=x.length;b<L;++b){const M=x[b];let k=0,A=M.length;if(g==null){const F=eP(o.maxAngle,M,0,M.length,2);k=F[0],A=F[1]}for(let F=k;F<A;F+=u)a.push(M[F],M[F+1]);const T=a.length;p=f[y],this.drawChars_(l,T),l=T}}this.endGeometry(e)}else{let f=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),u=2;break;case"Polygon":c=t.getFlatInteriorPoint(),o.overflow||f.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const x=t.getFlatInteriorPoints();c=[];for(let b=0,L=x.length;b<L;b+=3)o.overflow||f.push(x[b+2]/this.resolution),c.push(x[b],x[b+1]);if(c.length===0)return;u=2;break}const d=this.appendFlatPointCoordinates(c,u);if(d===l)return;if(f&&(d-l)/2!==c.length/u){let x=l/2;f=f.filter((b,L)=>{const M=a[(x+L)*2]===c[L*u]&&a[(x+L)*2+1]===c[L*u+1];return M||--x,M})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,n);let g=o.padding;if(g!=Al&&(o.scale[0]<0||o.scale[1]<0)){let x=o.padding[0],b=o.padding[1],L=o.padding[2],M=o.padding[3];o.scale[0]<0&&(b=-b,M=-M),o.scale[1]<0&&(x=-x,L=-L),g=[x,b,L,M]}const p=this.pixelRatio;this.instructions.push([fe.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==Al?Al:g.map(function(x){return x*p}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const y=1/p,_=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=ms,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([fe.DRAW_IMAGE,l,d,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,g,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ms:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),o.backgroundFill&&(this.state.fillStyle=_,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Vd,justify:e.justify,textBaseline:e.textBaseline||$p,scale:e.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,s=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=Qp[s.textBaseline],c=this.textOffsetY_*l,u=this.text_,f=n?n.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([fe.DRAW_CHARS,t,e,h,s.overflow,a,s.maxAngle,l,c,r,f*l,u,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([fe.DRAW_CHARS,t,e,h,s.overflow,a&&ms,s.maxAngle,l,c,r,f*l,u,o,1/l,this.declutterMode_])}setTextStyle(t,e){let n,s,r;if(!t)this.text_="";else{const o=t.getFill();o?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=Jr(o.getColor()||ms)):(s=null,this.textFillState_=s);const a=t.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const g=a.getLineDash(),p=a.getLineDashOffset(),y=a.getWidth(),_=a.getMiterLimit();r.lineCap=a.getLineCap()||Gc,r.lineDash=g?g.slice():qo,r.lineDashOffset=p===void 0?Vo:p,r.lineJoin=a.getLineJoin()||Uc,r.lineWidth=y===void 0?Hd:y,r.miterLimit=_===void 0?Wd:_,r.strokeStyle=Jr(a.getColor()||qd)}n=this.textState_;const l=t.getFont()||FS;GT(l);const h=t.getScaleArray();n.overflow=t.getOverflow(),n.font=l,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||$p,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Al,n.scale=h===void 0?[1,1]:h;const c=t.getOffsetX(),u=t.getOffsetY(),f=t.getRotateWithView(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=f===void 0?!1:f,this.textRotation_=d===void 0?0:d,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:le(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?typeof s.fillStyle=="string"?s.fillStyle:"|"+le(s.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const nP={Circle:qx,Default:Mf,Image:JA,LineString:QA,Polygon:qx,Text:iP};class KS{constructor(t,e,n,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const s in n){const r=n[s].finish();t[e][s]=r}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[n];s===void 0&&(s={},this.buildersByZIndex_[n]=s);let r=s[e];if(r===void 0){const o=nP[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=r}return r}}const sP=5;class ZS extends xf{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=sP}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return de()}getData(t){return null}prepareFrame(t){return de()}renderFrame(t,e){return de()}forEachFeatureAtCoordinate(t,e,n,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===re.LOADED||e.getState()===re.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=re.LOADED&&e!=re.ERROR&&t.addEventListener(ce.CHANGE,this.boundHandleImageChange_),e==re.IDLE&&(t.load(),e=t.getState()),e==re.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class vd extends os{constructor(t,e,n,s){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=s}}class d2{constructor(){Vt(this,"pushMethodArgs_",(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Hp(),{get:(t,e)=>{if(typeof Hp()[e]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,n)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,n),!0)})}pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,s=e.length;n<s;++n){const r=e[n];if(typeof r=="function"){r(t);continue}const o=e[++n];if(typeof t[r]=="function")t[r](...o);else{if(typeof o=="function"){t[r]=o(t);continue}t[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Vx=[];let ic=null;function rP(){ic=Bi(1,1,void 0,{willReadFrequently:!0})}class f2 extends ZS{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=hn(),this.pixelTransform=hn(),this.inversePixelTransform=hn(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,n){ic||rP(),ic.clearRect(0,0,1,1);let s;try{ic.drawImage(t,e,n,1,1,0,0,1,1),s=ic.getImageData(0,0,1,1).data}catch{return ic=null,null}return s}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const s=this.getLayer().getClassName();let r,o;if(t&&t.className===s&&(!n||t&&t.style.backgroundColor&&uo(ql(t.style.backgroundColor),ql(n)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=s;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=Bi();const l=o.canvas;r.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const s=Qa(n),r=B0(n),o=D0(n),a=O0(n);Vi(e.coordinateToPixelTransform,s),Vi(e.coordinateToPixelTransform,r),Vi(e.coordinateToPixelTransform,o),Vi(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Vi(l,s),Vi(l,r),Vi(l,o),Vi(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const n=t.extent,s=t.viewState.resolution,r=t.viewState.rotation,o=t.pixelRatio,a=Math.round(Ie(n)/s*o),l=Math.round(ln(n)/s*o);or(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,r,-a/2,-l/2),Py(this.inversePixelTransform,this.pixelTransform);const h=CM(this.pixelTransform);if(this.useContainer(e,h,this.getBackground(t)),!this.containerReused){const c=this.context.canvas;c.width!=a||c.height!=l?(c.width=a,c.height=l):this.context.clearRect(0,0,a,l),h!==c.style.transform&&(c.style.transform=h)}}dispatchRenderEvent_(t,e,n){const s=this.getLayer();if(s.hasListener(t)){const r=new vd(t,this.inversePixelTransform,n,e);s.dispatchEvent(r)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Sn.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Sn.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new d2),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Sn.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Sn.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,s,r,o,a){const l=r/2,h=o/2,c=s/e,u=-c,f=-t[0]+a,d=-t[1];return or(this.tempTransform,l,h,c,u,-n,f,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function oP(i,t,e,n,s,r,o,a,l,h,c,u){let f=i[t],d=i[t+1],g=0,p=0,y=0,_=0;function x(){g=f,p=d,t+=n,f=i[t],d=i[t+1],_+=y,y=Math.sqrt((f-g)*(f-g)+(d-p)*(d-p))}do x();while(t<e-n&&_+y<r);let b=y===0?0:(r-_)/y;const L=Ds(g,f,b),M=Ds(p,d,b),k=t-n,A=_,T=r+a*l(h,s,c);for(;t<e-n&&_+y<T;)x();b=y===0?0:(T-_)/y;const F=Ds(g,f,b),q=Ds(p,d,b);let R;if(u){const X=[L,M,F,q];zy(X,0,4,2,u,X,X),R=X[0]>X[2]}else R=L>F;const S=Math.PI,O=[],E=k+n===t;t=k,y=0,_=A,f=i[t],d=i[t+1];let U;if(E){x(),U=Math.atan2(d-p,f-g),R&&(U+=U>0?-S:S);const X=(F+L)/2,Z=(q+M)/2;return O[0]=[X,Z,(T-r)/2,U,s],O}s=s.replace(/\n/g," ");for(let X=0,Z=s.length;X<Z;){x();let st=Math.atan2(d-p,f-g);if(R&&(st+=st>0?-S:S),U!==void 0){let j=st-U;if(j+=j>S?-2*S:j<-S?2*S:0,Math.abs(j)>o)return null}U=st;const tt=X;let ot=0;for(;X<Z;++X){const j=R?Z-X-1:X,K=a*l(h,s[j],c);if(t+n<e&&_+y<r+ot+K/2)break;ot+=K}if(X===tt)continue;const et=R?s.substring(Z-tt,Z-X):s.substring(tt,X);b=y===0?0:(r+ot/2-_)/y;const P=Ds(g,f,b),H=Ds(p,d,b);O.push([P,H,ot/2,st,et]),r+=ot}return O}const Uh=Es(),_a=[],Co=[],Lo=[],ya=[];function Hx(i){return i[3].declutterBox}const Yx=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function v1(i,t){return t==="start"?t=Yx.test(i)?"right":"left":t==="end"&&(t=Yx.test(i)?"left":"right"),Qp[t]}function aP(i,t,e){return e>0&&i.push(`
`,""),i.push(t,""),i}class lP{constructor(t,e,n,s,r){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=hn(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new d2:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,s){const r=t+e+n+s;if(this.labels_[r])return this.labels_[r];const o=s?this.strokeStates[s]:null,a=n?this.fillStates[n]:null,l=this.textStates[e],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],u=l.justify?Qp[l.justify]:v1(Array.isArray(t)?t[0]:t,l.textAlign||Vd),f=s&&o.lineWidth?o.lineWidth:0,d=Array.isArray(t)?t:String(t).split(`
`).reduce(aP,[]),{width:g,height:p,widths:y,heights:_,lineWidths:x}=WT(l,d),b=g+f,L=[],M=(b+2)*c[0],k=(p+f)*c[1],A={width:M<0?Math.floor(M):Math.ceil(M),height:k<0?Math.floor(k):Math.ceil(k),contextInstructions:L};(c[0]!=1||c[1]!=1)&&L.push("scale",c),s&&(L.push("strokeStyle",o.strokeStyle),L.push("lineWidth",f),L.push("lineCap",o.lineCap),L.push("lineJoin",o.lineJoin),L.push("miterLimit",o.miterLimit),L.push("setLineDash",[o.lineDash]),L.push("lineDashOffset",o.lineDashOffset)),n&&L.push("fillStyle",a.fillStyle),L.push("textBaseline","middle"),L.push("textAlign","center");const T=.5-u;let F=u*b+T*f;const q=[],R=[];let S=0,O=0,E=0,U=0,X;for(let Z=0,st=d.length;Z<st;Z+=2){const tt=d[Z];if(tt===`
`){O+=S,S=0,F=u*b+T*f,++U;continue}const ot=d[Z+1]||l.font;ot!==X&&(s&&q.push("font",ot),n&&R.push("font",ot),X=ot),S=Math.max(S,_[E]);const et=[tt,F+T*y[E]+u*(y[E]-x[U]),.5*(f+S)+O];F+=y[E],s&&q.push("strokeText",et),n&&R.push("fillText",et),++E}return Array.prototype.push.apply(L,q),Array.prototype.push.apply(L,R),this.labels_[r]=A,A}replayTextBackground_(t,e,n,s,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,s,r,o,a,l,h,c,u,f,d,g,p,y){a*=f[0],l*=f[1];let _=n-a,x=s-l;const b=r+h>t?t-h:r,L=o+c>e?e-c:o,M=g[3]+b*f[0]+g[1],k=g[0]+L*f[1]+g[2],A=_-g[3],T=x-g[0];(p||u!==0)&&(_a[0]=A,ya[0]=A,_a[1]=T,Co[1]=T,Co[0]=A+M,Lo[0]=Co[0],Lo[1]=T+k,ya[1]=Lo[1]);let F;return u!==0?(F=or(hn(),n,s,1,1,u,-n,-s),Vi(F,_a),Vi(F,Co),Vi(F,Lo),Vi(F,ya),ao(Math.min(_a[0],Co[0],Lo[0],ya[0]),Math.min(_a[1],Co[1],Lo[1],ya[1]),Math.max(_a[0],Co[0],Lo[0],ya[0]),Math.max(_a[1],Co[1],Lo[1],ya[1]),Uh)):ao(Math.min(A,A+M),Math.min(T,T+k),Math.max(A,A+M),Math.max(T,T+k),Uh),d&&(_=Math.round(_),x=Math.round(x)),{drawImageX:_,drawImageY:x,drawImageW:b,drawImageH:L,originX:h,originY:c,declutterBox:{minX:Uh[0],minY:Uh[1],maxX:Uh[2],maxY:Uh[3],value:y},canvasTransform:F,scale:f}}replayImageOrLabel_(t,e,n,s,r,o,a){const l=!!(o||a),h=s.declutterBox,c=a?a[2]*s.scale[0]/2:0;return h.minX-c<=e[0]&&h.maxX+c>=0&&h.minY-c<=e[1]&&h.maxY+c>=0&&(l&&this.replayTextBackground_(t,_a,Co,Lo,ya,o,a),qT(t,s.canvasTransform,r,n,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=Vi(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;t.save(),t.translate(n[0]%s,n[1]%s),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,s){const r=this.textStates[e],o=this.createLabel(t,e,s,n),a=this.strokeStates[n],l=this.pixelRatio,h=v1(Array.isArray(t)?t[0]:t,r.textAlign||Vd),c=Qp[r.textBaseline||$p],u=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*r.scale[0],d=h*f+2*(.5-h)*u,g=c*o.height/l+2*(.5-c)*u;return{label:o,anchorX:d,anchorY:g}}execute_(t,e,n,s,r,o,a,l){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&uo(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Da(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),SM(this.renderedTransform_,n));let u=0;const f=s.length;let d=0,g,p,y,_,x,b,L,M,k,A,T,F,q,R=0,S=0,O=null,E=null;const U=this.coordinateCache_,X=this.viewRotation_,Z=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,st={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:X},tt=this.instructions!=s||this.overlaps?0:200;let ot,et,P,H;for(;u<f;){const j=s[u];switch(j[0]){case fe.BEGIN_GEOMETRY:ot=j[1],H=j[3],ot.getGeometry()?a!==void 0&&!Ri(a,H.getExtent())?u=j[2]+1:++u:u=j[2],h&&(h.zIndex=j[4]);break;case fe.BEGIN_PATH:R>tt&&(this.fill_(t),R=0),S>tt&&(t.stroke(),S=0),!R&&!S&&(t.beginPath(),x=NaN,b=NaN),++u;break;case fe.CIRCLE:d=j[1];const ht=c[d],ft=c[d+1],gt=c[d+2],_t=c[d+3],Pt=gt-ht,Tt=_t-ft,Wt=Math.sqrt(Pt*Pt+Tt*Tt);t.moveTo(ht+Wt,ft),t.arc(ht,ft,Wt,0,2*Math.PI,!0),++u;break;case fe.CLOSE_PATH:t.closePath(),++u;break;case fe.CUSTOM:d=j[1],g=j[2];const Gt=j[3],N=j[4],rt=j[5];st.geometry=Gt,st.feature=ot,u in U||(U[u]=[]);const z=U[u];rt?rt(c,d,g,2,z):(z[0]=c[d],z[1]=c[d+1],z.length=2),h&&(h.zIndex=j[6]),N(z,st),++u;break;case fe.DRAW_IMAGE:d=j[1],g=j[2],k=j[3],p=j[4],y=j[5];let J=j[6];const Y=j[7],it=j[8],pt=j[9],vt=j[10];let at=j[11];const Et=j[12];let It=j[13];_=j[14]||"declutter";const Ct=j[15];if(!k&&j.length>=20){A=j[19],T=j[20],F=j[21],q=j[22];const en=this.drawLabelWithPointPlacement_(A,T,F,q);k=en.label,j[3]=k;const wi=j[23];p=(en.anchorX-wi)*this.pixelRatio,j[4]=p;const Ti=j[24];y=(en.anchorY-Ti)*this.pixelRatio,j[5]=y,J=k.height,j[6]=J,It=k.width,j[13]=It}let jt;j.length>25&&(jt=j[25]);let ie,te,ee;j.length>17?(ie=j[16],te=j[17],ee=j[18]):(ie=Al,te=!1,ee=!1),vt&&Z?at+=X:!vt&&!Z&&(at-=X);let be=0;for(;d<g;d+=2){if(jt&&jt[be++]<It/this.pixelRatio)continue;const en=this.calculateImageOrLabelDimensions_(k.width,k.height,c[d],c[d+1],It,J,p,y,it,pt,at,Et,r,ie,te||ee,ot),wi=[t,e,k,en,Y,te?O:null,ee?E:null];if(l){let Ti,zi,se;if(Ct){const Ne=g-d;if(!Ct[Ne]){Ct[Ne]={args:wi,declutterMode:_};continue}const je=Ct[Ne];Ti=je.args,zi=je.declutterMode,delete Ct[Ne],se=Hx(Ti)}let Gi,nn;if(Ti&&(zi!=="declutter"||!l.collides(se))&&(Gi=!0),(_!=="declutter"||!l.collides(en.declutterBox))&&(nn=!0),zi==="declutter"&&_==="declutter"){const Ne=Gi&&nn;Gi=Ne,nn=Ne}Gi&&(zi!=="none"&&l.insert(se),this.replayImageOrLabel_.apply(this,Ti)),nn&&(_!=="none"&&l.insert(en.declutterBox),this.replayImageOrLabel_.apply(this,wi))}else this.replayImageOrLabel_.apply(this,wi)}++u;break;case fe.DRAW_CHARS:const qt=j[1],bi=j[2],he=j[3],pn=j[4];q=j[5];const We=j[6],Re=j[7],Rn=j[8];F=j[9];const Fe=j[10];A=j[11],T=j[12];const Vs=[j[13],j[13]];_=j[14]||"declutter";const ci=this.textStates[T],tn=ci.font,ji=[ci.scale[0]*Re,ci.scale[1]*Re];let qe;tn in this.widths_?qe=this.widths_[tn]:(qe={},this.widths_[tn]=qe);const _e=NS(c,qt,bi,2),Ve=Math.abs(ji[0])*Tx(tn,A,qe);if(pn||Ve<=_e){const en=this.textStates[T].textAlign,wi=(_e-Ve)*v1(A,en),Ti=oP(c,qt,bi,2,A,wi,We,Math.abs(ji[0]),Tx,tn,qe,Z?0:this.viewRotation_);t:if(Ti){const zi=[];let se,Gi,nn,Ne,je;if(F)for(se=0,Gi=Ti.length;se<Gi;++se){je=Ti[se],nn=je[4],Ne=this.createLabel(nn,T,"",F),p=je[2]+(ji[0]<0?-Fe:Fe),y=he*Ne.height+(.5-he)*2*Fe*ji[1]/ji[0]-Rn;const ti=this.calculateImageOrLabelDimensions_(Ne.width,Ne.height,je[0],je[1],Ne.width,Ne.height,p,y,0,0,je[3],Vs,!1,Al,!1,ot);if(l&&_==="declutter"&&l.collides(ti.declutterBox))break t;zi.push([t,e,Ne,ti,1,null,null])}if(q)for(se=0,Gi=Ti.length;se<Gi;++se){je=Ti[se],nn=je[4],Ne=this.createLabel(nn,T,q,""),p=je[2],y=he*Ne.height-Rn;const ti=this.calculateImageOrLabelDimensions_(Ne.width,Ne.height,je[0],je[1],Ne.width,Ne.height,p,y,0,0,je[3],Vs,!1,Al,!1,ot);if(l&&_==="declutter"&&l.collides(ti.declutterBox))break t;zi.push([t,e,Ne,ti,1,null,null])}l&&_!=="none"&&l.load(zi.map(Hx));for(let ti=0,$n=zi.length;ti<$n;++ti)this.replayImageOrLabel_.apply(this,zi[ti])}}++u;break;case fe.END_GEOMETRY:if(o!==void 0){ot=j[1];const en=o(ot,H,_);if(en)return en}++u;break;case fe.FILL:tt?R++:this.fill_(t),++u;break;case fe.MOVE_TO_LINE_TO:for(d=j[1],g=j[2],et=c[d],P=c[d+1],t.moveTo(et,P),x=et+.5|0,b=P+.5|0,d+=2;d<g;d+=2)et=c[d],P=c[d+1],L=et+.5|0,M=P+.5|0,(d==g-2||L!==x||M!==b)&&(t.lineTo(et,P),x=L,b=M);++u;break;case fe.SET_FILL_STYLE:O=j,this.alignAndScaleFill_=j[2],R&&(this.fill_(t),R=0,S&&(t.stroke(),S=0)),t.fillStyle=j[1],++u;break;case fe.SET_STROKE_STYLE:E=j,S&&(t.stroke(),S=0),this.setStrokeStyle_(t,j),++u;break;case fe.STROKE:tt?S++:t.stroke(),++u;break;default:++u;break}}R&&this.fill_(t),S&&t.stroke()}execute(t,e,n,s,r,o){this.viewRotation_=s,this.execute_(t,e,n,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,n,s,r){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,s,r)}}const cc=["Polygon","Circle","LineString","Image","Text","Default"],t0=["Image","Text"],hP=cc.filter(i=>!t0.includes(i));class JS{constructor(t,e,n,s,r,o,a){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=hn(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let s=this.executorsByZIndex_[n];s===void 0&&(s={},this.executorsByZIndex_[n]=s);const r=t[n];for(const o in r){const a=r[o];s[o]=new lP(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let s=0,r=t.length;s<r;++s)if(t[s]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,s,r,o){s=Math.round(s);const a=s*2+1,l=or(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-n,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Bi(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):h||c.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=Es(),yd(u,t),Xo(u,e*(this.renderBuffer_+s),u));const f=cP(s);let d;function g(M,k,A){const T=c.getImageData(0,0,a,a).data;for(let F=0,q=f.length;F<q;F++)if(T[f[F]]>0){if(!o||A==="none"||d!=="Image"&&d!=="Text"||o.includes(M)){const R=(f[F]-3)/4,S=s-R%a,O=s-(R/a|0),E=r(M,k,S*S+O*O);if(E)return E}c.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(no);let y,_,x,b,L;for(y=p.length-1;y>=0;--y){const M=p[y].toString();for(x=this.executorsByZIndex_[M],_=cc.length-1;_>=0;--_)if(d=cc[_],b=x[d],b!==void 0&&(L=b.executeHitDetection(c,l,n,g,u),L))return L}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],s=e[1],r=e[2],o=e[3],a=[n,s,n,o,r,o,r,s];return Da(a,0,8,2,t,a),a}isEmpty(){return Ul(this.executorsByZIndex_)}execute(t,e,n,s,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(no),o=o||cc;const h=cc.length;let c,u,f,d,g;for(a&&l.reverse(),c=0,u=l.length;c<u;++c){const p=l[c].toString();for(g=this.executorsByZIndex_[p],f=0,d=o.length;f<d;++f){const y=o[f],_=g[y];if(_!==void 0){const x=a===null?void 0:_.getZIndexContext(),b=x?x.getContext():t,L=this.maxExtent_&&y!=="Image"&&y!=="Text";if(L&&(b.save(),this.clip(b,n)),!x||y==="Text"||y==="Image"?_.execute(b,e,n,s,r,a):x.pushFunction(M=>_.execute(M,e,n,s,r,a)),L&&b.restore(),x){x.offset();const M=l[c]*h+f;this.deferredZIndexContexts_[M]||(this.deferredZIndexContexts_[M]=[]),this.deferredZIndexContexts_[M].push(x)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(no);for(let n=0,s=e.length;n<s;++n)t[e[n]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),t[e[n]].length=0}}const x1={};function cP(i){if(x1[i]!==void 0)return x1[i];const t=i*2+1,e=i*i,n=new Array(e+1);for(let r=0;r<=i;++r)for(let o=0;o<=i;++o){const a=r*r+o*o;if(a>e)break;let l=n[a];l||(l=[],n[a]=l),l.push(((i+r)*t+(i+o))*4+3),r>0&&l.push(((i-r)*t+(i+o))*4+3),o>0&&(l.push(((i+r)*t+(i-o))*4+3),r>0&&l.push(((i-r)*t+(i-o))*4+3))}const s=[];for(let r=0,o=n.length;r<o;++r)n[r]&&s.push(...n[r]);return x1[i]=s,s}class QS extends $S{constructor(t,e,n,s,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=s,this.transformRotation_=s?wf(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=hn()}drawImages_(t,e,n,s){if(!this.image_)return;const r=Da(t,e,n,s,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,u=r.length;c<u;c+=2){const f=r[c]-this.imageAnchorX_,d=r[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=f+this.imageAnchorX_,p=d+this.imageAnchorY_;or(a,g,p,1,1,h,-g,-p),o.save(),o.transform.apply(o,a),o.translate(g,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,n,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Da(t,e,n,s,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=s){const l=r[e]+this.textOffsetX_,h=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(t,e,n,s,r){const o=this.context_,a=Da(t,e,n,s,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return r&&o.closePath(),n}drawRings_(t,e,n,s){for(let r=0,o=n.length;r<o;++r)e=this.moveToLineTo_(t,e,n[r],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=nT(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],s=e[3]-e[1],r=Math.sqrt(n*n+s*s),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,s=e.length;n<s;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Ri(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,s=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();n.beginPath();for(let l=0,h=o.length;l<h;++l)r=this.moveToLineTo_(s,r,o[l],a,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ri(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let s=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=r.length;a<l;++a){const h=r[a];s=this.drawRings_(n,s,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),uo(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,s=t.textAlign?t.textAlign:Vd;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=s&&(n.textAlign=s,e.textAlign=s),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:Jr(n||ms)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),s=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),c=r||qo;this.strokeState_={lineCap:s!==void 0?s:Gc,lineDash:this.pixelRatio_===1?c:c.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Vo)*this.pixelRatio_,lineJoin:a!==void 0?a:Uc,lineWidth:(l!==void 0?l:Hd)*this.pixelRatio_,miterLimit:h!==void 0?h:Wd,strokeStyle:Jr(n||qd)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*n,this.imageAnchorY_=s[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const d=e.getColor();this.textFillState_={fillStyle:Jr(d||ms)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const d=n.getColor(),g=n.getLineCap(),p=n.getLineDash(),y=n.getLineDashOffset(),_=n.getLineJoin(),x=n.getWidth(),b=n.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:Gc,lineDash:p||qo,lineDashOffset:y||Vo,lineJoin:_!==void 0?_:Uc,lineWidth:x!==void 0?x:Hd,miterLimit:b!==void 0?b:Wd,strokeStyle:Jr(d||qd)}}const s=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),c=t.getText(),u=t.getTextAlign(),f=t.getTextBaseline();this.textState_={font:s!==void 0?s:FS,textAlign:u!==void 0?u:Vd,textBaseline:f!==void 0?f:$p},this.text_=c!==void 0?Array.isArray(c)?c.reduce((d,g,p)=>d+=p%2?" ":g,""):c:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const js=.5;function tE(i,t,e,n,s,r,o,a,l){const h=l?U0(s):s,c=i[0]*js,u=i[1]*js,f=Bi(c,u);f.imageSmoothingEnabled=!1;const d=f.canvas,g=new QS(f,js,s,null,o,a,l?th(uS(),l):null),p=e.length,y=Math.floor((256*256*256-1)/p),_={};for(let b=1;b<=p;++b){const L=e[b-1],M=L.getStyleFunction()||n;if(!M)continue;let k=M(L,r);if(!k)continue;Array.isArray(k)||(k=[k]);const T=(b*y).toString(16).padStart(7,"#00000");for(let F=0,q=k.length;F<q;++F){const R=k[F],S=R.getGeometryFunction()(L);if(!S||!Ri(h,S.getExtent()))continue;const O=R.clone(),E=O.getFill();E&&E.setColor(T);const U=O.getStroke();U&&(U.setColor(T),U.setLineDash(null)),O.setText(void 0);const X=R.getImage();if(X){const ot=X.getImageSize();if(!ot)continue;const et=Bi(ot[0],ot[1],void 0,{alpha:!1}),P=et.canvas;et.fillStyle=T,et.fillRect(0,0,P.width,P.height),O.setImage(new Wa({img:P,anchor:X.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:X.getOrigin(),opacity:1,size:X.getSize(),scale:X.getScale(),rotation:X.getRotation(),rotateWithView:X.getRotateWithView()}))}const Z=O.getZIndex()||0;let st=_[Z];st||(st={},_[Z]=st,st.Polygon=[],st.Circle=[],st.LineString=[],st.Point=[]);const tt=S.getType();if(tt==="GeometryCollection"){const ot=S.getGeometriesArrayRecursive();for(let et=0,P=ot.length;et<P;++et){const H=ot[et];st[H.getType().replace("Multi","")].push(H,O)}}else st[tt.replace("Multi","")].push(S,O)}}const x=Object.keys(_).map(Number).sort(no);for(let b=0,L=x.length;b<L;++b){const M=_[x[b]];for(const k in M){const A=M[k];for(let T=0,F=A.length;T<F;T+=2){g.setStyle(A[T+1]);for(let q=0,R=t.length;q<R;++q)g.setTransform(t[q]),g.drawGeometry(A[T])}}}return f.getImageData(0,0,d.width,d.height)}function eE(i,t,e){const n=[];if(e){const s=Math.floor(Math.round(i[0])*js),r=Math.floor(Math.round(i[1])*js),o=(xi(s,0,e.width-1)+xi(r,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);c&&c%u===0&&n.push(t[c/u-1])}return n}const uP=.5,iE={Point:vP,LineString:mP,Polygon:bP,MultiPoint:xP,MultiLineString:_P,MultiPolygon:yP,GeometryCollection:pP,Circle:fP};function dP(i,t){return parseInt(le(i),10)-parseInt(le(t),10)}function A_(i,t){const e=nE(i,t);return e*e}function nE(i,t){return uP*i/t}function fP(i,t,e,n,s){const r=e.getFill(),o=e.getStroke();if(r||o){const l=i.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(t,n,s)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n)}}function e0(i,t,e,n,s,r,o,a){const l=[],h=e.getImage();if(h){let f=!0;const d=h.getImageState();d==re.LOADED||d==re.ERROR?f=!1:d==re.IDLE&&h.load(),f&&l.push(h.ready())}const c=e.getFill();c&&c.loading()&&l.push(c.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>s(null)),gP(i,t,e,n,r,o,a),u}function gP(i,t,e,n,s,r,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(n,s);if(e.getRenderer())sE(i,l,e,t,o);else{const c=iE[l.getType()];c(i,l,e,t,o,r)}}function sE(i,t,e,n,s){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)sE(i,o[a],e,n,s);return}i.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer(),s)}function pP(i,t,e,n,s,r){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const h=iE[o[a].getType()];h(i,o[a],e,n,s,r)}}function mP(i,t,e,n,s){const r=e.getStroke();if(r){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(t,n,s)}const o=e.getText();if(o&&o.getText()){const a=i.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n,s)}}function _P(i,t,e,n,s){const r=e.getStroke();if(r){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(t,n,s)}const o=e.getText();if(o&&o.getText()){const a=i.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n,s)}}function yP(i,t,e,n,s){const r=e.getFill(),o=e.getStroke();if(o||r){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(t,n,s)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n,s)}}function vP(i,t,e,n,s,r){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),h=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=re.LOADED)return;const c=i.getBuilder(e.getZIndex(),"Image");c.setImageStyle(o,h),c.drawPoint(t,n,s)}if(l){const c=i.getBuilder(e.getZIndex(),"Text");c.setTextStyle(a,h),c.drawText(t,n,s)}}function xP(i,t,e,n,s,r){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),h=l&&l.getText(),c=r&&a&&h?{}:void 0;if(a){if(o.getImageState()!=re.LOADED)return;const u=i.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,c),u.drawMultiPoint(t,n,s)}if(h){const u=i.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,c),u.drawText(t,n,s)}}function bP(i,t,e,n,s){const r=e.getFill(),o=e.getStroke();if(r||o){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(t,n,s)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n,s)}}class wP extends f2{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Es(),this.wrappedRenderedExtent_=Es(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,n){const s=e.extent,r=e.viewState,o=r.center,a=r.resolution,l=r.projection,h=r.rotation,c=l.getExtent(),u=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),d=e.pixelRatio,g=e.viewHints,p=!(g[vi.ANIMATING]||g[vi.INTERACTING]),y=this.context,_=Math.round(Ie(s)/a*d),x=Math.round(ln(s)/a*d),b=u.getWrapX()&&l.canWrapX(),L=b?Ie(c):null,M=b?Math.ceil((s[2]-c[2])/L)+1:1;let k=b?Math.floor((s[0]-c[0])/L):0;do{let A=this.getRenderTransform(o,a,0,d,_,x,k*L);e.declutter&&(A=A.slice(0)),t.execute(y,[y.canvas.width,y.canvas.height],A,h,p,n===void 0?cc:n?t0:hP,n?f&&e.declutter[f]:void 0)}while(++k<M)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Bi(this.context.canvas.width,this.context.canvas.height,Vx))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,zc(this.context),Vx.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;const s=t.viewState;this.prepareContainer(t,e);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Sn.PRERENDER)||this.getLayer().hasListener(Sn.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(r,t),s.projection,this.clipped_=!1,a&&n.extent&&this.clipping){const l=Er(n.extent);a=Ri(l,t.extent),this.clipped_=a&&!ir(l,t.extent),this.clipped_&&this.clipUnrotated(r,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&r.restore(),this.postRender(r,t),this.renderedRotation_!==s.rotation&&(this.renderedRotation_=s.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=this.frameState.size.slice(),s=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],u=n[0]*js,f=n[1]*js;c.push(this.getRenderTransform(s,r,o,js,u,f,0).slice());const d=h.getSource(),g=a.getExtent();if(d.getWrapX()&&a.canWrapX()&&!ir(g,l)){let p=l[0];const y=Ie(g);let _=0,x;for(;p<g[0];)--_,x=y*_,c.push(this.getRenderTransform(s,r,o,js,u,f,x).slice()),p+=y;for(_=0,p=l[2];p>g[2];)++_,x=y*_,c.push(this.getRenderTransform(s,r,o,js,u,f,x).slice()),p-=y}this.hitDetectionImageData_=tE(n,c,this.renderedFeatures_,h.getStyleFunction(),l,r,o,A_(r,this.renderedPixelRatio_),null)}e(eE(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,s,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),h={},c=function(g,p,y){const _=le(g),x=h[_];if(x){if(x!==!0&&y<x.distanceSq){if(y===0)return h[_]=!0,r.splice(r.lastIndexOf(x),1),s(g,l,p);x.geometry=p,x.distanceSq=y}}else{if(y===0)return h[_]=!0,s(g,l,p);r.push(h[_]={feature:g,layer:l,geometry:p,distanceSq:y,callback:s})}};let u;const f=[this.replayGroup_],d=this.getLayer().getDeclutter();return f.some(g=>u=g.forEachFeatureAtCoordinate(t,o,a,n,c,d&&e.declutter[d]?e.declutter[d].all().map(p=>p.value):null)),u}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const s=t.viewHints[vi.ANIMATING],r=t.viewHints[vi.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&s||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,c=h.projection,u=h.resolution,f=t.pixelRatio,d=e.getRevision(),g=e.getRenderBuffer();let p=e.getRenderOrder();p===void 0&&(p=dP);const y=h.center.slice(),_=Xo(l,g*u),x=_.slice(),b=[_.slice()],L=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!ir(L,t.extent)){const E=Ie(L),U=Math.max(Ie(_)/2,E);_[0]=L[0]-U,_[2]=L[2]+U,j0(y,c);const X=iS(b[0],c);X[0]<L[0]&&X[2]<L[2]?b.push([X[0]+E,X[1],X[2]+E,X[3]]):X[0]>L[0]&&X[2]>L[2]&&b.push([X[0]-E,X[1],X[2]-E,X[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==d&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&ir(this.wrappedRenderedExtent_,_))return uo(this.renderedExtent_,x)||(this.hitDetectionImageData_=null,this.renderedExtent_=x),this.renderedCenter_=y,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const M=new KS(nE(u,f),_,u,f);let k;for(let E=0,U=b.length;E<U;++E)n.loadFeatures(b[E],u,c);const A=A_(u,f);let T=!0;const F=(E,U)=>{let X;const Z=E.getStyleFunction()||e.getStyleFunction();if(Z&&(X=Z(E,u)),X){const st=this.renderFeature(E,A,X,M,k,this.getLayer().getDeclutter(),U);T=T&&!st}},q=U0(_),R=n.getFeaturesInExtent(q);p&&R.sort(p);for(let E=0,U=R.length;E<U;++E)F(R[E],E);this.renderedFeatures_=R,this.ready=T;const S=M.finish(),O=new JS(_,u,f,n.getOverlaps(),S,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=d,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=x,this.wrappedRenderedExtent_=_,this.renderedCenter_=y,this.renderedProjection_=c,this.renderedPixelRatio_=f,this.replayGroup_=O,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,s,r,o,a){if(!n)return!1;let l=!1;if(Array.isArray(n))for(let h=0,c=n.length;h<c;++h)l=e0(s,t,n[h],e,this.boundHandleStyleImageChange_,r,o,a)||l;else l=e0(s,t,n,e,this.boundHandleStyleImageChange_,r,o,a);return l}}class Rr extends Lf{constructor(t){super(t)}createRenderer(){return new wP(this)}}class P_{constructor(t){this.rbush_=new GS(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[le(e)]=n}load(t,e){const n=new Array(e.length);for(let s=0,r=e.length;s<r;s++){const o=t[s],a=e[s],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[s]=l,this.items_[le(a)]=l}this.rbush_.load(n)}remove(t){const e=le(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[le(e)],s=[n.minX,n.minY,n.maxX,n.maxY];Ga(s,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(s){return s.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let s=0,r=t.length;s<r;s++)if(n=e(t[s]),n)return n;return n}isEmpty(){return Ul(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ao(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class K0 extends tl{constructor(t,e,n){super(),n!==void 0&&e===void 0?this.setFlatCoordinates(n,t):(e=e||0,this.setCenterAndRadius(t,e,n))}clone(){const t=new K0(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const r=this.flatCoordinates,o=t-r[0],a=e-r[1],l=o*o+a*a;if(l<s){if(l===0)for(let h=0;h<this.stride;++h)n[h]=r[h];else{const h=this.getRadius()/Math.sqrt(l);n[0]=r[0]+h*o,n[1]=r[1]+h*a;for(let c=2;c<this.stride;++c)n[c]=r[c]}return n.length=this.stride,l}return s}containsXY(t,e){const n=this.flatCoordinates,s=t-n[0],r=e-n[1];return s*s+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,n=e[this.stride]-e[0];return ao(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if(Ri(t,e)){const n=this.getCenter();return t[0]<=n[0]&&t[2]>=n[0]||t[1]<=n[1]&&t[3]>=n[1]?!0:ky(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],s=t.slice();s[e]=s[0]+n;for(let r=1;r<e;++r)s[e+r]=t[r];this.setFlatCoordinates(this.layout,s),this.changed()}setCenterAndRadius(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const s=this.flatCoordinates;let r=dS(s,0,t,this.stride);s[r++]=s[0]+e;for(let o=1,a=this.stride;o<a;++o)s[r++]=s[o];s.length=r,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const n=this.getCenter(),s=this.getStride();this.setCenter(zy(n,0,n.length,s,t,e,n)),this.changed()}}K0.prototype.transform;class rr extends Gy{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ke),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(ve(t[e],ce.CHANGE,this.changed,this))}clone(){const t=new rr(b1(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,s){if(s<Zl(this.getExtent(),t,e))return s;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)s=r[o].closestPointXY(t,e,n,s);return s}containsXY(t,e){const n=this.geometries_;for(let s=0,r=n.length;s<r;++s)if(n[s].containsXY(t,e))return!0;return!1}computeExtent(t){Kc(t);const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)Ny(t,e[n].getExtent());return t}getGeometries(){return b1(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let s=!1;for(let r=0,o=n.length;r<o;++r){const a=n[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(s=!0)}return s?new rr(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const n=this.geometries_;for(let s=0,r=n.length;s<r;++s)n[s].rotate(t,e);this.changed()}scale(t,e,n){n||(n=lo(this.getExtent()));const s=this.geometries_;for(let r=0,o=s.length;r<o;++r)s[r].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(b1(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let s=0,r=n.length;s<r;++s)n[s].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function b1(i){return i.map(t=>t.clone())}class ho extends tl{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const s=t,r=[],o=[];for(let l=0,h=s.length;l<h;++l){const c=s[l];Ye(r,c.getFlatCoordinates()),o.push(r.length)}const a=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){Ye(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new ho(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Zl(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wy(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vy(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,s))}getCoordinateAtM(t,e,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,n=n!==void 0?n:!1,OT(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return zd(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new cn(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,s=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new cn(t.slice(r,l),n);s.push(h),r=l}return s}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const s=this.ends_,r=this.stride;for(let o=0,a=s.length;o<a;++o){const l=s[o],h=Xp(e,n,l,r,.5);Ye(t,h),n=l}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=gS(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new ho(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return uT(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Sf(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class nh extends tl{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){Ye(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new nh(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){if(s<Zl(this.getExtent(),t,e))return s;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const h=Wo(t,e,r[a],r[a+1]);if(h<s){s=h;for(let c=0;c<o;++c)n[c]=r[a+c];n.length=o}}return s}getCoordinates(){return Ma(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Qi(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,s=[];for(let r=0,o=t.length;r<o;r+=n){const a=new Qi(t.slice(r,r+n),e);s.push(a)}return s}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let s=0,r=e.length;s<r;s+=n){const o=e[s],a=e[s+1];if(Iy(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=W0(this.flatCoordinates,0,t,this.stride),this.changed()}}function rE(i,t,e,n){const s=[];let r=Es();for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Ry(i,t,l[0],n),s.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=l[l.length-1]}return s}class qa extends tl{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const s=t,r=[],o=[];for(let a=0,l=s.length;a<l;++a){const h=s[a],c=r.length,u=h.getEnds();for(let f=0,d=u.length;f<d;++f)u[f]+=c;Ye(r,h.getFlatCoordinates()),o.push(u)}e=s.length===0?this.getLayout():s[0].getLayout(),t=r,n=o}e!==void 0&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;Ye(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let s=0,r=e.length;s<r;++s)e[s]+=n}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let s=0;s<t;++s)e[s]=this.endss_[s].slice();const n=new qa(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,s){return s<Zl(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(sT(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rT(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return cT(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return lT(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),S_(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,w_(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=rE(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=yS(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new nh(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;wS(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=S_(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=aT(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new qa(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const n=this.endss_[t].slice(),s=n[n.length-1];if(e!==0)for(let r=0,o=n.length;r<o;++r)n[r]-=e;return new sr(this.flatCoordinates.slice(e,s),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,s=[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=n[o].slice(),h=l[l.length-1];if(r!==0)for(let u=0,f=l.length;u<f;++u)l[u]-=r;const c=new sr(e.slice(r,h),t,l);s.push(c),r=h}return s}getType(){return"MultiPolygon"}intersectsExtent(t){return dT(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=fS(this.flatCoordinates,0,t,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const s=n[n.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}const Xx=hn();class Bs{constructor(t,e,n,s,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=r,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?_d(this.flatCoordinates_):Ry(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=lo(this.getExtent());this.flatInteriorPoints_=Xy(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=gT(this.flatCoordinates_,this.ends_),e=rE(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=yS(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Xp(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let s=0,r=n.length;s<r;++s){const o=n[s],a=Xp(t,e,o,2,.5);Ye(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=xe(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const s=ln(n)/ln(e);or(Xx,n[0],n[3],s,-s,0,0,0),Da(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Xx,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new Bs(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=$w((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":n.length=q0(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),s=[n.length];break;case"MultiLineString":s=[],n.length=gS(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,s);break;case"Polygon":s=[],n.length=Hy(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,s);break}return s&&(this.simplifiedGeometry_=new Bs(this.type_,n,s,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}Bs.prototype.getFlatCoordinates=Bs.prototype.getOrientedFlatCoordinates;class g2 extends In{constructor(t){super(),this.projection=xe(t.projection),this.attributions_=$x(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,s){e.viewResolver=n,e.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=$x(t),this.changed()}setState(t){this.state_=t,this.changed()}}function $x(i){return i?typeof i=="function"?i:(Array.isArray(i)||(i=[i]),t=>i):null}const xn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function SP(i,t){return[[-1/0,-1/0,1/0,1/0]]}let EP=!1;function CP(i,t,e,n,s,r,o){const a=new XMLHttpRequest;a.open("GET",typeof i=="function"?i(e,n,s):i,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=EP,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();try{let c;h=="text"||h=="json"?c=a.responseText:h=="xml"?c=a.responseXML||a.responseText:h=="arraybuffer"&&(c=a.response),c?r(t.readFeatures(c,{extent:e,featureProjection:s}),t.readProjection(c)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Kx(i,t){return function(e,n,s,r,o){const a=this;CP(i,t,e,n,s,function(l,h){a.addFeatures(l),r!==void 0&&r(l)},o||Nc)}}class va extends os{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class Ws extends g2{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Nc,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(De(this.format_,"`format` must be set when `url` is set"),this.loader_=Kx(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:SP;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new P_:null,this.loadedExtentsRtree_=new P_,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,s;Array.isArray(t.features)?s=t.features:t.features&&(n=t.features,s=n.getArray()),!e&&n===void 0&&(n=new ns(s)),s!==void 0&&this.addFeaturesInternal(s),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=le(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const s=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new va(xn.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof Bs||(this.featureChangeKeys_[t]=[ve(e,ce.CHANGE,this.handleFeatureChange_,this),ve(e,Rc.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(e.getId()!==void 0){const s=String(e.getId());if(!(s in this.idIndex_))this.idIndex_[s]=e;else if(e instanceof Bs){const r=this.idIndex_[s];r instanceof Bs?Array.isArray(r)?r.push(e):this.idIndex_[s]=[r,e]:n=!1}else n=!1}return n&&(De(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],s=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=le(a);this.addToIndex_(l,a)&&n.push(a)}for(let r=0,o=n.length;r<o;r++){const a=n[r],l=le(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const c=h.getExtent();e.push(c),s.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,s),this.hasListener(xn.ADDFEATURE))for(let r=0,o=n.length;r<o;r++)this.dispatchEvent(new va(xn.ADDFEATURE,n[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(xn.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(xn.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(an.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(an.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(Ke);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=s=>{this.removeFeatureInternal(s)};this.featuresRtree_.forEach(n);for(const s in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[s])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new va(xn.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(s){const r=s.getGeometry();if(r instanceof Bs||r.intersectsCoordinate(t))return e(s)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){const s=n.getGeometry();if(s instanceof Bs||s.intersectsExtent(t)){const r=e(n);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ul(this.nullGeometryFeatures_)||Ye(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const s=Fy(t,e);return[].concat(...s.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],s=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Yo,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const c=h.getGeometry(),u=a;if(a=c instanceof Bs?0:c.closestPointXY(n,s,o,a),a<u){r=h;const f=Math.sqrt(a);l[0]=n-f,l[1]=s-f,l[2]=n+f,l[3]=s+f}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=le(e),s=e.getGeometry();if(!s)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const o=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new va(xn.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:le(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Ul(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const s=this.loadedExtentsRtree_,r=this.strategy_(t,e,n);for(let o=0,a=r.length;o<a;++o){const l=r[o];s.forEachInExtent(l,function(c){return ir(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new va(xn.FEATURESLOADSTART)),this.loader_.call(this,l,e,n,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new va(xn.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new va(xn.FEATURESLOADERROR))}),s.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,function(s){if(Ga(s.extent,t))return n=s,!0}),n&&e.remove(n)}removeFeatures(t){let e=!1;for(let n=0,s=t.length;n<s;++n)e=this.removeFeatureInternal(t[n])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=le(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const n=this.featureChangeKeys_[e];n==null||n.forEach(Ke),delete this.featureChangeKeys_[e];const s=t.getId();if(s!==void 0){const r=s.toString(),o=this.idIndex_[r];o===t?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[e],this.hasListener(xn.REMOVEFEATURE)&&this.dispatchEvent(new va(xn.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){De(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Kx(t,this.format_))}}function LP(i,t){const e=i.canvas;t=t||{};const n=t.pixelRatio||Tl,s=t.size;s&&(e.width=s[0]*n,e.height=s[1]*n,e.style.width=s[0]+"px",e.style.height=s[1]+"px");const r=[0,0,e.width,e.height],o=xp(hn(),n,n);return new QS(i,n,r,o,0)}const Jt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class p2 extends vf{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ce.CHANGE)}release(){this.state===Jt.ERROR&&this.setState(Jt.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==Jt.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){de()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const s=e-n+1e3/60;return s>=this.transition_?1:jS(s/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}class oE extends p2{constructor(t,e,n,s,r,o){super(t,e,o),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=Jt.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=Jt.ERROR,this.unlistenImage_(),this.image_=MP(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Jt.LOADED:this.state=Jt.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==Jt.ERROR&&(this.state=Jt.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Jt.IDLE&&(this.state=Jt.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=RT(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function MP(){const i=Bi(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class TP{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[e+2]-this.points_[n+2];if(s<1e3/60)return!1;const r=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class AP extends yf{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){de()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,s=t.pixelToCoordinateTransform;or(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Py(s,n)}forEachFeatureAtCoordinate(t,e,n,s,r,o,a,l){let h;const c=e.viewState;function u(L,M,k,A){return r.call(o,M,L?k:null,A)}const f=c.projection,d=j0(t.slice(),f),g=[[0,0]];if(f.canWrapX()&&s){const L=f.getExtent(),M=Ie(L);g.push([-M,0],[M,0])}const p=e.layerStatesArray,y=p.length,_=[],x=[];for(let L=0;L<g.length;L++)for(let M=y-1;M>=0;--M){const k=p[M],A=k.layer;if(A.hasRenderer()&&h2(k,c)&&a.call(l,A)){const T=A.getRenderer(),F=A.getSource();if(T&&F){const q=F.getWrapX()?d:t,R=u.bind(null,k.managed);x[0]=q[0]+g[L][0],x[1]=q[1]+g[L][1],h=T.forEachFeatureAtCoordinate(x,e,n,R,_)}if(h)return h}}if(_.length===0)return;const b=1/_.length;return _.forEach((L,M)=>L.distanceSq+=M*b),_.sort((L,M)=>L.distanceSq-M.distanceSq),_.some(L=>h=L.callback(L.feature,L.layer,L.geometry)),h}hasFeatureAtCoordinate(t,e,n,s,r,o){return this.forEachFeatureAtCoordinate(t,e,n,s,Yo,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(t){de()}scheduleExpireIconCache(t){Zr.canExpireCache()&&t.postRenderFunctions.push(PP)}}function PP(i,t){Zr.expire()}class IP extends AP{constructor(t){super(t),this.fontChangeListenerKey_=ve(Ao,Rc.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Zc+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const s=new vd(t,void 0,e);n.dispatchEvent(s)}}disposeInternal(){Ke(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Sn.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof Lf&&a.layer.getDeclutter())&&(t.declutter={});const s=t.viewState;this.children_.length=0;const r=[];let o=null;for(let a=0,l=e.length;a<l;++a){const h=e[a];t.layerIndex=a;const c=h.layer,u=c.getSourceState();if(!h2(h,s)||u!="ready"&&u!="undefined"){c.unrender();continue}const f=c.render(t,o);f&&(f!==o&&(this.children_.push(f),o=f),r.push(h))}this.declutter(t,r),IT(this.element_,this.children_),this.dispatchRenderEvent(Sn.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let n=e.length-1;n>=0;--n){const s=e[n],r=s.layer;r.getDeclutter()&&r.renderDeclutter(t,s)}e.forEach(n=>n.layer.renderDeferred(t))}}}class Ea extends os{constructor(t,e){super(t),this.layer=e}}const w1={LAYERS:"layers"};class Hn extends BS{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(w1.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new ns(n.slice(),{unique:!0}):De(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new ns(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ke),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(ve(t,an.ADD,this.handleLayersAdd_,this),ve(t,an.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ke);Kl(this.listenerKeys_);const e=t.getArray();for(let n=0,s=e.length;n<s;n++){const r=e[n];this.registerLayerListeners_(r),this.dispatchEvent(new Ea("addlayer",r))}this.changed()}registerLayerListeners_(t){const e=[ve(t,Rc.PROPERTYCHANGE,this.handleLayerChange_,this),ve(t,ce.CHANGE,this.handleLayerChange_,this)];t instanceof Hn&&e.push(ve(t,"addlayer",this.handleLayerGroupAdd_,this),ve(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[le(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ea("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ea("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ea("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=le(e);this.listenerKeys_[n].forEach(Ke),delete this.listenerKeys_[n],this.dispatchEvent(new Ea("removelayer",e)),this.changed()}getLayers(){return this.get(w1.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let s=0,r=n.length;s<r;++s)this.dispatchEvent(new Ea("removelayer",n[s]))}this.set(w1.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const s=this.getLayerState();let r=s.zIndex;!t&&s.zIndex===void 0&&(r=0);for(let o=n,a=e.length;o<a;o++){const l=e[o];l.opacity*=s.opacity,l.visible=l.visible&&s.visible,l.maxResolution=Math.min(l.maxResolution,s.maxResolution),l.minResolution=Math.max(l.minResolution,s.minResolution),l.minZoom=Math.max(l.minZoom,s.minZoom),l.maxZoom=Math.min(l.maxZoom,s.maxZoom),s.extent!==void 0&&(l.extent!==void 0?l.extent=Ss(l.extent,s.extent):l.extent=s.extent),l.zIndex===void 0&&(l.zIndex=r)}return e}getSourceState(){return"ready"}}class nc extends os{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}class No extends nc{constructor(t,e,n,s,r,o){super(t,e,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Ge={SINGLECLICK:"singleclick",CLICK:ce.CLICK,DBLCLICK:ce.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Kd={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class RP extends vf{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=ve(n,Kd.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ve(n,Kd.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ce.TOUCHMOVE,this.boundHandleTouchMove_,TS?{passive:!1}:!1)}emulateClick_(t){let e=new No(Ge.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new No(Ge.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new No(Ge.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==Ge.POINTERUP||e.type==Ge.POINTERCANCEL){delete this.trackedTouches_[n];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==e.target){delete this.trackedTouches_[s];break}}else(e.type==Ge.POINTERDOWN||e.type==Ge.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new No(Ge.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Ke),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new No(Ge.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ve(n,Ge.POINTERMOVE,this.handlePointerMove_,this),ve(n,Ge.POINTERUP,this.handlePointerUp_,this),ve(this.element_,Ge.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(ve(this.element_.getRootNode(),Ge.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new No(Ge.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new No(Ge.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ke(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ce.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ke(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ke),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ko={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},vn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},i0=1/0;class NP{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Kl(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const s=this.keyFunction_(n);return delete this.queuedElements_[s],n}enqueue(t){De(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=i0?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,s=e.length,r=e[t],o=n[t],a=t;for(;t<s>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),c=h<s&&n[h]<n[l]?h:l;e[t]=e[c],n[t]=n[c],t=c}e[t]=r,n[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const n=this.elements_,s=this.priorities_,r=n[e],o=s[e];for(;e>t;){const a=this.getParentIndex_(e);if(s[a]>o)n[e]=n[a],s[e]=s[a],e=a;else break}n[e]=r,s[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let s=0;const r=e.length;let o,a,l;for(a=0;a<r;++a)o=e[a],l=t(o),l==i0?delete this.queuedElements_[this.keyFunction_(o)]:(n[s]=l,e[s++]=o);e.length=s,n.length=s,this.heapify_()}}class kP extends NP{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(ce.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===Jt.LOADED||n===Jt.ERROR||n===Jt.EMPTY){n!==Jt.ERROR&&e.removeEventListener(ce.CHANGE,this.boundHandleTileChange_);const s=e.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;){const s=this.dequeue()[0],r=s.getKey();s.getState()===Jt.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++n,s.load())}}}function FP(i,t,e,n,s){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return i0;const r=i.viewState.center,o=n[0]-r[0],a=n[1]-r[1];return 65536*Math.log(s)+Math.sqrt(o*o+a*a)/s}class Ms extends In{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){var t;(t=this.element)==null||t.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){var e;this.map_&&((e=this.element)==null||e.remove());for(let n=0,s=this.listenerKeys.length;n<s;++n)Ke(this.listenerKeys[n]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_??t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Nc&&this.listenerKeys.push(ve(t,ko.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class m2 extends Ms{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",s=t.expandClassName!==void 0?t.expandClassName:e+"-expand",r=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=s):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(ce.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+Zc+" "+Y0+(this.collapsed_&&this.collapsible_?" "+Lx:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),n=new Set(e.flatMap(s=>s.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(s=>n.add(s)):n.add(this.attributions_)),!this.overrideCollapsible_){const s=!e.some(r=>{var o;return((o=r.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(s)}return Array.from(n)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(s=>Kw(()=>s))),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!uo(e,this.renderedAttributions_)){AS(this.ulElement_);for(let s=0,r=e.length;s<r;++s){const o=document.createElement("li");o.innerHTML=e[s],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Lx),this.collapsed_?Yp(this.collapseLabel_,this.label_):Yp(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class aE extends Ms{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",s=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(s));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(ce.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Zc+" "+Y0,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Rg)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Qc}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const s="rotate("+n+"rad)";if(this.autoHide_){const r=this.element.classList.contains(Rg);!r&&n===0?this.element.classList.add(Rg):r&&n!==0&&this.element.classList.remove(Rg)}this.label_.style.transform=s}this.rotation_=n}}class OP extends Ms{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,s=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",r=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=s,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(ce.CLICK,this.handleClick_.bind(this,n),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(ce.CLICK,this.handleClick_.bind(this,-n),!1);const f=e+" "+Zc+" "+Y0,d=this.element;d.className=f,d.appendChild(c),d.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const s=n.getZoom();if(s!==void 0){const r=n.getConstrainedZoom(s+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:r,duration:this.duration_,easing:Qc})):n.setZoom(r)}}}function lE(i){i=i||{};const t=new ns;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new OP(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new aE(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new m2(i.attributionOptions)),t}const I_={ACTIVE:"active"};let sh=class extends In{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(I_.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(I_.ACTIVE,t)}setMap(t){this.map_=t}};function DP(i,t,e){const n=i.getCenterInternal();if(n){const s=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:eA,center:i.getConstrainedCenter(s)})}}function _2(i,t,e,n){const s=i.getZoom();if(s===void 0)return;const r=i.getConstrainedZoom(s+t),o=i.getResolutionForZoom(r);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:e,duration:n!==void 0?n:250,easing:Qc})}class BP extends sh{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Ge.DBLCLICK){const n=t.originalEvent,s=t.map,r=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=s.getView();_2(a,o,r,this.duration_),n.preventDefault(),e=!0}return!e}}class rh extends sh{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ge.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Ge.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Ge.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Ge.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function y2(i){const t=i.length;let e=0,n=0;for(let s=0;s<t;s++)e+=i[s].clientX,n+=i[s].clientY;return{clientX:e/t,clientY:n/t}}function R_(i){const t=arguments;return function(e){let n=!0;for(let s=0,r=t.length;s<r&&(n=n&&t[s](e),!!n);++s);return n}}const hE=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},jP=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},zP=function(i){const t=i.map.getTargetElement(),e=t.getRootNode(),n=i.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(n):t.contains(n)},cE=function(i){const t=i.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?zP(i):!0},n0=Yo,uE=function(i){const t=i.originalEvent;return t.button==0&&!(MT&&e2&&t.ctrlKey)},N_=$c,dE=function(i){return i.type==Ge.SINGLECLICK},v2=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},GP=function(i){const t=i.originalEvent;return!t.altKey&&(e2?t.metaKey:t.ctrlKey)&&!t.shiftKey},UP=function(i){const t=i.originalEvent;return e2?t.metaKey:t.ctrlKey},x2=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},fE=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},S1=function(i){const t=i.originalEvent;return De(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},gE=function(i){const t=i.originalEvent;return De(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};class pE extends rh{constructor(t){super({stopDown:$c}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:R_(v2,gE);this.condition_=t.onFocusOnly?R_(cE,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,s=e.getEventPixel(y2(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const r=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],a=t.map.getView();qM(r,a.getResolution()),Dy(r,a.getRotation()),a.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-s*Math.cos(r),a[1]-s*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:Qc})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class mE extends rh{constructor(t){t=t||{},super({stopDown:$c}),this.condition_=t.condition?t.condition:jP,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!S1(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===l2)return;const s=e.getSize(),r=t.pixel,o=Math.atan2(s[1]/2-r[1],r[0]-s[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return S1(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return S1(t)&&uE(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class WP extends yf{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+n,s.top=Math.min(t[1],e[1])+n,s.width=Math.abs(e[0]-t[0])+n,s.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,s=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new sr([s])}getGeometry(){return this.geometry_}}const Wh={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class zu extends os{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class qP extends rh{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new WP(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??uE,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const s=n[0]-e[0],r=n[1]-e[1];return s*s+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new zu(Wh.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new zu(e?Wh.BOXEND:Wh.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new zu(Wh.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zu(Wh.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zu(Wh.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class VP extends qP{constructor(t){t=t||{};const e=t.condition?t.condition:x2;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let s=this.getGeometry();if(this.out_){const r=n.rotatedExtentForGeometry(s),o=n.getResolutionForExtentInternal(r),a=n.getResolution()/o;s=s.clone(),s.scale(a*a)}n.fitInternal(s,{duration:this.duration_,easing:Qc})}}const ml={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class HP extends sh{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return v2(e)&&fE(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==ce.KEYDOWN){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==ml.DOWN||s==ml.LEFT||s==ml.RIGHT||s==ml.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,h=0;s==ml.DOWN?h=-a:s==ml.LEFT?l=-a:s==ml.RIGHT?l=a:h=a;const c=[l,h];Dy(c,o.getRotation()),DP(o,c,this.duration_),n.preventDefault(),e=!0}}return!e}}class YP extends sh{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!UP(e)&&fE(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==ce.KEYDOWN||t.type==ce.KEYPRESS){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==="+"||s==="-")){const r=t.map,o=s==="+"?this.delta_:-this.delta_,a=r.getView();_2(a,o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}class XP extends sh{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:n0;this.condition_=t.onFocusOnly?R_(cE,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==ce.WHEEL)return!0;const n=t.map,s=t.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let r;if(t.type==ce.WHEEL&&(r=s.deltaY,ET&&s.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=Tl),s.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?n.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=r;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-xi(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),_2(e,n,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class $P extends rh{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=$c),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],s=this.targetPointers[1],r=Math.atan2(s.clientY-n.clientY,s.clientX-n.clientX);if(this.lastAngle_!==void 0){const l=r-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=r;const o=t.map,a=o.getView();a.getConstraints().rotation!==l2&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(y2(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class KP extends rh{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=$c),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],s=this.targetPointers[1],r=n.clientX-s.clientX,o=n.clientY-s.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(y2(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function ZP(i){i=i||{};const t=new ns,e=new TP(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new mE),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new BP({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new pE({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new $P),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new KP({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new HP),t.push(new YP({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new XP({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new VP({duration:i.zoomDuration})),t}function _E(i){if(i instanceof Ef){i.setMapInternal(null);return}i instanceof Hn&&i.getLayers().forEach(_E)}function yE(i,t){if(i instanceof Ef){i.setMapInternal(t);return}if(i instanceof Hn){const e=i.getLayers().getArray();for(let n=0,s=e.length;n<s;++n)yE(e[n],t)}}let vE=class extends In{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=JP(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Tl,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=hn(),this.pixelToCoordinateTransform_=hn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||lE(),this.interactions=e.interactions||ZP({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new kP(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(vn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(vn.VIEW,this.handleViewChanged_),this.addChangeListener(vn.SIZE,this.handleSizeChanged_),this.addChangeListener(vn.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof $r)&&t.view.then(function(s){n.setView(new $r(s))}),this.controls.addEventListener(an.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(an.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(an.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(an.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(an.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(an.REMOVE,s=>{const r=s.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){yE(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const r=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:Yo,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,r,a,e,null,o,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(s){n.push(s)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(s){s instanceof Hn?e(s.getLayers()):t.push(s)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const s=e.layerFilter!==void 0?e.layerFilter:Yo,r=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,o,s,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),s=this.getSize(),r=n.width/s[0],o=n.height/s[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-n.left)/r,(a.clientY-n.top)/o]}getTarget(){return this.get(vn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Bc(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Vi(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(vn.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof ns){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e];if(!s.visible)continue;const r=s.layer.getRenderer();if(r&&!r.ready)return!0;const o=s.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Hi(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Vi(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(vn.SIZE)}getView(){return this.get(vn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,s){return FP(this.frameState_,t,e,n,s)}handleBrowserEvent(t,e){e=e||t.type;const n=new No(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===Kd.POINTERDOWN||n===ce.WHEEL||n===ce.KEYDOWN){const s=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():s,o=e.target,a=r instanceof ShadowRoot?r.host===o?r.host.ownerDocument:r:r===s?s.documentElement:r;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const s=this.getInteractions().getArray().slice();for(let r=s.length-1;r>=0;r--){const o=s[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let s=this.maxTilesLoading_,r=s;if(t){const o=t.viewHints;if(o[vi.ANIMATING]||o[vi.INTERACTING]){const a=Date.now()-t.time>8;s=a?0:8,r=a?0:2}}e.getTilesLoading()<s&&(e.reprioritize(),e.loadMoreTiles(s,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Sn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Sn.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new nc(ko.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new nc(ko.LOADSTART,this,t))));const n=this.postRenderFunctions_;for(let s=0,r=n.length;s<r;++s)n[s](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,s=this.targetChangeHandlerKeys_.length;n<s;++n)Ke(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ce.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ce.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new IP(this)),this.mapBrowserEventHandler_=new RP(this,this.moveTolerance_);for(const r in Ge)this.mapBrowserEventHandler_.addEventListener(Ge[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ce.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ce.WHEEL,this.boundHandleBrowserEvent_,TS?{passive:!1}:!1);let n;if(this.keyboardEventTarget_)n=this.keyboardEventTarget_;else{const r=e.getRootNode();n=r instanceof ShadowRoot?r.host:e}this.targetChangeHandlerKeys_=[ve(n,ce.KEYDOWN,this.handleBrowserEvent,this),ve(n,ce.KEYPRESS,this.handleBrowserEvent,this)];const s=e.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ke(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ke(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ve(t,Rc.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ve(t,ce.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ke),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ea("addlayer",t)),this.layerGroupPropertyListenerKeys_=[ve(t,Rc.PROPERTYCHANGE,this.render,this),ve(t,ce.CHANGE,this.render,this),ve(t,"addlayer",this.handleLayerAdd_,this),ve(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){_E(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),s=this.frameState_;let r=null;if(e!==void 0&&Ex(e)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Bd(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:le(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=Bd(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),s&&(!this.previousExtent_||!Jl(this.previousExtent_)&&!Ga(r.extent,this.previousExtent_))&&(this.dispatchEvent(new nc(ko.MOVESTART,this,s)),this.previousExtent_=Kc(this.previousExtent_)),this.previousExtent_&&!r.viewHints[vi.ANIMATING]&&!r.viewHints[vi.INTERACTING]&&!Ga(r.extent,this.previousExtent_)&&(this.dispatchEvent(new nc(ko.MOVEEND,this,r)),Qw(r.extent,this.previousExtent_))),this.dispatchEvent(new nc(ko.POSTRENDER,this,r)),this.renderComplete_=(this.hasListener(ko.LOADSTART)||this.hasListener(ko.LOADEND)||this.hasListener(Sn.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ea("removelayer",e)),this.set(vn.LAYERGROUP,t)}setSize(t){this.set(vn.SIZE,t)}setTarget(t){this.set(vn.TARGET,t)}setView(t){if(!t||t instanceof $r){this.set(vn.VIEW,t);return}this.set(vn.VIEW,new $r);const e=this;t.then(function(n){e.setView(new $r(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const s=getComputedStyle(t),r=t.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),o=t.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(r)&&!isNaN(o)&&(e=[Math.max(0,r),Math.max(0,o)],!Ex(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&lS("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!uo(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function JP(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new Hn({layers:i.layers});e[vn.LAYERGROUP]=n,e[vn.TARGET]=i.target,e[vn.VIEW]=i.view instanceof $r?i.view:new $r;let s;i.controls!==void 0&&(Array.isArray(i.controls)?s=new ns(i.controls.slice()):(De(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=i.controls));let r;i.interactions!==void 0&&(Array.isArray(i.interactions)?r=new ns(i.interactions.slice()):(De(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),r=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new ns(i.overlays.slice()):(De(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=i.overlays):o=new ns,{controls:s,interactions:r,keyboardEventTarget:t,overlays:o,values:e}}const Fn={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class QP extends In{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+jT,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Fn.ELEMENT,this.handleElementChanged),this.addChangeListener(Fn.MAP,this.handleMapChanged),this.addChangeListener(Fn.OFFSET,this.handleOffsetChanged),this.addChangeListener(Fn.POSITION,this.handlePositionChanged),this.addChangeListener(Fn.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(Fn.ELEMENT)}getId(){return this.id}getMap(){return this.get(Fn.MAP)||null}getOffset(){return this.get(Fn.OFFSET)}getPosition(){return this.get(Fn.POSITION)}getPositioning(){return this.get(Fn.POSITIONING)}handleElementChanged(){AS(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){var e;this.mapPostrenderListenerKey&&((e=this.element)==null||e.remove(),Ke(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=ve(t,ko.POSTRENDER,this.render,this),this.updatePixelPosition();const n=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?n.insertBefore(this.element,n.childNodes[0]||null):n.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Fn.ELEMENT,t)}setMap(t){this.set(Fn.MAP,t)}setOffset(t){this.set(Fn.OFFSET,t)}setPosition(t){this.set(Fn.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Fn.POSITION))return;const n=this.getRect(e.getTargetElement(),e.getSize()),s=this.getElement(),r=this.getRect(s,[AT(s),PT(s)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!ir(n,r)){const a=r[0]-n[0],l=n[2]-r[2],h=r[1]-n[1],c=n[3]-r[3],u=[0,0];if(a<0?u[0]=a-o:l<0&&(u[0]=Math.abs(l)+o),h<0?u[1]=h-o:c<0&&(u[1]=Math.abs(c)+o),u[0]!==0||u[1]!==0){const f=e.getView().getCenterInternal(),d=e.getPixelFromCoordinateInternal(f);if(!d)return;const g=[d[0]+u[0],d[1]+u[1]],p=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(g),duration:p.duration,easing:p.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),s=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[s,r,s+e[0],r+e[1]]}setPositioning(t){this.set(Fn.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const n=t.getPixelFromCoordinate(e),s=t.getSize();this.updateRenderedPosition(n,s)}updateRenderedPosition(t,e){const n=this.element.style,s=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=Math.round(t[0]+s[0])+"px",a=Math.round(t[1]+s[1])+"px";let l="0%",h="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?l="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(l="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?h="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(h="-50%");const c=`translate(${l}, ${h}) translate(${o}, ${a})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,n.transform=c)}getOptions(){return this.options}}class xE{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();){const e=this.pop();e instanceof yf&&e.dispose()}}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return De(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return De(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){De(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}function Zd(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function bE(i,t,e){return i+"/"+t+"/"+e}function wE(i){return bE(i[0],i[1],i[2])}function tI(i){return i.split("/").map(Number)}function SE(i){return eI(i[0],i[1],i[2])}function eI(i,t,e){return(t<<i)+e}function iI(i,t){const e=i[0],n=i[1],s=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const r=t.getFullTileRange(e);return r?r.containsXY(n,s):!0}class nI extends xE{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),n=tI(t)[0];this.forEach(s=>{s.tileCoord[0]!==n&&(this.remove(wE(s.tileCoord)),s.release())})}}class b2{constructor(t,e,n,s){this.minX=t,this.maxX=e,this.minY=n,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function qh(i,t,e,n,s){return s!==void 0?(s.minX=i,s.maxX=t,s.minY=e,s.maxY=n,s):new b2(i,t,e,n)}const Aa={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class sI extends Ef{constructor(t){t=t||{};const e=Object.assign({},t),n=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Aa.PRELOAD)}setPreload(t){this.set(Aa.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Aa.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Aa.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}function s0(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}function rI(i){return i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Float32Array||i instanceof DataView?i:null}const oI=new Error("disposed");let Vh=null;function aI(i){Vh||(Vh=Bi(i.width,i.height,void 0,{willReadFrequently:!0}));const t=Vh.canvas,e=i.width;t.width!==e&&(t.width=e);const n=i.height;return t.height!==n&&(t.height=n),Vh.clearRect(0,0,e,n),Vh.drawImage(i,0,0),Vh.getImageData(0,0,e,n).data}const lI=[256,256];class k_ extends p2{constructor(t){const e=Jt.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=s0(this.data_);return t?[t.width,t.height]:lI}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Jt.IDLE&&this.state!==Jt.ERROR)return;this.state=Jt.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=Jt.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=Jt.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(oI),this.controller_=null),super.disposeInternal()}}const w2=.5,hI=10,Zx=.25;class S2{constructor(t,e,n,s,r,o){this.sourceProj_=t,this.targetProj_=e;let a={};const l=Dc(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){const b=x[0]+"/"+x[1];return a[b]||(a[b]=l(x)),a[b]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&Ie(s)>=Ie(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ie(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ie(this.targetProj_.getExtent()):null;const h=Qa(n),c=B0(n),u=D0(n),f=O0(n),d=this.transformInv_(h),g=this.transformInv_(c),p=this.transformInv_(u),y=this.transformInv_(f),_=hI+(o?Math.max(0,Math.ceil(Math.log2(Dd(n)/(o*o*256*256)))):0);if(this.addQuad_(h,c,u,f,d,g,p,y,_),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(b,L,M){x=Math.min(x,b.source[0][0],b.source[1][0],b.source[2][0])}),this.triangles_.forEach(b=>{if(Math.max(b.source[0][0],b.source[1][0],b.source[2][0])-x>this.sourceWorldWidth_/2){const L=[[b.source[0][0],b.source[0][1]],[b.source[1][0],b.source[1][1]],[b.source[2][0],b.source[2][1]]];L[0][0]-x>this.sourceWorldWidth_/2&&(L[0][0]-=this.sourceWorldWidth_),L[1][0]-x>this.sourceWorldWidth_/2&&(L[1][0]-=this.sourceWorldWidth_),L[2][0]-x>this.sourceWorldWidth_/2&&(L[2][0]-=this.sourceWorldWidth_);const M=Math.min(L[0][0],L[1][0],L[2][0]);Math.max(L[0][0],L[1][0],L[2][0])-M<this.sourceWorldWidth_/2&&(b.source=L)}})}a={}}addTriangle_(t,e,n,s,r,o){this.triangles_.push({source:[s,r,o],target:[t,e,n]})}addQuad_(t,e,n,s,r,o,a,l,h){const c=es([r,o,a,l]),u=this.sourceWorldWidth_?Ie(c)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const y=es([t,e,n,s]);g=Ie(y)/this.targetWorldWidth_>Zx||g}!d&&this.sourceProj_.isGlobal()&&u&&(g=u>Zx||g)}if(!g&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!Ri(c,this.maxSourceExtent_))return;let p=0;if(!g&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)g=!0;else if(p=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(h>0){if(!g){const y=[(t[0]+n[0])/2,(t[1]+n[1])/2],_=this.transformInv_(y);let x;d?x=(Ol(r[0],f)+Ol(a[0],f))/2-Ol(_[0],f):x=(r[0]+a[0])/2-_[0];const b=(r[1]+a[1])/2-_[1];g=x*x+b*b>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const y=[(e[0]+n[0])/2,(e[1]+n[1])/2],_=this.transformInv_(y),x=[(s[0]+t[0])/2,(s[1]+t[1])/2],b=this.transformInv_(x);this.addQuad_(t,e,y,x,r,o,_,b,h-1),this.addQuad_(x,y,n,s,b,_,a,l,h-1)}else{const y=[(t[0]+e[0])/2,(t[1]+e[1])/2],_=this.transformInv_(y),x=[(n[0]+s[0])/2,(n[1]+s[1])/2],b=this.transformInv_(x);this.addQuad_(t,y,x,s,r,_,b,l,h-1),this.addQuad_(y,e,n,x,_,o,a,b,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}p&11||this.addTriangle_(t,n,s,r,a,l),p&14||this.addTriangle_(t,n,e,r,a,o),p&&(p&13||this.addTriangle_(e,s,t,o,l,r),p&7||this.addTriangle_(e,s,n,o,l,a))}calculateSourceExtent(){const t=Es();return this.triangles_.forEach(function(e,n,s){const r=e.source;yd(t,r[0]),yd(t,r[1]),yd(t,r[2])}),t}getTriangles(){return this.triangles_}}let E1;const Ho=[];function Jx(i,t,e,n,s){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,s),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,s)),i.restore()}function C1(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function cI(){if(E1===void 0){const i=Bi(6,6,Ho);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",Jx(i,4,5,4,0),Jx(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;E1=C1(t,0)||C1(t,4)||C1(t,8),zc(i),Ho.push(i.canvas)}return E1}function Jd(i,t,e,n){const s=Zi(e,t,i);let r=Wp(t,n,e);const o=t.getMetersPerUnit();o!==void 0&&(r*=o);const a=i.getMetersPerUnit();a!==void 0&&(r/=a);const l=i.getExtent();if(!l||Wl(l,s)){const h=Wp(i,r,s)/r;isFinite(h)&&h>0&&(r/=h)}return r}function EE(i,t,e,n){const s=lo(e);let r=Jd(i,t,s,n);return(!isFinite(r)||r<=0)&&ky(e,function(o){return r=Jd(i,t,o,n),isFinite(r)&&r>0}),r}function E2(i,t,e,n,s,r,o,a,l,h,c,u,f,d){const g=Bi(Math.round(e*i),Math.round(e*t),Ho);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(e,e);function p(M){return Math.round(M*e)/e}g.globalCompositeOperation="lighter";const y=Es();l.forEach(function(M,k,A){Ny(y,M.extent)});let _;const x=e/n,b=(u?1:1+Math.pow(2,-24))/x;if(!f||l.length!==1||h!==0){if(_=Bi(Math.round(Ie(y)*x),Math.round(ln(y)*x),Ho),u||(_.imageSmoothingEnabled=!1),s&&d){const M=(s[0]-y[0])*x,k=-(s[3]-y[3])*x,A=Ie(s)*x,T=ln(s)*x;_.rect(M,k,A,T),_.clip()}l.forEach(function(M,k,A){if(M.image.width>0&&M.image.height>0){if(M.clipExtent){_.save();const S=(M.clipExtent[0]-y[0])*x,O=-(M.clipExtent[3]-y[3])*x,E=Ie(M.clipExtent)*x,U=ln(M.clipExtent)*x;_.rect(u?S:Math.round(S),u?O:Math.round(O),u?E:Math.round(S+E)-Math.round(S),u?U:Math.round(O+U)-Math.round(O)),_.clip()}const T=(M.extent[0]-y[0])*x,F=-(M.extent[3]-y[3])*x,q=Ie(M.extent)*x,R=ln(M.extent)*x;_.drawImage(M.image,h,h,M.image.width-2*h,M.image.height-2*h,u?T:Math.round(T),u?F:Math.round(F),u?q:Math.round(T+q)-Math.round(T),u?R:Math.round(F+R)-Math.round(F)),M.clipExtent&&_.restore()}})}const L=Qa(o);return a.getTriangles().forEach(function(M,k,A){const T=M.source,F=M.target;let q=T[0][0],R=T[0][1],S=T[1][0],O=T[1][1],E=T[2][0],U=T[2][1];const X=p((F[0][0]-L[0])/r),Z=p(-(F[0][1]-L[1])/r),st=p((F[1][0]-L[0])/r),tt=p(-(F[1][1]-L[1])/r),ot=p((F[2][0]-L[0])/r),et=p(-(F[2][1]-L[1])/r),P=q,H=R;q=0,R=0,S-=P,O-=H,E-=P,U-=H;const j=[[S,O,0,0,st-X],[E,U,0,0,ot-X],[0,0,S,O,tt-Z],[0,0,E,U,et-Z]],K=GM(j);if(!K)return;if(g.save(),g.beginPath(),cI()||!u){g.moveTo(st,tt);const ft=4,gt=X-st,_t=Z-tt;for(let Pt=0;Pt<ft;Pt++)g.lineTo(st+p((Pt+1)*gt/ft),tt+p(Pt*_t/(ft-1))),Pt!=ft-1&&g.lineTo(st+p((Pt+1)*gt/ft),tt+p((Pt+1)*_t/(ft-1)));g.lineTo(ot,et)}else g.moveTo(st,tt),g.lineTo(X,Z),g.lineTo(ot,et);g.clip(),g.transform(K[0],K[2],K[1],K[3],X,Z),g.translate(y[0]-P,y[3]-H);let ht;if(_)ht=_.canvas,g.scale(b,-b);else{const ft=l[0],gt=ft.extent;ht=ft.image,g.scale(Ie(gt)/ht.width,-ln(gt)/ht.height)}g.drawImage(ht,0,0),g.restore()}),_&&(zc(_),Ho.push(_.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(M,k,A){const T=M.target,F=(T[0][0]-L[0])/r,q=-(T[0][1]-L[1])/r,R=(T[1][0]-L[0])/r,S=-(T[1][1]-L[1])/r,O=(T[2][0]-L[0])/r,E=-(T[2][1]-L[1])/r;g.beginPath(),g.moveTo(R,S),g.lineTo(F,q),g.lineTo(O,E),g.closePath(),g.stroke()}),g.restore()),g.canvas}class uI extends k_{constructor(t){super({tileCoord:t.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:t.interpolate,transition:t.transition}),this.pixelRatio_=t.pixelRatio,this.gutter_=t.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=t.sourceTileGrid,this.targetTileGrid_=t.targetTileGrid,this.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const e=t.sourceProj,n=e.getExtent(),s=t.sourceTileGrid.getExtent();this.clipExtent_=e.canWrapX()?s?Ss(n,s):n:s;const r=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),o=this.targetTileGrid_.getExtent();let a=this.sourceTileGrid_.getExtent();const l=o?Ss(r,o):r;if(Dd(l)===0){this.state=Jt.EMPTY;return}n&&(a?a=Ss(a,n):a=n);const h=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),c=t.targetProj,u=EE(e,c,l,h);if(!isFinite(u)||u<=0){this.state=Jt.EMPTY;return}const f=t.errorThreshold!==void 0?t.errorThreshold:w2;if(this.triangulation_=new S2(e,c,l,a,u*f,h),this.triangulation_.getTriangles().length===0){this.state=Jt.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(u);let d=this.triangulation_.calculateSourceExtent();if(a&&(e.canWrapX()?(d[1]=xi(d[1],a[1],a[3]),d[3]=xi(d[3],a[1],a[3])):d=Ss(d,a)),!Dd(d))this.state=Jt.EMPTY;else{let g=0,p=0;e.canWrapX()&&(g=Ie(n),p=Math.floor((d[0]-n[0])/g)),Fy(d.slice(),e,!0).forEach(_=>{const x=this.sourceTileGrid_.getTileRangeForExtentAndZ(_,this.sourceZ_),b=t.getTileFunction;for(let L=x.minX;L<=x.maxX;L++)for(let M=x.minY;M<=x.maxY;M++){const k=b(this.sourceZ_,L,M,this.pixelRatio_);if(k){const A=p*g;this.sourceTiles_.push({tile:k,offset:A})}}++p}),this.sourceTiles_.length===0&&(this.state=Jt.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const t=[];let e=!1;if(this.sourceTiles_.forEach(g=>{var Z;const p=g.tile;if(!p||p.getState()!==Jt.LOADED)return;const y=p.getSize(),_=this.gutter_;let x;const b=rI(p.getData());b?x=b:(e=!0,x=aI(s0(p.getData())));const L=[y[0]+2*_,y[1]+2*_],M=x instanceof Float32Array,k=L[0]*L[1],A=M?Float32Array:Uint8ClampedArray,T=new A(x.buffer),F=A.BYTES_PER_ELEMENT,q=F*T.length/k,R=T.byteLength/L[1],S=Math.floor(R/F/L[0]),O=k*S;let E=T;if(T.length!==O){E=new A(O);let st=0,tt=0;const ot=L[0]*S;for(let et=0;et<L[1];++et){for(let P=0;P<ot;++P)E[st++]=T[tt+P];tt+=R/F}}const U=this.sourceTileGrid_.getTileCoordExtent(p.tileCoord);U[0]+=g.offset,U[2]+=g.offset;const X=(Z=this.clipExtent_)==null?void 0:Z.slice();X&&(X[0]+=g.offset,X[2]+=g.offset),t.push({extent:U,clipExtent:X,data:new Uint8ClampedArray(E.buffer),dataType:A,bytesPerPixel:q,pixelSize:L})}),this.sourceTiles_.length=0,t.length===0){this.state=Jt.ERROR,this.changed();return}const n=this.wrappedTileCoord_[0],s=this.targetTileGrid_.getTileSize(n),r=typeof s=="number"?s:s[0],o=typeof s=="number"?s:s[1],a=this.targetTileGrid_.getResolution(n),l=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let c,u;const f=t[0].bytesPerPixel,d=Math.ceil(f/3);for(let g=d-1;g>=0;--g){const p=[];for(let M=0,k=t.length;M<k;++M){const A=t[M],T=A.data,F=A.pixelSize,q=F[0],R=F[1],S=Bi(q,R,Ho),O=S.createImageData(q,R),E=O.data;let U=g*3;for(let X=0,Z=E.length;X<Z;X+=4)E[X]=T[U],E[X+1]=T[U+1],E[X+2]=T[U+2],E[X+3]=255,U+=f;S.putImageData(O,0,0),p.push({extent:A.extent,clipExtent:A.clipExtent,image:S.canvas})}const y=E2(r,o,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),a,h,this.triangulation_,p,this.gutter_,!1,!1,!1);for(let M=0,k=p.length;M<k;++M){const T=p[M].image.getContext("2d");zc(T),Ho.push(T.canvas)}const _=y.getContext("2d"),x=_.getImageData(0,0,y.width,y.height);zc(_),Ho.push(y),c||(u=new Uint8ClampedArray(f*x.width*x.height),c=new t[0].dataType(u.buffer));const b=x.data;let L=g*3;for(let M=0,k=b.length;M<k;M+=4)b[M+3]===255?(u[L]=b[M],u[L+1]=b[M+1],u[L+2]=b[M+2]):(u[L]=0,u[L+1]=0,u[L+2]=0),L+=f}if(e){const g=Bi(r,o),p=new ImageData(c,r);g.putImageData(p,0,0),this.reprojData_=g.canvas}else this.reprojData_=c;this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(o*this.pixelRatio_)],this.state=Jt.LOADED,this.changed()}load(){if(this.state!==Jt.IDLE&&this.state!==Jt.ERROR)return;this.state=Jt.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const n=e.getState();if(n!==Jt.IDLE&&n!==Jt.LOADING)return;t++;const s=ve(e,ce.CHANGE,()=>{const r=e.getState();(r==Jt.LOADED||r==Jt.ERROR||r==Jt.EMPTY)&&(Ke(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e}){e.getState()==Jt.IDLE&&e.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ke),this.sourcesListenerKeys_=null}}class F_ extends p2{constructor(t,e,n,s,r,o,a,l,h,c,u,f){super(r,Jt.IDLE,f),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=s.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const y=g?Ss(d,g):d;if(Dd(y)===0){this.state=Jt.EMPTY;return}const _=t.getExtent();_&&(p?p=Ss(p,_):p=_);const x=s.getResolution(this.wrappedTileCoord_[0]),b=EE(t,n,y,x);if(!isFinite(b)||b<=0){this.state=Jt.EMPTY;return}const L=c!==void 0?c:w2;if(this.triangulation_=new S2(t,n,y,p,b*L,x),this.triangulation_.getTriangles().length===0){this.state=Jt.EMPTY;return}this.sourceZ_=e.getZForResolution(b);let M=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(M[1]=xi(M[1],p[1],p[3]),M[3]=xi(M[3],p[1],p[3])):M=Ss(M,p)),!Dd(M))this.state=Jt.EMPTY;else{let k=0,A=0;t.canWrapX()&&(k=Ie(_),A=Math.floor((M[0]-_[0])/k)),Fy(M.slice(),t,!0).forEach(F=>{const q=e.getTileRangeForExtentAndZ(F,this.sourceZ_);for(let R=q.minX;R<=q.maxX;R++)for(let S=q.minY;S<=q.maxY;S++){const O=h(this.sourceZ_,R,S,a);if(O){const E=A*k;this.sourceTiles_.push({tile:O,offset:E})}}++A}),this.sourceTiles_.length===0&&(this.state=Jt.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{var s;const n=e.tile;if(n&&n.getState()==Jt.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const o=(s=this.clipExtent_)==null?void 0:s.slice();o&&(o[0]+=e.offset,o[2]+=e.offset),t.push({extent:r,clipExtent:o,image:n.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=Jt.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),s=typeof n=="number"?n:n[0],r=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=E2(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Jt.LOADED}this.changed()}load(){if(this.state==Jt.IDLE){this.state=Jt.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const n=e.getState();if(n==Jt.IDLE||n==Jt.LOADING){t++;const s=ve(e,ce.CHANGE,r=>{const o=e.getState();(o==Jt.LOADED||o==Jt.ERROR||o==Jt.EMPTY)&&(Ke(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},n,s){e.getState()==Jt.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ke),this.sourcesListenerKeys_=null}release(){this.canvas_&&(zc(this.canvas_.getContext("2d")),Ho.push(this.canvas_),this.canvas_=null),super.release()}}function L1(i,t,e,n){return`${i},${bE(t,e,n)}`}function M1(i,t,e){if(!(e in i))return i[e]=new Set([t]),!0;const n=i[e],s=n.has(t);return s||n.add(t),!s}function dI(i,t,e){const n=i[e];return n?n.delete(t):!1}function Qx(i,t){const e=i.layerStatesArray[i.layerIndex];e.extent&&(t=Ss(t,Er(e.extent,i.viewState.projection)));const n=e.layer.getRenderSource();if(!n.getWrapX()){const s=n.getTileGridForProjection(i.viewState.projection).getExtent();s&&(t=Ss(t,s))}return t}class CE extends f2{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Es(),this.tempTileRange_=new b2(0,0,0,0),this.tempTileCoord_=Zd(0,0,0);const n=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new xE(n),this.renderedProjection_=void 0,this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,n,s){const r=this.tileCache_,a=this.getLayer().getSource(),l=L1(a.getKey(),t,e,n);let h;if(r.containsKey(l))h=r.get(l);else{if(h=a.getTile(t,e,n,s.pixelRatio,s.viewState.projection),!h)return null;r.set(l,h)}return h}getTile(t,e,n,s){const r=this.getOrCreateTile(t,e,n,s);return r||null}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=Vi(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!Wl(r,s))return null;const o=e.viewState,a=n.getRenderSource(),l=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(e.pixelRatio);for(let c=l.getZForResolution(o.resolution);c>=l.getMinZoom();--c){const u=l.getTileCoordForCoordAndZ(s,c),f=this.getTile(c,u[1],u[2],e);if(!f||f.getState()!==Jt.LOADED)continue;const d=l.getOrigin(c),g=ss(l.getTileSize(c)),p=l.getResolution(c);let y;if(f instanceof oE||f instanceof F_)y=f.getImage();else if(f instanceof k_){if(y=s0(f.getData()),!y)continue}else continue;const _=Math.floor(h*((s[0]-d[0])/p-u[1]*g[0])),x=Math.floor(h*((d[1]-s[1])/p-u[2]*g[1])),b=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(y,_+b,x+b)}return null}prepareFrame(t){this.renderedProjection_?t.viewState.projection!==this.renderedProjection_&&(this.tileCache_.clear(),this.renderedProjection_=t.viewState.projection):this.renderedProjection_=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const n=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==n&&(this.renderedRevision_=n,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=n,!0}enqueueTiles(t,e,n,s,r){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),h=l.getTileGridForProjection(o.projection),c=le(l);c in t.wantedTiles||(t.wantedTiles[c]={});const u=t.wantedTiles[c],f=a.getMapInternal(),d=Math.max(n-r,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),l.zDirection));for(let g=n;g>=d;--g){const p=h.getTileRangeForExtentAndZ(e,g,this.tempTileRange_),y=h.getResolution(g);for(let _=p.minX;_<=p.maxX;++_)for(let x=p.minY;x<=p.maxY;++x){const b=this.getTile(g,_,x,t);if(!b||!M1(s,b,g))continue;const M=b.getKey();if(u[M]=!0,b.getState()===Jt.IDLE&&!t.tileQueue.isKeyQueued(M)){const k=Zd(g,_,x,this.tempTileCoord_);t.tileQueue.enqueue([b,c,h.getTileCoordCenter(k),y])}}}}findStaleTile_(t,e){const n=this.tileCache_,s=t[0],r=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const h=L1(a[l],s,r,o);if(n.containsKey(h)){const c=n.get(h);if(c.getState()===Jt.LOADED)return c.endTransition(le(this)),M1(e,c,s),!0}}return!1}findAltTiles_(t,e,n,s){const r=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileCache_,h=this.getLayer().getRenderSource().getKey();for(let c=r.minX;c<=r.maxX;++c)for(let u=r.minY;u<=r.maxY;++u){const f=L1(h,n,c,u);let d=!1;if(a.containsKey(f)){const g=a.get(f);g.getState()===Jt.LOADED&&(M1(s,g,n),d=!0)}d||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const n=t.layerStatesArray[t.layerIndex],s=t.viewState,r=s.projection,o=s.resolution,a=s.center,l=t.pixelRatio,h=this.getLayer(),c=h.getSource(),u=c.getRevision(),f=c.getTileGridForProjection(r),d=f.getZForResolution(o,c.zDirection),g=f.getResolution(d),p=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let y=t.extent;const _=c.getTilePixelRatio(l);this.prepareContainer(t,e);const x=this.context.canvas.width,b=this.context.canvas.height,L=n.extent&&Er(n.extent);L&&(y=Ss(y,Er(n.extent)));const M=g*x/2/_,k=g*b/2/_,A=[a[0]-M,a[1]-k,a[0]+M,a[1]+k],T={};this.renderedTiles.length=0;const F=h.getPreload();if(t.nextExtent){const ot=f.getZForResolution(s.nextResolution,c.zDirection),et=Qx(t,t.nextExtent);this.enqueueTiles(t,et,ot,T,F)}const q=Qx(t,y);if(this.enqueueTiles(t,q,d,T,0),F>0&&setTimeout(()=>{this.enqueueTiles(t,q,d-1,T,F-1)},0),!(d in T))return this.container;const R=le(this),S=t.time;for(const ot of T[d]){const et=ot.getState();if((ot instanceof F_||ot instanceof uI)&&et===Jt.EMPTY)continue;const P=ot.tileCoord;if(et===Jt.LOADED&&ot.getAlpha(R,S)===1){ot.endTransition(R);continue}if(this.renderComplete=!1,this.findStaleTile_(P,T)){dI(T,ot,d),t.animate=!0;continue}if(this.findAltTiles_(f,P,d+1,T))continue;const K=f.getMinZoom();for(let ht=d-1;ht>=K&&!this.findAltTiles_(f,P,ht,T);--ht);}const O=g/o*l/_,E=this.getRenderContext(t);or(this.tempTransform,x/2,b/2,O,O,0,-x/2,-b/2),n.extent&&this.clipUnrotated(E,t,L),c.getInterpolate()||(E.imageSmoothingEnabled=!1),this.preRender(E,t);const U=Object.keys(T).map(Number);U.sort(no);let X;const Z=[],st=[];for(let ot=U.length-1;ot>=0;--ot){const et=U[ot],P=c.getTilePixelSize(et,l,r),j=f.getResolution(et)/g,K=P[0]*j*O,ht=P[1]*j*O,ft=f.getTileCoordForCoordAndZ(Qa(A),et),gt=f.getTileCoordExtent(ft),_t=Vi(this.tempTransform,[_*(gt[0]-A[0])/g,_*(A[3]-gt[3])/g]),Pt=_*c.getGutterForProjection(r);for(const Tt of T[et]){if(Tt.getState()!==Jt.LOADED)continue;const Wt=Tt.tileCoord,Gt=ft[1]-Wt[1],N=Math.round(_t[0]-(Gt-1)*K),rt=ft[2]-Wt[2],z=Math.round(_t[1]-(rt-1)*ht),J=Math.round(_t[0]-Gt*K),Y=Math.round(_t[1]-rt*ht),it=N-J,pt=z-Y,vt=U.length===1;let at=!1;X=[J,Y,J+it,Y,J+it,Y+pt,J,Y+pt];for(let Et=0,It=Z.length;Et<It;++Et)if(!vt&&et<st[Et]){const Ct=Z[Et];Ri([J,Y,J+it,Y+pt],[Ct[0],Ct[3],Ct[4],Ct[7]])&&(at||(E.save(),at=!0),E.beginPath(),E.moveTo(X[0],X[1]),E.lineTo(X[2],X[3]),E.lineTo(X[4],X[5]),E.lineTo(X[6],X[7]),E.moveTo(Ct[6],Ct[7]),E.lineTo(Ct[4],Ct[5]),E.lineTo(Ct[2],Ct[3]),E.lineTo(Ct[0],Ct[1]),E.clip())}Z.push(X),st.push(et),this.drawTile(Tt,t,J,Y,it,pt,Pt,vt),at&&E.restore(),this.renderedTiles.unshift(Tt),this.updateUsedTiles(t.usedTiles,c,Tt)}}this.renderedRevision=u,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Ga(this.renderedExtent_,A),this.renderedExtent_=A,this.renderedPixelRatio=l,this.renderedProjection=r,this.postRender(this.context,t),n.extent&&E.restore(),E.imageSmoothingEnabled=!0;const tt=(ot,et)=>{const P=le(c),H=et.wantedTiles[P],j=H?Object.keys(H).length:0;this.updateCacheSize(j),this.tileCache_.expireCache()};return t.postRenderFunctions.push(tt),this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,n,s,r,o,a,l){let h;if(t instanceof k_){if(h=s0(t.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(t);if(!h)return;const c=this.getRenderContext(e),u=le(this),f=e.layerStatesArray[e.layerIndex],d=f.opacity*(l?t.getAlpha(u,e.time):1),g=d!==c.globalAlpha;g&&(c.save(),c.globalAlpha=d),c.drawImage(h,a,a,h.width-2*a,h.height-2*a,n,s,r,o),g&&c.restore(),d!==f.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,n){const s=le(e);s in t||(t[s]={}),t[s][n.getKey()]=!0}}class Yn extends sI{constructor(t){super(t)}createRenderer(){return new CE(this,{cacheSize:this.getCacheSize()})}}const T1={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Hh=[0,0,0],xa=5;class C2{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,De(xM(this.resolutions_,(s,r)=>r-s),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let s=0,r=this.resolutions_.length-1;s<r;++s)if(!e)e=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,De(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Qa(n)),De(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,De(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:r2,De(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((s,r)=>{const o=new b2(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(n){const a=this.getTileRangeForExtentAndZ(n,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const s=this.getTileRangeForExtentAndZ(t,e);for(let r=s.minX,o=s.maxX;r<=o;++r)for(let a=s.minY,l=s.maxY;a<=l;++a)n([e,r,a])}forEachTileCoordParentTileRange(t,e,n,s){let r,o,a,l=null,h=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,s);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),r=qh(o,o,a,a,n)):r=this.getTileRangeForExtentAndZ(l,h,n),e(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const r=t[1]*2,o=t[2]*2;return qh(r,r+1,o,o+1,e)}const s=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const s=t[0],r=t[1],o=t[2];if(e===s)return qh(r,o,r,o,n);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-s),h=Math.floor(r*l),c=Math.floor(o*l);if(e<s)return qh(h,h,c,c,n);const u=Math.floor(l*(r+1))-1,f=Math.floor(l*(o+1))-1;return qh(h,u,c,f,n)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Hh);const s=Hh[1],r=Hh[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Hh);const o=Hh[1],a=Hh[2];return qh(s,o,r,a,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=ss(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*s[0]*n,e[1]-(t[2]+.5)*s[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),s=this.getResolution(t[0]),r=ss(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*s,a=n[1]-(t[2]+1)*r[1]*s,l=o+r[0]*s,h=a+r[1]*s;return ao(o,a,l,h,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,s,r){const o=this.getZForResolution(n),a=n/this.getResolution(o),l=this.getOrigin(o),h=ss(this.getTileSize(o),this.tmpSize_);let c=a*(t-l[0])/n/h[0],u=a*(l[1]-e)/n/h[1];return s?(c=La(c,xa)-1,u=La(u,xa)-1):(c=hc(c,xa),u=hc(u,xa)),Zd(o,c,u,r)}getTileCoordForXYAndZ_(t,e,n,s,r){const o=this.getOrigin(n),a=this.getResolution(n),l=ss(this.getTileSize(n),this.tmpSize_);let h=(t-o[0])/a/l[0],c=(o[1]-e)/a/l[1];return s?(h=La(h,xa)-1,c=La(c,xa)-1):(h=hc(h,xa),c=hc(c,xa)),Zd(n,h,c,r)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=k0(this.resolutions_,t,e||0);return xi(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return xS(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let s=this.minZoom;s<e;++s)n[s]=this.getTileRangeForExtentAndZ(t,s);this.fullTileRanges_=n}}class fI extends C2{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}function gI(i,t,e){const n=[],s=[],r=[],o=[],a=[];e=e!==void 0?e:[];const l="SupportedCRS",h="TileMatrix",c="Identifier",u="ScaleDenominator",f="TopLeftCorner",d="TileWidth",g="TileHeight",p=i[l],y=xe(p),_=y.getMetersPerUnit(),x=y.getAxisOrientation().startsWith("ne");return i[h].sort(function(b,L){return L[u]-b[u]}),i[h].forEach(function(b){let L;if(e.length>0?L=e.find(function(M){return b[c]==M[h]?!0:b[c].includes(":")?!1:i[c]+":"+b[c]===M[h]}):L=!0,L){s.push(b[c]);const M=b[u]*28e-5/_,k=b[d],A=b[g];x?r.push([b[f][1],b[f][0]]):r.push(b[f]),n.push(M),o.push(k==A?k:[k,A]),a.push([b.MatrixWidth,b.MatrixHeight])}}),new fI({extent:t,origins:r,resolutions:n,matrixIds:s,tileSizes:o,sizes:a})}function LE(i){let t=i.getDefaultTileGrid();return t||(t=_I(i),i.setDefaultTileGrid(t)),t}function pI(i,t,e){const n=t[0],s=i.getTileCoordCenter(t),r=Z0(e);if(!Wl(r,s)){const o=Ie(r),a=Math.ceil((r[0]-s[0])/o);return s[0]+=o*a,i.getTileCoordForCoordAndZ(s,n)}return t}function mI(i,t,e,n){n=n!==void 0?n:"top-left";const s=TE(i,t,e);return new C2({extent:i,origin:TM(i,n),resolutions:s,tileSize:e})}function ME(i){const t=i||{},e=t.extent||xe("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:TE(e,t.maxZoom,t.tileSize,t.maxResolution)};return new C2(n)}function TE(i,t,e,n){t=t!==void 0?t:XT,e=ss(e!==void 0?e:r2);const s=ln(i),r=Ie(i);n=n>0?n:Math.max(r/e[0],s/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=n/Math.pow(2,l);return a}function _I(i,t,e,n){const s=Z0(i);return mI(s,t,e,n)}function Z0(i){i=xe(i);let t=i.getExtent();if(!t){const e=180*kc.degrees/i.getMetersPerUnit();t=ao(-e,-e,e,e)}return t}class yI extends g2{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&ss(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||le(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,s,r){return de()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:LE(t)}getTileCacheForProjection(t){const e=this.getProjection();return De(e===null||Kr(e,t),"Use the renderer's tile cache when not reprojecting."),null}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const s=this.getTileGridForProjection(n),r=this.getTilePixelRatio(e),o=ss(s.getTileSize(t),this.tmpSize);return r==1?o:DT(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=pI(n,t,e)),iI(t,n)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class vI extends os{constructor(t,e){super(t),this.tile=e}}function Qd(i,t){const e=[];Object.keys(t).forEach(function(s){t[s]!==null&&t[s]!==void 0&&e.push(s+"="+encodeURIComponent(t[s]))});const n=e.join("&");return i=i.replace(/[?&]$/,""),i+=i.includes("?")?"&":"?",i+n}const xI=/\{z\}/g,bI=/\{x\}/g,wI=/\{y\}/g,SI=/\{-y\}/g;function EI(i,t,e,n,s){return i.replace(xI,t.toString()).replace(bI,e.toString()).replace(wI,n.toString()).replace(SI,function(){if(s===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-n).toString()})}function AE(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const n=e[1].charCodeAt(0),s=e[2].charCodeAt(0);let r;for(r=n;r<=s;++r)t.push(i.replace(e[0],String.fromCharCode(r)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const n=parseInt(e[2],10);for(let s=parseInt(e[1],10);s<=n;s++)t.push(i.replace(e[0],s.toString()));return t}return t.push(i),t}function CI(i,t){return function(e,n,s){if(!e)return;let r;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(r=a.getHeight()-1)}return EI(i,o,e[1],e[2],r)}}function LI(i,t){const e=i.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=CI(i[s],t);return r0(n)}function r0(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;const s=SE(t),r=Ol(s,i.length);return i[r](t,e,n)}}class L2 extends yI{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===L2.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=le(e),s=e.getState();let r;s==Jt.LOADING?(this.tileLoadingKeys_[n]=!0,r=T1.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],r=s==Jt.ERROR?T1.TILELOADERROR:s==Jt.LOADED?T1.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new vI(r,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=AE(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(LI(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}}class J0 extends L2{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:MI,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:oE,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);for(const s in this.tileCacheForProjection){const r=this.tileCacheForProjection[s];r.expireCache(r==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Kr(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Kr(e,t)))return this.tileGrid;const n=le(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=LE(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Kr(e,t))return super.getTileCacheForProjection(t);const n=le(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new nI(512)),this.tileCacheForProjection[n]}createTile_(t,e,n,s,r,o){const a=[t,e,n],l=this.getTileCoordForTileUrlFunction(a,r),h=l?this.tileUrlFunction(l,s,r):void 0,c=new this.tileClass(a,h!==void 0?Jt.IDLE:Jt.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(ce.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,n,s,r){const o=this.getProjection();if(!o||!r||Kr(o,r))return this.getTileInternal(t,e,n,s,o||r);const a=this.getTileCacheForProjection(r),l=[t,e,n];let h;const c=wE(l);a.containsKey(c)&&(h=a.get(c));const u=this.getKey();if(h&&h.key==u)return h;const f=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),g=this.getTileCoordForTileUrlFunction(l,r),p=new F_(o,f,r,d,l,g,this.getTilePixelRatio(s),this.getGutter(),(y,_,x,b)=>this.getTileInternal(y,_,x,b,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return p.key=u,h?a.replace(c,p):a.set(c,p),p}getTileInternal(t,e,n,s,r){const o=this.getKey();return this.createTile_(t,e,n,s,r,o)}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const n=xe(t);if(n){const s=le(n);s in this.tileGridForProjection||(this.tileGridForProjection[s]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function MI(i,t){i.getImage().src=t}function TI(i){const t=i[0],e=new Array(t);let n=1<<t-1,s,r;for(s=0;s<t;++s)r=48,i[1]&n&&(r+=1),i[2]&n&&(r+=2),e[s]=String.fromCharCode(r),n>>=1;return e.join("")}const AI='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>';class PI extends J0{constructor(t){const e=t.hidpi!==void 0?t.hidpi:!1;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,projection:xe("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=t.culture!==void 0?t.culture:"en-us",this.maxZoom_=t.maxZoom!==void 0?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(n).then(s=>s.json()).then(s=>this.handleImageryMetadataResponse(s))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(t.statusCode!=200||t.statusDescription!="OK"||t.authenticationResultCode!="ValidCredentials"||t.resourceSets.length!=1||t.resourceSets[0].resources.length!=1){this.setState("error");return}const e=t.resourceSets[0].resources[0],n=this.maxZoom_==-1?e.zoomMax:this.maxZoom_,s=this.getProjection(),r=Z0(s),o=this.hidpi_?2:1,a=e.imageWidth==e.imageHeight?e.imageWidth/o:[e.imageWidth/o,e.imageHeight/o],l=ME({extent:r,minZoom:e.zoomMin,maxZoom:n,tileSize:a});this.tileGrid=l;const h=this.culture_,c=this.hidpi_,u=this.placeholderTiles_;if(this.tileUrlFunction=r0(e.imageUrlSubdomains.map(function(f){const d=[0,0,0],g=e.imageUrl.replace("{subdomain}",f).replace("{culture}",h);return function(p,y,_){if(!p)return;Zd(p[0],p[1],p[2],d);const x=new URL(g.replace("{quadkey}",TI(d))),b=x.searchParams;return c&&(b.set("dpi","d1"),b.set("device","mobile")),u===!0?b.delete("n"):u===!1&&b.set("n","z"),x.toString()}})),e.imageryProviders){const f=th(xe("EPSG:4326"),this.getProjection());this.setAttributions(d=>{const g=[],p=d.viewState,y=this.getTileGrid(),_=y.getZForResolution(p.resolution,this.zDirection),b=y.getTileCoordForCoordAndZ(p.center,_)[0];return e.imageryProviders.map(function(L){let M=!1;const k=L.coverageAreas;for(let A=0,T=k.length;A<T;++A){const F=k[A];if(b>=F.zoomMin&&b<=F.zoomMax){const q=F.bbox,R=[q[1],q[0],q[3],q[2]],S=eS(R,f);if(Ri(S,d.extent)){M=!0;break}}}M&&g.push(L.attribution)}),g.push(AI),g})}this.setState("ready")}}class PE extends J0{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:ME({extent:Z0(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const II="modulepreload",RI=function(i){return"/"+i},t5={},O_=function(t,e,n){let s=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(e.map(l=>{if(l=RI(l),l in t5)return;t5[l]=!0;const h=l.endsWith(".css"),c=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const u=document.createElement("link");if(u.rel=h?"stylesheet":II,h||(u.as="script"),u.crossOrigin="",u.href=l,a&&u.setAttribute("nonce",a),document.head.appendChild(u),h)return new Promise((f,d)=>{u.addEventListener("load",f),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})};function D_(i){return Array.isArray(i)?Math.min(...i):i}class NI extends PS{constructor(t,e,n,s,r,o,a){let l=t.getExtent();l&&t.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let h=e.getExtent();h&&e.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const c=h?Ss(n,h):n,u=lo(c),f=Jd(t,e,u,s),d=w2,g=new S2(t,e,c,l,f*d,s),p=g.calculateSourceExtent(),y=Jl(p)?null:o(p,f,r),_=y?re.IDLE:re.EMPTY,x=y?y.getPixelRatio():1;super(n,s,x,_),this.targetProj_=e,this.maxSourceExtent_=l,this.triangulation_=g,this.targetResolution_=s,this.targetExtent_=n,this.sourceImage_=y,this.sourcePixelRatio_=x,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==re.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==re.LOADED){const e=Ie(this.targetExtent_)/this.targetResolution_,n=ln(this.targetExtent_)/this.targetResolution_;this.canvas_=E2(e,n,this.sourcePixelRatio_,D_(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==re.IDLE){this.state=re.LOADING,this.changed();const t=this.sourceImage_.getState();t==re.LOADED||t==re.ERROR?this.reproject_():(this.sourceListenerKey_=ve(this.sourceImage_,ce.CHANGE,e=>{const n=this.sourceImage_.getState();(n==re.LOADED||n==re.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Ke(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Pa=4,A1={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class kI extends os{constructor(t,e){super(t),this.image=e}}class FI extends g2{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:t.interpolate!==void 0?t.interpolate:!0}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=t.resolutions!==void 0?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=t.loader?t.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();if(e){const n=k0(e,t,0);t=e[n]}return t}getImage(t,e,n,s){const r=this.getProjection();if(!r||!s||Kr(r,s))return r&&(s=r),this.getImageInternal(t,e,n,s);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Kr(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==e&&Ga(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new NI(r,s,t,e,n,(o,a,l)=>this.getImageInternal(o,a,l,r),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,n,s){if(this.loader){const r=IE(t,e,n,1),o=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===s&&(this.wantedExtent_&&ir(this.wantedExtent_,r)||ir(this.image.getExtent(),r))&&(this.wantedResolution_&&D_(this.wantedResolution_)===o||D_(this.image.getResolution())===o)))return this.image;this.wantedProjection_=s,this.wantedExtent_=r,this.wantedResolution_=o,this.image=new PS(r,o,n,this.loader),this.image.addEventListener(ce.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let n;switch(e.getState()){case re.LOADING:this.loading=!0,n=A1.IMAGELOADSTART;break;case re.LOADED:this.loading=!1,n=A1.IMAGELOADEND;break;case re.ERROR:this.loading=!1,n=A1.IMAGELOADERROR;break;default:return}this.hasListener(n)&&this.dispatchEvent(new kI(n,e))}}function OI(i,t){i.getImage().src=t}function IE(i,t,e,n){const s=t/e,r=lo(i),o=La(Ie(i)/s,Pa),a=La(ln(i)/s,Pa),l=La((n-1)*o/2,Pa),h=o+2*l,c=La((n-1)*a/2,Pa),u=a+2*c;return Bd(r,s,0,[h,u])}const o0="1.3.0",e5=[101,101];function RE(i,t,e,n,s){s.WIDTH=e[0],s.HEIGHT=e[1];const r=n.getAxisOrientation(),o=Oy(s.VERSION,"1.3")>=0;s[o?"CRS":"SRS"]=n.getCode();const a=o&&r.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return s.BBOX=a.join(","),Qd(i,s)}function NE(i,t,e,n,s,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=t/e,l=[px(Ie(i)/a,Pa),px(ln(i)/a,Pa)];if(e!=1)switch(o){case"geoserver":const c=90*e+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+c:r.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":r.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":r.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return RE(s,i,l,n,r)}function a0(i,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:o0,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},i)}function DI(i){const t=i.hidpi===void 0?!0:i.hidpi,e=xe(i.projection||"EPSG:3857"),n=i.ratio||1.5,s=i.load||RS,r=i.crossOrigin??null;return(o,a,l)=>{o=IE(o,a,l,n),l!=1&&(!t||i.serverType===void 0)&&(l=1);const h=NE(o,a,l,e,i.url,a0(i.params,"GetMap"),i.serverType),c=new Image;return c.crossOrigin=r,s(c,h).then(u=>({image:u,extent:o,pixelRatio:l}))}}function BI(i,t,e){if(i.url===void 0)return;const n=xe(i.projection||"EPSG:3857"),s=Bd(t,e,0,e5),r={QUERY_LAYERS:i.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(r,a0(i.params,"GetFeatureInfo"),i.params);const o=hc((t[0]-s[0])/e,Pa),a=hc((s[3]-t[1])/e,Pa),l=Oy(r.VERSION,"1.3")>=0;return r[l?"I":"X"]=o,r[l?"J":"Y"]=a,RE(i.url,s,e5,n,r)}function jI(i,t){if(i.url===void 0)return;const e={SERVICE:"WMS",VERSION:o0,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t!==void 0){const n=xe(i.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;e.SCALE=t*n/s}if(Object.assign(e,i.params),i.params!==void 0&&e.LAYER===void 0){const n=e.LAYERS;if(!(!Array.isArray(n)||n.length!==1))return;e.LAYER=n}return Qd(i.url,e)}class zI extends FI{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions}),this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null,this.url_=t.url,this.imageLoadFunction_=t.imageLoadFunction!==void 0?t.imageLoadFunction:OI,this.params_=Object.assign({},t.params),this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.renderedRevision_=0,this.ratio_=t.ratio!==void 0?t.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(t,e,n,s){const r=xe(n),o=this.getProjection();o&&o!==r&&(e=Jd(o,r,t,e),t=Zi(t,r,o));const a={url:this.url_,params:{...this.params_,...s},projection:o||r};return BI(a,t,e)}getLegendUrl(t,e){return jI({url:this.url_,params:{...this.params_,...e}},t)}getParams(){return this.params_}getImageInternal(t,e,n,s){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==s)&&(this.loaderProjection_=s,this.loader=DI({crossOrigin:this.crossOrigin_,params:this.params_,projection:s,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(r,o)=>(this.image.setImage(r),this.imageLoadFunction_(this.image,o),RS(r))})),super.getImageInternal(t,e,n,s))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(t){this.imageLoadFunction_=t,this.changed()}setUrl(t){t!=this.url_&&(this.url_=t,this.loader=null,this.changed())}updateParams(t){Object.assign(this.params_,t),this.changed()}changed(){this.image=null,super.changed()}}const GI='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class UI extends PE{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[GI];const n=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",s=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:s,wrapX:t.wrapX,zDirection:t.zDirection})}}class WI extends Ef{constructor(t){t=t||{},super(t)}}class qI extends f2{constructor(t){super(t),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,s=t.viewState,r=s.resolution,o=this.getLayer().getSource(),a=t.viewHints;let l=t.extent;if(e.extent!==void 0&&(l=Ss(l,Er(e.extent,s.projection))),!a[vi.ANIMATING]&&!a[vi.INTERACTING]&&!Jl(l))if(o){const h=s.projection,c=o.getImage(l,r,n,h);c&&(this.loadImage(c)?this.image=c:c.getState()===re.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=Vi(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!Wl(r,s))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Ie(o),h=Math.floor(a.width*((s[0]-o[0])/l));if(h<0||h>=a.width)return null;const c=ln(o),u=Math.floor(a.height*((o[3]-s[1])/c));return u<0||u>=a.height?null:this.getImageData(a,h,u)}renderFrame(t,e){const n=this.image,s=n.getExtent(),r=n.getResolution(),[o,a]=Array.isArray(r)?r:[r,r],l=n.getPixelRatio(),h=t.layerStatesArray[t.layerIndex],c=t.pixelRatio,u=t.viewState,f=u.center,d=u.resolution,g=c*o/(d*l),p=c*a/(d*l);this.prepareContainer(t,e);const y=this.context.canvas.width,_=this.context.canvas.height,x=this.getRenderContext(t);let b=!1,L=!0;if(h.extent){const F=Er(h.extent,u.projection);L=Ri(F,t.extent),b=L&&!ir(F,t.extent),b&&this.clipUnrotated(x,t,F)}const M=n.getImage(),k=or(this.tempTransform,y/2,_/2,g,p,0,l*(s[0]-f[0])/o,l*(f[1]-s[3])/a);this.renderedResolution=a*c/l;const A=M.width*k[0],T=M.height*k[3];if(this.getLayer().getSource().getInterpolate()||(x.imageSmoothingEnabled=!1),this.preRender(x,t),L&&A>=.5&&T>=.5){const F=k[4],q=k[5],R=h.opacity;R!==1&&(x.save(),x.globalAlpha=R),x.drawImage(M,0,0,+M.width,+M.height,F,q,A,T),R!==1&&x.restore()}return this.postRender(this.context,t),b&&x.restore(),x.imageSmoothingEnabled=!0,this.container}}class M2 extends WI{constructor(t){super(t)}createRenderer(){return new qI(this)}getData(t){return super.getData(t)}}class Zo extends J0{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Es(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,n,s){const r=xe(n),o=this.getProjection()||r;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=Zi(t,r,o),h=Jd(o,r,t,e),c=a.getZForResolution(h,this.zDirection),u=a.getResolution(c),f=a.getTileCoordForCoordAndZ(l,c);if(a.getResolutions().length<=f[0])return;let d=a.getTileCoordExtent(f,this.tmpExtent_);const g=this.gutter_;g!==0&&(d=Xo(d,u*g,d));const p={QUERY_LAYERS:this.params_.LAYERS};Object.assign(p,a0(this.params_,"GetFeatureInfo"),s);const y=Math.floor((l[0]-d[0])/u),_=Math.floor((d[3]-l[1])/u);return p[this.v13_?"I":"X"]=y,p[this.v13_?"J":"Y"]=_,this.getRequestUrl_(f,d,1,o||r,p)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const n={SERVICE:"WMS",VERSION:o0,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const s=this.params_.LAYERS;if(!(!Array.isArray(s)||s.length===1))return;n.LAYER=s}if(t!==void 0){const s=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;n.SCALE=t*s/r}return Object.assign(n,e),Qd(this.urls[0],n)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,n,s,r){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Ol(SE(t),o.length);a=o[l]}return NE(e,(this.tileGrid||this.getTileGridForProjection(s)).getResolution(t[0]),n,s,a,r,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||o0;this.v13_=Oy(t,"1.3")>=0}tileUrlFunction(t,e,n){let s=this.getTileGrid();if(s||(s=this.getTileGridForProjection(n)),s.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const r=s.getResolution(t[0]);let o=s.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Xo(o,r*a,o));const l=Object.assign({},a0(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,n,l)}}class VI extends J0{constructor(t){const e=t.requestEncoding!==void 0?t.requestEncoding:"KVP",n=t.tileGrid;let s=t.urls;s===void 0&&t.url!==void 0&&(s=AE(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:s,wrapX:t.wrapX!==void 0?t.wrapX:!1,transition:t.transition,zDirection:t.zDirection}),this.version_=t.version!==void 0?t.version:"1.0.0",this.format_=t.format!==void 0?t.format:"image/jpeg",this.dimensions_=t.dimensions!==void 0?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),s&&s.length>0&&(this.tileUrlFunction=r0(s.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join(`
`);this.setTileUrlFunction(r0(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,n={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e=="KVP"&&Object.assign(n,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e=="KVP"?Qd(t,n):t.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in n?n[a.toLowerCase()]:o});const s=this.tileGrid,r=this.dimensions_;return function(o,a,l){if(!o)return;const h={TileMatrix:s.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(h,r);let c=t;return e=="KVP"?c=Qd(c,h):c=c.replace(/\{(\w+?)\}/g,function(u,f){return h[f]}),c}}}const HI=VI;function YI(i,t){const e=i.Contents.Layer,n=e==null?void 0:e.find(function(S){return S.Identifier==t.layer});if(!n)return null;const s=i.Contents.TileMatrixSet;let r;n.TileMatrixSetLink.length>1?"projection"in t?r=n.TileMatrixSetLink.findIndex(function(S){const E=s.find(function(Z){return Z.Identifier==S.TileMatrixSet}).SupportedCRS,U=xe(E),X=xe(t.projection);return U&&X?Kr(U,X):E==t.projection}):r=n.TileMatrixSetLink.findIndex(function(S){return S.TileMatrixSet==t.matrixSet}):r=0,r<0&&(r=0);const o=n.TileMatrixSetLink[r].TileMatrixSet,a=n.TileMatrixSetLink[r].TileMatrixSetLimits;let l=n.Format[0];"format"in t&&(l=t.format),r=n.Style.findIndex(function(S){return"style"in t?S.Title==t.style:S.isDefault}),r<0&&(r=0);const h=n.Style[r].Identifier,c={};"Dimension"in n&&n.Dimension.forEach(function(S,O,E){const U=S.Identifier;let X=S.Default;X===void 0&&(X=S.Value[0]),c[U]=X});const f=i.Contents.TileMatrixSet.find(function(S){return S.Identifier==o});let d;const g=f.SupportedCRS;if(g&&(d=xe(g)),"projection"in t){const S=xe(t.projection);S&&(!d||Kr(S,d))&&(d=S)}let p=!1;const y=d.getAxisOrientation().startsWith("ne");let _=f.TileMatrix[0],x={MinTileCol:0,MinTileRow:0,MaxTileCol:_.MatrixWidth-1,MaxTileRow:_.MatrixHeight-1};if(a){x=a[a.length-1];const S=f.TileMatrix.find(O=>O.Identifier===x.TileMatrix||f.Identifier+":"+O.Identifier===x.TileMatrix);S&&(_=S)}const b=_.ScaleDenominator*28e-5/d.getMetersPerUnit(),L=y?[_.TopLeftCorner[1],_.TopLeftCorner[0]]:_.TopLeftCorner,M=_.TileWidth*b,k=_.TileHeight*b;let A=f.BoundingBox;A&&y&&(A=[A[1],A[0],A[3],A[2]]);let T=[L[0]+M*x.MinTileCol,L[1]-k*(1+x.MaxTileRow),L[0]+M*(1+x.MaxTileCol),L[1]-k*x.MinTileRow];if(A!==void 0&&!ir(A,T)){const S=n.WGS84BoundingBox,O=xe("EPSG:4326").getExtent();if(T=A,S)p=S[0]===O[0]&&S[2]===O[2];else{const E=JM(A,f.SupportedCRS,"EPSG:4326");p=E[0]-1e-10<=O[0]&&E[2]+1e-10>=O[2]}}const F=gI(f,T,a),q=[];let R=t.requestEncoding;if(R=R!==void 0?R:"","OperationsMetadata"in i&&"GetTile"in i.OperationsMetadata){const S=i.OperationsMetadata.GetTile.DCP.HTTP.Get;for(let O=0,E=S.length;O<E;++O)if(S[O].Constraint){const X=S[O].Constraint.find(function(Z){return Z.name=="GetEncoding"}).AllowedValues.Value;if(R===""&&(R=X[0]),R==="KVP")X.includes("KVP")&&q.push(S[O].href);else break}else S[O].href&&(R="KVP",q.push(S[O].href))}return q.length===0&&(R="REST",n.ResourceURL.forEach(function(S){S.resourceType==="tile"&&(l=S.format,q.push(S.template))})),{urls:q,layer:t.layer,matrixSet:o,format:l,projection:d,requestEncoding:R,tileGrid:F,style:h,dimensions:c,wrapX:p,crossOrigin:t.crossOrigin}}function XI(i){i("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),i("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),i("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),i.WGS84=i["EPSG:4326"],i["EPSG:3785"]=i["EPSG:3857"],i.GOOGLE=i["EPSG:3857"],i["EPSG:900913"]=i["EPSG:3857"],i["EPSG:102113"]=i["EPSG:3857"]}var Hl=1,Yl=2,vc=3,$I=4,B_=5,i5=6378137,KI=6356752314e-3,n5=.0066943799901413165,xd=484813681109536e-20,Bt=Math.PI/2,ZI=.16666666666666666,JI=.04722222222222222,QI=.022156084656084655,Xt=1e-10,Tn=.017453292519943295,Qr=57.29577951308232,ei=Math.PI/4,tf=Math.PI*2,Yi=3.14159265359,Ts={};Ts.greenwich=0;Ts.lisbon=-9.131906111111;Ts.paris=2.337229166667;Ts.bogota=-74.080916666667;Ts.madrid=-3.687938888889;Ts.rome=12.452333333333;Ts.bern=7.439583333333;Ts.jakarta=106.807719444444;Ts.ferro=-17.666666666667;Ts.brussels=4.367975;Ts.stockholm=18.058277777778;Ts.athens=23.7163375;Ts.oslo=10.722916666667;const t4={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var s5=/[\s_\-\/\(\)]/g;function Va(i,t){if(i[t])return i[t];for(var e=Object.keys(i),n=t.toLowerCase().replace(s5,""),s=-1,r,o;++s<e.length;)if(r=e[s],o=r.toLowerCase().replace(s5,""),o===n)return i[r]}function j_(i){var t={},e=i.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var h=l.split("=");return h.push(!0),a[h[0].toLowerCase()]=h[1],a},{}),n,s,r,o={proj:"projName",datum:"datumCode",rf:function(a){t.rf=parseFloat(a)},lat_0:function(a){t.lat0=a*Tn},lat_1:function(a){t.lat1=a*Tn},lat_2:function(a){t.lat2=a*Tn},lat_ts:function(a){t.lat_ts=a*Tn},lon_0:function(a){t.long0=a*Tn},lon_1:function(a){t.long1=a*Tn},lon_2:function(a){t.long2=a*Tn},alpha:function(a){t.alpha=parseFloat(a)*Tn},gamma:function(a){t.rectified_grid_angle=parseFloat(a)},lonc:function(a){t.longc=a*Tn},x_0:function(a){t.x0=parseFloat(a)},y_0:function(a){t.y0=parseFloat(a)},k_0:function(a){t.k0=parseFloat(a)},k:function(a){t.k0=parseFloat(a)},a:function(a){t.a=parseFloat(a)},b:function(a){t.b=parseFloat(a)},r:function(a){t.a=t.b=parseFloat(a)},r_a:function(){t.R_A=!0},zone:function(a){t.zone=parseInt(a,10)},south:function(){t.utmSouth=!0},towgs84:function(a){t.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){t.to_meter=parseFloat(a)},units:function(a){t.units=a;var l=Va(t4,a);l&&(t.to_meter=l.to_meter)},from_greenwich:function(a){t.from_greenwich=a*Tn},pm:function(a){var l=Va(Ts,a);t.from_greenwich=(l||parseFloat(a))*Tn},nadgrids:function(a){a==="@null"?t.datumCode="none":t.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(t.axis=a)},approx:function(){t.approx=!0}};for(n in e)s=e[n],n in o?(r=o[n],typeof r=="function"?r(s):t[r]=s):t[n]=s;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var ef=1,kE=2,FE=3,l0=4,OE=5,T2=-1,e4=/\s/,i4=/[A-Za-z]/,n4=/[A-Za-z84_]/,Q0=/[,\]]/,DE=/[\d\.E\-\+]/;function Jo(i){if(typeof i!="string")throw new Error("not a string");this.text=i.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=ef}Jo.prototype.readCharicter=function(){var i=this.text[this.place++];if(this.state!==l0)for(;e4.test(i);){if(this.place>=this.text.length)return;i=this.text[this.place++]}switch(this.state){case ef:return this.neutral(i);case kE:return this.keyword(i);case l0:return this.quoted(i);case OE:return this.afterquote(i);case FE:return this.number(i);case T2:return}};Jo.prototype.afterquote=function(i){if(i==='"'){this.word+='"',this.state=l0;return}if(Q0.test(i)){this.word=this.word.trim(),this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in afterquote yet, index '+this.place)};Jo.prototype.afterItem=function(i){if(i===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=ef;return}if(i==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=ef,this.currentObject=this.stack.pop(),this.currentObject||(this.state=T2);return}};Jo.prototype.number=function(i){if(DE.test(i)){this.word+=i;return}if(Q0.test(i)){this.word=parseFloat(this.word),this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in number yet, index '+this.place)};Jo.prototype.quoted=function(i){if(i==='"'){this.state=OE;return}this.word+=i};Jo.prototype.keyword=function(i){if(n4.test(i)){this.word+=i;return}if(i==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=ef;return}if(Q0.test(i)){this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in keyword yet, index '+this.place)};Jo.prototype.neutral=function(i){if(i4.test(i)){this.word=i,this.state=kE;return}if(i==='"'){this.word="",this.state=l0;return}if(DE.test(i)){this.word=i,this.state=FE;return}if(Q0.test(i)){this.afterItem(i);return}throw new Error(`havn't handled "`+i+'" in neutral yet, index '+this.place)};Jo.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===T2)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function s4(i){var t=new Jo(i);return t.output()}function r5(i,t,e){Array.isArray(t)&&(e.unshift(t),t=null);var n=t?{}:i,s=e.reduce(function(r,o){return uc(o,r),r},n);t&&(i[t]=s)}function uc(i,t){if(!Array.isArray(i)){t[i]=!0;return}var e=i.shift();if(e==="PARAMETER"&&(e=i.shift()),i.length===1){if(Array.isArray(i[0])){t[e]={},uc(i[0],t[e]);return}t[e]=i[0];return}if(!i.length){t[e]=!0;return}if(e==="TOWGS84"){t[e]=i;return}if(e==="AXIS"){e in t||(t[e]=[]),t[e].push(i);return}Array.isArray(e)||(t[e]={});var n;switch(e){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[e]={name:i[0].toLowerCase(),convert:i[1]},i.length===3&&uc(i[2],t[e]);return;case"SPHEROID":case"ELLIPSOID":t[e]={name:i[0],a:i[1],rf:i[2]},i.length===4&&uc(i[3],t[e]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":i[0]=["name",i[0]],r5(t,e,i);return;default:for(n=-1;++n<i.length;)if(!Array.isArray(i[n]))return uc(i,t[e]);return r5(t,e,i)}}var r4=.017453292519943295;function o4(i,t){var e=t[0],n=t[1];!(e in i)&&n in i&&(i[e]=i[n],t.length===3&&(i[e]=t[2](i[e])))}function Wr(i){return i*r4}function a4(i){if(i.type==="GEOGCS"?i.projName="longlat":i.type==="LOCAL_CS"?(i.projName="identity",i.local=!0):typeof i.PROJECTION=="object"?i.projName=Object.keys(i.PROJECTION)[0]:i.projName=i.PROJECTION,i.AXIS){for(var t="",e=0,n=i.AXIS.length;e<n;++e){var s=[i.AXIS[e][0].toLowerCase(),i.AXIS[e][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?t+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?t+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?t+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(i.axis=t)}i.UNIT&&(i.units=i.UNIT.name.toLowerCase(),i.units==="metre"&&(i.units="meter"),i.UNIT.convert&&(i.type==="GEOGCS"?i.DATUM&&i.DATUM.SPHEROID&&(i.to_meter=i.UNIT.convert*i.DATUM.SPHEROID.a):i.to_meter=i.UNIT.convert));var r=i.GEOGCS;i.type==="GEOGCS"&&(r=i),r&&(r.DATUM?i.datumCode=r.DATUM.name.toLowerCase():i.datumCode=r.name.toLowerCase(),i.datumCode.slice(0,2)==="d_"&&(i.datumCode=i.datumCode.slice(2)),(i.datumCode==="new_zealand_geodetic_datum_1949"||i.datumCode==="new_zealand_1949")&&(i.datumCode="nzgd49"),(i.datumCode==="wgs_1984"||i.datumCode==="world_geodetic_system_1984")&&(i.PROJECTION==="Mercator_Auxiliary_Sphere"&&(i.sphere=!0),i.datumCode="wgs84"),i.datumCode.slice(-6)==="_ferro"&&(i.datumCode=i.datumCode.slice(0,-6)),i.datumCode.slice(-8)==="_jakarta"&&(i.datumCode=i.datumCode.slice(0,-8)),~i.datumCode.indexOf("belge")&&(i.datumCode="rnb72"),r.DATUM&&r.DATUM.SPHEROID&&(i.ellps=r.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),i.ellps.toLowerCase().slice(0,13)==="international"&&(i.ellps="intl"),i.a=r.DATUM.SPHEROID.a,i.rf=parseFloat(r.DATUM.SPHEROID.rf,10)),r.DATUM&&r.DATUM.TOWGS84&&(i.datum_params=r.DATUM.TOWGS84),~i.datumCode.indexOf("osgb_1936")&&(i.datumCode="osgb36"),~i.datumCode.indexOf("osni_1952")&&(i.datumCode="osni52"),(~i.datumCode.indexOf("tm65")||~i.datumCode.indexOf("geodetic_datum_of_1965"))&&(i.datumCode="ire65"),i.datumCode==="ch1903+"&&(i.datumCode="ch1903"),~i.datumCode.indexOf("israel")&&(i.datumCode="isr93")),i.b&&!isFinite(i.b)&&(i.b=i.a);function o(h){var c=i.to_meter||1;return h*c}var a=function(h){return o4(i,h)},l=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Wr],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Wr],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",Wr],["lat0","latitude_of_origin",Wr],["lat0","standard_parallel_1",Wr],["lat1","standard_parallel_1",Wr],["lat2","standard_parallel_2",Wr],["azimuth","Azimuth"],["alpha","azimuth",Wr],["srsCode","name"]];l.forEach(a),!i.long0&&i.longc&&(i.projName==="Albers_Conic_Equal_Area"||i.projName==="Lambert_Azimuthal_Equal_Area")&&(i.long0=i.longc),!i.lat_ts&&i.lat1&&(i.projName==="Stereographic_South_Pole"||i.projName==="Polar Stereographic (variant B)")?(i.lat0=Wr(i.lat1>0?90:-90),i.lat_ts=i.lat1):!i.lat_ts&&i.lat0&&i.projName==="Polar_Stereographic"&&(i.lat_ts=i.lat0,i.lat0=Wr(i.lat0>0?90:-90))}function BE(i){var t=s4(i),e=t.shift(),n=t.shift();t.unshift(["name",n]),t.unshift(["type",e]);var s={};return uc(t,s),a4(s),s}function ts(i){var t=this;if(arguments.length===2){var e=arguments[1];typeof e=="string"?e.charAt(0)==="+"?ts[i]=j_(arguments[1]):ts[i]=BE(arguments[1]):ts[i]=e}else if(arguments.length===1){if(Array.isArray(i))return i.map(function(n){Array.isArray(n)?ts.apply(t,n):ts(n)});if(typeof i=="string"){if(i in ts)return ts[i]}else"EPSG"in i?ts["EPSG:"+i.EPSG]=i:"ESRI"in i?ts["ESRI:"+i.ESRI]=i:"IAU2000"in i?ts["IAU2000:"+i.IAU2000]=i:console.log(i);return}}XI(ts);function l4(i){return typeof i=="string"}function h4(i){return i in ts}var c4=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function u4(i){return c4.some(function(t){return i.indexOf(t)>-1})}var d4=["3857","900913","3785","102113"];function f4(i){var t=Va(i,"authority");if(t){var e=Va(t,"epsg");return e&&d4.indexOf(e)>-1}}function g4(i){var t=Va(i,"extension");if(t)return Va(t,"proj4")}function p4(i){return i[0]==="+"}function m4(i){if(l4(i)){if(h4(i))return ts[i];if(u4(i)){var t=BE(i);if(f4(t))return ts["EPSG:3857"];var e=g4(t);return e?j_(e):t}if(p4(i))return j_(i)}else return i}function o5(i,t){i=i||{};var e,n;if(!t)return i;for(n in t)e=t[n],e!==void 0&&(i[n]=e);return i}function co(i,t,e){var n=i*t;return e/Math.sqrt(1-n*n)}function Tf(i){return i<0?-1:1}function Kt(i){return Math.abs(i)<=Yi?i:i-Tf(i)*tf}function Mr(i,t,e){var n=i*e,s=.5*i;return n=Math.pow((1-n)/(1+n),s),Math.tan(.5*(Bt-t))/n}function nf(i,t){for(var e=.5*i,n,s,r=Bt-2*Math.atan(t),o=0;o<=15;o++)if(n=i*Math.sin(r),s=Bt-2*Math.atan(t*Math.pow((1-n)/(1+n),e))-r,r+=s,Math.abs(s)<=1e-10)return r;return-9999}function _4(){var i=this.b/this.a;this.es=1-i*i,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=co(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function y4(i){var t=i.x,e=i.y;if(e*Qr>90&&e*Qr<-90&&t*Qr>180&&t*Qr<-180)return null;var n,s;if(Math.abs(Math.abs(e)-Bt)<=Xt)return null;if(this.sphere)n=this.x0+this.a*this.k0*Kt(t-this.long0),s=this.y0+this.a*this.k0*Math.log(Math.tan(ei+.5*e));else{var r=Math.sin(e),o=Mr(this.e,e,r);n=this.x0+this.a*this.k0*Kt(t-this.long0),s=this.y0-this.a*this.k0*Math.log(o)}return i.x=n,i.y=s,i}function v4(i){var t=i.x-this.x0,e=i.y-this.y0,n,s;if(this.sphere)s=Bt-2*Math.atan(Math.exp(-e/(this.a*this.k0)));else{var r=Math.exp(-e/(this.a*this.k0));if(s=nf(this.e,r),s===-9999)return null}return n=Kt(this.long0+t/(this.a*this.k0)),i.x=n,i.y=s,i}var x4=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const b4={init:_4,forward:y4,inverse:v4,names:x4};function w4(){}function a5(i){return i}var S4=["longlat","identity"];const E4={init:w4,forward:a5,inverse:a5,names:S4};var C4=[b4,E4],bp={},h0=[];function jE(i,t){var e=h0.length;return i.names?(h0[e]=i,i.names.forEach(function(n){bp[n.toLowerCase()]=e}),this):(console.log(t),!0)}function L4(i){if(!i)return!1;var t=i.toLowerCase();if(typeof bp[t]<"u"&&h0[bp[t]])return h0[bp[t]]}function M4(){C4.forEach(jE)}const T4={start:M4,add:jE,get:L4};var Se={};Se.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Se.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Se.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Se.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Se.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Se.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Se.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Se.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Se.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Se.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Se.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Se.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Se.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Se.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Se.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Se.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Se.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Se.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Se.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Se.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Se.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Se.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Se.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Se.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Se.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Se.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Se.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Se.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Se.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Se.hough={a:6378270,rf:297,ellipseName:"Hough"};Se.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Se.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Se.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Se.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Se.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Se.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Se.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Se.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Se.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Se.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Se.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Se.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var A4=Se.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Se.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function P4(i,t,e,n){var s=i*i,r=t*t,o=(s-r)/s,a=0;n?(i*=1-o*(ZI+o*(JI+o*QI)),s=i*i,o=0):a=Math.sqrt(o);var l=(s-r)/r;return{es:o,e:a,ep2:l}}function I4(i,t,e,n,s){if(!i){var r=Va(Se,n);r||(r=A4),i=r.a,t=r.b,e=r.rf}return e&&!t&&(t=(1-1/e)*i),(e===0||Math.abs(i-t)<Xt)&&(s=!0,t=i),{a:i,b:t,rf:e,sphere:s}}var gn={};gn.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};gn.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};gn.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};gn.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};gn.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};gn.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};gn.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};gn.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};gn.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"};gn.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};gn.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};gn.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};gn.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};gn.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};gn.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};gn.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};gn.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};gn.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function R4(i,t,e,n,s,r,o){var a={};return i===void 0||i==="none"?a.datum_type=B_:a.datum_type=$I,t&&(a.datum_params=t.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Hl),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Yl,a.datum_params[3]*=xd,a.datum_params[4]*=xd,a.datum_params[5]*=xd,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=vc,a.grids=o),a.a=e,a.b=n,a.es=s,a.ep2=r,a}var zE={};function N4(i,t){var e=new DataView(t),n=O4(e),s=D4(e,n),r=B4(e,s,n),o={header:s,subgrids:r};return zE[i]=o,o}function k4(i){if(i===void 0)return null;var t=i.split(",");return t.map(F4)}function F4(i){if(i.length===0)return null;var t=i[0]==="@";return t&&(i=i.slice(1)),i==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:i,mandatory:!t,grid:zE[i]||null,isNull:!1}}function dc(i){return i/3600*Math.PI/180}function O4(i){var t=i.getInt32(8,!1);return t===11?!1:(t=i.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function D4(i,t){return{nFields:i.getInt32(8,t),nSubgridFields:i.getInt32(24,t),nSubgrids:i.getInt32(40,t),shiftType:z_(i,56,64).trim(),fromSemiMajorAxis:i.getFloat64(120,t),fromSemiMinorAxis:i.getFloat64(136,t),toSemiMajorAxis:i.getFloat64(152,t),toSemiMinorAxis:i.getFloat64(168,t)}}function z_(i,t,e){return String.fromCharCode.apply(null,new Uint8Array(i.buffer.slice(t,e)))}function B4(i,t,e){for(var n=176,s=[],r=0;r<t.nSubgrids;r++){var o=z4(i,n,e),a=G4(i,n,o,e),l=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),h=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);s.push({ll:[dc(o.lowerLongitude),dc(o.lowerLatitude)],del:[dc(o.longitudeInterval),dc(o.latitudeInterval)],lim:[l,h],count:o.gridNodeCount,cvs:j4(a)}),n+=176+o.gridNodeCount*16}return s}function j4(i){return i.map(function(t){return[dc(t.longitudeShift),dc(t.latitudeShift)]})}function z4(i,t,e){return{name:z_(i,t+8,t+16).trim(),parent:z_(i,t+24,t+24+8).trim(),lowerLatitude:i.getFloat64(t+72,e),upperLatitude:i.getFloat64(t+88,e),lowerLongitude:i.getFloat64(t+104,e),upperLongitude:i.getFloat64(t+120,e),latitudeInterval:i.getFloat64(t+136,e),longitudeInterval:i.getFloat64(t+152,e),gridNodeCount:i.getInt32(t+168,e)}}function G4(i,t,e,n){for(var s=t+176,r=16,o=[],a=0;a<e.gridNodeCount;a++){var l={latitudeShift:i.getFloat32(s+a*r,n),longitudeShift:i.getFloat32(s+a*r+4,n),latitudeAccuracy:i.getFloat32(s+a*r+8,n),longitudeAccuracy:i.getFloat32(s+a*r+12,n)};o.push(l)}return o}function so(i,t){if(!(this instanceof so))return new so(i);t=t||function(h){if(h)throw h};var e=m4(i);if(typeof e!="object"){t("Could not parse to valid json: "+i);return}var n=so.projections.get(e.projName);if(!n){t("Could not get projection name from: "+i);return}if(e.datumCode&&e.datumCode!=="none"){var s=Va(gn,e.datumCode);s&&(e.datum_params=e.datum_params||(s.towgs84?s.towgs84.split(","):null),e.ellps=s.ellipse,e.datumName=s.datumName?s.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var r=I4(e.a,e.b,e.rf,e.ellps,e.sphere),o=P4(r.a,r.b,r.rf,e.R_A),a=k4(e.nadgrids),l=e.datum||R4(e.datumCode,e.datum_params,r.a,r.b,o.es,o.ep2,a);o5(this,e),o5(this,n),this.a=r.a,this.b=r.b,this.rf=r.rf,this.sphere=r.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,this.init(),t(null,this)}so.projections=T4;so.projections.start();function U4(i,t){return i.datum_type!==t.datum_type||i.a!==t.a||Math.abs(i.es-t.es)>5e-11?!1:i.datum_type===Hl?i.datum_params[0]===t.datum_params[0]&&i.datum_params[1]===t.datum_params[1]&&i.datum_params[2]===t.datum_params[2]:i.datum_type===Yl?i.datum_params[0]===t.datum_params[0]&&i.datum_params[1]===t.datum_params[1]&&i.datum_params[2]===t.datum_params[2]&&i.datum_params[3]===t.datum_params[3]&&i.datum_params[4]===t.datum_params[4]&&i.datum_params[5]===t.datum_params[5]&&i.datum_params[6]===t.datum_params[6]:!0}function GE(i,t,e){var n=i.x,s=i.y,r=i.z?i.z:0,o,a,l,h;if(s<-Bt&&s>-1.001*Bt)s=-Bt;else if(s>Bt&&s<1.001*Bt)s=Bt;else{if(s<-Bt)return{x:-1/0,y:-1/0,z:i.z};if(s>Bt)return{x:1/0,y:1/0,z:i.z}}return n>Math.PI&&(n-=2*Math.PI),a=Math.sin(s),h=Math.cos(s),l=a*a,o=e/Math.sqrt(1-t*l),{x:(o+r)*h*Math.cos(n),y:(o+r)*h*Math.sin(n),z:(o*(1-t)+r)*a}}function UE(i,t,e,n){var s=1e-12,r=s*s,o=30,a,l,h,c,u,f,d,g,p,y,_,x,b,L=i.x,M=i.y,k=i.z?i.z:0,A,T,F;if(a=Math.sqrt(L*L+M*M),l=Math.sqrt(L*L+M*M+k*k),a/e<s){if(A=0,l/e<s)return T=Bt,F=-n,{x:i.x,y:i.y,z:i.z}}else A=Math.atan2(M,L);h=k/l,c=a/l,u=1/Math.sqrt(1-t*(2-t)*c*c),g=c*(1-t)*u,p=h*u,b=0;do b++,d=e/Math.sqrt(1-t*p*p),F=a*g+k*p-d*(1-t*p*p),f=t*d/(d+F),u=1/Math.sqrt(1-f*(2-f)*c*c),y=c*(1-f)*u,_=h*u,x=_*g-y*p,g=y,p=_;while(x*x>r&&b<o);return T=Math.atan(_/Math.abs(y)),{x:A,y:T,z:F}}function W4(i,t,e){if(t===Hl)return{x:i.x+e[0],y:i.y+e[1],z:i.z+e[2]};if(t===Yl){var n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6];return{x:h*(i.x-l*i.y+a*i.z)+n,y:h*(l*i.x+i.y-o*i.z)+s,z:h*(-a*i.x+o*i.y+i.z)+r}}}function q4(i,t,e){if(t===Hl)return{x:i.x-e[0],y:i.y-e[1],z:i.z-e[2]};if(t===Yl){var n=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5],h=e[6],c=(i.x-n)/h,u=(i.y-s)/h,f=(i.z-r)/h;return{x:c+l*u-a*f,y:-l*c+u+o*f,z:a*c-o*u+f}}}function Bg(i){return i===Hl||i===Yl}function V4(i,t,e){if(U4(i,t)||i.datum_type===B_||t.datum_type===B_)return e;var n=i.a,s=i.es;if(i.datum_type===vc){var r=l5(i,!1,e);if(r!==0)return;n=i5,s=n5}var o=t.a,a=t.b,l=t.es;if(t.datum_type===vc&&(o=i5,a=KI,l=n5),s===l&&n===o&&!Bg(i.datum_type)&&!Bg(t.datum_type))return e;if(e=GE(e,s,n),Bg(i.datum_type)&&(e=W4(e,i.datum_type,i.datum_params)),Bg(t.datum_type)&&(e=q4(e,t.datum_type,t.datum_params)),e=UE(e,l,o,a),t.datum_type===vc){var h=l5(t,!0,e);if(h!==0)return}return e}function l5(i,t,e){if(i.grids===null||i.grids.length===0)return console.log("Grid shift grids not found"),-1;var n={x:-e.x,y:e.y},s={x:Number.NaN,y:Number.NaN},r=[];t:for(var o=0;o<i.grids.length;o++){var a=i.grids[o];if(r.push(a.name),a.isNull){s=n;break}if(a.mandatory,a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var l=a.grid.subgrids,h=0,c=l.length;h<c;h++){var u=l[h],f=(Math.abs(u.del[1])+Math.abs(u.del[0]))/1e4,d=u.ll[0]-f,g=u.ll[1]-f,p=u.ll[0]+(u.lim[0]-1)*u.del[0]+f,y=u.ll[1]+(u.lim[1]-1)*u.del[1]+f;if(!(g>n.y||d>n.x||y<n.y||p<n.x)&&(s=H4(n,t,u),!isNaN(s.x)))break t}}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*Qr+" "+n.y*Qr+" tried: '"+r+"'"),-1):(e.x=-s.x,e.y=s.y,0)}function H4(i,t,e){var n={x:Number.NaN,y:Number.NaN};if(isNaN(i.x))return n;var s={x:i.x,y:i.y};s.x-=e.ll[0],s.y-=e.ll[1],s.x=Kt(s.x-Math.PI)+Math.PI;var r=h5(s,e);if(t){if(isNaN(r.x))return n;r.x=s.x-r.x,r.y=s.y-r.y;var o=9,a=1e-12,l,h;do{if(h=h5(r,e),isNaN(h.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:s.x-(h.x+r.x),y:s.y-(h.y+r.y)},r.x+=l.x,r.y+=l.y}while(o--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=Kt(r.x+e.ll[0]),n.y=r.y+e.ll[1]}else isNaN(r.x)||(n.x=i.x+r.x,n.y=i.y+r.y);return n}function h5(i,t){var e={x:i.x/t.del[0],y:i.y/t.del[1]},n={x:Math.floor(e.x),y:Math.floor(e.y)},s={x:e.x-1*n.x,y:e.y-1*n.y},r={x:Number.NaN,y:Number.NaN},o;if(n.x<0||n.x>=t.lim[0]||n.y<0||n.y>=t.lim[1])return r;o=n.y*t.lim[0]+n.x;var a={x:t.cvs[o][0],y:t.cvs[o][1]};o++;var l={x:t.cvs[o][0],y:t.cvs[o][1]};o+=t.lim[0];var h={x:t.cvs[o][0],y:t.cvs[o][1]};o--;var c={x:t.cvs[o][0],y:t.cvs[o][1]},u=s.x*s.y,f=s.x*(1-s.y),d=(1-s.x)*(1-s.y),g=(1-s.x)*s.y;return r.x=d*a.x+f*l.x+g*c.x+u*h.x,r.y=d*a.y+f*l.y+g*c.y+u*h.y,r}function c5(i,t,e){var n=e.x,s=e.y,r=e.z||0,o,a,l,h={};for(l=0;l<3;l++)if(!(t&&l===2&&e.z===void 0))switch(l===0?(o=n,"ew".indexOf(i.axis[l])!==-1?a="x":a="y"):l===1?(o=s,"ns".indexOf(i.axis[l])!==-1?a="y":a="x"):(o=r,a="z"),i.axis[l]){case"e":h[a]=o;break;case"w":h[a]=-o;break;case"n":h[a]=o;break;case"s":h[a]=-o;break;case"u":e[a]!==void 0&&(h.z=o);break;case"d":e[a]!==void 0&&(h.z=-o);break;default:return null}return h}function WE(i){var t={x:i[0],y:i[1]};return i.length>2&&(t.z=i[2]),i.length>3&&(t.m=i[3]),t}function Y4(i){u5(i.x),u5(i.y)}function u5(i){if(typeof Number.isFinite=="function"){if(Number.isFinite(i))return;throw new TypeError("coordinates must be finite numbers")}if(typeof i!="number"||i!==i||!isFinite(i))throw new TypeError("coordinates must be finite numbers")}function X4(i,t){return(i.datum.datum_type===Hl||i.datum.datum_type===Yl||i.datum.datum_type===vc)&&t.datumCode!=="WGS84"||(t.datum.datum_type===Hl||t.datum.datum_type===Yl||t.datum.datum_type===vc)&&i.datumCode!=="WGS84"}function c0(i,t,e,n){var s;Array.isArray(e)?e=WE(e):e={x:e.x,y:e.y,z:e.z,m:e.m};var r=e.z!==void 0;if(Y4(e),i.datum&&t.datum&&X4(i,t)&&(s=new so("WGS84"),e=c0(i,s,e,n),i=s),n&&i.axis!=="enu"&&(e=c5(i,!1,e)),i.projName==="longlat")e={x:e.x*Tn,y:e.y*Tn,z:e.z||0};else if(i.to_meter&&(e={x:e.x*i.to_meter,y:e.y*i.to_meter,z:e.z||0}),e=i.inverse(e),!e)return;if(i.from_greenwich&&(e.x+=i.from_greenwich),e=V4(i.datum,t.datum,e),!!e)return t.from_greenwich&&(e={x:e.x-t.from_greenwich,y:e.y,z:e.z||0}),t.projName==="longlat"?e={x:e.x*Qr,y:e.y*Qr,z:e.z||0}:(e=t.forward(e),t.to_meter&&(e={x:e.x/t.to_meter,y:e.y/t.to_meter,z:e.z||0})),n&&t.axis!=="enu"?c5(t,!0,e):(e&&!r&&delete e.z,e)}var d5=so("WGS84");function P1(i,t,e,n){var s,r,o;return Array.isArray(e)?(s=c0(i,t,e,n)||{x:NaN,y:NaN},e.length>2?typeof i.name<"u"&&i.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof s.z=="number"?[s.x,s.y,s.z].concat(e.slice(3)):[s.x,s.y,e[2]].concat(e.slice(3)):[s.x,s.y].concat(e.slice(2)):[s.x,s.y]):(r=c0(i,t,e,n),o=Object.keys(e),o.length===2||o.forEach(function(a){if(typeof i.name<"u"&&i.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;r[a]=e[a]}),r)}function f5(i){return i instanceof so?i:i.oProj?i.oProj:so(i)}function Cn(i,t,e){i=f5(i);var n=!1,s;return typeof t>"u"?(t=i,i=d5,n=!0):(typeof t.x<"u"||Array.isArray(t))&&(e=t,t=i,i=d5,n=!0),t=f5(t),e?P1(i,t,e):(s={forward:function(r,o){return P1(i,t,r,o)},inverse:function(r,o){return P1(t,i,r,o)}},n&&(s.oProj=t),s)}var g5=6,qE="AJSAJS",VE="AFAFAF",fc=65,fs=73,er=79,rd=86,od=90;const $4={forward:HE,inverse:K4,toPoint:YE};function HE(i,t){return t=t||5,Q4(Z4({lat:i[1],lon:i[0]}),t)}function K4(i){var t=A2($E(i.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function YE(i){var t=A2($E(i.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function I1(i){return i*(Math.PI/180)}function p5(i){return 180*(i/Math.PI)}function Z4(i){var t=i.lat,e=i.lon,n=6378137,s=.00669438,r=.9996,o,a,l,h,c,u,f,d=I1(t),g=I1(e),p,y;y=Math.floor((e+180)/6)+1,e===180&&(y=60),t>=56&&t<64&&e>=3&&e<12&&(y=32),t>=72&&t<84&&(e>=0&&e<9?y=31:e>=9&&e<21?y=33:e>=21&&e<33?y=35:e>=33&&e<42&&(y=37)),o=(y-1)*6-180+3,p=I1(o),a=s/(1-s),l=n/Math.sqrt(1-s*Math.sin(d)*Math.sin(d)),h=Math.tan(d)*Math.tan(d),c=a*Math.cos(d)*Math.cos(d),u=Math.cos(d)*(g-p),f=n*((1-s/4-3*s*s/64-5*s*s*s/256)*d-(3*s/8+3*s*s/32+45*s*s*s/1024)*Math.sin(2*d)+(15*s*s/256+45*s*s*s/1024)*Math.sin(4*d)-35*s*s*s/3072*Math.sin(6*d));var _=r*l*(u+(1-h+c)*u*u*u/6+(5-18*h+h*h+72*c-58*a)*u*u*u*u*u/120)+5e5,x=r*(f+l*Math.tan(d)*(u*u/2+(5-h+9*c+4*c*c)*u*u*u*u/24+(61-58*h+h*h+600*c-330*a)*u*u*u*u*u*u/720));return t<0&&(x+=1e7),{northing:Math.round(x),easting:Math.round(_),zoneNumber:y,zoneLetter:J4(t)}}function A2(i){var t=i.northing,e=i.easting,n=i.zoneLetter,s=i.zoneNumber;if(s<0||s>60)return null;var r=.9996,o=6378137,a=.00669438,l,h=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),c,u,f,d,g,p,y,_,x,b=e-5e5,L=t;n<"N"&&(L-=1e7),y=(s-1)*6-180+3,l=a/(1-a),p=L/r,_=p/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),x=_+(3*h/2-27*h*h*h/32)*Math.sin(2*_)+(21*h*h/16-55*h*h*h*h/32)*Math.sin(4*_)+151*h*h*h/96*Math.sin(6*_),c=o/Math.sqrt(1-a*Math.sin(x)*Math.sin(x)),u=Math.tan(x)*Math.tan(x),f=l*Math.cos(x)*Math.cos(x),d=o*(1-a)/Math.pow(1-a*Math.sin(x)*Math.sin(x),1.5),g=b/(c*r);var M=x-c*Math.tan(x)/d*(g*g/2-(5+3*u+10*f-4*f*f-9*l)*g*g*g*g/24+(61+90*u+298*f+45*u*u-252*l-3*f*f)*g*g*g*g*g*g/720);M=p5(M);var k=(g-(1+2*u+f)*g*g*g/6+(5-2*f+28*u-3*f*f+8*l+24*u*u)*g*g*g*g*g/120)/Math.cos(x);k=y+p5(k);var A;if(i.accuracy){var T=A2({northing:i.northing+i.accuracy,easting:i.easting+i.accuracy,zoneLetter:i.zoneLetter,zoneNumber:i.zoneNumber});A={top:T.lat,right:T.lon,bottom:M,left:k}}else A={lat:M,lon:k};return A}function J4(i){var t="Z";return 84>=i&&i>=72?t="X":72>i&&i>=64?t="W":64>i&&i>=56?t="V":56>i&&i>=48?t="U":48>i&&i>=40?t="T":40>i&&i>=32?t="S":32>i&&i>=24?t="R":24>i&&i>=16?t="Q":16>i&&i>=8?t="P":8>i&&i>=0?t="N":0>i&&i>=-8?t="M":-8>i&&i>=-16?t="L":-16>i&&i>=-24?t="K":-24>i&&i>=-32?t="J":-32>i&&i>=-40?t="H":-40>i&&i>=-48?t="G":-48>i&&i>=-56?t="F":-56>i&&i>=-64?t="E":-64>i&&i>=-72?t="D":-72>i&&i>=-80&&(t="C"),t}function Q4(i,t){var e="00000"+i.easting,n="00000"+i.northing;return i.zoneNumber+i.zoneLetter+tR(i.easting,i.northing,i.zoneNumber)+e.substr(e.length-5,t)+n.substr(n.length-5,t)}function tR(i,t,e){var n=XE(e),s=Math.floor(i/1e5),r=Math.floor(t/1e5)%20;return eR(s,r,n)}function XE(i){var t=i%g5;return t===0&&(t=g5),t}function eR(i,t,e){var n=e-1,s=qE.charCodeAt(n),r=VE.charCodeAt(n),o=s+i-1,a=r+t,l=!1;o>od&&(o=o-od+fc-1,l=!0),(o===fs||s<fs&&o>fs||(o>fs||s<fs)&&l)&&o++,(o===er||s<er&&o>er||(o>er||s<er)&&l)&&(o++,o===fs&&o++),o>od&&(o=o-od+fc-1),a>rd?(a=a-rd+fc-1,l=!0):l=!1,(a===fs||r<fs&&a>fs||(a>fs||r<fs)&&l)&&a++,(a===er||r<er&&a>er||(a>er||r<er)&&l)&&(a++,a===fs&&a++),a>rd&&(a=a-rd+fc-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function $E(i){if(i&&i.length===0)throw"MGRSPoint coverting from nothing";for(var t=i.length,e=null,n="",s,r=0;!/[A-Z]/.test(s=i.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+i;n+=s,r++}var o=parseInt(n,10);if(r===0||r+3>t)throw"MGRSPoint bad conversion from: "+i;var a=i.charAt(r++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+i;e=i.substring(r,r+=2);for(var l=XE(o),h=iR(e.charAt(0),l),c=nR(e.charAt(1),l);c<sR(a);)c+=2e6;var u=t-r;if(u%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+i;var f=u/2,d=0,g=0,p,y,_,x,b;return f>0&&(p=1e5/Math.pow(10,f),y=i.substring(r,r+f),d=parseFloat(y)*p,_=i.substring(r+f),g=parseFloat(_)*p),x=d+h,b=g+c,{easting:x,northing:b,zoneLetter:a,zoneNumber:o,accuracy:p}}function iR(i,t){for(var e=qE.charCodeAt(t-1),n=1e5,s=!1;e!==i.charCodeAt(0);){if(e++,e===fs&&e++,e===er&&e++,e>od){if(s)throw"Bad character: "+i;e=fc,s=!0}n+=1e5}return n}function nR(i,t){if(i>"V")throw"MGRSPoint given invalid Northing "+i;for(var e=VE.charCodeAt(t-1),n=0,s=!1;e!==i.charCodeAt(0);){if(e++,e===fs&&e++,e===er&&e++,e>rd){if(s)throw"Bad character: "+i;e=fc,s=!0}n+=1e5}return n}function sR(i){var t;switch(i){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+i}function Wc(i,t,e){if(!(this instanceof Wc))return new Wc(i,t,e);if(Array.isArray(i))this.x=i[0],this.y=i[1],this.z=i[2]||0;else if(typeof i=="object")this.x=i.x,this.y=i.y,this.z=i.z||0;else if(typeof i=="string"&&typeof t>"u"){var n=i.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=i,this.y=t,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Wc.fromMGRS=function(i){return new Wc(YE(i))};Wc.prototype.toMGRS=function(i){return HE([this.x,this.y],i)};var rR=1,oR=.25,m5=.046875,_5=.01953125,y5=.01068115234375,aR=.75,lR=.46875,hR=.013020833333333334,cR=.007120768229166667,uR=.3645833333333333,dR=.005696614583333333,fR=.3076171875;function P2(i){var t=[];t[0]=rR-i*(oR+i*(m5+i*(_5+i*y5))),t[1]=i*(aR-i*(m5+i*(_5+i*y5)));var e=i*i;return t[2]=e*(lR-i*(hR+i*cR)),e*=i,t[3]=e*(uR-i*dR),t[4]=e*i*fR,t}function tu(i,t,e,n){return e*=t,t*=t,n[0]*i-e*(n[1]+t*(n[2]+t*(n[3]+t*n[4])))}var gR=20;function I2(i,t,e){for(var n=1/(1-t),s=i,r=gR;r;--r){var o=Math.sin(s),a=1-t*o*o;if(a=(tu(s,o,Math.cos(s),e)-i)*(a*Math.sqrt(a))*n,s-=a,Math.abs(a)<Xt)return s}return s}function pR(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=P2(this.es),this.ml0=tu(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function mR(i){var t=i.x,e=i.y,n=Kt(t-this.long0),s,r,o,a=Math.sin(e),l=Math.cos(e);if(this.es){var c=l*n,u=Math.pow(c,2),f=this.ep2*Math.pow(l,2),d=Math.pow(f,2),g=Math.abs(l)>Xt?Math.tan(e):0,p=Math.pow(g,2),y=Math.pow(p,2);s=1-this.es*Math.pow(a,2),c=c/Math.sqrt(s);var _=tu(e,a,l,this.en);r=this.a*(this.k0*c*(1+u/6*(1-p+f+u/20*(5-18*p+y+14*f-58*p*f+u/42*(61+179*y-y*p-479*p)))))+this.x0,o=this.a*(this.k0*(_-this.ml0+a*n*c/2*(1+u/12*(5-p+9*f+4*d+u/30*(61+y-58*p+270*f-330*p*f+u/56*(1385+543*y-y*p-3111*p))))))+this.y0}else{var h=l*Math.sin(n);if(Math.abs(Math.abs(h)-1)<Xt)return 93;if(r=.5*this.a*this.k0*Math.log((1+h)/(1-h))+this.x0,o=l*Math.cos(n)/Math.sqrt(1-Math.pow(h,2)),h=Math.abs(o),h>=1){if(h-1>Xt)return 93;o=0}else o=Math.acos(o);e<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return i.x=r,i.y=o,i}function _R(i){var t,e,n,s,r=(i.x-this.x0)*(1/this.a),o=(i.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+o/this.k0,e=I2(t,this.es,this.en),Math.abs(e)<Bt){var u=Math.sin(e),f=Math.cos(e),d=Math.abs(f)>Xt?Math.tan(e):0,g=this.ep2*Math.pow(f,2),p=Math.pow(g,2),y=Math.pow(d,2),_=Math.pow(y,2);t=1-this.es*Math.pow(u,2);var x=r*Math.sqrt(t)/this.k0,b=Math.pow(x,2);t=t*d,n=e-t*b/(1-this.es)*.5*(1-b/12*(5+3*y-9*g*y+g-4*p-b/30*(61+90*y-252*g*y+45*_+46*g-b/56*(1385+3633*y+4095*_+1574*_*y)))),s=Kt(this.long0+x*(1-b/6*(1+2*y+g-b/20*(5+28*y+24*_+8*g*y+6*g-b/42*(61+662*y+1320*_+720*_*y))))/f)}else n=Bt*Tf(o),s=0;else{var a=Math.exp(r/this.k0),l=.5*(a-1/a),h=this.lat0+o/this.k0,c=Math.cos(h);t=Math.sqrt((1-Math.pow(c,2))/(1+Math.pow(l,2))),n=Math.asin(t),o<0&&(n=-n),l===0&&c===0?s=0:s=Kt(Math.atan2(l,c)+this.long0)}return i.x=s,i.y=n,i}var yR=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const wp={init:pR,forward:mR,inverse:_R,names:yR};function KE(i){var t=Math.exp(i);return t=(t-1/t)/2,t}function xs(i,t){i=Math.abs(i),t=Math.abs(t);var e=Math.max(i,t),n=Math.min(i,t)/(e||1);return e*Math.sqrt(1+Math.pow(n,2))}function vR(i){var t=1+i,e=t-1;return e===0?i:i*Math.log(t)/e}function xR(i){var t=Math.abs(i);return t=vR(t*(1+t/(xs(1,t)+1))),i<0?-t:t}function R2(i,t){for(var e=2*Math.cos(2*t),n=i.length-1,s=i[n],r=0,o;--n>=0;)o=-r+e*s+i[n],r=s,s=o;return t+o*Math.sin(2*t)}function bR(i,t){for(var e=2*Math.cos(t),n=i.length-1,s=i[n],r=0,o;--n>=0;)o=-r+e*s+i[n],r=s,s=o;return Math.sin(t)*o}function wR(i){var t=Math.exp(i);return t=(t+1/t)/2,t}function ZE(i,t,e){for(var n=Math.sin(t),s=Math.cos(t),r=KE(e),o=wR(e),a=2*s*o,l=-2*n*r,h=i.length-1,c=i[h],u=0,f=0,d=0,g,p;--h>=0;)g=f,p=u,f=c,u=d,c=-g+a*f-l*u+i[h],d=-p+l*f+a*u;return a=n*o,l=s*r,[a*c-l*d,a*d+l*c]}function SR(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(wp.init.apply(this),this.forward=wp.forward,this.inverse=wp.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var i=this.es/(1+Math.sqrt(1-this.es)),t=i/(2-i),e=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),e=e*t,this.cgb[1]=e*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=e*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),e=e*t,this.cgb[2]=e*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=e*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),e=e*t,this.cgb[3]=e*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=e*(1237/630+t*(-12/5+t*(-24832/14175))),e=e*t,this.cgb[4]=e*(4174/315+t*(-144838/6237)),this.cbg[4]=e*(-734/315+t*(109598/31185)),e=e*t,this.cgb[5]=e*(601676/22275),this.cbg[5]=e*(444337/155925),e=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+e*(1/4+e*(1/64+e/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=e*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=e*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),e=e*t,this.utg[2]=e*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=e*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),e=e*t,this.utg[3]=e*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=e*(49561/161280+t*(-179/168+t*(6601661/7257600))),e=e*t,this.utg[4]=e*(-4583/161280+t*(108847/3991680)),this.gtu[4]=e*(34729/80640+t*(-3418889/1995840)),e=e*t,this.utg[5]=e*(-20648693/638668800),this.gtu[5]=e*(212378941/319334400);var n=R2(this.cbg,this.lat0);this.Zb=-this.Qn*(n+bR(this.gtu,2*n))}function ER(i){var t=Kt(i.x-this.long0),e=i.y;e=R2(this.cbg,e);var n=Math.sin(e),s=Math.cos(e),r=Math.sin(t),o=Math.cos(t);e=Math.atan2(n,o*s),t=Math.atan2(r*s,xs(n,s*o)),t=xR(Math.tan(t));var a=ZE(this.gtu,2*e,2*t);e=e+a[0],t=t+a[1];var l,h;return Math.abs(t)<=2.623395162778?(l=this.a*(this.Qn*t)+this.x0,h=this.a*(this.Qn*e+this.Zb)+this.y0):(l=1/0,h=1/0),i.x=l,i.y=h,i}function CR(i){var t=(i.x-this.x0)*(1/this.a),e=(i.y-this.y0)*(1/this.a);e=(e-this.Zb)/this.Qn,t=t/this.Qn;var n,s;if(Math.abs(t)<=2.623395162778){var r=ZE(this.utg,2*e,2*t);e=e+r[0],t=t+r[1],t=Math.atan(KE(t));var o=Math.sin(e),a=Math.cos(e),l=Math.sin(t),h=Math.cos(t);e=Math.atan2(o*h,xs(l,h*a)),t=Math.atan2(l,h*a),n=Kt(t+this.long0),s=R2(this.cgb,e)}else n=1/0,s=1/0;return i.x=n,i.y=s,i}var LR=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Sp={init:SR,forward:ER,inverse:CR,names:LR};function MR(i,t){if(i===void 0){if(i=Math.floor((Kt(t)+Math.PI)*30/Math.PI)+1,i<0)return 0;if(i>60)return 60}return i}var TR="etmerc";function AR(){var i=MR(this.zone,this.long0);if(i===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(i)-183)*Tn,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Sp.init.apply(this),this.forward=Sp.forward,this.inverse=Sp.inverse}var PR=["Universal Transverse Mercator System","utm"];const IR={init:AR,names:PR,dependsOn:TR};function N2(i,t){return Math.pow((1-i)/(1+i),t)}var RR=20;function NR(){var i=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*i*i),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(i/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ei)/(Math.pow(Math.tan(.5*this.lat0+ei),this.C)*N2(this.e*i,this.ratexp))}function kR(i){var t=i.x,e=i.y;return i.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+ei),this.C)*N2(this.e*Math.sin(e),this.ratexp))-Bt,i.x=this.C*t,i}function FR(i){for(var t=1e-14,e=i.x/this.C,n=i.y,s=Math.pow(Math.tan(.5*n+ei)/this.K,1/this.C),r=RR;r>0&&(n=2*Math.atan(s*N2(this.e*Math.sin(i.y),-.5*this.e))-Bt,!(Math.abs(n-i.y)<t));--r)i.y=n;return r?(i.x=e,i.y=n,i):null}var OR=["gauss"];const k2={init:NR,forward:kR,inverse:FR,names:OR};function DR(){k2.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function BR(i){var t,e,n,s;return i.x=Kt(i.x-this.long0),k2.forward.apply(this,[i]),t=Math.sin(i.y),e=Math.cos(i.y),n=Math.cos(i.x),s=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*e*n),i.x=s*e*Math.sin(i.x),i.y=s*(this.cosc0*t-this.sinc0*e*n),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i}function jR(i){var t,e,n,s,r;if(i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,i.x/=this.k0,i.y/=this.k0,r=xs(i.x,i.y)){var o=2*Math.atan2(r,this.R2);t=Math.sin(o),e=Math.cos(o),s=Math.asin(e*this.sinc0+i.y*t*this.cosc0/r),n=Math.atan2(i.x*t,r*this.cosc0*e-i.y*this.sinc0*t)}else s=this.phic0,n=0;return i.x=n,i.y=s,k2.inverse.apply(this,[i]),i.x=Kt(i.x+this.long0),i}var zR=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const GR={init:DR,forward:BR,inverse:jR,names:zR};function UR(i,t,e){return t*=e,Math.tan(.5*(Bt+i))*Math.pow((1-t)/(1+t),.5*e)}function WR(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xt&&(this.k0=.5*(1+Tf(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Xt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xt&&Math.abs(Math.cos(this.lat_ts))>Xt&&(this.k0=.5*this.cons*co(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Mr(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=co(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Bt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function qR(i){var t=i.x,e=i.y,n=Math.sin(e),s=Math.cos(e),r,o,a,l,h,c,u=Kt(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=Xt&&Math.abs(e+this.lat0)<=Xt?(i.x=NaN,i.y=NaN,i):this.sphere?(r=2*this.k0/(1+this.sinlat0*n+this.coslat0*s*Math.cos(u)),i.x=this.a*r*s*Math.sin(u)+this.x0,i.y=this.a*r*(this.coslat0*n-this.sinlat0*s*Math.cos(u))+this.y0,i):(o=2*Math.atan(this.ssfn_(e,n,this.e))-Bt,l=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=Xt?(h=Mr(this.e,e*this.con,this.con*n),c=2*this.a*this.k0*h/this.cons,i.x=this.x0+c*Math.sin(t-this.long0),i.y=this.y0-this.con*c*Math.cos(t-this.long0),i):(Math.abs(this.sinlat0)<Xt?(r=2*this.a*this.k0/(1+l*Math.cos(u)),i.y=r*a):(r=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(u))),i.y=r*(this.cosX0*a-this.sinX0*l*Math.cos(u))+this.y0),i.x=r*l*Math.sin(u)+this.x0,i))}function VR(i){i.x-=this.x0,i.y-=this.y0;var t,e,n,s,r,o=Math.sqrt(i.x*i.x+i.y*i.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return t=this.long0,e=this.lat0,o<=Xt?(i.x=t,i.y=e,i):(e=Math.asin(Math.cos(a)*this.sinlat0+i.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<Xt?this.lat0>0?t=Kt(this.long0+Math.atan2(i.x,-1*i.y)):t=Kt(this.long0+Math.atan2(i.x,i.y)):t=Kt(this.long0+Math.atan2(i.x*Math.sin(a),o*this.coslat0*Math.cos(a)-i.y*this.sinlat0*Math.sin(a))),i.x=t,i.y=e,i)}else if(Math.abs(this.coslat0)<=Xt){if(o<=Xt)return e=this.lat0,t=this.long0,i.x=t,i.y=e,i;i.x*=this.con,i.y*=this.con,n=o*this.cons/(2*this.a*this.k0),e=this.con*nf(this.e,n),t=this.con*Kt(this.con*this.long0+Math.atan2(i.x,-1*i.y))}else s=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,o<=Xt?r=this.X0:(r=Math.asin(Math.cos(s)*this.sinX0+i.y*Math.sin(s)*this.cosX0/o),t=Kt(this.long0+Math.atan2(i.x*Math.sin(s),o*this.cosX0*Math.cos(s)-i.y*this.sinX0*Math.sin(s)))),e=-1*nf(this.e,Math.tan(.5*(Bt+r)));return i.x=t,i.y=e,i}var HR=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const YR={init:WR,forward:qR,inverse:VR,names:HR,ssfn_:UR};function XR(){var i=this.lat0;this.lambda0=this.long0;var t=Math.sin(i),e=this.a,n=this.rf,s=1/n,r=2*s-Math.pow(s,2),o=this.e=Math.sqrt(r);this.R=this.k0*e*Math.sqrt(1-r)/(1-r*Math.pow(t,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(i),4)),this.b0=Math.asin(t/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+i/2)),h=Math.log((1+o*t)/(1-o*t));this.K=a-this.alpha*l+this.alpha*o/2*h}function $R(i){var t=Math.log(Math.tan(Math.PI/4-i.y/2)),e=this.e/2*Math.log((1+this.e*Math.sin(i.y))/(1-this.e*Math.sin(i.y))),n=-this.alpha*(t+e)+this.K,s=2*(Math.atan(Math.exp(n))-Math.PI/4),r=this.alpha*(i.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(r))),a=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(r));return i.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,i.x=this.R*o+this.x0,i}function KR(i){for(var t=i.x-this.x0,e=i.y-this.y0,n=t/this.R,s=2*(Math.atan(Math.exp(e/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(s))),a=this.lambda0+o/this.alpha,l=0,h=r,c=-1e3,u=0;Math.abs(h-c)>1e-7;){if(++u>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),c=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return i.x=a,i.y=h,i}var ZR=["somerc"];const JR={init:XR,forward:$R,inverse:KR,names:ZR};var sc=1e-7;function QR(i){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],e=typeof i.PROJECTION=="object"?Object.keys(i.PROJECTION)[0]:i.PROJECTION;return"no_uoff"in i||"no_off"in i||t.indexOf(e)!==-1}function tN(){var i,t,e,n,s,r,o,a,l,h,c=0,u,f=0,d=0,g=0,p=0,y=0,_=0;this.no_off=QR(this),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var b=!1;if("rectified_grid_angle"in this&&(b=!0),x&&(_=this.alpha),b&&(c=this.rectified_grid_angle*Tn),x||b)f=this.longc;else if(d=this.long1,p=this.lat1,g=this.long2,y=this.lat2,Math.abs(p-y)<=sc||(i=Math.abs(p))<=sc||Math.abs(i-Bt)<=sc||Math.abs(Math.abs(this.lat0)-Bt)<=sc||Math.abs(Math.abs(y)-Bt)<=sc)throw new Error;var L=1-this.es;t=Math.sqrt(L),Math.abs(this.lat0)>Xt?(a=Math.sin(this.lat0),e=Math.cos(this.lat0),i=1-this.es*a*a,this.B=e*e,this.B=Math.sqrt(1+this.es*this.B*this.B/L),this.A=this.B*this.k0*t/i,n=this.B*t/(e*Math.sqrt(i)),s=n*n-1,s<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=n,this.E*=Math.pow(Mr(this.e,this.lat0,a),this.B)):(this.B=1/t,this.A=this.k0,this.E=n=s=1),x||b?(x?(u=Math.asin(Math.sin(_)/n),b||(c=_)):(u=c,_=Math.asin(n*Math.sin(u))),this.lam0=f-Math.asin(.5*(s-1/s)*Math.tan(u))/this.B):(r=Math.pow(Mr(this.e,p,Math.sin(p)),this.B),o=Math.pow(Mr(this.e,y,Math.sin(y)),this.B),s=this.E/r,l=(o-r)/(o+r),h=this.E*this.E,h=(h-o*r)/(h+o*r),i=d-g,i<-Math.pi?g-=tf:i>Math.pi&&(g+=tf),this.lam0=Kt(.5*(d+g)-Math.atan(h*Math.tan(.5*this.B*(d-g))/l)/this.B),u=Math.atan(2*Math.sin(this.B*Kt(d-this.lam0))/(s-1/s)),c=_=Math.asin(n*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(c),this.cosrot=Math.cos(c),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(ei-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(ei+s))}function eN(i){var t={},e,n,s,r,o,a,l,h;if(i.x=i.x-this.lam0,Math.abs(Math.abs(i.y)-Bt)>Xt){if(o=this.E/Math.pow(Mr(this.e,i.y,Math.sin(i.y)),this.B),a=1/o,e=.5*(o-a),n=.5*(o+a),r=Math.sin(this.B*i.x),s=(e*this.singam-r*this.cosgam)/n,Math.abs(Math.abs(s)-1)<Xt)throw new Error;h=.5*this.ArB*Math.log((1-s)/(1+s)),a=Math.cos(this.B*i.x),Math.abs(a)<sc?l=this.A*i.x:l=this.ArB*Math.atan2(e*this.cosgam+r*this.singam,a)}else h=i.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*i.y;return this.no_rot?(t.x=l,t.y=h):(l-=this.u_0,t.x=h*this.cosrot+l*this.sinrot,t.y=l*this.cosrot-h*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function iN(i){var t,e,n,s,r,o,a,l={};if(i.x=(i.x-this.x0)*(1/this.a),i.y=(i.y-this.y0)*(1/this.a),this.no_rot?(e=i.y,t=i.x):(e=i.x*this.cosrot-i.y*this.sinrot,t=i.y*this.cosrot+i.x*this.sinrot+this.u_0),n=Math.exp(-this.BrA*e),s=.5*(n-1/n),r=.5*(n+1/n),o=Math.sin(this.BrA*t),a=(o*this.cosgam+s*this.singam)/r,Math.abs(Math.abs(a)-1)<Xt)l.x=0,l.y=a<0?-Bt:Bt;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=nf(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(s*this.cosgam-o*this.singam,Math.cos(this.BrA*t))}return l.x+=this.lam0,l}var nN=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const sN={init:tN,forward:eN,inverse:iN,names:nN};function rN(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Xt)){var i=this.b/this.a;this.e=Math.sqrt(1-i*i);var t=Math.sin(this.lat1),e=Math.cos(this.lat1),n=co(this.e,t,e),s=Mr(this.e,this.lat1,t),r=Math.sin(this.lat2),o=Math.cos(this.lat2),a=co(this.e,r,o),l=Mr(this.e,this.lat2,r),h=Mr(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Xt?this.ns=Math.log(n/a)/Math.log(s/l):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=n/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function oN(i){var t=i.x,e=i.y;Math.abs(2*Math.abs(e)-Math.PI)<=Xt&&(e=Tf(e)*(Bt-2*Xt));var n=Math.abs(Math.abs(e)-Bt),s,r;if(n>Xt)s=Mr(this.e,e,Math.sin(e)),r=this.a*this.f0*Math.pow(s,this.ns);else{if(n=e*this.ns,n<=0)return null;r=0}var o=this.ns*Kt(t-this.long0);return i.x=this.k0*(r*Math.sin(o))+this.x0,i.y=this.k0*(this.rh-r*Math.cos(o))+this.y0,i}function aN(i){var t,e,n,s,r,o=(i.x-this.x0)/this.k0,a=this.rh-(i.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(o*o+a*a),e=1):(t=-Math.sqrt(o*o+a*a),e=-1);var l=0;if(t!==0&&(l=Math.atan2(e*o,e*a)),t!==0||this.ns>0){if(e=1/this.ns,n=Math.pow(t/(this.a*this.f0),e),s=nf(this.e,n),s===-9999)return null}else s=-Bt;return r=Kt(l/this.ns+this.long0),i.x=r,i.y=s,i}var lN=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const hN={init:rN,forward:oN,inverse:aN,names:lN};function cN(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function uN(i){var t,e,n,s,r,o,a,l=i.x,h=i.y,c=Kt(l-this.long0);return t=Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.alfa*this.e/2),e=2*(Math.atan(this.k*Math.pow(Math.tan(h/2+this.s45),this.alfa)/t)-this.s45),n=-c*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(e)+Math.sin(this.ad)*Math.cos(e)*Math.cos(n)),r=Math.asin(Math.cos(e)*Math.sin(n)/Math.cos(s)),o=this.n*r,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),i.y=a*Math.cos(o)/1,i.x=a*Math.sin(o)/1,this.czech||(i.y*=-1,i.x*=-1),i}function dN(i){var t,e,n,s,r,o,a,l,h=i.x;i.x=i.y,i.y=h,this.czech||(i.y*=-1,i.x*=-1),o=Math.sqrt(i.x*i.x+i.y*i.y),r=Math.atan2(i.y,i.x),s=r/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(s)),e=Math.asin(Math.cos(n)*Math.sin(s)/Math.cos(t)),i.x=this.long0-e/this.alfa,a=t,l=0;var c=0;do i.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-i.y)<1e-10&&(l=1),a=i.y,c+=1;while(l===0&&c<15);return c>=15?null:i}var fN=["Krovak","krovak"];const gN={init:cN,forward:uN,inverse:dN,names:fN};function rs(i,t,e,n,s){return i*s-t*Math.sin(2*s)+e*Math.sin(4*s)-n*Math.sin(6*s)}function Af(i){return 1-.25*i*(1+i/16*(3+1.25*i))}function Pf(i){return .375*i*(1+.25*i*(1+.46875*i))}function If(i){return .05859375*i*i*(1+.75*i)}function Rf(i){return i*i*i*(35/3072)}function qc(i,t,e){var n=t*e;return i/Math.sqrt(1-n*n)}function el(i){return Math.abs(i)<Bt?i:i-Tf(i)*Math.PI}function u0(i,t,e,n,s){var r,o;r=i/t;for(var a=0;a<15;a++)if(o=(i-(t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-s*Math.sin(6*r)))/(t-2*e*Math.cos(2*r)+4*n*Math.cos(4*r)-6*s*Math.cos(6*r)),r+=o,Math.abs(o)<=1e-10)return r;return NaN}function pN(){this.sphere||(this.e0=Af(this.es),this.e1=Pf(this.es),this.e2=If(this.es),this.e3=Rf(this.es),this.ml0=this.a*rs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function mN(i){var t,e,n=i.x,s=i.y;if(n=Kt(n-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(s)*Math.sin(n)),e=this.a*(Math.atan2(Math.tan(s),Math.cos(n))-this.lat0);else{var r=Math.sin(s),o=Math.cos(s),a=qc(this.a,this.e,r),l=Math.tan(s)*Math.tan(s),h=n*Math.cos(s),c=h*h,u=this.es*o*o/(1-this.es),f=this.a*rs(this.e0,this.e1,this.e2,this.e3,s);t=a*h*(1-c*l*(1/6-(8-l+8*u)*c/120)),e=f-this.ml0+a*r/o*c*(.5+(5-l+6*u)*c/24)}return i.x=t+this.x0,i.y=e+this.y0,i}function _N(i){i.x-=this.x0,i.y-=this.y0;var t=i.x/this.a,e=i.y/this.a,n,s;if(this.sphere){var r=e+this.lat0;n=Math.asin(Math.sin(r)*Math.cos(t)),s=Math.atan2(Math.tan(t),Math.cos(r))}else{var o=this.ml0/this.a+e,a=u0(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-Bt)<=Xt)return i.x=this.long0,i.y=Bt,e<0&&(i.y*=-1),i;var l=qc(this.a,this.e,Math.sin(a)),h=l*l*l/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(a),2),u=t*this.a/l,f=u*u;n=a-l*Math.tan(a)/h*u*u*(.5-(1+3*c)*u*u/24),s=u*(1-f*(c/3+(1+3*c)*c*f/15))/Math.cos(a)}return i.x=Kt(s+this.long0),i.y=el(n),i}var yN=["Cassini","Cassini_Soldner","cass"];const vN={init:pN,forward:mN,inverse:_N,names:yN};function Ba(i,t){var e;return i>1e-7?(e=i*t,(1-i*i)*(t/(1-e*e)-.5/i*Math.log((1-e)/(1+e)))):2*t}var xN=1,bN=2,wN=3,SN=4;function EN(){var i=Math.abs(this.lat0);if(Math.abs(i-Bt)<Xt?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(i)<Xt?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var t;switch(this.qp=Ba(this.e,1),this.mmf=.5/(1-this.es),this.apa=NN(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Ba(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function CN(i){var t,e,n,s,r,o,a,l,h,c,u=i.x,f=i.y;if(u=Kt(u-this.long0),this.sphere){if(r=Math.sin(f),c=Math.cos(f),n=Math.cos(u),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e=this.mode===this.EQUIT?1+c*n:1+this.sinph0*r+this.cosph0*c*n,e<=Xt)return null;e=Math.sqrt(2/e),t=e*c*Math.sin(u),e*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*c*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(f+this.lat0)<Xt)return null;e=ei-f*.5,e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e)),t=e*Math.sin(u),e*=n}}else{switch(a=0,l=0,h=0,n=Math.cos(u),s=Math.sin(u),r=Math.sin(f),o=Ba(this.e,r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:h=1+this.sinb1*a+this.cosb1*l*n;break;case this.EQUIT:h=1+l*n;break;case this.N_POLE:h=Bt+f,o=this.qp-o;break;case this.S_POLE:h=f-Bt,o=this.qp+o;break}if(Math.abs(h)<Xt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),this.mode===this.OBLIQ?e=this.ymf*h*(this.cosb1*a-this.sinb1*l*n):e=(h=Math.sqrt(2/(1+l*n)))*a*this.ymf,t=this.xmf*h*l*s;break;case this.N_POLE:case this.S_POLE:o>=0?(t=(h=Math.sqrt(o))*s,e=n*(this.mode===this.S_POLE?h:-h)):t=e=0;break}}return i.x=this.a*t+this.x0,i.y=this.a*e+this.y0,i}function LN(i){i.x-=this.x0,i.y-=this.y0;var t=i.x/this.a,e=i.y/this.a,n,s,r,o,a,l,h;if(this.sphere){var c=0,u,f=0;if(u=Math.sqrt(t*t+e*e),s=u*.5,s>1)return null;switch(s=2*Math.asin(s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(s),c=Math.cos(s)),this.mode){case this.EQUIT:s=Math.abs(u)<=Xt?0:Math.asin(e*f/u),t*=f,e=c*u;break;case this.OBLIQ:s=Math.abs(u)<=Xt?this.lat0:Math.asin(c*this.sinph0+e*f*this.cosph0/u),t*=f*this.cosph0,e=(c-Math.sin(s)*this.sinph0)*u;break;case this.N_POLE:e=-e,s=Bt-s;break;case this.S_POLE:s-=Bt;break}n=e===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,e)}else{if(h=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,e*=this.dd,l=Math.sqrt(t*t+e*e),l<Xt)return i.x=this.long0,i.y=this.lat0,i;o=2*Math.asin(.5*l/this.rq),r=Math.cos(o),t*=o=Math.sin(o),this.mode===this.OBLIQ?(h=r*this.sinb1+e*o*this.cosb1/l,a=this.qp*h,e=l*this.cosb1*r-e*this.sinb1*o):(h=e*o/l,a=this.qp*h,e=l*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(e=-e),a=t*t+e*e,!a)return i.x=this.long0,i.y=this.lat0,i;h=1-a/this.qp,this.mode===this.S_POLE&&(h=-h)}n=Math.atan2(t,e),s=kN(Math.asin(h),this.apa)}return i.x=Kt(this.long0+n),i.y=s,i}var MN=.3333333333333333,TN=.17222222222222222,AN=.10257936507936508,PN=.06388888888888888,IN=.0664021164021164,RN=.016415012942191543;function NN(i){var t,e=[];return e[0]=i*MN,t=i*i,e[0]+=t*TN,e[1]=t*PN,t*=i,e[0]+=t*AN,e[1]+=t*IN,e[2]=t*RN,e}function kN(i,t){var e=i+i;return i+t[0]*Math.sin(e)+t[1]*Math.sin(e+e)+t[2]*Math.sin(e+e+e)}var FN=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const ON={init:EN,forward:CN,inverse:LN,names:FN,S_POLE:xN,N_POLE:bN,EQUIT:wN,OBLIQ:SN};function Ha(i){return Math.abs(i)>1&&(i=i>1?1:-1),Math.asin(i)}function DN(){Math.abs(this.lat1+this.lat2)<Xt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=co(this.e3,this.sin_po,this.cos_po),this.qs1=Ba(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=co(this.e3,this.sin_po,this.cos_po),this.qs2=Ba(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ba(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Xt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function BN(i){var t=i.x,e=i.y;this.sin_phi=Math.sin(e),this.cos_phi=Math.cos(e);var n=Ba(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,r=this.ns0*Kt(t-this.long0),o=s*Math.sin(r)+this.x0,a=this.rh-s*Math.cos(r)+this.y0;return i.x=o,i.y=a,i}function jN(i){var t,e,n,s,r,o;return i.x-=this.x0,i.y=this.rh-i.y+this.y0,this.ns0>=0?(t=Math.sqrt(i.x*i.x+i.y*i.y),n=1):(t=-Math.sqrt(i.x*i.x+i.y*i.y),n=-1),s=0,t!==0&&(s=Math.atan2(n*i.x,n*i.y)),n=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-n*n)/(2*this.ns0)):(e=(this.c-n*n)/this.ns0,o=this.phi1z(this.e3,e)),r=Kt(s/this.ns0+this.long0),i.x=r,i.y=o,i}function zN(i,t){var e,n,s,r,o,a=Ha(.5*t);if(i<Xt)return a;for(var l=i*i,h=1;h<=25;h++)if(e=Math.sin(a),n=Math.cos(a),s=i*e,r=1-s*s,o=.5*r*r/n*(t/(1-l)-e/r+.5/i*Math.log((1-s)/(1+s))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var GN=["Albers_Conic_Equal_Area","Albers","aea"];const UN={init:DN,forward:BN,inverse:jN,names:GN,phi1z:zN};function WN(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function qN(i){var t,e,n,s,r,o,a,l,h=i.x,c=i.y;return n=Kt(h-this.long0),t=Math.sin(c),e=Math.cos(c),s=Math.cos(n),o=this.sin_p14*t+this.cos_p14*e*s,r=1,o>0||Math.abs(o)<=Xt?(a=this.x0+this.a*r*e*Math.sin(n)/o,l=this.y0+this.a*r*(this.cos_p14*t-this.sin_p14*e*s)/o):(a=this.x0+this.infinity_dist*e*Math.sin(n),l=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*e*s)),i.x=a,i.y=l,i}function VN(i){var t,e,n,s,r,o;return i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,i.x/=this.k0,i.y/=this.k0,(t=Math.sqrt(i.x*i.x+i.y*i.y))?(s=Math.atan2(t,this.rc),e=Math.sin(s),n=Math.cos(s),o=Ha(n*this.sin_p14+i.y*e*this.cos_p14/t),r=Math.atan2(i.x*e,t*this.cos_p14*n-i.y*this.sin_p14*e),r=Kt(this.long0+r)):(o=this.phic0,r=0),i.x=r,i.y=o,i}var HN=["gnom"];const YN={init:WN,forward:qN,inverse:VN,names:HN};function XN(i,t){var e=1-(1-i*i)/(2*i)*Math.log((1-i)/(1+i));if(Math.abs(Math.abs(t)-e)<1e-6)return t<0?-1*Bt:Bt;for(var n=Math.asin(.5*t),s,r,o,a,l=0;l<30;l++)if(r=Math.sin(n),o=Math.cos(n),a=i*r,s=Math.pow(1-a*a,2)/(2*o)*(t/(1-i*i)-r/(1-a*a)+.5/i*Math.log((1-a)/(1+a))),n+=s,Math.abs(s)<=1e-10)return n;return NaN}function $N(){this.sphere||(this.k0=co(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function KN(i){var t=i.x,e=i.y,n,s,r=Kt(t-this.long0);if(this.sphere)n=this.x0+this.a*r*Math.cos(this.lat_ts),s=this.y0+this.a*Math.sin(e)/Math.cos(this.lat_ts);else{var o=Ba(this.e,Math.sin(e));n=this.x0+this.a*this.k0*r,s=this.y0+this.a*o*.5/this.k0}return i.x=n,i.y=s,i}function ZN(i){i.x-=this.x0,i.y-=this.y0;var t,e;return this.sphere?(t=Kt(this.long0+i.x/this.a/Math.cos(this.lat_ts)),e=Math.asin(i.y/this.a*Math.cos(this.lat_ts))):(e=XN(this.e,2*i.y*this.k0/this.a),t=Kt(this.long0+i.x/(this.a*this.k0))),i.x=t,i.y=e,i}var JN=["cea"];const QN={init:$N,forward:KN,inverse:ZN,names:JN};function tk(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function ek(i){var t=i.x,e=i.y,n=Kt(t-this.long0),s=el(e-this.lat0);return i.x=this.x0+this.a*n*this.rc,i.y=this.y0+this.a*s,i}function ik(i){var t=i.x,e=i.y;return i.x=Kt(this.long0+(t-this.x0)/(this.a*this.rc)),i.y=el(this.lat0+(e-this.y0)/this.a),i}var nk=["Equirectangular","Equidistant_Cylindrical","eqc"];const sk={init:tk,forward:ek,inverse:ik,names:nk};var v5=20;function rk(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Af(this.es),this.e1=Pf(this.es),this.e2=If(this.es),this.e3=Rf(this.es),this.ml0=this.a*rs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function ok(i){var t=i.x,e=i.y,n,s,r,o=Kt(t-this.long0);if(r=o*Math.sin(e),this.sphere)Math.abs(e)<=Xt?(n=this.a*o,s=-1*this.a*this.lat0):(n=this.a*Math.sin(r)/Math.tan(e),s=this.a*(el(e-this.lat0)+(1-Math.cos(r))/Math.tan(e)));else if(Math.abs(e)<=Xt)n=this.a*o,s=-1*this.ml0;else{var a=qc(this.a,this.e,Math.sin(e))/Math.tan(e);n=a*Math.sin(r),s=this.a*rs(this.e0,this.e1,this.e2,this.e3,e)-this.ml0+a*(1-Math.cos(r))}return i.x=n+this.x0,i.y=s+this.y0,i}function ak(i){var t,e,n,s,r,o,a,l,h;if(n=i.x-this.x0,s=i.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=Xt)t=Kt(n/this.a+this.long0),e=0;else{o=this.lat0+s/this.a,a=n*n/this.a/this.a+o*o,l=o;var c;for(r=v5;r;--r)if(c=Math.tan(l),h=-1*(o*(l*c+1)-l-.5*(l*l+a)*c)/((l-o)/c-1),l+=h,Math.abs(h)<=Xt){e=l;break}t=Kt(this.long0+Math.asin(n*Math.tan(l)/this.a)/Math.sin(e))}else if(Math.abs(s+this.ml0)<=Xt)e=0,t=Kt(this.long0+n/this.a);else{o=(this.ml0+s)/this.a,a=n*n/this.a/this.a+o*o,l=o;var u,f,d,g,p;for(r=v5;r;--r)if(p=this.e*Math.sin(l),u=Math.sqrt(1-p*p)*Math.tan(l),f=this.a*rs(this.e0,this.e1,this.e2,this.e3,l),d=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),g=f/this.a,h=(o*(u*g+1)-g-.5*u*(g*g+a))/(this.es*Math.sin(2*l)*(g*g+a-2*o*g)/(4*u)+(o-g)*(u*d-2/Math.sin(2*l))-d),l-=h,Math.abs(h)<=Xt){e=l;break}u=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e),t=Kt(this.long0+Math.asin(n*u/this.a)/Math.sin(e))}return i.x=t,i.y=e,i}var lk=["Polyconic","poly"];const hk={init:rk,forward:ok,inverse:ak,names:lk};function ck(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function uk(i){var t,e=i.x,n=i.y,s=n-this.lat0,r=e-this.long0,o=s/xd*1e-5,a=r,l=1,h=0;for(t=1;t<=10;t++)l=l*o,h=h+this.A[t]*l;var c=h,u=a,f=1,d=0,g,p,y=0,_=0;for(t=1;t<=6;t++)g=f*c-d*u,p=d*c+f*u,f=g,d=p,y=y+this.B_re[t]*f-this.B_im[t]*d,_=_+this.B_im[t]*f+this.B_re[t]*d;return i.x=_*this.a+this.x0,i.y=y*this.a+this.y0,i}function dk(i){var t,e=i.x,n=i.y,s=e-this.x0,r=n-this.y0,o=r/this.a,a=s/this.a,l=1,h=0,c,u,f=0,d=0;for(t=1;t<=6;t++)c=l*o-h*a,u=h*o+l*a,l=c,h=u,f=f+this.C_re[t]*l-this.C_im[t]*h,d=d+this.C_im[t]*l+this.C_re[t]*h;for(var g=0;g<this.iterations;g++){var p=f,y=d,_,x,b=o,L=a;for(t=2;t<=6;t++)_=p*f-y*d,x=y*f+p*d,p=_,y=x,b=b+(t-1)*(this.B_re[t]*p-this.B_im[t]*y),L=L+(t-1)*(this.B_im[t]*p+this.B_re[t]*y);p=1,y=0;var M=this.B_re[1],k=this.B_im[1];for(t=2;t<=6;t++)_=p*f-y*d,x=y*f+p*d,p=_,y=x,M=M+t*(this.B_re[t]*p-this.B_im[t]*y),k=k+t*(this.B_im[t]*p+this.B_re[t]*y);var A=M*M+k*k;f=(b*M+L*k)/A,d=(L*M-b*k)/A}var T=f,F=d,q=1,R=0;for(t=1;t<=9;t++)q=q*T,R=R+this.D[t]*q;var S=this.lat0+R*xd*1e5,O=this.long0+F;return i.x=O,i.y=S,i}var fk=["New_Zealand_Map_Grid","nzmg"];const gk={init:ck,forward:uk,inverse:dk,names:fk};function pk(){}function mk(i){var t=i.x,e=i.y,n=Kt(t-this.long0),s=this.x0+this.a*n,r=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return i.x=s,i.y=r,i}function _k(i){i.x-=this.x0,i.y-=this.y0;var t=Kt(this.long0+i.x/this.a),e=2.5*(Math.atan(Math.exp(.8*i.y/this.a))-Math.PI/4);return i.x=t,i.y=e,i}var yk=["Miller_Cylindrical","mill"];const vk={init:pk,forward:mk,inverse:_k,names:yk};var xk=20;function bk(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=P2(this.es)}function wk(i){var t,e,n=i.x,s=i.y;if(n=Kt(n-this.long0),this.sphere){if(!this.m)s=this.n!==1?Math.asin(this.n*Math.sin(s)):s;else for(var r=this.n*Math.sin(s),o=xk;o;--o){var a=(this.m*s+Math.sin(s)-r)/(this.m+Math.cos(s));if(s-=a,Math.abs(a)<Xt)break}t=this.a*this.C_x*n*(this.m+Math.cos(s)),e=this.a*this.C_y*s}else{var l=Math.sin(s),h=Math.cos(s);e=this.a*tu(s,l,h,this.en),t=this.a*n*h/Math.sqrt(1-this.es*l*l)}return i.x=t,i.y=e,i}function Sk(i){var t,e,n,s;return i.x-=this.x0,n=i.x/this.a,i.y-=this.y0,t=i.y/this.a,this.sphere?(t/=this.C_y,n=n/(this.C_x*(this.m+Math.cos(t))),this.m?t=Ha((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=Ha(Math.sin(t)/this.n)),n=Kt(n+this.long0),t=el(t)):(t=I2(i.y/this.a,this.es,this.en),s=Math.abs(t),s<Bt?(s=Math.sin(t),e=this.long0+i.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(t)),n=Kt(e)):s-Xt<Bt&&(n=this.long0)),i.x=n,i.y=t,i}var Ek=["Sinusoidal","sinu"];const Ck={init:bk,forward:wk,inverse:Sk,names:Ek};function Lk(){}function Mk(i){for(var t=i.x,e=i.y,n=Kt(t-this.long0),s=e,r=Math.PI*Math.sin(e);;){var o=-(s+Math.sin(s)-r)/(1+Math.cos(s));if(s+=o,Math.abs(o)<Xt)break}s/=2,Math.PI/2-Math.abs(e)<Xt&&(n=0);var a=.900316316158*this.a*n*Math.cos(s)+this.x0,l=1.4142135623731*this.a*Math.sin(s)+this.y0;return i.x=a,i.y=l,i}function Tk(i){var t,e;i.x-=this.x0,i.y-=this.y0,e=i.y/(1.4142135623731*this.a),Math.abs(e)>.999999999999&&(e=.999999999999),t=Math.asin(e);var n=Kt(this.long0+i.x/(.900316316158*this.a*Math.cos(t)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),e=(2*t+Math.sin(2*t))/Math.PI,Math.abs(e)>1&&(e=1);var s=Math.asin(e);return i.x=n,i.y=s,i}var Ak=["Mollweide","moll"];const Pk={init:Lk,forward:Mk,inverse:Tk,names:Ak};function Ik(){Math.abs(this.lat1+this.lat2)<Xt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Af(this.es),this.e1=Pf(this.es),this.e2=If(this.es),this.e3=Rf(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=co(this.e,this.sinphi,this.cosphi),this.ml1=rs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Xt?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=co(this.e,this.sinphi,this.cosphi),this.ml2=rs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=rs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Rk(i){var t=i.x,e=i.y,n;if(this.sphere)n=this.a*(this.g-e);else{var s=rs(this.e0,this.e1,this.e2,this.e3,e);n=this.a*(this.g-s)}var r=this.ns*Kt(t-this.long0),o=this.x0+n*Math.sin(r),a=this.y0+this.rh-n*Math.cos(r);return i.x=o,i.y=a,i}function Nk(i){i.x-=this.x0,i.y=this.rh-i.y+this.y0;var t,e,n,s;this.ns>=0?(e=Math.sqrt(i.x*i.x+i.y*i.y),t=1):(e=-Math.sqrt(i.x*i.x+i.y*i.y),t=-1);var r=0;if(e!==0&&(r=Math.atan2(t*i.x,t*i.y)),this.sphere)return s=Kt(this.long0+r/this.ns),n=el(this.g-e/this.a),i.x=s,i.y=n,i;var o=this.g-e/this.a;return n=u0(o,this.e0,this.e1,this.e2,this.e3),s=Kt(this.long0+r/this.ns),i.x=s,i.y=n,i}var kk=["Equidistant_Conic","eqdc"];const Fk={init:Ik,forward:Rk,inverse:Nk,names:kk};function Ok(){this.R=this.a}function Dk(i){var t=i.x,e=i.y,n=Kt(t-this.long0),s,r;Math.abs(e)<=Xt&&(s=this.x0+this.R*n,r=this.y0);var o=Ha(2*Math.abs(e/Math.PI));(Math.abs(n)<=Xt||Math.abs(Math.abs(e)-Bt)<=Xt)&&(s=this.x0,e>=0?r=this.y0+Math.PI*this.R*Math.tan(.5*o):r=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/n-n/Math.PI),l=a*a,h=Math.sin(o),c=Math.cos(o),u=c/(h+c-1),f=u*u,d=u*(2/h-1),g=d*d,p=Math.PI*this.R*(a*(u-g)+Math.sqrt(l*(u-g)*(u-g)-(g+l)*(f-g)))/(g+l);n<0&&(p=-p),s=this.x0+p;var y=l+u;return p=Math.PI*this.R*(d*y-a*Math.sqrt((g+l)*(l+1)-y*y))/(g+l),e>=0?r=this.y0+p:r=this.y0-p,i.x=s,i.y=r,i}function Bk(i){var t,e,n,s,r,o,a,l,h,c,u,f,d;return i.x-=this.x0,i.y-=this.y0,u=Math.PI*this.R,n=i.x/u,s=i.y/u,r=n*n+s*s,o=-Math.abs(s)*(1+r),a=o-2*s*s+n*n,l=-2*o+1+2*s*s+r*r,d=s*s/l+(2*a*a*a/l/l/l-9*o*a/l/l)/27,h=(o-a*a/3/l)/l,c=2*Math.sqrt(-h/3),u=3*d/h/c,Math.abs(u)>1&&(u>=0?u=1:u=-1),f=Math.acos(u)/3,i.y>=0?e=(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:e=-(-c*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,Math.abs(n)<Xt?t=this.long0:t=Kt(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(n*n-s*s)+r*r))/2/n),i.x=t,i.y=e,i}var jk=["Van_der_Grinten_I","VanDerGrinten","vandg"];const zk={init:Ok,forward:Dk,inverse:Bk,names:jk};function Gk(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Uk(i){var t=i.x,e=i.y,n=Math.sin(i.y),s=Math.cos(i.y),r=Kt(t-this.long0),o,a,l,h,c,u,f,d,g,p,y,_,x,b,L,M,k,A,T,F,q,R,S;return this.sphere?Math.abs(this.sin_p12-1)<=Xt?(i.x=this.x0+this.a*(Bt-e)*Math.sin(r),i.y=this.y0-this.a*(Bt-e)*Math.cos(r),i):Math.abs(this.sin_p12+1)<=Xt?(i.x=this.x0+this.a*(Bt+e)*Math.sin(r),i.y=this.y0+this.a*(Bt+e)*Math.cos(r),i):(A=this.sin_p12*n+this.cos_p12*s*Math.cos(r),M=Math.acos(A),k=M?M/Math.sin(M):1,i.x=this.x0+this.a*k*s*Math.sin(r),i.y=this.y0+this.a*k*(this.cos_p12*n-this.sin_p12*s*Math.cos(r)),i):(o=Af(this.es),a=Pf(this.es),l=If(this.es),h=Rf(this.es),Math.abs(this.sin_p12-1)<=Xt?(c=this.a*rs(o,a,l,h,Bt),u=this.a*rs(o,a,l,h,e),i.x=this.x0+(c-u)*Math.sin(r),i.y=this.y0-(c-u)*Math.cos(r),i):Math.abs(this.sin_p12+1)<=Xt?(c=this.a*rs(o,a,l,h,Bt),u=this.a*rs(o,a,l,h,e),i.x=this.x0+(c+u)*Math.sin(r),i.y=this.y0+(c+u)*Math.cos(r),i):(f=n/s,d=qc(this.a,this.e,this.sin_p12),g=qc(this.a,this.e,n),p=Math.atan((1-this.es)*f+this.es*d*this.sin_p12/(g*s)),y=Math.atan2(Math.sin(r),this.cos_p12*Math.tan(p)-this.sin_p12*Math.cos(r)),y===0?T=Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.abs(Math.abs(y)-Math.PI)<=Xt?T=-Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):T=Math.asin(Math.sin(r)*Math.cos(p)/Math.sin(y)),_=this.e*this.sin_p12/Math.sqrt(1-this.es),x=this.e*this.cos_p12*Math.cos(y)/Math.sqrt(1-this.es),b=_*x,L=x*x,F=T*T,q=F*T,R=q*T,S=R*T,M=d*T*(1-F*L*(1-L)/6+q/8*b*(1-2*L)+R/120*(L*(4-7*L)-3*_*_*(1-7*L))-S/48*b),i.x=this.x0+M*Math.sin(y),i.y=this.y0+M*Math.cos(y),i))}function Wk(i){i.x-=this.x0,i.y-=this.y0;var t,e,n,s,r,o,a,l,h,c,u,f,d,g,p,y,_,x,b,L,M,k,A,T;return this.sphere?(t=Math.sqrt(i.x*i.x+i.y*i.y),t>2*Bt*this.a?void 0:(e=t/this.a,n=Math.sin(e),s=Math.cos(e),r=this.long0,Math.abs(t)<=Xt?o=this.lat0:(o=Ha(s*this.sin_p12+i.y*n*this.cos_p12/t),a=Math.abs(this.lat0)-Bt,Math.abs(a)<=Xt?this.lat0>=0?r=Kt(this.long0+Math.atan2(i.x,-i.y)):r=Kt(this.long0-Math.atan2(-i.x,i.y)):r=Kt(this.long0+Math.atan2(i.x*n,t*this.cos_p12*s-i.y*this.sin_p12*n))),i.x=r,i.y=o,i)):(l=Af(this.es),h=Pf(this.es),c=If(this.es),u=Rf(this.es),Math.abs(this.sin_p12-1)<=Xt?(f=this.a*rs(l,h,c,u,Bt),t=Math.sqrt(i.x*i.x+i.y*i.y),d=f-t,o=u0(d/this.a,l,h,c,u),r=Kt(this.long0+Math.atan2(i.x,-1*i.y)),i.x=r,i.y=o,i):Math.abs(this.sin_p12+1)<=Xt?(f=this.a*rs(l,h,c,u,Bt),t=Math.sqrt(i.x*i.x+i.y*i.y),d=t-f,o=u0(d/this.a,l,h,c,u),r=Kt(this.long0+Math.atan2(i.x,i.y)),i.x=r,i.y=o,i):(t=Math.sqrt(i.x*i.x+i.y*i.y),y=Math.atan2(i.x,i.y),g=qc(this.a,this.e,this.sin_p12),_=Math.cos(y),x=this.e*this.cos_p12*_,b=-x*x/(1-this.es),L=3*this.es*(1-b)*this.sin_p12*this.cos_p12*_/(1-this.es),M=t/g,k=M-b*(1+b)*Math.pow(M,3)/6-L*(1+3*b)*Math.pow(M,4)/24,A=1-b*k*k/2-M*k*k*k/6,p=Math.asin(this.sin_p12*Math.cos(k)+this.cos_p12*Math.sin(k)*_),r=Kt(this.long0+Math.asin(Math.sin(y)*Math.sin(k)/Math.cos(p))),T=Math.sin(p),o=Math.atan2((T-this.es*A*this.sin_p12)*Math.tan(p),T*(1-this.es)),i.x=r,i.y=o,i))}var qk=["Azimuthal_Equidistant","aeqd"];const Vk={init:Gk,forward:Uk,inverse:Wk,names:qk};function Hk(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Yk(i){var t,e,n,s,r,o,a,l,h=i.x,c=i.y;return n=Kt(h-this.long0),t=Math.sin(c),e=Math.cos(c),s=Math.cos(n),o=this.sin_p14*t+this.cos_p14*e*s,r=1,(o>0||Math.abs(o)<=Xt)&&(a=this.a*r*e*Math.sin(n),l=this.y0+this.a*r*(this.cos_p14*t-this.sin_p14*e*s)),i.x=a,i.y=l,i}function Xk(i){var t,e,n,s,r,o,a;return i.x-=this.x0,i.y-=this.y0,t=Math.sqrt(i.x*i.x+i.y*i.y),e=Ha(t/this.a),n=Math.sin(e),s=Math.cos(e),o=this.long0,Math.abs(t)<=Xt?(a=this.lat0,i.x=o,i.y=a,i):(a=Ha(s*this.sin_p14+i.y*n*this.cos_p14/t),r=Math.abs(this.lat0)-Bt,Math.abs(r)<=Xt?(this.lat0>=0?o=Kt(this.long0+Math.atan2(i.x,-i.y)):o=Kt(this.long0-Math.atan2(-i.x,i.y)),i.x=o,i.y=a,i):(o=Kt(this.long0+Math.atan2(i.x*n,t*this.cos_p14*s-i.y*this.sin_p14*n)),i.x=o,i.y=a,i))}var $k=["ortho"];const Kk={init:Hk,forward:Yk,inverse:Xk,names:$k};var Ii={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},ii={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Zk(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Bt-ei/2?this.face=Ii.TOP:this.lat0<=-(Bt-ei/2)?this.face=Ii.BOTTOM:Math.abs(this.long0)<=ei?this.face=Ii.FRONT:Math.abs(this.long0)<=Bt+ei?this.face=this.long0>0?Ii.RIGHT:Ii.LEFT:this.face=Ii.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Jk(i){var t={x:0,y:0},e,n,s,r,o,a,l={value:0};if(i.x-=this.long0,this.es!==0?e=Math.atan(this.one_minus_f_squared*Math.tan(i.y)):e=i.y,n=i.x,this.face===Ii.TOP)r=Bt-e,n>=ei&&n<=Bt+ei?(l.value=ii.AREA_0,s=n-Bt):n>Bt+ei||n<=-(Bt+ei)?(l.value=ii.AREA_1,s=n>0?n-Yi:n+Yi):n>-(Bt+ei)&&n<=-ei?(l.value=ii.AREA_2,s=n+Bt):(l.value=ii.AREA_3,s=n);else if(this.face===Ii.BOTTOM)r=Bt+e,n>=ei&&n<=Bt+ei?(l.value=ii.AREA_0,s=-n+Bt):n<ei&&n>=-ei?(l.value=ii.AREA_1,s=-n):n<-ei&&n>=-(Bt+ei)?(l.value=ii.AREA_2,s=-n-Bt):(l.value=ii.AREA_3,s=n>0?-n+Yi:-n-Yi);else{var h,c,u,f,d,g,p;this.face===Ii.RIGHT?n=xc(n,+Bt):this.face===Ii.BACK?n=xc(n,+Yi):this.face===Ii.LEFT&&(n=xc(n,-Bt)),f=Math.sin(e),d=Math.cos(e),g=Math.sin(n),p=Math.cos(n),h=d*p,c=d*g,u=f,this.face===Ii.FRONT?(r=Math.acos(h),s=jg(r,u,c,l)):this.face===Ii.RIGHT?(r=Math.acos(c),s=jg(r,u,-h,l)):this.face===Ii.BACK?(r=Math.acos(-h),s=jg(r,u,-c,l)):this.face===Ii.LEFT?(r=Math.acos(-c),s=jg(r,u,h,l)):(r=s=0,l.value=ii.AREA_0)}return a=Math.atan(12/Yi*(s+Math.acos(Math.sin(s)*Math.cos(ei))-Bt)),o=Math.sqrt((1-Math.cos(r))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(s))))),l.value===ii.AREA_1?a+=Bt:l.value===ii.AREA_2?a+=Yi:l.value===ii.AREA_3&&(a+=1.5*Yi),t.x=o*Math.cos(a),t.y=o*Math.sin(a),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,i.x=t.x,i.y=t.y,i}function Qk(i){var t={lam:0,phi:0},e,n,s,r,o,a,l,h,c,u={value:0};if(i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a,n=Math.atan(Math.sqrt(i.x*i.x+i.y*i.y)),e=Math.atan2(i.y,i.x),i.x>=0&&i.x>=Math.abs(i.y)?u.value=ii.AREA_0:i.y>=0&&i.y>=Math.abs(i.x)?(u.value=ii.AREA_1,e-=Bt):i.x<0&&-i.x>=Math.abs(i.y)?(u.value=ii.AREA_2,e=e<0?e+Yi:e-Yi):(u.value=ii.AREA_3,e+=Bt),c=Yi/12*Math.tan(e),o=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),a=Math.atan(o),s=Math.cos(e),r=Math.tan(n),l=1-s*s*r*r*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Ii.TOP)h=Math.acos(l),t.phi=Bt-h,u.value===ii.AREA_0?t.lam=a+Bt:u.value===ii.AREA_1?t.lam=a<0?a+Yi:a-Yi:u.value===ii.AREA_2?t.lam=a-Bt:t.lam=a;else if(this.face===Ii.BOTTOM)h=Math.acos(l),t.phi=h-Bt,u.value===ii.AREA_0?t.lam=-a+Bt:u.value===ii.AREA_1?t.lam=-a:u.value===ii.AREA_2?t.lam=-a-Bt:t.lam=a<0?-a-Yi:-a+Yi;else{var f,d,g;f=l,c=f*f,c>=1?g=0:g=Math.sqrt(1-c)*Math.sin(a),c+=g*g,c>=1?d=0:d=Math.sqrt(1-c),u.value===ii.AREA_1?(c=d,d=-g,g=c):u.value===ii.AREA_2?(d=-d,g=-g):u.value===ii.AREA_3&&(c=d,d=g,g=-c),this.face===Ii.RIGHT?(c=f,f=-d,d=c):this.face===Ii.BACK?(f=-f,d=-d):this.face===Ii.LEFT&&(c=f,f=d,d=-c),t.phi=Math.acos(-g)-Bt,t.lam=Math.atan2(d,f),this.face===Ii.RIGHT?t.lam=xc(t.lam,-Bt):this.face===Ii.BACK?t.lam=xc(t.lam,-Yi):this.face===Ii.LEFT&&(t.lam=xc(t.lam,+Bt))}if(this.es!==0){var p,y,_;p=t.phi<0?1:0,y=Math.tan(t.phi),_=this.b/Math.sqrt(y*y+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-_*_)/(this.one_minus_f*_)),p&&(t.phi=-t.phi)}return t.lam+=this.long0,i.x=t.lam,i.y=t.phi,i}function jg(i,t,e,n){var s;return i<Xt?(n.value=ii.AREA_0,s=0):(s=Math.atan2(t,e),Math.abs(s)<=ei?n.value=ii.AREA_0:s>ei&&s<=Bt+ei?(n.value=ii.AREA_1,s-=Bt):s>Bt+ei||s<=-(Bt+ei)?(n.value=ii.AREA_2,s=s>=0?s-Yi:s+Yi):(n.value=ii.AREA_3,s+=Bt)),s}function xc(i,t){var e=i+t;return e<-Yi?e+=tf:e>+Yi&&(e-=tf),e}var t6=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const e6={init:Zk,forward:Jk,inverse:Qk,names:t6};var G_=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ad=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],JE=.8487,QE=1.3523,tC=Qr/5,i6=1/tC,gc=18,d0=function(i,t){return i[0]+t*(i[1]+t*(i[2]+t*i[3]))},n6=function(i,t){return i[1]+t*(2*i[2]+t*3*i[3])};function s6(i,t,e,n){for(var s=t;n;--n){var r=i(s);if(s-=r,Math.abs(r)<e)break}return s}function r6(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function o6(i){var t=Kt(i.x-this.long0),e=Math.abs(i.y),n=Math.floor(e*tC);n<0?n=0:n>=gc&&(n=gc-1),e=Qr*(e-i6*n);var s={x:d0(G_[n],e)*t,y:d0(ad[n],e)};return i.y<0&&(s.y=-s.y),s.x=s.x*this.a*JE+this.x0,s.y=s.y*this.a*QE+this.y0,s}function a6(i){var t={x:(i.x-this.x0)/(this.a*JE),y:Math.abs(i.y-this.y0)/(this.a*QE)};if(t.y>=1)t.x/=G_[gc][0],t.y=i.y<0?-Bt:Bt;else{var e=Math.floor(t.y*gc);for(e<0?e=0:e>=gc&&(e=gc-1);;)if(ad[e][0]>t.y)--e;else if(ad[e+1][0]<=t.y)++e;else break;var n=ad[e],s=5*(t.y-n[0])/(ad[e+1][0]-n[0]);s=s6(function(r){return(d0(n,r)-t.y)/n6(n,r)},s,Xt,100),t.x/=d0(G_[e],s),t.y=(5*e+s)*Tn,i.y<0&&(t.y=-t.y)}return t.x=Kt(t.x+this.long0),t}var l6=["Robinson","robin"];const h6={init:r6,forward:o6,inverse:a6,names:l6};function c6(){this.name="geocent"}function u6(i){var t=GE(i,this.es,this.a);return t}function d6(i){var t=UE(i,this.es,this.a,this.b);return t}var f6=["Geocentric","geocentric","geocent","Geocent"];const g6={init:c6,forward:u6,inverse:d6,names:f6};var Gn={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Gu={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function p6(){if(Object.keys(Gu).forEach((function(e){if(typeof this[e]>"u")this[e]=Gu[e].def;else{if(Gu[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);Gu[e].num&&(this[e]=parseFloat(this[e]))}Gu[e].degrees&&(this[e]=this[e]*Tn)}).bind(this)),Math.abs(Math.abs(this.lat0)-Bt)<Xt?this.mode=this.lat0<0?Gn.S_POLE:Gn.N_POLE:Math.abs(this.lat0)<Xt?this.mode=Gn.EQUIT:(this.mode=Gn.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var i=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(i),this.sw=Math.sin(i)}function m6(i){i.x-=this.long0;var t=Math.sin(i.y),e=Math.cos(i.y),n=Math.cos(i.x),s,r;switch(this.mode){case Gn.OBLIQ:r=this.sinph0*t+this.cosph0*e*n;break;case Gn.EQUIT:r=e*n;break;case Gn.S_POLE:r=-t;break;case Gn.N_POLE:r=t;break}switch(r=this.pn1/(this.p-r),s=r*e*Math.sin(i.x),this.mode){case Gn.OBLIQ:r*=this.cosph0*t-this.sinph0*e*n;break;case Gn.EQUIT:r*=t;break;case Gn.N_POLE:r*=-(e*n);break;case Gn.S_POLE:r*=e*n;break}var o,a;return o=r*this.cg+s*this.sg,a=1/(o*this.sw*this.h1+this.cw),s=(s*this.cg-r*this.sg)*this.cw*a,r=o*a,i.x=s*this.a,i.y=r*this.a,i}function _6(i){i.x/=this.a,i.y/=this.a;var t={x:i.x,y:i.y},e,n,s;s=1/(this.pn1-i.y*this.sw),e=this.pn1*i.x*s,n=this.pn1*i.y*this.cw*s,i.x=e*this.cg+n*this.sg,i.y=n*this.cg-e*this.sg;var r=xs(i.x,i.y);if(Math.abs(r)<Xt)t.x=0,t.y=i.y;else{var o,a;switch(a=1-r*r*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/r+r/this.pn1),o=Math.sqrt(1-a*a),this.mode){case Gn.OBLIQ:t.y=Math.asin(o*this.sinph0+i.y*a*this.cosph0/r),i.y=(o-this.sinph0*Math.sin(t.y))*r,i.x*=a*this.cosph0;break;case Gn.EQUIT:t.y=Math.asin(i.y*a/r),i.y=o*r,i.x*=a;break;case Gn.N_POLE:t.y=Math.asin(o),i.y=-i.y;break;case Gn.S_POLE:t.y=-Math.asin(o);break}t.x=Math.atan2(i.x,i.y)}return i.x=t.x+this.long0,i.y=t.y,i}var y6=["Tilted_Perspective","tpers"];const v6={init:p6,forward:m6,inverse:_6,names:y6};function x6(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var i=1-this.es,t=1/i;this.radius_p=Math.sqrt(i),this.radius_p2=i,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function b6(i){var t=i.x,e=i.y,n,s,r,o;if(t=t-this.long0,this.shape==="ellipse"){e=Math.atan(this.radius_p2*Math.tan(e));var a=this.radius_p/xs(this.radius_p*Math.cos(e),Math.sin(e));if(s=a*Math.cos(t)*Math.cos(e),r=a*Math.sin(t)*Math.cos(e),o=a*Math.sin(e),(this.radius_g-s)*s-r*r-o*o*this.radius_p_inv2<0)return i.x=Number.NaN,i.y=Number.NaN,i;n=this.radius_g-s,this.flip_axis?(i.x=this.radius_g_1*Math.atan(r/xs(o,n)),i.y=this.radius_g_1*Math.atan(o/n)):(i.x=this.radius_g_1*Math.atan(r/n),i.y=this.radius_g_1*Math.atan(o/xs(r,n)))}else this.shape==="sphere"&&(n=Math.cos(e),s=Math.cos(t)*n,r=Math.sin(t)*n,o=Math.sin(e),n=this.radius_g-s,this.flip_axis?(i.x=this.radius_g_1*Math.atan(r/xs(o,n)),i.y=this.radius_g_1*Math.atan(o/n)):(i.x=this.radius_g_1*Math.atan(r/n),i.y=this.radius_g_1*Math.atan(o/xs(r,n))));return i.x=i.x*this.a,i.y=i.y*this.a,i}function w6(i){var t=-1,e=0,n=0,s,r,o,a;if(i.x=i.x/this.a,i.y=i.y/this.a,this.shape==="ellipse"){this.flip_axis?(n=Math.tan(i.y/this.radius_g_1),e=Math.tan(i.x/this.radius_g_1)*xs(1,n)):(e=Math.tan(i.x/this.radius_g_1),n=Math.tan(i.y/this.radius_g_1)*xs(1,e));var l=n/this.radius_p;if(s=e*e+l*l+t*t,r=2*this.radius_g*t,o=r*r-4*s*this.C,o<0)return i.x=Number.NaN,i.y=Number.NaN,i;a=(-r-Math.sqrt(o))/(2*s),t=this.radius_g+a*t,e*=a,n*=a,i.x=Math.atan2(e,t),i.y=Math.atan(n*Math.cos(i.x)/t),i.y=Math.atan(this.radius_p_inv2*Math.tan(i.y))}else if(this.shape==="sphere"){if(this.flip_axis?(n=Math.tan(i.y/this.radius_g_1),e=Math.tan(i.x/this.radius_g_1)*Math.sqrt(1+n*n)):(e=Math.tan(i.x/this.radius_g_1),n=Math.tan(i.y/this.radius_g_1)*Math.sqrt(1+e*e)),s=e*e+n*n+t*t,r=2*this.radius_g*t,o=r*r-4*s*this.C,o<0)return i.x=Number.NaN,i.y=Number.NaN,i;a=(-r-Math.sqrt(o))/(2*s),t=this.radius_g+a*t,e*=a,n*=a,i.x=Math.atan2(e,t),i.y=Math.atan(n*Math.cos(i.x)/t)}return i.x=i.x+this.long0,i}var S6=["Geostationary Satellite View","Geostationary_Satellite","geos"];const E6={init:x6,forward:b6,inverse:w6,names:S6};var bd=1.340264,wd=-.081106,Sd=893e-6,Ed=.003796,f0=Math.sqrt(3)/2;function C6(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function L6(i){var t=Kt(i.x-this.long0),e=i.y,n=Math.asin(f0*Math.sin(e)),s=n*n,r=s*s*s;return i.x=t*Math.cos(n)/(f0*(bd+3*wd*s+r*(7*Sd+9*Ed*s))),i.y=n*(bd+wd*s+r*(Sd+Ed*s)),i.x=this.a*i.x+this.x0,i.y=this.a*i.y+this.y0,i}function M6(i){i.x=(i.x-this.x0)/this.a,i.y=(i.y-this.y0)/this.a;var t=1e-9,e=12,n=i.y,s,r,o,a,l,h;for(h=0;h<e&&(s=n*n,r=s*s*s,o=n*(bd+wd*s+r*(Sd+Ed*s))-i.y,a=bd+3*wd*s+r*(7*Sd+9*Ed*s),n-=l=o/a,!(Math.abs(l)<t));++h);return s=n*n,r=s*s*s,i.x=f0*i.x*(bd+3*wd*s+r*(7*Sd+9*Ed*s))/Math.cos(n),i.y=Math.asin(Math.sin(n)/f0),i.x=Kt(i.x+this.long0),i}var T6=["eqearth","Equal Earth","Equal_Earth"];const A6={init:C6,forward:L6,inverse:M6,names:T6};var sf=1e-10;function P6(){var i;if(this.phi1=this.lat1,Math.abs(this.phi1)<sf)throw new Error;this.es?(this.en=P2(this.es),this.m1=tu(this.phi1,this.am1=Math.sin(this.phi1),i=Math.cos(this.phi1),this.en),this.am1=i/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=R6,this.forward=I6):(Math.abs(this.phi1)+sf>=Bt?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=k6,this.forward=N6)}function I6(i){var t=Kt(i.x-(this.long0||0)),e=i.y,n,s,r;return n=this.am1+this.m1-tu(e,s=Math.sin(e),r=Math.cos(e),this.en),s=r*t/(n*Math.sqrt(1-this.es*s*s)),i.x=n*Math.sin(s),i.y=this.am1-n*Math.cos(s),i.x=this.a*i.x+(this.x0||0),i.y=this.a*i.y+(this.y0||0),i}function R6(i){i.x=(i.x-(this.x0||0))/this.a,i.y=(i.y-(this.y0||0))/this.a;var t,e,n,s;if(e=xs(i.x,i.y=this.am1-i.y),s=I2(this.am1+this.m1-e,this.es,this.en),(t=Math.abs(s))<Bt)t=Math.sin(s),n=e*Math.atan2(i.x,i.y)*Math.sqrt(1-this.es*t*t)/Math.cos(s);else if(Math.abs(t-Bt)<=sf)n=0;else throw new Error;return i.x=Kt(n+(this.long0||0)),i.y=el(s),i}function N6(i){var t=Kt(i.x-(this.long0||0)),e=i.y,n,s;return s=this.cphi1+this.phi1-e,Math.abs(s)>sf?(i.x=s*Math.sin(n=t*Math.cos(e)/s),i.y=this.cphi1-s*Math.cos(n)):i.x=i.y=0,i.x=this.a*i.x+(this.x0||0),i.y=this.a*i.y+(this.y0||0),i}function k6(i){i.x=(i.x-(this.x0||0))/this.a,i.y=(i.y-(this.y0||0))/this.a;var t,e,n=xs(i.x,i.y=this.cphi1-i.y);if(e=this.cphi1+this.phi1-n,Math.abs(e)>Bt)throw new Error;return Math.abs(Math.abs(e)-Bt)<=sf?t=0:t=n*Math.atan2(i.x,i.y)/Math.cos(e),i.x=Kt(t+(this.long0||0)),i.y=el(e),i}var F6=["bonne","Bonne (Werner lat_1=90)"];const O6={init:P6,names:F6};function D6(i){i.Proj.projections.add(wp),i.Proj.projections.add(Sp),i.Proj.projections.add(IR),i.Proj.projections.add(GR),i.Proj.projections.add(YR),i.Proj.projections.add(JR),i.Proj.projections.add(sN),i.Proj.projections.add(hN),i.Proj.projections.add(gN),i.Proj.projections.add(vN),i.Proj.projections.add(ON),i.Proj.projections.add(UN),i.Proj.projections.add(YN),i.Proj.projections.add(QN),i.Proj.projections.add(sk),i.Proj.projections.add(hk),i.Proj.projections.add(gk),i.Proj.projections.add(vk),i.Proj.projections.add(Ck),i.Proj.projections.add(Pk),i.Proj.projections.add(Fk),i.Proj.projections.add(zk),i.Proj.projections.add(Vk),i.Proj.projections.add(Kk),i.Proj.projections.add(e6),i.Proj.projections.add(h6),i.Proj.projections.add(g6),i.Proj.projections.add(v6),i.Proj.projections.add(E6),i.Proj.projections.add(A6),i.Proj.projections.add(O6)}Cn.defaultDatum="WGS84";Cn.Proj=so;Cn.WGS84=new Cn.Proj("WGS84");Cn.Point=Wc;Cn.toPoint=WE;Cn.defs=ts;Cn.nadgrid=N4;Cn.transform=c0;Cn.mgrs=$4;Cn.version="__VERSION__";D6(Cn);function F2(i){const t=Object.keys(i.defs),e=t.length;let n,s;for(n=0;n<e;++n){const r=t[n];if(!xe(r)){const o=i.defs(r);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),cS(new Ql({code:r,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(n=0;n<e;++n){const r=t[n],o=xe(r);for(s=0;s<e;++s){const a=t[s],l=xe(a);if(!nS(r,a))if(i.defs[r]===i.defs[a])b_([o,l]);else{const h=i(r,a);KM(o,l,_x(o,l,h.forward),_x(l,o,h.inverse))}}}}const x5=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],b5={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class B6 extends Ms{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target}),this.on,this.once,this.un,this.keys_=t.keys!==void 0?t.keys:!1,this.source_=t.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=t.className!==void 0?t.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=t.activeClassName!==void 0?t.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=t.inactiveClassName!==void 0?t.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const e=t.label!==void 0?t.label:"⤢";this.labelNode_=typeof e=="string"?document.createTextNode(e):e;const n=t.labelActive!==void 0?t.labelActive:"×";this.labelActiveNode_=typeof n=="string"?document.createTextNode(n):n;const s=t.tipLabel?t.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=s,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(ce.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${Zc} ${Y0}`,this.element.appendChild(this.button_)}handleClick_(t){t.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const t=this.getMap();if(!t)return;const e=t.getOwnerDocument();if(w5(e))if(S5(e))z6(e);else{let n;this.source_?n=typeof this.source_=="string"?e.getElementById(this.source_):this.source_:n=t.getTargetElement(),this.keys_?j6(n):eC(n)}}handleFullScreenChange_(){const t=this.getMap();if(!t)return;const e=this.isInFullscreen_;this.isInFullscreen_=S5(t.getOwnerDocument()),e!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Yp(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(b5.ENTERFULLSCREEN)):(Yp(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(b5.LEAVEFULLSCREEN)),t.updateSize())}setClassName_(t,e){e?(t.classList.remove(...this.inactiveClassName_),t.classList.add(...this.activeClassName_)):(t.classList.remove(...this.activeClassName_),t.classList.add(...this.inactiveClassName_))}setMap(t){const e=this.getMap();e&&e.removeChangeListener(vn.TARGET,this.boundHandleMapTargetChange_),super.setMap(t),this.handleMapTargetChange_(),t&&t.addChangeListener(vn.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const t=this.documentListeners_;for(let n=0,s=t.length;n<s;++n)Ke(t[n]);t.length=0;const e=this.getMap();if(e){const n=e.getOwnerDocument();w5(n)?this.element.classList.remove(Cx):this.element.classList.add(Cx);for(let s=0,r=x5.length;s<r;++s)t.push(ve(n,x5[s],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function w5(i){const t=i.body;return!!(t.webkitRequestFullscreen||t.requestFullscreen&&i.fullscreenEnabled)}function S5(i){return!!(i.webkitIsFullScreen||i.fullscreenElement)}function eC(i){i.requestFullscreen?i.requestFullscreen():i.webkitRequestFullscreen&&i.webkitRequestFullscreen()}function j6(i){i.webkitRequestFullscreen?i.webkitRequestFullscreen():eC(i)}function z6(i){i.exitFullscreen?i.exitFullscreen():i.webkitExitFullscreen&&i.webkitExitFullscreen()}const R1="projection",E5="coordinateFormat";class G6 extends Ms{constructor(t){t=t||{};const e=document.createElement("div");e.className=t.className!==void 0?t.className:"ol-mouse-position",super({element:e,render:t.render,target:t.target}),this.on,this.once,this.un,this.addChangeListener(R1,this.handleProjectionChanged_),t.coordinateFormat&&this.setCoordinateFormat(t.coordinateFormat),t.projection&&this.setProjection(t.projection),this.renderOnMouseOut_=t.placeholder!==void 0,this.placeholder_=this.renderOnMouseOut_?t.placeholder:"&#160;",this.renderedHTML_=e.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=t.wrapX!==!1}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(E5)}getProjection(){return this.get(R1)}handleMouseMove(t){const e=this.getMap();this.updateHTML_(e.getEventPixel(t))}handleMouseOut(t){this.updateHTML_(null)}setMap(t){if(super.setMap(t),t){const e=t.getViewport();this.listenerKeys.push(ve(e,Kd.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(ve(e,Kd.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(t){this.set(E5,t)}setProjection(t){this.set(R1,xe(t))}updateHTML_(t){let e=this.placeholder_;if(t&&this.mapProjection_){if(!this.transform_){const r=this.getProjection();r?this.transform_=th(this.mapProjection_,r):this.transform_=G0}const s=this.getMap().getCoordinateFromPixelInternal(t);if(s){if(this.transform_(s,s),this.wrapX_){const o=this.getProjection()||this.mapProjection_;j0(s,o)}const r=this.getCoordinateFormat();r?e=r(s):e=s.toString()}}(!this.renderedHTML_||e!==this.renderedHTML_)&&(this.element.innerHTML=e,this.renderedHTML_=e)}render(t){const e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}}const N1="units",U6=[1,2,5],Uu=25.4/.28;class W6 extends Ms{constructor(t){t=t||{};const e=document.createElement("div");e.style.pointerEvents="none",super({element:e,render:t.render,target:t.target}),this.on,this.once,this.un;const n=t.className!==void 0?t.className:t.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=n+"-inner",this.element.className=n+" "+Zc,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=t.minWidth!==void 0?t.minWidth:64,this.maxWidth_=t.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(N1,this.handleUnitsChanged_),this.setUnits(t.units||"metric"),this.scaleBar_=t.bar||!1,this.scaleBarSteps_=t.steps||4,this.scaleBarText_=t.text||!1,this.dpi_=t.dpi||void 0}getUnits(){return this.get(N1)}handleUnitsChanged_(){this.updateElement_()}setUnits(t){this.set(N1,t)}setDpi(t){this.dpi_=t}updateElement_(){const t=this.viewState_;if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=t.center,n=t.projection,s=this.getUnits(),r=s=="degrees"?"degrees":"m";let o=Wp(n,t.resolution,e,r);const a=this.minWidth_*(this.dpi_||Uu)/Uu,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Uu)/Uu:void 0;let h=a*o,c="";if(s=="degrees"){const b=kc.degrees;h*=b,h<b/60?(c="″",o*=3600):h<b?(c="′",o*=60):c="°"}else if(s=="imperial")h<.9144?(c="in",o/=.0254):h<1609.344?(c="ft",o/=.3048):(c="mi",o/=1609.344);else if(s=="nautical")o/=1852,c="NM";else if(s=="metric")h<1e-6?(c="nm",o*=1e9):h<.001?(c="μm",o*=1e6):h<1?(c="mm",o*=1e3):h<1e3?c="m":(c="km",o/=1e3);else if(s=="us")h<.9144?(c="in",o*=39.37):h<1609.344?(c="ft",o/=.30480061):(c="mi",o/=1609.3472);else throw new Error("Invalid units");let u=3*Math.floor(Math.log(a*o)/Math.log(10)),f,d,g,p,y,_;for(;;){g=Math.floor(u/3);const b=Math.pow(10,g);if(f=U6[(u%3+3)%3]*b,d=Math.round(f/o),isNaN(d)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&d>=l){f=p,d=y,g=_;break}else if(d>=a)break;p=f,y=d,_=g,++u}const x=this.scaleBar_?this.createScaleBar(d,f,c):f.toFixed(g<0?-g:0)+" "+c;this.renderedHTML_!=x&&(this.innerElement_.innerHTML=x,this.renderedHTML_=x),this.renderedWidth_!=d&&(this.innerElement_.style.width=d+"px",this.renderedWidth_=d),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(t,e,n){const s=this.getScaleForResolution(),r=s<1?Math.round(1/s).toLocaleString()+" : 1":"1 : "+Math.round(s).toLocaleString(),o=this.scaleBarSteps_,a=t/o,l=[this.createMarker("absolute")];for(let c=0;c<o;++c){const u=c%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${u}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(c%2===0||o===2?this.createStepText(c,t,!1,e,n):"")+"</div>")}return l.push(this.createStepText(o,t,!0,e,n)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${t}px;">`+r+"</div>":"")+l.join("")}createMarker(t){return`<div class="ol-scale-step-marker" style="position: ${t}; top: ${t==="absolute"?3:-10}px;"></div>`}createStepText(t,e,n,s,r){const a=(t===0?0:Math.round(s/this.scaleBarSteps_*t*100)/100)+(t===0?"":" "+r),l=t===0?-3:e/this.scaleBarSteps_*-1,h=t===0?0:e/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${t===0?"left":"center"};min-width: ${h}px;left: ${n?e+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const t=Wp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),e=this.dpi_||Uu,n=1e3/25.4;return t*n*e}render(t){const e=t.frameState;e?this.viewState_=e.viewState:this.viewState_=null,this.updateElement_()}}const q6={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},C5={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class V6 extends CE{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=hn(),this.tileClipContexts_=null}drawTile(t,e,n,s,r,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,n,s,r,o,a,l)}getTile(t,e,n,s){const r=this.getOrCreateTile(t,e,n,s);if(!r)return null;const a=s.viewState.resolution,l=s.viewHints;return(!(l[vi.ANIMATING]||l[vi.INTERACTING])||!r.wantedResolution)&&(r.wantedResolution=a),r}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,n){const s=this.getLayer(),r=s.getRevision(),o=s.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(s);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const h=s.getSource(),c=!!s.getDeclutter(),u=h.getTileGrid(),d=h.getTileGridForProjection(n).getTileCoordExtent(t.wrappedTileCoord),g=h.getSourceTiles(e,n,t),p=le(s);delete t.hitDetectionImageData[p],t.executorGroups[p]=[],l.dirty=!1;for(let y=0,_=g.length;y<_;++y){const x=g[y];if(x.getState()!=Jt.LOADED)continue;const b=x.tileCoord,L=u.getTileCoordExtent(b),M=Ss(d,L),k=Xo(M,s.getRenderBuffer()*a,this.tempExtent),A=Ga(L,M)?null:k,T=new KS(0,M,a,e),F=A_(a,e),q=function(U,X){let Z;const st=U.getStyleFunction()||s.getStyleFunction();if(st&&(Z=st(U,a)),Z){const tt=this.renderFeature(U,F,Z,T,c,X);l.dirty=l.dirty||tt}},R=x.getFeatures();o&&o!==l.renderedRenderOrder&&R.sort(o);for(let U=0,X=R.length;U<X;++U){const Z=R[U];(!A||Ri(A,Z.getGeometry().getExtent()))&&q.call(this,Z,U)}const S=T.finish(),O=s.getRenderMode()!=="vector"&&c&&g.length===1?null:M,E=new JS(O,a,e,h.getOverlaps(),S,s.getRenderBuffer(),!0);t.executorGroups[p].push(E)}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,n,s,r){const o=e.viewState.resolution,a=e.viewState.rotation;n=n??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(e.viewState.projection),u=es([t]);Xo(u,o*n,u);const f={},d=function(y,_,x){let b=y.getId();b===void 0&&(b=le(y));const L=f[b];if(L){if(L!==!0&&x<L.distanceSq){if(x===0)return f[b]=!0,r.splice(r.lastIndexOf(L),1),s(y,l,_);L.geometry=_,L.distanceSq=x}}else{if(x===0)return f[b]=!0,s(y,l,_);r.push(f[b]={feature:y,layer:l,geometry:_,distanceSq:x,callback:s})}},g=this.renderedTiles;let p;for(let y=0,_=g.length;!p&&y<_;++y){const x=g[y],b=c.getTileCoordExtent(x.wrappedTileCoord);if(!Ri(b,u))continue;const L=le(l),M=[x.executorGroups[L]],k=l.getDeclutter();M.some(A=>{const T=k?e.declutter[k].all().map(F=>F.value):null;for(let F=0,q=A.length;F<q;++F)if(p=A[F].forEachFeatureAtCoordinate(t,o,a,n,d,T),p)return!0})}return p}getFeatures(t){return new Promise((e,n)=>{const s=this.getLayer(),r=le(s),o=s.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,c=o.getTileGridForProjection(a),u=Vi(this.renderedPixelToCoordinateTransform_,t.slice()),f=c.getTileCoordForCoordAndResolution(u,h);let d;for(let b=0,L=this.renderedTiles.length;b<L;++b)if(f.toString()===this.renderedTiles[b].tileCoord.toString()){if(d=this.renderedTiles[b],d.getState()===Jt.LOADED){const M=c.getTileCoordExtent(d.tileCoord);o.getWrapX()&&a.canWrapX()&&!ir(l,M)&&j0(u,a);break}d=void 0}if(!d||d.loadingSourceTiles>0){e([]);return}const g=c.getTileCoordExtent(d.wrappedTileCoord),p=Qa(g),y=[(u[0]-p[0])/h,(p[1]-u[1])/h],_=d.getSourceTiles().reduce(function(b,L){return b.concat(L.getFeatures())},[]);let x=d.hitDetectionImageData[r];if(!x){const b=ss(c.getTileSize(c.getZForResolution(h,o.zDirection))),L=this.renderedRotation_,M=[this.getRenderTransform(c.getTileCoordCenter(d.wrappedTileCoord),h,0,js,b[0]*js,b[1]*js,0)];x=tE(b,M,_,s.getStyleFunction(),c.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(s).renderedResolution,L),d.hitDetectionImageData[r]=x}e(eE(y,_,x))})}getFeaturesInExtent(t){const e=[],n=this.getTileCache();if(n.getCount()===0)return e;const r=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),o=r.getZForResolution(this.renderedResolution),a={};return n.forEach(l=>{if(l.tileCoord[0]!==o||l.getState()!==Jt.LOADED)return;const h=l.getSourceTiles();for(let c=0,u=h.length;c<u;++c){const f=h[c],d=f.getKey();if(d in a)continue;a[d]=!0;const g=f.tileCoord;if(Ri(t,r.getTileCoordExtent(g))){const p=f.getFeatures();if(p)for(let y=0,_=p.length;y<_;++y){const x=p[y],b=x.getGeometry();Ri(t,b.getExtent())&&e.push(x)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const n=this.context,s=n.globalAlpha;n.globalAlpha=e.opacity;const r=t.viewHints,o=!(r[vi.ANIMATING]||r[vi.INTERACTING]),a=this.renderedTiles;for(let l=0,h=a.length;l<h;++l){const c=a[l],u=c.executorGroups[le(this.getLayer())],f=this.getLayer().getDeclutter();if(u)for(let d=u.length-1;d>=0;--d)u[d].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(c,t),t.viewState.rotation,o,t0,f?t.declutter[f]:void 0)}n.globalAlpha=s}renderDeferredInternal(t){const n=this.renderedTiles.reduce((a,l,h)=>(l.executorGroups[le(this.getLayer())].forEach(c=>a.push({executorGroup:c,index:h})),a),[]),s=n.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),r={};for(let a=0,l=n.length;a<l;++a){const h=n[a].executorGroup.getDeferredZIndexContexts();for(const c in h)r[c]=!0}Object.keys(r).sort(no).map(Number).forEach(a=>{s.forEach((l,h)=>{l[a]&&(l[a].forEach(c=>{const{executorGroup:u,index:f}=n[h],d=u.getRenderedContext(),g=d.globalAlpha;d.globalAlpha=this.renderedOpacity_;const p=this.tileClipContexts_[f];p&&p.draw(d),c.draw(d),p&&d.restore(),d.globalAlpha=g,c.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const n=e.pixelRatio,s=e.viewState,r=s.center,o=s.resolution,a=s.rotation,l=e.size,h=Math.round(l[0]*n),c=Math.round(l[1]*n),f=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),d=t.tileCoord,g=f.getTileCoordExtent(t.wrappedTileCoord),p=f.getTileCoordExtent(d,this.tempExtent)[0]-g[0];return F0(xp(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(r,o,a,n,h,c,p))}postRender(t,e){var L;const n=e.viewHints,s=!(n[vi.ANIMATING]||n[vi.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=r.getDeclutter(),h=l?C5[o].filter(M=>!t0.includes(M)):C5[o],c=e.viewState,u=c.rotation,f=r.getSource(),g=f.getTileGridForProjection(c.projection).getZForResolution(c.resolution,f.zDirection),p=this.renderedTiles,y=[],_=[],x=[];let b=!0;for(let M=p.length-1;M>=0;--M){const k=p[M];b=b&&!k.getReplayState(r).dirty;const A=k.executorGroups[le(r)].filter(E=>E.hasExecutors(h));if(A.length===0)continue;const T=this.getTileRenderTransform(k,e),F=k.tileCoord[0];let q=!1;const R=A[0].getClipCoords(T);let S=t,O;if(R){O=new d2,S=O.getContext();for(let E=0,U=y.length;E<U;++E)if(g!==F&&F<_[E]){const X=y[E];Ri([R[0],R[3],R[4],R[7]],[X[0],X[3],X[4],X[7]])&&(q||(S.save(),q=!0),S.beginPath(),S.moveTo(R[0],R[1]),S.lineTo(R[2],R[3]),S.lineTo(R[4],R[5]),S.lineTo(R[6],R[7]),S.moveTo(X[6],X[7]),S.lineTo(X[4],X[5]),S.lineTo(X[2],X[3]),S.lineTo(X[0],X[1]),S.clip())}y.push(R),_.push(F)}for(let E=0,U=A.length;E<U;++E)A[E].execute(t,[t.canvas.width,t.canvas.height],T,u,s,h,(L=e.declutter)==null?void 0:L[l]);q&&(S===t?S.restore():x[M]=O)}t.globalAlpha=a,this.ready=b,this.tileClipContexts_=x,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,n,s,r,o){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let l=0,h=n.length;l<h;++l)a=e0(s,t,n[l],e,this.boundHandleStyleImageChange_,void 0,r,o)||a;else a=e0(s,t,n,e,this.boundHandleStyleImageChange_,void 0,r,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const n=t.getReplayState(e),s=e.getRevision(),r=t.wantedResolution;return n.renderedTileResolution!==r||n.renderedTileRevision!==s}renderTileImage_(t,e){const n=this.getLayer(),s=t.getReplayState(n),r=n.getRevision(),o=t.executorGroups[le(n)];s.renderedTileRevision=r;const a=t.wrappedTileCoord,l=a[0],h=n.getSource();let c=e.pixelRatio;const f=e.viewState.projection,d=h.getTileGridForProjection(f),g=d.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*g,y=d.getResolution(l),_=t.getContext();c=Math.round(Math.max(c,p/c));const x=h.getTilePixelSize(l,c,f);_.canvas.width=x[0],_.canvas.height=x[1];const b=c/p;if(b!==1){const A=hx(this.tmpTransform_);xp(A,b,b),_.setTransform.apply(_,A)}const L=d.getTileCoordExtent(a,this.tempExtent),M=p/y,k=hx(this.tmpTransform_);xp(k,M,-M),Jw(k,-L[0],-L[3]);for(let A=0,T=o.length;A<T;++A)o[A].execute(_,[_.canvas.width*b,_.canvas.height*b],k,0,!0,q6[n.getRenderMode()],null);s.renderedTileResolution=t.wantedResolution}}class H6 extends Lf{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const n=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=n;const s=t.renderMode||"hybrid";De(s=="hybrid"||s=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=s,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new V6(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Aa.PRELOAD)}getUseInterimTilesOnError(){return this.get(Aa.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Aa.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Aa.USE_INTERIM_TILES_ON_ERROR,t)}}const O2=34962,D2=34963,Y6=35040,X6=35044,U_=35048,$6=5121,K6=5123,Z6=5125,iC=5126,L5=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function J6(i,t){t=Object.assign({preserveDrawingBuffer:!0,antialias:!LT},t);const e=L5.length;for(let n=0;n<e;++n)try{const s=i.getContext(L5[n],t);if(s)return s}catch{}return null}const Q6={STATIC_DRAW:X6,STREAM_DRAW:Y6,DYNAMIC_DRAW:U_};class M5{constructor(t,e){this.array_=null,this.type_=t,De(t===O2||t===D2,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=e!==void 0?e:Q6.STATIC_DRAW}ofSize(t){return this.array_=new(zg(this.type_))(t),this}fromArray(t){return this.array_=zg(this.type_).from(t),this}fromArrayBuffer(t){return this.array_=new(zg(this.type_))(t),this}getType(){return this.type_}getArray(){return this.array_}setArray(t){const e=zg(this.type_);if(!(t instanceof e))throw new Error(`Expected ${e}`);this.array_=t}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function zg(i){switch(i){case O2:return Float32Array;case D2:return Uint32Array;default:return Float32Array}}const Gg={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},tF=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,eF=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class T5{constructor(t){this.gl_=t.webGlContext;const e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer(),this.depthBuffer_=e.createRenderbuffer();const n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t.vertexShader||tF),e.compileShader(n);const s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,t.fragmentShader||eF),e.compileShader(s),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,n),e.attachShader(this.renderTargetProgram_,s),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();const r=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(r),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(o=>{this.uniforms_.push({value:t.uniforms[o],location:e.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(t){const e=this.getGL(),n=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.bindRenderbuffer(e.RENDERBUFFER,this.getDepthBuffer()),e.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;const s=0,r=e.RGBA,o=0,a=e.RGBA,l=e.UNSIGNED_BYTE,h=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,s,r,n[0],n[1],o,a,l,h),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n[0],n[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer_)}}apply(t,e,n,s){const r=this.getGL(),o=t.size;if(r.bindFramebuffer(r.FRAMEBUFFER,e?e.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),!e){const l=le(r.canvas);if(!t.renderTargets[l]){const h=r.getContextAttributes();h&&h.preserveDrawingBuffer&&(r.clearColor(0,0,0,0),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)),t.renderTargets[l]=!0}}r.disable(r.DEPTH_TEST),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),r.uniform1i(this.renderTargetTextureLocation_,0);const a=t.layerStatesArray[t.layerIndex].opacity;r.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(t),n&&n(r,t),r.drawArrays(r.TRIANGLES,0,6),s&&s(r,t)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(t){const e=this.getGL();let n,s=1;this.uniforms_.forEach(function(r){if(n=typeof r.value=="function"?r.value(t):r.value,n instanceof HTMLCanvasElement||n instanceof ImageData)r.texture||(r.texture=e.createTexture()),e.activeTexture(e[`TEXTURE${s}`]),e.bindTexture(e.TEXTURE_2D,r.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,n.width,n.height,0,e.UNSIGNED_BYTE,new Uint8Array(n.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.uniform1i(r.location,s++);else if(Array.isArray(n))switch(n.length){case 2:e.uniform2f(r.location,n[0],n[1]);return;case 3:e.uniform3f(r.location,n[0],n[1],n[2]);return;case 4:e.uniform4f(r.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&e.uniform1f(r.location,n)})}}function iF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function nF(i,t){return i[0]=t[0],i[1]=t[1],i[4]=t[2],i[5]=t[3],i[12]=t[4],i[13]=t[5],i}const Po={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},jo={UNSIGNED_BYTE:$6,UNSIGNED_SHORT:K6,UNSIGNED_INT:Z6,FLOAT:iC},g0={};function A5(i){return"shared/"+i}let P5=0;function sF(){const i="unique/"+P5;return P5+=1,i}function rF(i){let t=g0[i];if(!t){const e=document.createElement("canvas");e.width=1,e.height=1,e.style.position="absolute",e.style.left="0",t={users:0,context:J6(e)},g0[i]=t}return t.users+=1,t.context}function oF(i){const t=g0[i];if(!t||(t.users-=1,t.users>0))return;const e=t.context,n=e.getExtension("WEBGL_lose_context");n&&n.loseContext();const s=e.canvas;s.width=1,s.height=1,delete g0[i]}class aF extends yf{constructor(t){super(),t=t||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=t.canvasCacheKey?A5(t.canvasCacheKey):sF(),this.gl_=rF(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const e=this.gl_.canvas;e.addEventListener(Gg.LOST,this.boundHandleWebGLContextLost_),e.addEventListener(Gg.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=hn(),this.offsetScaleMatrix_=hn(),this.tmpMat4_=iF(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],t.uniforms&&this.setUniforms(t.uniforms),this.postProcessPasses_=t.postProcesses?t.postProcesses.map(n=>new T5({webGlContext:this.gl_,scaleRatio:n.scaleRatio,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms})):[new T5({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(t){this.uniforms_=[],this.addUniforms(t)}addUniforms(t){for(const e in t)this.uniforms_.push({name:e,value:t[e]})}canvasCacheKeyMatches(t){return this.canvasCacheKey_===A5(t)}getExtension(t){if(t in this.extensionCache_)return this.extensionCache_[t];const e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e}bindBuffer(t){const e=this.gl_,n=le(t);let s=this.bufferCache_[n];if(!s){const r=e.createBuffer();s={buffer:t,webGlBuffer:r},this.bufferCache_[n]=s}e.bindBuffer(t.getType(),s.webGlBuffer)}flushBufferData(t){const e=this.gl_;this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())}deleteBuffer(t){const e=le(t);delete this.bufferCache_[e]}disposeInternal(){const t=this.gl_.canvas;t.removeEventListener(Gg.LOST,this.boundHandleWebGLContextLost_),t.removeEventListener(Gg.RESTORED,this.boundHandleWebGLContextRestored_),oF(this.canvasCacheKey_),delete this.gl_}prepareDraw(t,e,n){const s=this.gl_,r=this.getCanvas(),o=t.size,a=t.pixelRatio;(r.width!==o[0]*a||r.height!==o[1]*a)&&(r.width=o[0]*a,r.height=o[1]*a,r.style.width=o[0]+"px",r.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(t);s.bindTexture(s.TEXTURE_2D,null),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,e?s.ZERO:s.ONE_MINUS_SRC_ALPHA),n?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}bindFrameBuffer(t,e){const n=this.getGL();n.bindFramebuffer(n.FRAMEBUFFER,t),e&&n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0)}bindInitialFrameBuffer(){const t=this.getGL(),e=this.postProcessPasses_[0].getFrameBuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);const n=this.postProcessPasses_[0].getRenderTargetTexture();t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}bindTexture(t,e,n){const s=this.gl_;s.activeTexture(s.TEXTURE0+e),s.bindTexture(s.TEXTURE_2D,t),s.uniform1i(this.getUniformLocation(n),e)}bindAttribute(t,e,n){const s=this.getGL();this.bindBuffer(t);const r=this.getAttributeLocation(e);s.enableVertexAttribArray(r),s.vertexAttribPointer(r,n,s.FLOAT,!1,0,0)}prepareDrawToRenderTarget(t,e,n,s){const r=this.gl_,o=e.getSize();r.bindFramebuffer(r.FRAMEBUFFER,e.getFramebuffer()),r.bindRenderbuffer(r.RENDERBUFFER,e.getDepthbuffer()),r.viewport(0,0,o[0],o[1]),r.bindTexture(r.TEXTURE_2D,e.getTexture()),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,n?r.ZERO:r.ONE_MINUS_SRC_ALPHA),s?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}drawElements(t,e){const n=this.gl_;this.getExtension("OES_element_index_uint");const s=n.UNSIGNED_INT,r=4,o=e-t,a=t*r;n.drawElements(n.TRIANGLES,o,s,a)}finalizeDraw(t,e,n){for(let s=0,r=this.postProcessPasses_.length;s<r;s++)s===r-1?this.postProcessPasses_[s].apply(t,null,e,n):this.postProcessPasses_[s].apply(t,this.postProcessPasses_[s+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(t){const e=t.size,n=t.viewState.rotation,s=t.pixelRatio;this.setUniformFloatValue(Po.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Po.ZOOM,t.viewState.zoom),this.setUniformFloatValue(Po.RESOLUTION,t.viewState.resolution),this.setUniformFloatValue(Po.PIXEL_RATIO,s),this.setUniformFloatVec2(Po.VIEWPORT_SIZE_PX,[e[0],e[1]]),this.setUniformFloatValue(Po.ROTATION,n)}applyHitDetectionUniform(t){const e=this.getUniformLocation(Po.HIT_DETECTION);this.getGL().uniform1i(e,t?1:0),t&&this.setUniformFloatValue(Po.PIXEL_RATIO,.5)}applyUniforms(t){const e=this.gl_;let n,s=0;this.uniforms_.forEach(r=>{if(n=typeof r.value=="function"?r.value(t):r.value,n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData||n instanceof WebGLTexture){n instanceof WebGLTexture&&!r.texture?(r.prevValue=void 0,r.texture=n):r.texture||(r.prevValue=void 0,r.texture=e.createTexture()),this.bindTexture(r.texture,s,r.name),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);const o=!(n instanceof HTMLImageElement)||n.complete;!(n instanceof WebGLTexture)&&o&&r.prevValue!==n&&(r.prevValue=n,e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),s++}else if(Array.isArray(n)&&n.length===6)this.setUniformMatrixValue(r.name,nF(this.tmpMat4_,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:e.uniform2f(this.getUniformLocation(r.name),n[0],n[1]);return;case 3:e.uniform3f(this.getUniformLocation(r.name),n[0],n[1],n[2]);return;case 4:e.uniform4f(this.getUniformLocation(r.name),n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&e.uniform1f(this.getUniformLocation(r.name),n)})}useProgram(t,e){this.gl_.useProgram(t),this.currentProgram_=t,e&&(this.applyFrameState(e),this.applyUniforms(e))}compileShader(t,e){const n=this.gl_,s=n.createShader(e);return n.shaderSource(s,t),n.compileShader(s),s}getProgram(t,e){const n=this.gl_,s=this.compileShader(t,n.FRAGMENT_SHADER),r=this.compileShader(e,n.VERTEX_SHADER),o=n.createProgram();if(n.attachShader(o,s),n.attachShader(o,r),n.linkProgram(o),!n.getShaderParameter(s,n.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${n.getShaderInfoLog(s)}`;throw new Error(a)}if(n.deleteShader(s),!n.getShaderParameter(r,n.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${n.getShaderInfoLog(r)}`;throw new Error(a)}if(n.deleteShader(r),!n.getProgramParameter(o,n.LINK_STATUS)){const a=`GL program linking failed: ${n.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(t){const e=le(this.currentProgram_);return this.uniformLocationsByProgram_[e]===void 0&&(this.uniformLocationsByProgram_[e]={}),this.uniformLocationsByProgram_[e][t]===void 0&&(this.uniformLocationsByProgram_[e][t]=this.gl_.getUniformLocation(this.currentProgram_,t)),this.uniformLocationsByProgram_[e][t]}getAttributeLocation(t){const e=le(this.currentProgram_);return this.attribLocationsByProgram_[e]===void 0&&(this.attribLocationsByProgram_[e]={}),this.attribLocationsByProgram_[e][t]===void 0&&(this.attribLocationsByProgram_[e][t]=this.gl_.getAttribLocation(this.currentProgram_,t)),this.attribLocationsByProgram_[e][t]}makeProjectionTransform(t,e){const n=t.size,s=t.viewState.rotation,r=t.viewState.resolution,o=t.viewState.center;return or(e,0,0,2/(r*n[0]),2/(r*n[1]),-s,-o[0],-o[1]),e}setUniformFloatValue(t,e){this.gl_.uniform1f(this.getUniformLocation(t),e)}setUniformFloatVec2(t,e){this.gl_.uniform2fv(this.getUniformLocation(t),e)}setUniformFloatVec4(t,e){this.gl_.uniform4fv(this.getUniformLocation(t),e)}setUniformMatrixValue(t,e){this.gl_.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}enableAttributeArray_(t,e,n,s,r){const o=this.getAttributeLocation(t);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,e,n,!1,s,r))}enableAttributes(t){const e=lF(t);let n=0;for(let s=0;s<t.length;s++){const r=t[s];this.enableAttributeArray_(r.name,r.size,r.type||iC,e,n),n+=r.size*nC(r.type)}}handleWebGLContextLost(t){Kl(this.bufferCache_),this.currentProgram_=null,t.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(t,e,n,s){const r=this.gl_;n=n||r.createTexture();const o=s?r.NEAREST:r.LINEAR;r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);const a=0,l=r.RGBA,h=0,c=r.RGBA,u=r.UNSIGNED_BYTE;return e instanceof Uint8Array?r.texImage2D(r.TEXTURE_2D,a,l,t[0],t[1],h,c,u,e):e?r.texImage2D(r.TEXTURE_2D,a,l,c,u,e):r.texImage2D(r.TEXTURE_2D,a,l,t[0],t[1],h,c,u,null),n}}function lF(i){let t=0;for(let e=0;e<i.length;e++){const n=i[e];t+=n.size*nC(n.type)}return t}function nC(i){switch(i){case jo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case jo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case jo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case jo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class B2 extends ZS{constructor(t,e){super(t),e=e||{},this.inversePixelTransform_=hn(),this.postProcesses_=e.postProcesses,this.uniforms_=e.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},t.addChangeListener(Qe.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(t,e){const n=this.getLayer();if(n.hasListener(Sn.PRECOMPOSE)){const s=new vd(Sn.PRECOMPOSE,void 0,e,t);n.dispatchEvent(s)}}dispatchPostComposeEvent(t,e){const n=this.getLayer();if(n.hasListener(Sn.POSTCOMPOSE)){const s=new vd(Sn.POSTCOMPOSE,void 0,e,t);n.dispatchEvent(s)}}reset(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(t){if(this.getLayer().getRenderSource()){let e=!0,n=-1,s;for(let o=0,a=t.layerStatesArray.length;o<a;o++){const l=t.layerStatesArray[o].layer,h=l.getRenderer();if(!(h instanceof B2)){e=!0;continue}const c=l.getClassName();if((e||c!==s)&&(n+=1,e=!1),s=c,h===this)break}const r="map/"+t.mapId+"/group/"+n;(!this.helper||!this.helper.canvasCacheKeyMatches(r)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new aF({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:r}),s&&(this.helper.getCanvas().className=s),this.afterHelperCreated())}return this.prepareFrameInternal(t)}afterHelperCreated(){}prepareFrameInternal(t){return!0}clearCache(){}disposeInternal(){var t;this.clearCache(),this.removeHelper(),(t=this.getLayer())==null||t.removeChangeListener(Qe.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(t,e,n){const s=this.getLayer();if(s.hasListener(t)){or(this.inversePixelTransform_,0,0,n.pixelRatio,-n.pixelRatio,0,0,-n.size[1]);const r=new vd(t,this.inversePixelTransform_,n,e);s.dispatchEvent(r)}}preRender(t,e){this.dispatchRenderEvent_(Sn.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(Sn.POSTRENDER,t,e)}}const qr=new Uint8Array(4);class hF{constructor(t,e){this.helper_=t;const n=t.getGL();this.texture_=n.createTexture(),this.framebuffer_=n.createFramebuffer(),this.depthbuffer_=n.createRenderbuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(t){uo(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return qr[0]=0,qr[1]=0,qr[2]=0,qr[3]=0,qr;this.readAll();const n=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return qr[0]=this.data_[n*4],qr[1]=this.data_[n*4+1],qr[2]=this.data_[n*4+2],qr[3]=this.data_[n*4+3],qr}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),e.bindRenderbuffer(e.RENDERBUFFER,this.depthbuffer_),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t[0],t[1]),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(t[0]*t[1]*4)}}const I5={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"},R5=.985;function cF(i,t){t=t||[];const e=256,n=e-1;return t[0]=Math.floor(i/e/e/e)/n,t[1]=Math.floor(i/e/e)%e/n,t[2]=Math.floor(i/e)%e/n,t[3]=i%e/n,t}function uF(i){let t=0;const e=256,n=e-1;return t+=Math.round(i[0]*e*e*e*n),t+=Math.round(i[1]*e*e*n),t+=Math.round(i[2]*e*n),t+=Math.round(i[3]*n),t}function dF(){const i='const t="GENERATE_POLYGON_BUFFERS",e="GENERATE_POINT_BUFFERS",n="GENERATE_LINE_STRING_BUFFERS";function r(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function x(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],u=e[2],i=e[3],f=e[4],s=e[5];return t[0]=i/n,t[1]=-o/n,t[2]=-u/n,t[3]=x/n,t[4]=(u*s-i*f)/n,t[5]=-(x*s-o*f)/n,t}function o(t,e,n=2){const r=e&&e.length,x=r?e[0]*n:t.length;let o=u(t,0,x,n,!0);const i=[];if(!o||o.next===o.prev)return i;let s,l,c;if(r&&(o=function(t,e,n,r){const x=[];for(let n=0,o=e.length;n<o;n++){const i=u(t,e[n]*r,n<o-1?e[n+1]*r:t.length,r,!1);i===i.next&&(i.steiner=!0),x.push(g(i))}x.sort(y);for(let t=0;t<x.length;t++)n=h(x[t],n);return n}(t,e,o,n)),t.length>80*n){s=1/0,l=1/0;let e=-1/0,r=-1/0;for(let o=n;o<x;o+=n){const n=t[o],x=t[o+1];n<s&&(s=n),x<l&&(l=x),n>e&&(e=n),x>r&&(r=x)}c=Math.max(e-s,r-l),c=0!==c?32767/c:0}return f(o,i,n,s,l,c,0),i}function u(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,u=n-r;o<n;o+=r)x+=(t[u]-t[o])*(t[o+1]+t[u+1]),u=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=z(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=z(x/r|0,t[x],t[x+1],o);return o&&M(o,o.next)&&(F(o),o=o.next),o}function i(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!M(r,r.next)&&0!==d(r.prev,r,r.next))r=r.next;else{if(F(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function f(t,e,n,r,x,o,u){if(!t)return;!u&&o&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=v(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let u=x,i=0;for(let t=0;t<n&&(i++,u=u.nextZ,u);t++);let f=n;for(;i>0||f>0&&u;)0!==i&&(0===f||!u||x.z<=u.z)?(r=x,x=x.nextZ,i--):(r=u,u=u.nextZ,f--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=u}o.nextZ=null,n*=2}while(e>1)}(x)}(t,r,x,o);let y=t;for(;t.prev!==t.next;){const h=t.prev,p=t.next;if(o?l(t,r,x,o):s(t))e.push(h.i,t.i,p.i),F(t),t=p.next,y=p.next;else if((t=p)===y){u?1===u?f(t=c(i(t),e),e,n,r,x,o,2):2===u&&a(t,e,n,r,x,o):f(i(t),e,n,r,x,o,1);break}}}function s(t){const e=t.prev,n=t,r=t.next;if(d(e,n,r)>=0)return!1;const x=e.x,o=n.x,u=r.x,i=e.y,f=n.y,s=r.y,l=x<o?x<u?x:u:o<u?o:u,c=i<f?i<s?i:s:f<s?f:s,a=x>o?x>u?x:u:o>u?o:u,y=i>f?i>s?i:s:f>s?f:s;let h=r.next;for(;h!==e;){if(h.x>=l&&h.x<=a&&h.y>=c&&h.y<=y&&b(x,i,o,f,u,s,h.x,h.y)&&d(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function l(t,e,n,r){const x=t.prev,o=t,u=t.next;if(d(x,o,u)>=0)return!1;const i=x.x,f=o.x,s=u.x,l=x.y,c=o.y,a=u.y,y=i<f?i<s?i:s:f<s?f:s,h=l<c?l<a?l:a:c<a?c:a,p=i>f?i>s?i:s:f>s?f:s,g=l>c?l>a?l:a:c>a?c:a,Z=v(y,h,e,n,r),M=v(p,g,e,n,r);let w=t.prevZ,m=t.nextZ;for(;w&&w.z>=Z&&m&&m.z<=M;){if(w.x>=y&&w.x<=p&&w.y>=h&&w.y<=g&&w!==x&&w!==u&&b(i,l,f,c,s,a,w.x,w.y)&&d(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,m.x>=y&&m.x<=p&&m.y>=h&&m.y<=g&&m!==x&&m!==u&&b(i,l,f,c,s,a,m.x,m.y)&&d(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;w&&w.z>=Z;){if(w.x>=y&&w.x<=p&&w.y>=h&&w.y<=g&&w!==x&&w!==u&&b(i,l,f,c,s,a,w.x,w.y)&&d(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;m&&m.z<=M;){if(m.x>=y&&m.x<=p&&m.y>=h&&m.y<=g&&m!==x&&m!==u&&b(i,l,f,c,s,a,m.x,m.y)&&d(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function c(t,e){let n=t;do{const r=n.prev,x=n.next.next;!M(r,x)&&w(r,n,n.next,x)&&E(r,x)&&E(x,r)&&(e.push(r.i,n.i,x.i),F(n),F(n.next),n=t=x),n=n.next}while(n!==t);return i(n)}function a(t,e,n,r,x,o){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&Z(u,t)){let s=I(u,t);return u=i(u,u.next),s=i(s,s.next),f(u,e,n,r,x,o,0),void f(s,e,n,r,x,o,0)}t=t.next}u=u.next}while(u!==t)}function y(t,e){return t.x-e.x}function h(t,e){const n=function(t,e){let n=e;const r=t.x,x=t.y;let o,u=-1/0;do{if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>u&&(u=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const i=o,f=o.x,s=o.y;let l=1/0;n=o;do{if(r>=n.x&&n.x>=f&&r!==n.x&&b(x<s?r:u,x,f,s,x<s?u:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);E(n,t)&&(e<l||e===l&&(n.x>o.x||n.x===o.x&&p(o,n)))&&(o=n,l=e)}n=n.next}while(n!==i);return o}(t,e);if(!n)return e;const r=I(n,t);return i(r,r.next),i(n,n.next)}function p(t,e){return d(t.prev,t,e.prev)<0&&d(e.next,t,t.next)<0}function v(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function b(t,e,n,r,x,o,u,i){return(x-u)*(e-i)>=(t-u)*(o-i)&&(t-u)*(r-i)>=(n-u)*(e-i)&&(n-u)*(o-i)>=(x-u)*(r-i)}function Z(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(d(t.prev,t,e.prev)||d(t,e.prev,e))||M(t,e)&&d(t.prev,t,t.next)>0&&d(e.prev,e,e.next)>0)}function d(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function M(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,r){const x=A(d(t,e,n)),o=A(d(t,e,r)),u=A(d(n,r,t)),i=A(d(n,r,e));return x!==o&&u!==i||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==u||!m(n,t,r))||!(0!==i||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function E(t,e){return d(t.prev,t,t.next)<0?d(t,e,t.next)>=0&&d(t,t.prev,e)>=0:d(t,e,t.prev)<0||d(t,t.next,e)<0}function I(t,e){const n=P(t.i,t.x,t.y),r=P(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function z(t,e,n,r){const x=P(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function F(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}new Array(6);const B=[],N={vertexPosition:0,indexPosition:0};function R(t,e,n,r,x){t[e+0]=n,t[e+1]=r,t[e+2]=x}function S(t,e,n,r,x,o){const u=3+x,i=t[e+0],f=t[e+1],s=B;s.length=x;for(let n=0;n<s.length;n++)s[n]=t[e+2+n];let l=o?o.vertexPosition:0,c=o?o.indexPosition:0;const a=l/u;return R(n,l,i,f,0),s.length&&n.set(s,l+3),l+=u,R(n,l,i,f,1),s.length&&n.set(s,l+3),l+=u,R(n,l,i,f,2),s.length&&n.set(s,l+3),l+=u,R(n,l,i,f,3),s.length&&n.set(s,l+3),l+=u,r[c++]=a,r[c++]=a+1,r[c++]=a+3,r[c++]=a+1,r[c++]=a+2,r[c++]=a+3,N.vertexPosition=l,N.indexPosition=c,N}function T(t,e,n,x,o,u,i,f,s,l,c){const a=10+f.length,y=u.length/a,h=[t[e+0],t[e+1]],p=[t[n],t[n+1]],v=t[e+2],g=t[n+2],b=r(s,[...h]),Z=r(s,[...p]);function d(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],u=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),i=[(n[0]-t[0])/u,(n[1]-t[1])/u],f=0===r||0===u?0:Math.acos((s=i[0]*x[0]+i[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;return i[0]*o[0]+i[1]*o[1]>0?f:2*Math.PI-f}let M=-1,w=-1,m=c;const A=null!==o;if(null!==x){M=d(b,Z,r(s,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((M-Math.PI)/2))}if(A){w=d(Z,b,r(s,[...[t[o],t[o+1]]])),Math.cos(w)<=.985&&(m+=Math.tan((Math.PI-w)/2))}function E(t,e){return 0===e?1e4*t:Math.sign(e)*(1e4*t+Math.abs(e))}return u.push(h[0],h[1],v,p[0],p[1],g,M,w,l,E(0,c)),u.push(...f),u.push(h[0],h[1],v,p[0],p[1],g,M,w,l,E(1,c)),u.push(...f),u.push(h[0],h[1],v,p[0],p[1],g,M,w,l,E(2,c)),u.push(...f),u.push(h[0],h[1],v,p[0],p[1],g,M,w,l,E(3,c)),u.push(...f),i.push(y,y+1,y+2,y+1,y+3,y+2),{length:l+Math.sqrt((Z[0]-b[0])*(Z[0]-b[0])+(Z[1]-b[1])*(Z[1]-b[1])),angle:m}}function _(t,e,n,r,x){const u=2+x;let i=e;const f=t.slice(i,i+x);i+=x;const s=t[i++];let l=0;const c=new Array(s-1);for(let e=0;e<s;e++)l+=t[i++],e<s-1&&(c[e]=l);const a=t.slice(i,i+2*l),y=o(a,c,2);for(let t=0;t<y.length;t++)r.push(y[t]+n.length/u);for(let t=0;t<a.length;t+=2)n.push(a[t],a[t+1],...f);return i+2*l}const O=self;O.onmessage=r=>{const o=r.data;switch(o.type){case e:{const t=3,e=2,n=o.customAttributesSize,r=e+n,x=new Float32Array(o.renderInstructions),u=x.length/r,i=4*u*(n+t),f=new Uint32Array(6*u),s=new Float32Array(i);let l;for(let t=0;t<x.length;t+=r)l=S(x,t,s,f,n,l);const c=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:x.buffer},o);O.postMessage(c,[s.buffer,f.buffer,x.buffer]);break}case n:{const t=[],e=[],n=o.customAttributesSize,r=3,u=new Float32Array(o.renderInstructions);let i=0;const f=[1,0,0,1,0,0];let s,l;for(x(f,o.renderInstructionsTransform);i<u.length;){l=Array.from(u.slice(i,i+n)),i+=n,s=u[i++];const x=i,o=i+(s-1)*r,c=u[x]===u[o]&&u[x+1]===u[o+1];let a=0,y=0;for(let n=0;n<s-1;n++){let h=null;n>0?h=i+(n-1)*r:c&&(h=o-r);let p=null;n<s-2?p=i+(n+2)*r:c&&(p=x+r);const v=T(u,i+n*r,i+(n+1)*r,h,p,t,e,l,f,a,y);a=v.length,y=v.angle}i+=s*r}const c=Uint32Array.from(e),a=Float32Array.from(t),y=Object.assign({vertexBuffer:a.buffer,indexBuffer:c.buffer,renderInstructions:u.buffer},o);O.postMessage(y,[a.buffer,c.buffer,u.buffer]);break}case t:{const t=[],e=[],n=o.customAttributesSize,r=new Float32Array(o.renderInstructions);let x=0;for(;x<r.length;)x=_(r,x,t,e,n);const u=Uint32Array.from(e),i=Float32Array.from(t),f=Object.assign({vertexBuffer:i.buffer,indexBuffer:u.buffer,renderInstructions:r.buffer},o);O.postMessage(f,[i.buffer,u.buffer,r.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(i,"binary").toString("base64"):URL.createObjectURL(new Blob([i],{type:"application/javascript"})))}function fF(i,t){const e=i.viewState.projection,s=t.getSource().getWrapX()&&e.canWrapX(),r=e.getExtent(),o=i.extent,a=s?Ie(r):null,l=s?Math.ceil((o[2]-r[2])/a)+1:1;return[s?Math.floor((o[0]-r[0])/a):0,l,a]}class gF extends B2{constructor(t,e){const n=e.uniforms||{},s=hn();n[Po.PROJECTION_MATRIX]=s,super(t,{uniforms:n,postProcesses:e.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new M5(O2,U_),this.indicesBuffer_=new M5(D2,U_),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.program_,this.hitDetectionEnabled_=e.hitDetectionEnabled??!0;const r=e.attributes?e.attributes.map(function(a){return{name:"a_prop_"+a.name,size:1,type:jo.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:jo.FLOAT},{name:"a_index",size:1,type:jo.FLOAT}],this.hitDetectionEnabled_&&(this.attributes.push({name:"a_prop_hitColor",size:4,type:jo.FLOAT}),this.attributes.push({name:"a_featureUid",size:1,type:jo.FLOAT})),this.attributes.push(...r),this.customAttributes=e.attributes?e.attributes:[],this.previousExtent_=Es(),this.currentTransform_=s,this.renderTransform_=hn(),this.invertRenderTransform_=hn(),this.renderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.lastSentId=0,this.worker_=dF(),this.worker_.addEventListener("message",a=>{const l=a.data;if(l.type===I5.GENERATE_POINT_BUFFERS){const h=l.projectionTransform;this.verticesBuffer_.fromArrayBuffer(l.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.fromArrayBuffer(l.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=h,Py(this.invertRenderTransform_,this.renderTransform_),this.renderInstructions_=new Float32Array(a.data.renderInstructions),l.id===this.lastSentId&&(this.ready=!0),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const o=this.getLayer().getSource();this.sourceListenKeys_=[ve(o,xn.ADDFEATURE,this.handleSourceFeatureAdded_,this),ve(o,xn.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),ve(o,xn.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),ve(o,xn.CLEAR,this.handleSourceFeatureClear_,this)],o.forEachFeature(a=>{this.featureCache_[le(a)]={feature:a,properties:a.getProperties(),geometry:a.getGeometry()},this.featureCount_++})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new hF(this.helper)),this.verticesBuffer_.getArray()&&this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.getArray()&&this.helper.flushBufferData(this.indicesBuffer_)}handleSourceFeatureAdded_(t){const e=t.feature;this.featureCache_[le(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}handleSourceFeatureChanged_(t){const e=t.feature;this.featureCache_[le(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()}}handleSourceFeatureDelete_(t){const e=t.feature;delete this.featureCache_[le(e)],this.featureCount_--}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(t){const e=this.helper.getGL();this.preRender(e,t);const[n,s,r]=fF(t,this.getLayer());return this.renderWorlds(t,!1,n,s,r),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(t,!0,n,s,r),this.hitRenderTarget_.clearCachedData()),this.postRender(e,t),this.helper.getCanvas()}prepareFrameInternal(t){const e=this.getLayer(),n=e.getSource(),s=t.viewState,r=!t.viewHints[vi.ANIMATING]&&!t.viewHints[vi.INTERACTING],o=!Ga(this.previousExtent_,t.extent),a=this.sourceRevision_<n.getRevision();if(a&&(this.sourceRevision_=n.getRevision()),r&&(o||a)){const l=s.projection,h=s.resolution,c=e instanceof Lf?e.getRenderBuffer():0,u=Xo(t.extent,c*h);n.loadFeatures(u,h,l),this.rebuildBuffers_(t),this.previousExtent_=t.extent.slice()}return this.helper.useProgram(this.program_,t),this.helper.prepareDraw(t),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(t){const e=hn();this.helper.makeProjectionTransform(t,e);const s=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,r=s*this.featureCount_;(!this.renderInstructions_||this.renderInstructions_.length!==r)&&(this.renderInstructions_=new Float32Array(r));let o,a;const l=[],h=[];let c=-1;for(const f in this.featureCache_)if(o=this.featureCache_[f],a=o.geometry,!(!a||a.getType()!=="Point")){if(l[0]=a.getFlatCoordinates()[0],l[1]=a.getFlatCoordinates()[1],Vi(e,l),this.renderInstructions_[++c]=l[0],this.renderInstructions_[++c]=l[1],this.hitDetectionEnabled_){const d=cF(c+5,h);this.renderInstructions_[++c]=d[0],this.renderInstructions_[++c]=d[1],this.renderInstructions_[++c]=d[2],this.renderInstructions_[++c]=d[3],this.renderInstructions_[++c]=Number(f)}for(let d=0;d<this.customAttributes.length;d++){const g=this.customAttributes[d].callback(o.feature,o.properties);this.renderInstructions_[++c]=g}}const u={id:++this.lastSentId,type:I5.GENERATE_POINT_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesSize:s-2};u.projectionTransform=e,this.ready=!1,this.worker_.postMessage(u,[this.renderInstructions_.buffer]),this.renderInstructions_=null}forEachFeatureAtCoordinate(t,e,n,s,r){if(De(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.renderInstructions_||!this.hitDetectionEnabled_)return;const o=Vi(e.coordinateToPixelTransform,t.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],h=uF(l),c=this.renderInstructions_[h],u=Math.floor(c).toString(),d=this.getLayer().getSource().getFeatureByUid(u);if(d)return s(d,this.getLayer(),null)}renderWorlds(t,e,n,s,r){let o=n;this.helper.useProgram(this.program_,t),e&&(this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(t,this.currentTransform_),Jw(this.currentTransform_,o*r,0),F0(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(t),this.helper.applyHitDetectionUniform(e);const a=this.indicesBuffer_.getSize();this.helper.drawElements(0,a)}while(++o<s)}disposeInternal(){this.worker_.terminate(),this.sourceListenKeys_.forEach(function(t){Ke(t)}),this.sourceListenKeys_=null,super.disposeInternal()}renderDeclutter(){}}function Cd(i){const t=i.toString();return t.includes(".")?t:t+".0"}function pF(i){if(i.length<2||i.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${i.length}(${i.map(Cd).join(", ")})`}function k1(i){const t=ql(i),e=t.length>3?t[3]:1;return pF([t[0]/255,t[1]/255,t[2]/255,e])}const F1={};let mF=0;function _F(i){return i in F1||(F1[i]=mF++),F1[i]}function Yh(i){return Cd(_F(i))}function yF(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const Xh=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders
`,$h=yF();class vF{constructor(){this.uniforms_=[],this.attributes_=[],this.varyings_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Cd($h["circle-radius"])} + ${Cd($h["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=k1($h["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Cd($h["stroke-width"]),this.strokeColorExpression_=k1($h["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Yh("round"),this.strokeJoinExpression_=Yh("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=k1($h["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(t){return this.uniforms_.push(t),this}addAttribute(t){return this.attributes_.push(t),this}addVarying(t,e,n){return this.varyings_.push({name:t,type:e,expression:n}),this}setSymbolSizeExpression(t){return this.hasSymbol_=!0,this.symbolSizeExpression_=t,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(t){return this.symbolRotationExpression_=t,this}setSymbolOffsetExpression(t){return this.symbolOffsetExpression_=t,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(t){return this.hasSymbol_=!0,this.symbolColorExpression_=t,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(t){return this.texCoordExpression_=t,this}setFragmentDiscardExpression(t){return this.discardExpression_=t,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(t){return this.symbolRotateWithView_=t,this}setStrokeWidthExpression(t){return this.hasStroke_=!0,this.strokeWidthExpression_=t,this}setStrokeColorExpression(t){return this.hasStroke_=!0,this.strokeColorExpression_=t,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(t){return this.strokeOffsetExpression_=t,this}setStrokeCapExpression(t){return this.strokeCapExpression_=t,this}setStrokeJoinExpression(t){return this.strokeJoinExpression_=t,this}setStrokeMiterLimitExpression(t){return this.strokeMiterLimitExpression_=t,this}setStrokeDistanceFieldExpression(t){return this.strokeDistanceFieldExpression_=t,this}setFillColorExpression(t){return this.hasFill_=!0,this.fillColorExpression_=t,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(t){this.vertexShaderFunctions_.includes(t)||this.vertexShaderFunctions_.push(t)}addFragmentShaderFunction(t){this.fragmentShaderFunctions_.includes(t)||this.fragmentShaderFunctions_.push(t)}getSymbolVertexShader(){return this.hasSymbol_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_prop_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx;
  if (a_index == 0.0) {
    offsetPx -= halfSizePx;
  } else if (a_index == 1.0) {
    offsetPx += halfSizePx * vec2(1., -1.);
  } else if (a_index == 2.0) {
    offsetPx += halfSizePx;
  } else {
    offsetPx += halfSizePx * vec2(-1., 1.);
  }
  float angle = ${this.symbolRotationExpression_};
  ${this.symbolRotateWithView_?"angle += u_rotation;":""}
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  v_prop_hitColor = a_prop_hitColor;
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y); 
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_prop_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_parameters;
attribute float a_distance;
attribute vec2 a_joinAngles;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_prop_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);
  currentLineMetric = vertexNumber < 1.5 ? a_measureStart : a_measureEnd;
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)
  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);
  
  // compute current vertex position
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 joinDirection;
  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${R5} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStart = segmentStartPx;
  v_segmentEnd = segmentEndPx;
  v_width = lineWidth;
  v_prop_hitColor = a_prop_hitColor;
  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);
  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_prop_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${R5}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Yh("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Yh("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Yh("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Yh("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

void main(void) {
  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLength = length(v_segmentEnd - v_segmentStart);
  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPoint = currentPoint - v_segmentStart;
  float lengthToPoint = max(0., min(dot(segmentTangent, startToPoint), segmentLength));
  float currentLengthPx = lengthToPoint + v_distanceOffsetPx; 
  float currentRadiusPx = abs(dot(segmentNormal, startToPoint));
  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPoint / segmentLength);

  if (${this.discardExpression_}) { discard; }

  vec4 color = ${this.strokeColorExpression_};
  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);
  float distance = max(
    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distance = max(distance, ${this.strokeDistanceFieldExpression_});
  color.a *= smoothstep(0.5, -0.5, distance);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
attribute vec2 a_position;
attribute vec4 a_prop_hitColor;
${this.attributes_.map(function(t){return"attribute "+t+";"}).join(`
`)}
varying vec4 v_prop_hitColor;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_prop_hitColor = a_prop_hitColor;
${this.varyings_.map(function(t){return"  "+t.name+" = "+t.expression+";"}).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Xh}
${this.uniforms_.map(function(t){return"uniform "+t+";"}).join(`
`)}
varying vec4 v_prop_hitColor;
${this.varyings_.map(function(t){return"varying "+t.type+" "+t.name+";"}).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_prop_hitColor;
  }
}`:null}}const mr={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},xF=["#00f","#0ff","#0f0","#ff0","#f00"];class bF extends Lf{constructor(t){t=t||{};const e=Object.assign({},t);delete e.gradient,delete e.radius,delete e.blur,delete e.weight,super(e),this.gradient_=null,this.addChangeListener(mr.GRADIENT,this.handleGradientChanged_),this.setGradient(t.gradient?t.gradient:xF),this.setBlur(t.blur!==void 0?t.blur:15),this.setRadius(t.radius!==void 0?t.radius:8);const n=t.weight?t.weight:"weight";this.weightFunction_=typeof n=="string"?s=>s.get(n):n,this.setRenderOrder(null)}getBlur(){return this.get(mr.BLUR)}getGradient(){return this.get(mr.GRADIENT)}getRadius(){return this.get(mr.RADIUS)}handleGradientChanged_(){this.gradient_=wF(this.getGradient())}setBlur(t){this.set(mr.BLUR,t)}setGradient(t){this.set(mr.GRADIENT,t)}setRadius(t){this.set(mr.RADIUS,t)}createRenderer(){const t=new vF().addAttribute("float a_prop_weight").addVarying("v_prop_weight","float","a_prop_weight").addUniform("float u_size").addUniform("float u_blurSlope").setSymbolSizeExpression("vec2(u_size)").setSymbolColorExpression("vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * u_blurSlope) * v_prop_weight)");return new gF(this,{className:this.getClassName(),attributes:[{name:"weight",callback:e=>{const n=this.weightFunction_(e);return n!==void 0?xi(n,0,1):1}}],uniforms:{u_size:()=>(this.get(mr.RADIUS)+this.get(mr.BLUR))*2,u_blurSlope:()=>this.get(mr.RADIUS)/Math.max(1,this.get(mr.BLUR))},hitDetectionEnabled:!0,vertexShader:t.getSymbolVertexShader(),fragmentShader:t.getSymbolFragmentShader(),postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}renderDeclutter(){}}function wF(i){const n=Bi(1,256),s=n.createLinearGradient(0,0,1,256),r=1/(i.length-1);for(let o=0,a=i.length;o<a;++o)s.addColorStop(o*r,i[o]);return n.fillStyle=s,n.fillRect(0,0,1,256),n.canvas}var SF=class extends In{constructor(t){t=t||{},super();var e=this.input=t.input;e||(e=this.input=document.createElement("INPUT"),t.type&&e.setAttribute("type",t.type),t.min!==void 0&&e.setAttribute("min",t.min),t.max!==void 0&&e.setAttribute("max",t.max),t.step!==void 0&&e.setAttribute("step",t.step),t.parent&&t.parent.appendChild(e)),t.disabled&&(e.disabled=!0),t.checked!==void 0&&(e.checked=!!t.checked),t.val!==void 0&&(e.value=t.val),t.hidden&&(e.style.display="none"),e.addEventListener("focus",(function(){this.element&&this.element.classList.add("ol-focus")}).bind(this));var n;e.addEventListener("focusout",(function(){this.element&&(n&&clearTimeout(n),n=setTimeout((function(){this.element.classList.remove("ol-focus")}).bind(this),0))}).bind(this))}_listenDrag(t,e){var n=(function(s){this.moving=!0,this.element.classList.add("ol-moving");var r=(function(o){o.type==="pointerup"&&(document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",r),document.removeEventListener("pointercancel",r),setTimeout((function(){this.moving=!1,this.element.classList.remove("ol-moving")}).bind(this))),o.target===t&&e(o),o.stopPropagation(),o.preventDefault()}).bind(this);document.addEventListener("pointermove",r,!1),document.addEventListener("pointerup",r,!1),document.addEventListener("pointercancel",r,!1),s.stopPropagation(),s.preventDefault()}).bind(this);t.addEventListener("mousedown",n,!1),t.addEventListener("touchstart",n,!1)}setValue(t){t!==void 0&&(this.input.value=t),this.input.dispatchEvent(new Event("change"))}getValue(){return this.input.value}getInputElement(){return this.input}},j2=class extends SF{constructor(t){t=t||{},super(t);var e=this.element=document.createElement("LABEL");t.html instanceof Element?e.appendChild(t.html):t.html!==void 0&&(e.innerHTML=t.html),e.className=("ol-ext-check ol-ext-checkbox "+(t.className||"")).trim(),this.input.parentNode&&this.input.parentNode.insertBefore(e,this.input),e.appendChild(this.input),e.appendChild(document.createElement("SPAN")),t.after&&e.appendChild(document.createTextNode(t.after)),this.input.addEventListener("change",(function(){this.dispatchEvent({type:"check",checked:this.input.checked,value:this.input.value})}).bind(this))}isChecked(){return this.input.checked}},EF=class extends j2{constructor(t){t=t||{},super(t),this.element.className=("ol-ext-toggle-switch "+(t.className||"")).trim()}},CF=class extends j2{constructor(t){t=t||{},super(t),this.element.className=("ol-ext-check ol-ext-radio "+(t.className||"")).trim()}},lt={};lt.create=function(i,t){t=t||{};var e;if(i==="TEXT")e=document.createTextNode(t.html||""),t.parent&&t.parent.appendChild(e);else{e=document.createElement(i),/button/i.test(i)&&e.setAttribute("type","button");for(var n in t)switch(n){case"className":{t.className&&t.className.trim&&e.setAttribute("class",t.className.trim());break}case"text":{e.innerText=t.text;break}case"html":{t.html instanceof Element?e.appendChild(t.html):t.html!==void 0&&(e.innerHTML=t.html);break}case"parent":{t.parent&&t.parent.appendChild(e);break}case"options":{if(/select/i.test(i))for(var s in t.options)lt.create("OPTION",{html:s,value:t.options[s],parent:e});break}case"style":{lt.setStyle(e,t.style);break}case"change":case"click":{lt.addListener(e,n,t[n]);break}case"on":{for(var r in t.on)lt.addListener(e,r,t.on[r]);break}case"checked":{e.checked=!!t.checked;break}default:{e.setAttribute(n,t[n]);break}}}return e};lt.createSwitch=function(i){var t=lt.create("INPUT",{type:"checkbox",on:i.on,click:i.click,change:i.change,parent:i.parent}),e=Object.assign({input:t},i||{});return new EF(e),t};lt.createCheck=function(i){var t=lt.create("INPUT",{name:i.name,type:i.type==="radio"?"radio":"checkbox",on:i.on,parent:i.parent}),e=Object.assign({input:t},i||{});return i.type==="radio"?new CF(e):new j2(e),t};lt.setHTML=function(i,t){t instanceof Element?i.appendChild(t):t!==void 0&&(i.innerHTML=t)};lt.appendText=function(i,t){i.appendChild(document.createTextNode(t||""))};lt.addListener=function(i,t,e,n){typeof t=="string"&&(t=t.split(" ")),t.forEach(function(s){i.addEventListener(s,e,n)})};lt.removeListener=function(i,t,e){typeof t=="string"&&(t=t.split(" ")),t.forEach(function(n){i.removeEventListener(n,e)})};lt.show=function(i){i.style.display=""};lt.hide=function(i){i.style.display="none"};lt.hidden=function(i){return lt.getStyle(i,"display")==="none"};lt.toggle=function(i){i.style.display=i.style.display==="none"?"":"none"};lt.setStyle=function(i,t){for(var e in t)switch(e){case"top":case"left":case"bottom":case"right":case"minWidth":case"maxWidth":case"width":case"height":{typeof t[e]=="number"?i.style[e]=t[e]+"px":i.style[e]=t[e];break}default:i.style[e]=t[e]}};lt.getStyle=function(i,t){var e,n=(i.ownerDocument||document).defaultView;if(n&&n.getComputedStyle)t=t.replace(/([A-Z])/g,"-$1").toLowerCase(),e=n.getComputedStyle(i,null).getPropertyValue(t);else if(i.currentStyle&&(t=t.replace(/-(\w)/g,function(s,r){return r.toUpperCase()}),e=i.currentStyle[t],/^\d+(em|pt|%|ex)?$/i.test(e)))return function(s){var r=i.style.left,o=i.runtimeStyle.left;return i.runtimeStyle.left=i.currentStyle.left,i.style.left=s||0,s=i.style.pixelLeft+"px",i.style.left=r,i.runtimeStyle.left=o,s}(e);return/px$/.test(e)?parseInt(e):e};lt.outerHeight=function(i){return i.offsetHeight+lt.getStyle(i,"marginBottom")};lt.outerWidth=function(i){return i.offsetWidth+lt.getStyle(i,"marginLeft")};lt.offsetRect=function(i){var t=i.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),height:t.height||t.bottom-t.top,width:t.width||t.right-t.left}};lt.getFixedOffset=function(i){var t={left:0,top:0},e=function(n){if(!n)return t;if(lt.getStyle(n,"position")==="absolute"&&lt.getStyle(n,"transform")!=="none"){var s=n.getBoundingClientRect();return t.left+=s.left,t.top+=s.top,t}return e(n.offsetParent)};return e(i.offsetParent)};lt.positionRect=function(i,t){var e=0,n=0,s=function(r){if(r)return e+=r.offsetLeft,n+=r.offsetTop,s(r.offsetParent);var o={top:i.offsetTop+n,left:i.offsetLeft+e};return t&&(o.top-=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,o.left-=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0),o.bottom=o.top+i.offsetHeight,o.right=o.top+i.offsetWidth,o};return s(i.offsetParent)};lt.scrollDiv=function(i,t){t=t||{};var e=!1,n=0,s,r=0,o=typeof t.onmove=="function"?t.onmove:function(){},a=t.vertical?"screenY":"screenX",l=t.vertical?"scrollTop":"scrollLeft",h=!1,c,u,f=0,d=function(){b&&(f++,setTimeout(g))},g=function(){if(b){if(f--,f)return;var A=i.clientHeight,T=i.scrollHeight;c=A/T,b.style.height=c*100+"%",b.style.top=i.scrollTop/T*100+"%",x.style.height=A+"px",A>T-.5?x.classList.add("ol-100pc"):x.classList.remove("ol-100pc")}},p=function(A){A.target.classList.contains("ol-noscroll")||(h=!1,e=A[a],r=new Date,i.classList.add("ol-move"),A.preventDefault(),window.addEventListener("pointermove",y),lt.addListener(window,["pointerup","pointercancel"],M))},y=function(A){if(e!==!1){var T=(u?-1/c:1)*(e-A[a]);h=h||Math.round(T),i[l]+=T,s=new Date,s-r&&(n=(n+T/(s-r))/2),e=A[a],r=s,T&&o(!0)}else h=!0},_=function(A){var T=A>0?Math.min(100,A/2):Math.max(-100,A/2);A-=T,i[l]+=T,-1<A&&A<1?(h?setTimeout(function(){i.classList.remove("ol-move")}):i.classList.remove("ol-move"),h=!1,o(!1)):setTimeout(function(){_(A)},40)},x,b;if(t.vertical&&t.minibar){var L=function(A){i.removeEventListener("pointermove",L),i.parentNode.classList.add("ol-miniscroll"),b=lt.create("DIV"),x=lt.create("DIV",{className:"ol-scroll",html:b}),i.parentNode.insertBefore(x,i),b.addEventListener("pointerdown",function(T){u=!0,p(T)}),t.mousewheel&&(lt.addListener(x,["mousewheel","DOMMouseScroll","onmousewheel"],function(T){k(T)}),lt.addListener(b,["mousewheel","DOMMouseScroll","onmousewheel"],function(T){k(T)})),i.parentNode.addEventListener("pointerenter",d),window.addEventListener("resize",d),A!==!1&&d()};i.parentNode?L(!1):i.addEventListener("pointermove",L),i.addEventListener("scroll",function(){d()})}i.style["touch-action"]="none",i.style.overflow="hidden",i.classList.add("ol-scrolldiv"),lt.addListener(i,["pointerdown"],function(A){u=!1,p(A)}),i.addEventListener("click",function(A){i.classList.contains("ol-move")&&(A.preventDefault(),A.stopPropagation())},!0);var M=function(A){r=new Date-r,r>100||u?n=0:r>0&&(n=((n||0)+(e-A[a])/r)/2),_(t.animate===!1?0:n*200),e=!1,n=0,r=0,i.classList.contains("ol-move")?i.classList.remove("ol-hasClick"):(i.classList.add("ol-hasClick"),setTimeout(function(){i.classList.remove("ol-hasClick")},500)),u=!1,window.removeEventListener("pointermove",y),lt.removeListener(window,["pointerup","pointercancel"],M)},k=function(A){var T=Math.max(-1,Math.min(1,A.wheelDelta||-A.detail));return i.classList.add("ol-move"),i[l]-=T*30,i.classList.remove("ol-move"),!1};return t.mousewheel&&lt.addListener(i,["mousewheel","DOMMouseScroll","onmousewheel"],k),{refresh:d}};lt.dispatchEvent=function(i,t){var e;try{e=new CustomEvent(i)}catch{e=document.createEvent("CustomEvent"),e.initCustomEvent(i,!0,!0,{})}t.dispatchEvent(e)};lt.setCursor=function(i,t){i instanceof vE&&(i=i.getTargetElement()),!("ontouchstart"in window)&&i instanceof Element&&(i.style.cursor=t)};var sC=class extends Ms{constructor(t){t=t||{};var e=lt.create("DIV",{className:t.switcherClass||"ol-layerswitcher"});super({element:e,target:t.target});var n=this;this.dcount=0,this.show_progress=t.show_progress,this.oninfo=typeof t.oninfo=="function"?t.oninfo:null,this.onextent=typeof t.onextent=="function"?t.onextent:null,this.hasextent=t.extent||t.onextent,this.hastrash=t.trash,this.reordering=t.reordering!==!1,this._layers=[],this._layerGroup=t.layerGroup&&t.layerGroup.getLayers?t.layerGroup:null,this.onchangeCheck=typeof t.onchangeCheck=="function"?t.onchangeCheck:null,typeof t.displayInLayerSwitcher=="function"&&(this.displayInLayerSwitcher=t.displayInLayerSwitcher),t.target||(e.classList.add("ol-unselectable"),e.classList.add("ol-control"),e.classList.add(t.collapsed!==!1?"ol-collapsed":"ol-forceopen"),this.button=lt.create("BUTTON",{type:"button",parent:e}),this.button.addEventListener("touchstart",function(s){e.classList.toggle("ol-forceopen"),e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:e.classList.contains("ol-collapsed")}),s.preventDefault(),n.overflow()}),this.button.addEventListener("click",function(){e.classList.toggle("ol-forceopen"),e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!e.classList.contains("ol-forceopen")}),n.overflow()}),t.mouseover&&(e.addEventListener("mouseleave",function(){e.classList.add("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!0})}),e.addEventListener("mouseover",function(){e.classList.remove("ol-collapsed"),n.dispatchEvent({type:"toggle",collapsed:!1})})),t.minibar&&(t.noScroll=!0),t.noScroll||(this.topv=lt.create("DIV",{className:"ol-switchertopdiv",parent:e,click:function(){n.overflow("+50%")}}),this.botv=lt.create("DIV",{className:"ol-switcherbottomdiv",parent:e,click:function(){n.overflow("-50%")}})),this._noScroll=t.noScroll),this.panel_=lt.create("UL",{className:"panel"}),this.panelContainer_=lt.create("DIV",{className:"panel-container",html:this.panel_,parent:e}),!t.target&&!t.noScroll&&lt.addListener(this.panel_,"mousewheel DOMMouseScroll onmousewheel",function(s){n.overflow(Math.max(-1,Math.min(1,s.wheelDelta||-s.detail)))&&(s.stopPropagation(),s.preventDefault())}),this.header_=lt.create("LI",{className:"ol-header",parent:this.panel_}),this.set("drawDelay",t.drawDelay||0),this.set("selection",t.selection),t.minibar&&setTimeout((function(){var s=lt.scrollDiv(this.panelContainer_,{mousewheel:!0,vertical:!0,minibar:!0});this.on(["drawlist","toggle"],function(){s.refresh()})}).bind(this))}displayInLayerSwitcher(t){return t.get("displayInLayerSwitcher")!==!1}setMap(t){if(super.setMap(t),this.drawPanel(),this._listener)for(var e in this._listener)Ar(this._listener[e]);this._listener=null,t&&(this._listener={moveend:t.on("moveend",this.viewChange.bind(this)),size:t.on("change:size",this.overflow.bind(this))},this._layerGroup?this._listener.change=this._layerGroup.getLayers().on("change:length",this.drawPanel.bind(this)):this._listener.change=t.getLayerGroup().getLayers().on("change:length",this.drawPanel.bind(this)))}show(){this.element.classList.add("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!1})}hide(){this.element.classList.remove("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!0})}toggle(){this.element.classList.toggle("ol-forceopen"),this.overflow(),this.dispatchEvent({type:"toggle",collapsed:!this.isOpen()})}isOpen(){return this.element.classList.contains("ol-forceopen")}setHeader(t){lt.setHTML(this.header_,t)}overflow(t){if(this.button&&!this._noScroll){if(lt.hidden(this.panel_)){lt.setStyle(this.element,{height:"auto"});return}var e=lt.outerHeight(this.element),n=lt.outerHeight(this.panel_),s=this.button.offsetTop+lt.outerHeight(this.button),r=this.panel_.offsetTop-s;if(n>e-s){lt.setStyle(this.element,{height:"100%"});var o=this.panel_.querySelectorAll("li.ol-visible .li-content")[0],a=o?2*lt.getStyle(o,"height"):0;switch(t){case 1:r+=a;break;case-1:r-=a;break;case"+50%":r+=Math.round(e/2);break;case"-50%":r-=Math.round(e/2);break}return r+n<=e-3*s/2?(r=e-3*s/2-n,lt.hide(this.botv)):lt.show(this.botv),r>=0?(r=0,lt.hide(this.topv)):lt.show(this.topv),lt.setStyle(this.panel_,{top:r+"px"}),!0}else return lt.setStyle(this.element,{height:"auto"}),lt.setStyle(this.panel_,{top:0}),lt.hide(this.botv),lt.hide(this.topv),!1}else return!1}_setLayerForLI(t,e){var n=[];e.getLayers&&n.push(e.getLayers().on("change:length",this.drawPanel.bind(this))),t&&(n.push(e.on("change:opacity",(function(){this.setLayerOpacity(e,t)}).bind(this))),n.push(e.on("change:visible",(function(){this.setLayerVisibility(e,t)}).bind(this)))),n.push(e.on("propertychange",(function(s){(s.key==="displayInLayerSwitcher"||s.key==="openInLayerSwitcher"||s.key==="title"||s.key==="name")&&this.drawPanel(s)}).bind(this))),this._layers.push({li:t,layer:e,listeners:n})}setLayerOpacity(t,e){var n=e.querySelector(".layerswitcher-opacity-cursor");n&&(n.style.left=t.getOpacity()*100+"%"),this.dispatchEvent({type:"layer:opacity",layer:t})}setLayerVisibility(t,e){var n=e.querySelector(".ol-visibility");n&&(n.checked=t.getVisible()),t.getVisible()?e.classList.add("ol-visible"):e.classList.remove("ol-visible"),this.dispatchEvent({type:"layer:visible",layer:t})}_clearLayerForLI(){this._layers.forEach(function(t){t.listeners.forEach(function(e){Ar(e)})}),this._layers=[]}_getLayerForLI(t){for(var e=0,n;n=this._layers[e];e++)if(n.li===t)return n.layer;return null}viewChange(){this.panel_.querySelectorAll("li").forEach((function(t){var e=this._getLayerForLI(t);e&&(this.testLayerVisibility(e)?t.classList.remove("ol-layer-hidden"):t.classList.add("ol-layer-hidden"))}).bind(this))}getPanel(){return this.panelContainer_}drawPanel(){if(this.getMap()){var t=this;this.dcount++,setTimeout(function(){t.drawPanel_()},this.get("drawDelay")||0)}}drawPanel_(){if(!(--this.dcount||this.dragging_)){var t=this.panelContainer_.scrollTop;this._clearLayerForLI(),this.panel_.querySelectorAll("li").forEach((function(e){e.classList.contains("ol-header")||e.remove()}).bind(this)),this._layerGroup?this.drawList(this.panel_,this._layerGroup.getLayers()):this.getMap()&&this.drawList(this.panel_,this.getMap().getLayers()),this.panelContainer_.scrollTop=t}}switchLayerVisibility(t,e){t.get("baseLayer")?(t.getVisible()||t.setVisible(!0),e.forEach(function(n){t!==n&&n.get("baseLayer")&&n.getVisible()&&n.setVisible(!1)})):t.setVisible(!t.getVisible())}testLayerVisibility(t){if(!this.getMap())return!0;var e=this.getMap().getView().getResolution(),n=this.getMap().getView().getZoom();if(t.getMaxResolution()<=e||t.getMinResolution()>=e)return!1;if(t.getMinZoom&&(t.getMinZoom()>=n||t.getMaxZoom()<n))return!1;var s=t.getExtent();if(s){var r=this.getMap().getView().calculateExtent(this.getMap().getSize());return Ri(r,s)}return!0}dragOrdering_(t){t.stopPropagation(),t.preventDefault();var e=this,n=t.currentTarget.parentNode.parentNode,s=!0,r=this.panel_,o,a=t.pageY||t.touches&&t.touches.length&&t.touches[0].pageY||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageY,l,h,c,u;n.parentNode.classList.add("drag");function f(){if(l){var g=c,p=e.getSelection()===g;if(g&&l){var y;u?y=u.getLayers():y=e._layerGroup?e._layerGroup.getLayers():e.getMap().getLayers();for(var _=y.getArray(),x=0;x<_.length;x++)if(_[x]==g){y.removeAt(x);break}for(var b=0;b<_.length;b++)if(_[b]===l){x>b?y.insertAt(b,g):y.insertAt(b+1,g);break}}p&&e.selectLayer(g),e.dispatchEvent({type:"reorder-end",layer:g,group:u})}n.parentNode.querySelectorAll("li").forEach(function(L){L.classList.remove("dropover"),L.classList.remove("dropover-after"),L.classList.remove("dropover-before")}),n.classList.remove("drag"),n.parentNode.classList.remove("drag"),e.element.classList.remove("drag"),h&&h.remove(),lt.removeListener(document,"mousemove touchmove",d),lt.removeListener(document,"mouseup touchend touchcancel",f)}function d(g){if(o=g.pageY||g.touches&&g.touches.length&&g.touches[0].pageY||g.changedTouches&&g.changedTouches.length&&g.changedTouches[0].pageY,s&&Math.abs(a-o)>2&&(s=!1,n.classList.add("drag"),c=e._getLayerForLI(n),l=!1,u=e._getLayerForLI(n.parentNode.parentNode),h=lt.create("LI",{className:"ol-dragover",html:n.innerHTML,style:{position:"absolute","z-index":1e4,left:n.offsetLeft,opacity:.5,width:lt.outerWidth(n),height:lt.getStyle(n,"height")},parent:r}),e.element.classList.add("drag"),e.dispatchEvent({type:"reorder-start",layer:c,group:u})),!s){g.preventDefault(),g.stopPropagation(),lt.setStyle(h,{top:o-lt.offsetRect(r).top+r.scrollTop+5});var p;if(!g.touches)p=g.target,g.target.shadowRoot&&(p=g.composedPath()[0]);else for(p=document.elementFromPoint(g.touches[0].clientX,g.touches[0].clientY);p.shadowRoot;)p=p.shadowRoot.elementFromPoint(g.touches[0].clientX,g.touches[0].clientY);for(p.classList.contains("ol-switcherbottomdiv")?e.overflow(-1):p.classList.contains("ol-switchertopdiv")&&e.overflow(1);p&&p.tagName!=="LI";)p=p.parentNode;(!p||!p.classList.contains("dropover"))&&n.parentNode.querySelectorAll("li").forEach(function(y){y.classList.remove("dropover"),y.classList.remove("dropover-after"),y.classList.remove("dropover-before")}),p&&p.parentNode.classList.contains("drag")&&p!==n?(l=e._getLayerForLI(p),l&&!l.get("allwaysOnTop")==!c.get("allwaysOnTop")?(p.classList.add("dropover"),p.classList.add(n.offsetTop<p.offsetTop?"dropover-after":"dropover-before")):l=!1,lt.show(h)):(l=!1,p===n?lt.hide(h):lt.show(h)),l?h.classList.remove("forbidden"):h.classList.add("forbidden")}}lt.addListener(document,"mousemove touchmove",d),lt.addListener(document,"mouseup touchend touchcancel",f)}dragOpacity_(t){t.stopPropagation(),t.preventDefault();var e=this,n=t.target,s=this._getLayerForLI(n.parentNode.parentNode.parentNode);if(!s)return;var r=t.pageX||t.touches&&t.touches.length&&t.touches[0].pageX||t.changedTouches&&t.changedTouches.length&&t.changedTouches[0].pageX,o=lt.getStyle(n,"left")-r;e.dragging_=!0;function a(){lt.removeListener(document,"mouseup touchend touchcancel",a),lt.removeListener(document,"mousemove touchmove",l),e.dragging_=!1}function l(h){var c=h.pageX||h.touches&&h.touches.length&&h.touches[0].pageX||h.changedTouches&&h.changedTouches.length&&h.changedTouches[0].pageX,u=(o+c)/lt.getStyle(n.parentNode,"width"),f=Math.max(0,Math.min(1,u));lt.setStyle(n,{left:f*100+"%"}),n.parentNode.nextElementSibling.innerHTML=Math.round(f*100),s.setOpacity(f)}lt.addListener(document,"mouseup touchend touchcancel",a),lt.addListener(document,"mousemove touchmove",l)}drawList(t,e){var n=this,s=e.getArray(),r=function(u){u.stopPropagation(),u.preventDefault();var f=n._getLayerForLI(this.parentNode.parentNode);n.switchLayerVisibility(f,e),n.get("selection")&&f.getVisible()&&n.selectLayer(f),n.onchangeCheck&&n.onchangeCheck(f)};function o(u){u.stopPropagation(),u.preventDefault();var f=n._getLayerForLI(this.parentNode.parentNode);n.oninfo(f),n.dispatchEvent({type:"info",layer:f})}function a(u){u.stopPropagation(),u.preventDefault();var f=n._getLayerForLI(this.parentNode.parentNode);n.onextent?n.onextent(f):n.getMap().getView().fit(f.getExtent(),n.getMap().getSize()),n.dispatchEvent({type:"extent",layer:f})}function l(u){u.stopPropagation(),u.preventDefault();var f=this.parentNode.parentNode.parentNode.parentNode,d,g=n._getLayerForLI(f);g?(d=n._getLayerForLI(this.parentNode.parentNode),g.getLayers().remove(d),g.getLayers().getLength()==0&&!g.get("noSwitcherDelete")&&l.call(f.querySelectorAll(".layerTrash")[0],u)):(f=this.parentNode.parentNode,n.getMap().removeLayer(n._getLayerForLI(f)))}function h(u){if(!this.displayInLayerSwitcher(u)){this._setLayerForLI(null,u);return}var f=lt.create("LI",{className:(u.getVisible()?"ol-visible ":" ")+(u.get("baseLayer")?"baselayer":""),parent:t});this._setLayerForLI(f,u),this._selectedLayer===u&&f.classList.add("ol-layer-select");var d=lt.create("DIV",{className:"ol-layerswitcher-buttons",parent:f}),g=lt.create("DIV",{className:"li-content",parent:f});lt.create("INPUT",{type:u.get("baseLayer")?"radio":"checkbox",className:"ol-visibility",checked:u.getVisible(),click:r,parent:g});var p=lt.create("LABEL",{title:u.get("title")||u.get("name"),click:r,style:{userSelect:"none"},parent:g});if(p.addEventListener("selectstart",function(){return!1}),lt.create("SPAN",{html:u.get("title")||u.get("name"),click:(function(M){this.get("selection")&&(M.stopPropagation(),this.selectLayer(u))}).bind(this),parent:p}),this.reordering&&(c<s.length-1&&(u.get("allwaysOnTop")||!s[c+1].get("allwaysOnTop"))||c>0&&(!u.get("allwaysOnTop")||s[c-1].get("allwaysOnTop")))&&lt.create("DIV",{className:"layerup ol-noscroll",title:this.tip.up,on:{"mousedown touchstart":function(M){n.dragOrdering_(M)}},parent:d}),u.getLayers){var y=0;u.getLayers().forEach(function(M){n.displayInLayerSwitcher(M)&&y++}),y&&lt.create("DIV",{className:u.get("openInLayerSwitcher")?"collapse-layers":"expend-layers",title:this.tip.plus,click:function(){var M=n._getLayerForLI(this.parentNode.parentNode);M.set("openInLayerSwitcher",!M.get("openInLayerSwitcher"))},parent:d})}if(this.oninfo&&lt.create("DIV",{className:"layerInfo",title:this.tip.info,click:o,parent:d}),this.hastrash&&!u.get("noSwitcherDelete")&&lt.create("DIV",{className:"layerTrash",title:this.tip.trash,click:l,parent:d}),this.hasextent&&s[c].getExtent()){var _=s[c].getExtent();_.length==4&&_[0]<_[2]&&_[1]<_[3]&&lt.create("DIV",{className:"layerExtent",title:this.tip.extent,click:a,parent:d})}if(this.show_progress&&u instanceof Yn){var x=lt.create("DIV",{className:"layerswitcher-progress",parent:g});this.setprogress_(u),u.layerswitcher_progress=lt.create("DIV",{parent:x})}var b=lt.create("DIV",{className:"layerswitcher-opacity",click:function(M){if(M.target===this){M.stopPropagation(),M.preventDefault();var k=Math.max(0,Math.min(1,M.offsetX/lt.getStyle(this,"width")));n._getLayerForLI(this.parentNode.parentNode).setOpacity(k),this.parentNode.querySelectorAll(".layerswitcher-opacity-label")[0].innerHTML=Math.round(k*100)}},parent:g});if(lt.create("DIV",{className:"layerswitcher-opacity-cursor ol-noscroll",style:{left:u.getOpacity()*100+"%"},on:{"mousedown touchstart":function(M){n.dragOpacity_(M)}},parent:b}),lt.create("DIV",{className:"layerswitcher-opacity-label",html:Math.round(u.getOpacity()*100),parent:g}),u.getLayers&&(f.classList.add("ol-layer-group"),u.get("openInLayerSwitcher")===!0)){var L=lt.create("UL",{parent:f});this.drawList(L,u.getLayers())}f.classList.add(this.getLayerClass(u)),this.dispatchEvent({type:"drawlist",layer:u,li:f})}for(var c=s.length-1;c>=0;c--)h.call(this,s[c]);this.viewChange(),t===this.panel_&&this.overflow()}getLayerClass(t){return t?t.getLayers?"ol-layer-group":t instanceof Rr?"ol-layer-vector":t instanceof H6?"ol-layer-vectortile":t instanceof Yn?"ol-layer-tile":t instanceof M2?"ol-layer-image":t instanceof bF?"ol-layer-heatmap":t.getFeatures?"ol-layer-vectorimage":"unknown":"none"}selectLayer(t,e){if(!t){if(!this.getMap())return;t=this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)}this._selectedLayer=t,this.drawPanel(),e||this.dispatchEvent({type:"select",layer:t})}getSelection(){return this._selectedLayer}setprogress_(t){if(!t.layerswitcher_progress){var e=0,n=0,s=function(){n===e?(n=e=0,lt.setStyle(t.layerswitcher_progress,{width:0})):lt.setStyle(t.layerswitcher_progress,{width:(e/n*100).toFixed(1)+"%"})};t.getSource().on("tileloadstart",function(){n++,s()}),t.getSource().on("tileloadend",function(){e++,s()}),t.getSource().on("tileloaderror",function(){e++,s()})}}};sC.prototype.tip={up:"up/down",down:"down",info:"informations...",extent:"zoom to extent",trash:"remove layer",plus:"expand/shrink"};var z2=class extends Ms{constructor(t){t=t||{};var e=(t.className||"")+" ol-search"+(t.target?"":" ol-unselectable ol-control"),n=lt.create("DIV",{className:e});super({element:n,target:t.target});var s=this;if(t.typing==null&&(t.typing=300),this._classname=t.className||"search",t.collapsed!==!1&&n.classList.add("ol-collapsed"),t.target||(this.button=document.createElement("BUTTON"),this.button.setAttribute("type","button"),this.button.setAttribute("title",t.title||t.label||"Search"),this.button.addEventListener("click",function(){if(n.classList.toggle("ol-collapsed"),!n.classList.contains("ol-collapsed")){n.querySelector("input.search").focus();for(var f=n.querySelectorAll("li"),d=0;d<f.length;d++)f[d].classList.remove("select");l.value||s.drawList_()}}),n.appendChild(this.button)),t.inputLabel){var r=document.createElement("LABEL");r.innerText=t.inputLabel,n.appendChild(r)}var o,a="",l=this._input=document.createElement("INPUT");l.setAttribute("type","search"),l.setAttribute("class","search"),l.setAttribute("autocomplete","off"),l.setAttribute("placeholder",t.placeholder||"Search..."),l.addEventListener("change",function(f){s.dispatchEvent({type:"change:input",input:f,value:l.value})});var h=function(f){var d=n.querySelector("ul.autocomplete li.select"),g=l.value;if(f.key=="ArrowDown"||f.key=="ArrowUp"||f.key=="Down"||f.key=="Up")d?(d.classList.remove("select"),d=/Down/.test(f.key)?d.nextElementSibling:d.previousElementSibling,d&&d.classList.add("select")):n.querySelector("ul.autocomplete li").classList.add("select");else if(f.type=="input"&&!g)setTimeout(function(){s.drawList_()},200);else if(d&&(f.type=="search"||f.key=="Enter"))n.classList.contains("ol-control")&&l.blur(),d.classList.remove("select"),a=g,s._handleSelect(s._list[d.getAttribute("data-search")]);else if(f.type=="search"||f.key=="Enter"||a!=g&&t.typing>=0)if(a=g,a){o&&clearTimeout(o);var p=s.get("minLength");o=setTimeout(function(){if(a.length>=p){var y=s.autocomplete(a,function(_){s.drawList_(_)});y&&s.drawList_(y)}else s.drawList_()},t.typing)}else s.drawList_();else d=n.querySelector("ul.autocomplete li"),d&&d.classList.remove("select")};if(l.addEventListener("keyup",h),l.addEventListener("search",h),l.addEventListener("cut",h),l.addEventListener("paste",h),l.addEventListener("input",h),t.noCollapse||(l.addEventListener("blur",(function(){setTimeout((function(){l!==document.activeElement&&(n.classList.add("ol-collapsed"),this.set("reverse",!1),n.classList.remove("ol-revers"))}).bind(this),200)}).bind(this)),l.addEventListener("focus",(function(){this.get("reverse")||(n.classList.remove("ol-collapsed"),n.classList.remove("ol-revers"))}).bind(this))),n.appendChild(l),t.reverse){var c=lt.create("BUTTON",{type:"button",class:"ol-revers",title:t.reverseTitle||"click on the map",click:(function(){this.get("reverse")?this.set("reverse",!1):(this.set("reverse",!this.get("reverse")),l.focus(),n.classList.add("ol-revers"))}).bind(this)});n.appendChild(c)}var u=document.createElement("UL");u.classList.add("autocomplete"),n.appendChild(u),typeof t.getTitle=="function"&&(this.getTitle=t.getTitle),typeof t.autocomplete=="function"&&(this.autocomplete=t.autocomplete),this.set("copy",t.copy),this.set("minLength",t.minLength||1),this.set("maxItems",t.maxItems||10),this.set("maxHistory",t.maxHistory||t.maxItems||10),t.onselect&&this.on("select",t.onselect),t.centerOnSelect&&this.on("select",(function(f){var d=this.getMap();d&&d.getView().setCenter(f.coordinate)}).bind(this)),t.zoomOnSelect&&this.on("select",(function(f){var d=this.getMap();d&&(d.getView().setCenter(f.coordinate),d.getView().getZoom()<t.zoomOnSelect&&d.getView().setZoom(t.zoomOnSelect))}).bind(this)),this.restoreHistory(),this.drawList_()}setMap(t){this._listener&&Ar(this._listener),this._listener=null,super.setMap(t),t&&(this._listener=t.on("click",this._handleClick.bind(this)))}collapse(t){t===!1?this.element.classList.remove("ol-collapsed"):this.element.classList.add("ol-collapsed")}getInputField(){return this._input}getTitle(t){return t.name||"No title"}_getTitleTxt(t){return lt.create("DIV",{html:this.getTitle(t)}).innerText}search(){var t=this.element.querySelector("input.search");this._triggerCustomEvent("search",t)}_handleClick(t){this.get("reverse")&&(document.activeElement.blur(),this.reverseGeocode(t.coordinate))}reverseGeocode(){}_triggerCustomEvent(t,e){lt.dispatchEvent(t,e)}setInput(t,e){var n=this.element.querySelector("input.search");n.value=t,e&&this._triggerCustomEvent("keyup",n)}select(t,e,n,s){var r={type:"select",search:t,reverse:!!e,coordinate:n};if(s)for(var o in s)r[o]=s[o];this.dispatchEvent(r)}_handleSelect(t,e,n){if(t){var s=this.get("history"),r;try{var o=JSON.stringify(t);for(r=s.length-1;r>=0;r--)(!s[r]||JSON.stringify(s[r])===o)&&s.splice(r,1)}catch{for(r=s.length-1;r>=0;r--)s[r]===t&&s.splice(r,1)}s.unshift(t);for(var a=Math.max(0,this.get("maxHistory")||10)||0;s.length>a;)s.pop();this.saveHistory(),this.select(t,e,null,n),e&&(this.setInput(this._getTitleTxt(t)),this.drawList_(),setTimeout((function(){this.collapse(!1)}).bind(this),300))}}saveHistory(){try{this.get("maxHistory")>=0?localStorage["ol@search-"+this._classname]=JSON.stringify(this.get("history")):localStorage.removeItem("ol@search-"+this._classname)}catch{console.warn("Failed to access localStorage...")}}restoreHistory(){if(this._history[this._classname])this.set("history",this._history[this._classname]);else try{this._history[this._classname]=JSON.parse(localStorage["ol@search-"+this._classname]),this.set("history",this._history[this._classname])}catch{this.set("history",[])}}clearHistory(){this.set("history",[]),this.saveHistory(),this.drawList_()}getHistory(){return this.get("history")}autocomplete(t,e){return e([]),!1}drawList_(t){var e=this,n=this.element.querySelector("ul.autocomplete");if(n.innerHTML="",this._list=[],t)n.setAttribute("class","autocomplete");else{var s=this.element.querySelector("input.search"),r=s.value;if(!r)t=this.get("history");else return;n.setAttribute("class","autocomplete history")}for(var o,a=Math.min(e.get("maxItems"),t.length),l=0;l<a;l++)if(t[l]&&(!l||!e.equalFeatures(t[l],t[l-1]))){o=document.createElement("LI"),o.setAttribute("data-search",this._list.length),this._list.push(t[l]),o.addEventListener("click",function(c){e._handleSelect(e._list[c.currentTarget.getAttribute("data-search")])});var h=e.getTitle(t[l]);h instanceof Element?o.appendChild(h):o.innerHTML=h,n.appendChild(o)}a&&this.get("copy")&&(o=document.createElement("LI"),o.classList.add("copy"),o.innerHTML=this.get("copy"),n.appendChild(o))}equalFeatures(){return!1}};z2.prototype._history={};var rC=class extends In{constructor(t){t=t||{},super(),this._auth=t.auth,this.set("dataType",t.dataType||"JSON")}static get(t){var e=new rC(t);t.success&&e.on("success",function(n){t.success(n.response,n)}),t.error&&e.on("error",function(n){t.error(n)}),e.send(t.url,t.data,t.options)}static getCORS(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.send(),n.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&e(n.getResponseHeader("Access-Control-Allow-Origin"))}}send(t,e,n){n=n||{};var s=this,r=n.encode!==!1;r&&(t=encodeURI(t));var o="";for(var a in e)e.hasOwnProperty(a)&&e[a]!==void 0&&(o+=(o?"&":"?")+a+"="+(r?encodeURIComponent(e[a]):e[a]));this._request&&n.abort!==!1&&this._request.abort();var l=this._request=new XMLHttpRequest;l.open("GET",t+o,!0),n.timeout&&(l.timeout=n.timeout),this._auth&&l.setRequestHeader("Authorization","Basic "+this._auth),this.dispatchEvent({type:"loadstart"}),l.onload=function(){if(s._request=null,s.dispatchEvent({type:"loadend"}),this.status>=200&&this.status<400){var h;try{switch(s.get("dataType")){case"JSON":{h=JSON.parse(this.response);break}default:h=this.response}}catch(c){s.dispatchEvent({type:"error",status:0,statusText:"parsererror",error:c,options:n,jqXHR:this});return}s.dispatchEvent({type:"success",response:h,status:this.status,statusText:this.statusText,options:n,jqXHR:this})}else s.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:n,jqXHR:this})},l.ontimeout=function(){s._request=null,s.dispatchEvent({type:"loadend"}),s.dispatchEvent({type:"error",status:this.status,statusText:"Timeout",options:n,jqXHR:this})},l.onerror=function(){s._request=null,s.dispatchEvent({type:"loadend"}),s.dispatchEvent({type:"error",status:this.status,statusText:this.statusText,options:n,jqXHR:this})},l.send()}},LF=class extends z2{constructor(t){t=t||{},t.className=t.className||"JSON",delete t.autocomplete,t.minLength=t.minLength||3,t.typing=t.typing||800,super(t);var e=t.url||"";if(window.location.protocol==="https:"){var n=document.createElement("a");n.href=e,n.protocol=window.location.protocol,e=n.href}this.set("url",e),this._ajax=new rC({dataType:"JSON",auth:t.authentication}),this._ajax.on("success",(function(s){s.status>=200&&s.status<400?typeof this._callback=="function"&&this._callback(s.response):(typeof this._callback=="function"&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments))}).bind(this)),this._ajax.on("error",(function(){typeof this._callback=="function"&&this._callback(!1,"error"),console.log("AJAX ERROR",arguments)}).bind(this)),this._ajax.on("loadstart",(function(){this.element.classList.add("searching")}).bind(this)),this._ajax.on("loadend",(function(){this.element.classList.remove("searching")}).bind(this)),typeof t.handleResponse=="function"&&(this.handleResponse=t.handleResponse)}ajax(t,e,n,s){s=s||{},this._callback=n,this._ajax.set("dataType",s.dataType||"JSON"),this._ajax.send(t,e,s)}autocomplete(t,e){var n=this.requestData(t),s=encodeURI(this.get("url"));this.ajax(s,n,function(r){typeof e=="function"&&e(this.handleResponse(r))})}requestData(t){return{q:t}}handleResponse(t){return t}},MF=class extends LF{constructor(t){t=t||{},t.className=t.className||"nominatim",t.typing=t.typing||-1,t.url=t.url||"https://nominatim.openstreetmap.org/search",t.copy='<a href="http://www.openstreetmap.org/copyright" target="new">&copy; OpenStreetMap contributors</a>',super(t),this.set("polygon",t.polygon),this.set("viewbox",t.viewbox),this.set("bounded",t.bounded)}getTitle(t){var e=[];t.class&&e.push(t.class),t.type&&e.push(t.type);var n=t.display_name+(e.length?"<i>"+e.join(" - ")+"</i>":"");return t.icon&&(n="<img src='"+t.icon+"' />"+n),n}requestData(t){var e={format:"json",addressdetails:1,q:t,polygon_geojson:this.get("polygon")?1:0,bounded:this.get("bounded")?1:0,limit:this.get("maxItems")};return this.get("viewbox")&&(e.viewbox=this.get("viewbox")),e}select(t){var e=[Number(t.lon),Number(t.lat)];try{e=Zi(e,"EPSG:4326",this.getMap().getView().getProjection())}catch{}this.dispatchEvent({type:"select",search:t,coordinate:e})}reverseGeocode(t,e){var n=Zi(t,this.getMap().getView().getProjection(),"EPSG:4326");this.ajax(this.get("url").replace("search","reverse"),{lon:n[0],lat:n[1],format:"json"},(function(s){e?e.call(this,[s]):s&&!s.error&&this._handleSelect(s,!0)}).bind(this))}handleResponse(t){return t.results||t}};const TF={ADD_FEATURES:"addfeatures"};class AF extends os{constructor(t,e,n,s){super(t),this.features=n,this.file=e,this.projection=s}}class PF extends sh{constructor(t){t=t||{},super({handleEvent:Yo}),this.on,this.once,this.un,this.readAsBuffer_=!1,this.formats_=[];const e=t.formatConstructors?t.formatConstructors:[];for(let n=0,s=e.length;n<s;++n){let r=e[n];typeof r=="function"&&(r=new r),this.formats_.push(r),this.readAsBuffer_=this.readAsBuffer_||r.getType()==="arraybuffer"}this.projection_=t.projection?xe(t.projection):null,this.dropListenKeys_=null,this.source_=t.source||null,this.target=t.target?t.target:null}handleResult_(t,e){const n=e.target.result,s=this.getMap();let r=this.projection_;r||(r=uS(),r||(r=s.getView().getProjection()));let o;const a=this.formats_;for(let l=0,h=a.length;l<h;++l){const c=a[l];let u=n;this.readAsBuffer_&&c.getType()!=="arraybuffer"&&(o===void 0&&(o=new TextDecoder().decode(n)),u=o);const f=this.tryReadFeatures_(c,u,{featureProjection:r});if(f&&f.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(f)),this.dispatchEvent(new AF(TF.ADD_FEATURES,t,f,r));break}}}registerListeners_(){const t=this.getMap();if(t){const e=this.target?this.target:t.getViewport();this.dropListenKeys_=[ve(e,ce.DROP,this.handleDrop,this),ve(e,ce.DRAGENTER,this.handleStop,this),ve(e,ce.DRAGOVER,this.handleStop,this),ve(e,ce.DROP,this.handleStop,this)]}}setActive(t){!this.getActive()&&t&&this.registerListeners_(),this.getActive()&&!t&&this.unregisterListeners_(),super.setActive(t)}setMap(t){this.unregisterListeners_(),super.setMap(t),this.getActive()&&this.registerListeners_()}tryReadFeatures_(t,e,n){try{return t.readFeatures(e,n)}catch{return null}}unregisterListeners_(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(Ke),this.dropListenKeys_=null)}handleDrop(t){const e=t.dataTransfer.files;for(let n=0,s=e.length;n<s;++n){const r=e.item(n),o=new FileReader;o.addEventListener(ce.LOAD,this.handleResult_.bind(this,r)),this.readAsBuffer_?o.readAsArrayBuffer(r):o.readAsText(r)}}handleStop(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}}const Ug={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Wg extends os{constructor(t,e){super(t),this.feature=e}}function IF(i,t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].getGeometry();oC(i,r,e)}return e}function qg(i,t){return Wo(i[0],i[1],t[0],t[1])}function pc(i,t){const e=i.length;return t<0?i[t+e]:t>=e?i[t-e]:i[t]}function Vg(i,t,e){let n,s;t<e?(n=t,s=e):(n=e,s=t);const r=Math.ceil(n),o=Math.floor(s);if(r>o){const l=mc(i,n),h=mc(i,s);return qg(l,h)}let a=0;if(n<r){const l=mc(i,n),h=pc(i,r);a+=qg(l,h)}if(o<s){const l=pc(i,o),h=mc(i,s);a+=qg(l,h)}for(let l=r;l<o-1;++l){const h=pc(i,l),c=pc(i,l+1);a+=qg(h,c)}return a}function oC(i,t,e){if(t instanceof cn){Hg(i,t.getCoordinates(),!1,e);return}if(t instanceof ho){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s)Hg(i,n[s],!1,e);return}if(t instanceof sr){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s)Hg(i,n[s],!0,e);return}if(t instanceof qa){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s){const o=n[s];for(let a=0,l=o.length;a<l;++a)Hg(i,o[a],!0,e)}return}if(t instanceof rr){const n=t.getGeometries();for(let s=0;s<n.length;++s)oC(i,n[s],e);return}}const O1={index:-1,endIndex:NaN};function RF(i,t,e,n){const s=i[0],r=i[1];let o=1/0,a=-1,l=NaN;for(let u=0;u<t.targets.length;++u){const f=t.targets[u],d=f.coordinates;let g=1/0,p;for(let y=0;y<d.length-1;++y){const _=d[y],x=d[y+1],b=aC(s,r,_,x);b.squaredDistance<g&&(g=b.squaredDistance,p=y+b.along)}g<o&&(o=g,f.ring&&t.targetIndex===u&&(f.endIndex>f.startIndex?p<f.startIndex&&(p+=d.length):f.endIndex<f.startIndex&&p>f.startIndex&&(p-=d.length)),l=p,a=u)}const h=t.targets[a];let c=h.ring;if(t.targetIndex===a&&c){const u=mc(h.coordinates,l),f=e.getPixelFromCoordinate(u);Up(f,t.startPx)>n&&(c=!1)}if(c){const u=h.coordinates,f=u.length,d=h.startIndex,g=l;if(d<g){const p=Vg(u,d,g);Vg(u,d,g-f)<p&&(l-=f)}else{const p=Vg(u,d,g);Vg(u,d,g+f)<p&&(l+=f)}}return O1.index=a,O1.endIndex=l,O1}function Hg(i,t,e,n){const s=i[0],r=i[1];for(let o=0,a=t.length-1;o<a;++o){const l=t[o],h=t[o+1],c=aC(s,r,l,h);if(c.squaredDistance===0){const u=o+c.along;n.push({coordinates:t,ring:e,startIndex:u,endIndex:u});return}}}const D1={along:0,squaredDistance:0};function aC(i,t,e,n){const s=e[0],r=e[1],o=n[0],a=n[1],l=o-s,h=a-r;let c=0,u=s,f=r;return(l!==0||h!==0)&&(c=xi(((i-s)*l+(t-r)*h)/(l*l+h*h),0,1),u+=l*c,f+=h*c),D1.along=c,D1.squaredDistance=wf(Wo(i,t,u,f),10),D1}function mc(i,t){const e=i.length;let n=Math.floor(t);const s=t-n;n>=e?n-=e:n<0&&(n+=e);let r=n+1;r>=e&&(r-=e);const o=i[n],a=o[0],l=o[1],h=i[r],c=h[0]-a,u=h[1]-l;return[a+c*s,l+u*s]}class G2 extends rh{constructor(t){const e=t;e.stopDown||(e.stopDown=$c),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=kF(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:Yo,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let n=t.geometryFunction;if(!n){const s=this.mode_;if(s==="Circle")n=(r,o,a)=>{const l=o||new K0([NaN,NaN]),h=Hi(r[0]),c=Oc(h,Hi(r[r.length-1]));return l.setCenterAndRadius(h,Math.sqrt(c),this.geometryLayout_),l};else{let r;s==="Point"?r=Qi:s==="LineString"?r=cn:s==="Polygon"&&(r=sr),n=(o,a,l)=>(a?s==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new r(o,this.geometryLayout_),a)}}this.geometryFunction_=n,this.dragVertexDelay_=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Rr({source:new Ws({useSpatialIndex:!1,wrapX:t.wrapX?t.wrapX:!1}),style:t.style?t.style:NF(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:v2,this.freehandCondition_,t.freehand?this.freehandCondition_=n0:this.freehandCondition_=t.freehandCondition?t.freehandCondition:x2,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(I_.ACTIVE,this.updateState_)}setTrace(t){let e;t?t===!0?e=n0:e=t:e=N_,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===ce.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(t);let e=t.type===Ge.POINTERMOVE,n=!0;return!this.freehand_&&this.lastDragTime_&&t.type===Ge.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===Ge.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(t.coordinate),n=!1):this.freehand_&&t.type===Ge.POINTERDOWN?n=!1:e&&this.getPointerCount()<2?(n=t.type===Ge.POINTERMOVE,n&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===Ge.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(t)):t.type===Ge.DBLCLICK&&(n=!1),super.handleEvent(t)&&n}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new No(Ge.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_();return}const e=this.getMap(),n=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),s=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),r=es([n,s]),o=this.traceSource_.getFeaturesInExtent(r);if(o.length===0)return;const a=IF(t.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const n=t.startIndex<=t.endIndex,s=t.startIndex<=e;n===s?n&&e>t.endIndex||!n&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(n&&e<t.endIndex||!n&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let n=0;if(t<e){const s=Math.ceil(t);let r=Math.floor(e);r===e&&(r-=1),n=r-s+1}else{const s=Math.floor(t);let r=Math.ceil(e);r===e&&(r+=1),n=s-r+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(t,e,n){if(e===n)return;const s=[];if(e<n){const r=Math.ceil(e);let o=Math.floor(n);o===n&&(o-=1);for(let a=r;a<=o;++a)s.push(pc(t.coordinates,a))}else{const r=Math.floor(e);let o=Math.ceil(n);o===n&&(o+=1);for(let a=r;a>=o;--a)s.push(pc(t.coordinates,a))}s.length&&this.appendCoordinates(s)}updateTrace_(t){const e=this.traceState_;if(!e.active||e.targetIndex===-1&&Up(e.startPx,t.pixel)<this.snapTolerance_)return;const n=RF(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==n.index){if(e.targetIndex!==-1){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=e.targets[n.index];this.addTracedCoordinates_(a,a.startIndex,n.endIndex)}else{const a=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(a,n.endIndex)}e.targetIndex=n.index;const s=e.targets[e.targetIndex];s.endIndex=n.endIndex;const r=mc(s.coordinates,s.endIndex),o=this.getMap().getPixelFromCoordinate(r);t.coordinate=r,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(t){let e=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const n=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const s=!this.finishCoordinate_;s&&this.startDrawing_(t.coordinate),!s&&this.freehand_?this.finishDrawing():!this.freehand_&&(!s||this.mode_==="Point")&&(this.atFinish_(t.pixel,n)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,n=t.pixel,s=e[0]-n[0],r=e[1]-n[1],o=s*s+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}atFinish_(t,e){let n=!1;if(this.sketchFeature_){let s=!1,r=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")n=!0;else if(o==="Circle")n=this.sketchCoords_.length===2;else if(o==="LineString")s=!e&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;s=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],e?r=[a[0][0]]:r=[a[0][0],a[0][a[0].length-2]]}if(s){const a=this.getMap();for(let l=0,h=r.length;l<h;l++){const c=r[l],u=a.getPixelFromCoordinate(c),f=t[0]-u[0],d=t[1]-u[1],g=this.freehand_?1:this.snapTolerance_;if(n=Math.sqrt(f*f+d*d)<=g,n){this.finishCoordinate_=c;break}}}}return n}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new gi(new Qi(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new gi);const e=t.getLinearRing(0);let n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),n.changed()):(n=new cn(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(t){const e=this.getMap().getView().getProjection(),n=qp(this.geometryLayout_);for(;t.length<n;)t.push(0);this.finishCoordinate_=t,this.mode_==="Point"?this.sketchCoords_=t.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new gi(new cn(this.sketchLineCoords_)));const s=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new gi,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(s),this.updateSketchFeatures_(),this.dispatchEvent(new Wg(Ug.DRAWSTART,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),n=this.sketchFeature_.getGeometry(),s=e.getView().getProjection(),r=qp(this.geometryLayout_);let o,a;for(;t.length<r;)t.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=t[0],a[1]=t[1],this.geometryFunction_(this.sketchCoords_,n,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),n.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(n):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();let s,r;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=t.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(t.slice()),this.geometryFunction_(r,e,n)):o==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(t.slice()),s&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,e,n)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),s?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),s=this.mode_;for(let r=0;r<t;++r){let o;if(s==="LineString"||s==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,n),e.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(s==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,n)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_;const n=t.getGeometry(),s=this.getMap().getView().getProjection();return this.mode_==="LineString"?(e.pop(),this.geometryFunction_(e,n,s)):this.mode_==="Polygon"&&(e[0].pop(),this.geometryFunction_(e,n,s),e=n.getCoordinates()),this.type_==="MultiPoint"?t.setGeometry(new nh([e])):this.type_==="MultiLineString"?t.setGeometry(new ho([e])):this.type_==="MultiPolygon"&&t.setGeometry(new qa([e])),this.dispatchEvent(new Wg(Ug.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new Wg(Ug.DRAWABORT,t))}appendCoordinates(t){const e=this.mode_,n=!this.sketchFeature_;n&&this.startDrawing_(t[0]);let s;if(e==="LineString"||e==="Circle")s=this.sketchCoords_;else if(e==="Polygon")s=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;n&&s.shift(),s.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const r=t[t.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(t){const n=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=n.getCoordinates();const s=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=s.slice(),this.sketchCoords_.push(s.slice()),this.sketchPoint_=new gi(new Qi(s)),this.updateSketchFeatures_(),this.dispatchEvent(new Wg(Ug.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}}function NF(){const i=s2();return function(t,e){return i[t.getGeometry().getType()]}}function kF(i){switch(i){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+i)}}const N5=0,Ld=1,k5=[0,0,0,0],bc=[],B1={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class j1 extends os{constructor(t,e,n){super(t),this.features=e,this.mapBrowserEvent=n}}class lC extends rh{constructor(t){super(t),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=t.condition?t.condition:gE,this.defaultDeleteCondition_=function(n){return hE(n)&&dE(n)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:n0,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new P_,this.pixelTolerance_=t.pixelTolerance!==void 0?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Rr({source:new Ws({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:OF(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let e;if(t.features?e=t.features:t.source&&(this.source_=t.source,e=new ns(this.source_.getFeatures()),this.source_.addEventListener(xn.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(xn.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!e)throw new Error("The modify interaction requires features, a source or a layer");t.hitDetection&&(this.hitDetection_=t.hitDetection),this.features_=e,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(an.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(an.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=t.snapToPointer===void 0?!this.hitDetection_:t.snapToPointer}addFeature_(t){const e=t.getGeometry();if(e){const s=this.SEGMENT_WRITERS_[e.getType()];s&&s(t,e)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener(ce.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ns;const n=this.featuresBeingModified_.getArray();for(let s=0,r=e.length;s<r;++s){const o=e[s];for(let a=0,l=o.length;a<l;++a){const h=o[a].feature;h&&!n.includes(h)&&this.featuresBeingModified_.push(h)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new j1(B1.MODIFYSTART,this.featuresBeingModified_,t))}}removeFeature_(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(ce.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(t){const e=this.rBush_,n=[];e.forEach(function(s){t===s.feature&&n.push(s)});for(let s=n.length-1;s>=0;--s){const r=n[s];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===r&&this.dragSegments_.splice(o,1);e.remove(r)}}setActive(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(t)}setMap(t){this.overlay_.setMap(t),super.setMap(t)}getOverlay(){return this.overlay_}handleSourceAdd_(t){t.feature&&this.features_.push(t.feature)}handleSourceRemove_(t){t.feature&&this.features_.remove(t.feature)}handleFeatureAdd_(t){this.addFeature_(t.element)}handleFeatureChange_(t){if(!this.changingFeature_){const e=t.target;this.removeFeature_(e),this.addFeature_(e)}}handleFeatureRemove_(t){this.removeFeature_(t.element)}writePointGeometry_(t,e){const n=e.getCoordinates(),s={feature:t,geometry:e,segment:[n,n]};this.rBush_.insert(e.getExtent(),s)}writeMultiPointGeometry_(t,e){const n=e.getCoordinates();for(let s=0,r=n.length;s<r;++s){const o=n[s],a={feature:t,geometry:e,depth:[s],index:s,segment:[o,o]};this.rBush_.insert(e.getExtent(),a)}}writeLineStringGeometry_(t,e){const n=e.getCoordinates();for(let s=0,r=n.length-1;s<r;++s){const o=n.slice(s,s+2),a={feature:t,geometry:e,index:s,segment:o};this.rBush_.insert(es(o),a)}}writeMultiLineStringGeometry_(t,e){const n=e.getCoordinates();for(let s=0,r=n.length;s<r;++s){const o=n[s];for(let a=0,l=o.length-1;a<l;++a){const h=o.slice(a,a+2),c={feature:t,geometry:e,depth:[s],index:a,segment:h};this.rBush_.insert(es(h),c)}}}writePolygonGeometry_(t,e){const n=e.getCoordinates();for(let s=0,r=n.length;s<r;++s){const o=n[s];for(let a=0,l=o.length-1;a<l;++a){const h=o.slice(a,a+2),c={feature:t,geometry:e,depth:[s],index:a,segment:h};this.rBush_.insert(es(h),c)}}}writeMultiPolygonGeometry_(t,e){const n=e.getCoordinates();for(let s=0,r=n.length;s<r;++s){const o=n[s];for(let a=0,l=o.length;a<l;++a){const h=o[a];for(let c=0,u=h.length-1;c<u;++c){const f=h.slice(c,c+2),d={feature:t,geometry:e,depth:[a,s],index:c,segment:f};this.rBush_.insert(es(f),d)}}}}writeCircleGeometry_(t,e){const n=e.getCenter(),s={feature:t,geometry:e,index:N5,segment:[n,n]},r={feature:t,geometry:e,index:Ld,segment:[n,n]},o=[s,r];s.featureSegments=o,r.featureSegments=o,this.rBush_.insert(_d(n),s);let a=e;this.rBush_.insert(a.getExtent(),r)}writeGeometryCollectionGeometry_(t,e){const n=e.getGeometriesArray();for(let s=0;s<n.length;++s){const r=n[s],o=this.SEGMENT_WRITERS_[r.getType()];o(t,r)}}createOrUpdateVertexFeature_(t,e,n){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(t):(s=new gi(new Qi(t)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",e),s.set("geometries",n),s}handleEvent(t){if(!t.originalEvent)return!0;this.lastPointerEvent_=t;let e;return!t.map.getView().getInteracting()&&t.type==Ge.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(t.type!=Ge.SINGLECLICK||!this.ignoreNextSingleClick_?e=this.removePoint():e=!0),t.type==Ge.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(t)&&!e}handleDragEvent(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);const e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],n=[],s=[];for(let r=0,o=this.dragSegments_.length;r<o;++r){const a=this.dragSegments_[r],l=a[0],h=l.feature;n.includes(h)||n.push(h);const c=l.geometry;s.includes(c)||s.push(c);const u=l.depth;let f;const d=l.segment,g=a[1];for(;e.length<c.getStride();)e.push(d[g][e.length]);switch(c.getType()){case"Point":f=e,d[0]=e,d[1]=e;break;case"MultiPoint":f=c.getCoordinates(),f[l.index]=e,d[0]=e,d[1]=e;break;case"LineString":f=c.getCoordinates(),f[l.index+g]=e,d[g]=e;break;case"MultiLineString":f=c.getCoordinates(),f[u[0]][l.index+g]=e,d[g]=e;break;case"Polygon":f=c.getCoordinates(),f[u[0]][l.index+g]=e,d[g]=e;break;case"MultiPolygon":f=c.getCoordinates(),f[u[1]][u[0]][l.index+g]=e,d[g]=e;break;case"Circle":if(d[0]=e,d[1]=e,l.index===N5)this.changingFeature_=!0,c.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,t.map.getView().getProjection();let p=Up(Hi(c.getCenter()),Hi(e));c.setRadius(p),this.changingFeature_=!1}break}f&&this.setGeometryCoordinates_(c,f)}this.createOrUpdateVertexFeature_(e,n,s)}handleDownEvent(t){if(!this.condition_(t))return!1;const e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(n){t.map.getView().getProjection();const s=[],r=n.getGeometry().getCoordinates(),o=es([r]),a=this.rBush_.getInExtent(o),l={};a.sort(FF);for(let h=0,c=a.length;h<c;++h){const u=a[h],f=u.segment;let d=le(u.geometry);const g=u.depth;if(g&&(d+="-"+g.join("-")),l[d]||(l[d]=new Array(2)),u.geometry.getType()==="Circle"&&u.index===Ld){const p=O5(e,u);br(p,r)&&!l[d][0]&&(this.dragSegments_.push([u,0]),l[d][0]=u);continue}if(br(f[0],r)&&!l[d][0]){this.dragSegments_.push([u,0]),l[d][0]=u;continue}if(br(f[1],r)&&!l[d][1]){if(l[d][0]&&l[d][0].index===0){let p=u.geometry.getCoordinates();switch(u.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":p=p[g[1]];case"Polygon":if(u.index!==p[g[0]].length-2)continue;break}}this.dragSegments_.push([u,1]),l[d][1]=u;continue}le(f)in this.vertexSegments_&&!l[d][0]&&!l[d][1]&&this.insertVertexCondition_(t)&&s.push(u)}s.length&&this.willModifyFeatures_(t,[s]);for(let h=s.length-1;h>=0;--h)this.insertVertex_(s[h],r)}return!!this.vertexFeature_}handleUpEvent(t){for(let e=this.dragSegments_.length-1;e>=0;--e){const n=this.dragSegments_[e][0],s=n.geometry;if(s.getType()==="Circle"){const r=s.getCenter(),o=n.featureSegments[0],a=n.featureSegments[1];o.segment[0]=r,o.segment[1]=r,a.segment[0]=r,a.segment[1]=r,this.rBush_.update(_d(r),o);let l=s;this.rBush_.update(l.getExtent(),a)}else this.rBush_.update(es(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new j1(B1.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}handlePointerMove_(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}handlePointerAtPixel_(t,e,n){const s=n||e.getCoordinateFromPixel(t);e.getView().getProjection();const r=function(l,h){return F5(s,l)-F5(s,h)};let o,a;if(this.hitDetection_){const l=typeof this.hitDetection_=="object"?h=>h===this.hitDetection_:void 0;e.forEachFeatureAtPixel(t,(h,c,u)=>{u&&u.getType()==="Point"&&(u=new Qi(Bc(u.getCoordinates())));const f=u||h.getGeometry();if(h instanceof gi&&this.features_.getArray().includes(h)){a=f;const d=h.getGeometry().getFlatCoordinates().slice(0,2);o=[{feature:h,geometry:a,segment:[d,d]}]}return!0},{layerFilter:l})}if(!o){const l=Er(_d(s,k5)),h=e.getView().getResolution()*this.pixelTolerance_,c=U0(Xo(l,h,k5));o=this.rBush_.getInExtent(c)}if(o&&o.length>0){const l=o.sort(r)[0],h=l.segment;let c=O5(s,l);const u=e.getPixelFromCoordinate(c);let f=Up(t,u);if(a||f<=this.pixelTolerance_){const d={};if(d[le(h)]=!0,this.snapToPointer_||(this.delta_[0]=c[0]-s[0],this.delta_[1]=c[1]-s[1]),l.geometry.getType()==="Circle"&&l.index===Ld)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c,[l.feature],[l.geometry]);else{const g=e.getPixelFromCoordinate(h[0]),p=e.getPixelFromCoordinate(h[1]),y=Oc(u,g),_=Oc(u,p);f=Math.sqrt(Math.min(y,_)),this.snappedToVertex_=f<=this.pixelTolerance_,this.snappedToVertex_&&(c=y>_?h[1]:h[0]),this.createOrUpdateVertexFeature_(c,[l.feature],[l.geometry]);const x={};x[le(l.geometry)]=!0;for(let b=1,L=o.length;b<L;++b){const M=o[b].segment;if(br(h[0],M[0])&&br(h[1],M[1])||br(h[0],M[1])&&br(h[1],M[0])){const k=le(o[b].geometry);k in x||(x[k]=!0,d[le(M)]=!0)}else break}}this.vertexSegments_=d;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(t,e){const n=t.segment,s=t.feature,r=t.geometry,o=t.depth,a=t.index;let l;for(;e.length<r.getStride();)e.push(0);switch(r.getType()){case"MultiLineString":l=r.getCoordinates(),l[o[0]].splice(a+1,0,e);break;case"Polygon":l=r.getCoordinates(),l[o[0]].splice(a+1,0,e);break;case"MultiPolygon":l=r.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,e);break;case"LineString":l=r.getCoordinates(),l.splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(r,l);const h=this.rBush_;h.remove(t),this.updateSegmentIndices_(r,a,o,1);const c={segment:[n[0],e],feature:s,geometry:r,depth:o,index:a};h.insert(es(c.segment),c),this.dragSegments_.push([c,1]);const u={segment:[e,n[1]],feature:s,geometry:r,depth:o,index:a+1};h.insert(es(u.segment),u),this.dragSegments_.push([u,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Ge.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);const e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new j1(B1.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1}removeVertex_(){const t=this.dragSegments_,e={};let n=!1,s,r,o,a,l,h,c,u,f,d,g;for(l=t.length-1;l>=0;--l)o=t[l],d=o[0],g=le(d.feature),d.depth&&(g+="-"+d.depth.join("-")),g in e||(e[g]={}),o[1]===0?(e[g].right=d,e[g].index=d.index):o[1]==1&&(e[g].left=d,e[g].index=d.index+1);for(g in e){switch(f=e[g].right,c=e[g].left,h=e[g].index,u=h-1,c!==void 0?d=c:d=f,u<0&&(u=0),a=d.geometry,r=a.getCoordinates(),s=r,n=!1,a.getType()){case"MultiLineString":r[d.depth[0]].length>2&&(r[d.depth[0]].splice(h,1),n=!0);break;case"LineString":r.length>2&&(r.splice(h,1),n=!0);break;case"MultiPolygon":s=s[d.depth[1]];case"Polygon":s=s[d.depth[0]],s.length>4&&(h==s.length-1&&(h=0),s.splice(h,1),n=!0,h===0&&(s.pop(),s.push(s[0]),u=s.length-1));break}if(n){this.setGeometryCoordinates_(a,r);const p=[];if(c!==void 0&&(this.rBush_.remove(c),p.push(c.segment[0])),f!==void 0&&(this.rBush_.remove(f),p.push(f.segment[1])),c!==void 0&&f!==void 0){const y={depth:d.depth,feature:d.feature,geometry:d.geometry,index:u,segment:p};this.rBush_.insert(es(y.segment),y)}this.updateSegmentIndices_(a,h,d.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return n}setGeometryCoordinates_(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}updateSegmentIndices_(t,e,n,s){this.rBush_.forEachInExtent(t.getExtent(),function(r){r.geometry===t&&(n===void 0||r.depth===void 0||uo(r.depth,n))&&r.index>e&&(r.index+=s)})}}function FF(i,t){return i.index-t.index}function F5(i,t,e){const n=t.geometry;if(n.getType()==="Circle"){let r=n;if(t.index===Ld){const o=Oc(r.getCenter(),Hi(i)),a=Math.sqrt(o)-r.getRadius();return a*a}}const s=Hi(i);return bc[0]=Hi(t.segment[0]),bc[1]=Hi(t.segment[1]),VM(s,bc)}function O5(i,t,e){const n=t.geometry;if(n.getType()==="Circle"&&t.index===Ld)return Bc(n.getClosestPoint(Hi(i)));const s=Hi(i);return bc[0]=Hi(t.segment[0]),bc[1]=Hi(t.segment[1]),Bc(sS(s,bc))}function OF(){const i=s2();return function(t,e){return i.Point}}const DF={SELECT:"select"};class BF extends os{constructor(t,e,n,s){super(t),this.selected=e,this.deselected=n,this.mapBrowserEvent=s}}const Yg={};class U2 extends sh{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:dE,this.addCondition_=t.addCondition?t.addCondition:N_,this.removeCondition_=t.removeCondition?t.removeCondition:N_,this.toggleCondition_=t.toggleCondition?t.toggleCondition:x2,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:Yo,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:jF(),this.features_=t.features||new ns;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const n=t.layers;e=function(s){return n.includes(s)}}else e=Yo;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[le(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[le(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(an.ADD,this.boundAddFeature_),this.features_.addEventListener(an.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(an.ADD,this.boundAddFeature_),this.features_.removeEventListener(an.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const n=this.getMap().getAllLayers().find(function(s){if(s instanceof Rr&&s.getSource()&&s.getSource().hasFeature(e))return s});n&&this.addFeatureLayerAssociation_(e,n)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=le(t);e in Yg||(Yg[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let s=e.length-1;s>=0;--s){const r=e[s];if(r!==this&&r instanceof U2&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(r.getStyle());return}}const n=le(t);t.setStyle(Yg[n]),delete Yg[n]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[le(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),n=this.removeCondition_(t),s=this.toggleCondition_(t),r=!e&&!n&&!s,o=t.map,a=this.getFeatures(),l=[],h=[];if(r){Kl(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,(c,u)=>{if(!(!(c instanceof gi)||!this.filter_(c,u)))return this.addFeatureLayerAssociation_(c,u),h.push(c),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=a.getLength()-1;c>=0;--c){const u=a.item(c),f=h.indexOf(u);f>-1?h.splice(f,1):(a.remove(u),l.push(u))}h.length!==0&&a.extend(h)}else{o.forEachFeatureAtPixel(t.pixel,(c,u)=>{if(!(!(c instanceof gi)||!this.filter_(c,u)))return(e||s)&&!a.getArray().includes(c)?(this.addFeatureLayerAssociation_(c,u),h.push(c)):(n||s)&&a.getArray().includes(c)&&(l.push(c),this.removeFeatureLayerAssociation_(c)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=l.length-1;c>=0;--c)a.remove(l[c]);a.extend(h)}return(h.length>0||l.length>0)&&this.dispatchEvent(new BF(DF.SELECT,h,l,t)),!0}}function jF(){const i=s2();return Ye(i.Polygon,i.LineString),Ye(i.GeometryCollection,i.LineString),function(t){return t.getGeometry()?i[t.getGeometry().getType()]:null}}var zF=class extends Ms{constructor(t){t=t||{},t.fullscreen&&(t.target=document.body);var e=lt.create("DIV",{className:((t.className||"")+(t.zoom?" ol-zoom":"")+" ol-ext-dialog").trim()});super({element:e,target:t.target}),e.addEventListener("click",(function(r){this.get("hideOnBack")&&r.target===e&&this.close(),this.get("hideOnClick")&&this.close()}).bind(this));var n=lt.create("FORM",{on:{submit:this._onButton("submit")},parent:e});lt.create("H2",{parent:n}),lt.create("DIV",{className:"ol-closebox",click:this._onButton("cancel"),parent:n}),lt.create("DIV",{className:"ol-content",parent:n}),this._progress=lt.create("DIV",{style:{display:"none"},parent:n});var s=lt.create("DIV",{className:"ol-progress-bar",parent:this._progress});this._progressbar=lt.create("DIV",{parent:s}),this._progressMessage=lt.create("DIV",{className:"ol-progress-message",parent:this._progress}),lt.create("DIV",{className:"ol-buttons",parent:n}),this.set("closeBox",t.closeBox!==!1),this.set("zoom",!!t.zoom),this.set("hideOnClick",!!t.hideOnClick),this.set("hideOnBack",!!t.hideOnBack),this.set("className",e.className),this.set("closeOnSubmit",t.closeOnSubmit),this.set("buttons",t.buttons),this.setContent(t)}show(t){t&&((t instanceof Element||typeof t=="string")&&(t={content:t}),this.setContent(t)),this.element.classList.add("ol-visible");var e=this.element.querySelector('input[type="text"],input[type="search"],input[type="number"]');if(e&&e.focus(),this.dispatchEvent({type:"show"}),t){if(t.autoclose){var n=setTimeout((function(){this.hide()}).bind(this),t.autoclose);this.once("hide",function(){clearTimeout(n)})}if(t.hideOnBack){var s=this.get("hideOnBack");this.set("hideOnBack",!0),this.once("hide",(function(){this.set("hideOnBack",s)}).bind(this))}}}open(){this.show()}setContentMessage(t){if(t!==void 0){var e=this.getContentElement();t instanceof Element&&lt.setHTML(e,""),lt.setHTML(e,t||"")}}setTitle(t){var e=this.element.querySelector("form");e.querySelector("h2").innerText=t||"",t?e.classList.add("ol-title"):e.classList.remove("ol-title")}setContent(t){if(t){this.element.className=this.get("className"),typeof t=="string"&&(t={content:t}),t=t||{},this.setProgress(!1),t.max&&this.setProgress(0,t.max),t.progress!==void 0&&this.setProgress(t.progress),this.get("zoom")?this.element.classList.add("ol-zoom"):this.element.classList.remove("ol-zoom"),t.className&&t.className.split(" ").forEach((function(o){this.element.classList.add(o)}).bind(this));var e=this.element.querySelector("form");t.content!==void 0&&(t.content instanceof Element&&lt.setHTML(e.querySelector(".ol-content"),""),lt.setHTML(e.querySelector(".ol-content"),t.content||"")),this.setTitle(t.title),t.closeBox||this.get("closeBox")&&t.closeBox!==!1?e.classList.add("ol-closebox"):e.classList.remove("ol-closebox");var n=this.element.querySelector(".ol-buttons");n.innerHTML="";var s=t.buttons||this.get("buttons");if(s){e.classList.add("ol-button");for(var r in s)lt.create("INPUT",{type:r==="submit"?"submit":"button",value:s[r],click:this._onButton(r,t.onButton),parent:n})}else e.classList.remove("ol-button")}}getContentElement(){return this.element.querySelector("form .ol-content")}setProgress(t,e,n){if(t===!1){lt.setStyle(this._progress,{display:"none"});return}if(e>0?this.set("max",Number(e)):e=this.get("max"),!e)lt.setStyle(this._progress,{display:"none"});else{var s=Math.round(t/e*100);lt.setStyle(this._progress,{display:""}),this._progressbar.className=s?"":"notransition",lt.setStyle(this._progressbar,{width:s+"%"})}this._progressMessage.innerHTML="",lt.setHTML(this._progressMessage,n||"")}_onButton(t,e){var n=(function(s){s.preventDefault(),(t!=="submit"||this.get("closeOnSubmit")!==!1)&&this.hide();var r=this.getInputs();this.dispatchEvent({type:"button",button:t,inputs:r}),typeof e=="function"&&e(t,r)}).bind(this);return n}getInputs(){var t={};return["input","textarea","select"].forEach((function(e){this.element.querySelectorAll("form "+e).forEach(function(n){n.className&&n.className.split(" ").forEach(function(s){t[s]=n})})}).bind(this)),t}hide(){this.element.classList.remove("ol-visible"),this.dispatchEvent({type:"hide"})}close(){this.hide()}isOpen(){return this.element.classList.contains("ol-visible")}},GF=function(i){if(!i)return null;var t=i.getViewport().getElementsByClassName("ol-fixedoverlay")[0];return t||(i.getViewport().querySelector(".ol-layers")?(t=document.createElement("canvas"),t.className="ol-fixedoverlay",i.getViewport().querySelector(".ol-layers").after(t),i.on("precompose",function(e){t.width=i.getSize()[0]*e.frameState.pixelRatio,t.height=i.getSize()[1]*e.frameState.pixelRatio})):t=i.getViewport().querySelector("canvas")),t},Ya=class extends Ms{constructor(t){t=t||{},super(t),this.setStyle(t.style)}setMap(t){this.getCanvas(t);var e=this.getMap();if(this._listener&&(Ar(this._listener),this._listener=null),super.setMap(t),e)try{e.renderSync()}catch{}t&&(this._listener=t.on("postcompose",this._draw.bind(this)))}getCanvas(t){return GF(t)}getContext(t){var e=t.context;if(!e&&this.getMap()){var n=this.getMap().getViewport().getElementsByClassName("ol-fixedoverlay")[0];e=n?n.getContext("2d"):null}return e}setStyle(t){this._style=t||new Pe({})}getStyle(){return this._style}getStroke(){var t=this._style.getStroke();return t||this._style.setStroke(new si({color:"#000",width:1.25})),this._style.getStroke()}getFill(){var t=this._style.getFill();return t||this._style.setFill(new ke({color:"#fff"})),this._style.getFill()}getTextStroke(){var t=this._style.getText();return t||(t=new qn({})),t.getStroke()||t.setStroke(new si({color:"#fff",width:3})),t.getStroke()}getTextFill(){var t=this._style.getText();return t||(t=new qn({})),t.getFill()||t.setFill(new ke({color:"#fff"})),t.getFill()}getTextFont(){var t=this._style.getText();return t||(t=new qn({})),t.getFont()||t.setFont("12px sans-serif"),t.getFont()}_draw(){console.warn("[CanvasBase] draw function not implemented.")}},z1=class extends In{constructor(t){t=t||{},super(t),t.feature&&this.set("feature",t.feature.clone()),this.setWidth(t.width),this.setHeight(t.height)}setTitle(t){this.set("title",t||""),this.changed()}setWidth(t){this.set("width",t||null),this.changed()}setHeight(t){this.set("heigth",t||null),this.changed()}getElement(t,e){this.get("width")&&(t[0]=this.get("width")),this.get("height")&&(t[1]=this.get("height"));var n=lt.create("LI",{className:this.get("className"),click:function(s){e(!1),s.stopPropagation()},style:{height:t[1]+"px"},"aria-label":this.get("title")});return lt.create("DIV",{click:function(s){e(!0),s.stopPropagation()},style:{width:t[0]+"px",height:t[1]+"px"},parent:n}),n}},Xg=class extends In{constructor(t){t=t||{},super(t),this.set("width",t.width),this._img=t.img||new Image,this._img.onload=(function(){this.changed()}).bind(this),t.img||(this._img.src=t.src)}setTitle(t){this.set("title",t||""),this.changed()}setWidth(t){this.set("width",t||null),this.changed()}getWidth(){return this._img.naturalWidth?this.get("width")||this._img.naturalWidth:0}getHeight(){return this._img.naturalWidth?this.get("width")?this.get("width")*this._img.naturalHeight/this._img.naturalWidth:this._img.naturalHeight||0:0}getImage(){return this._img}getElement(t,e){this.get("width")&&(t[0]=this.get("width")),this.get("height")&&(t[1]=this.get("height"));var n=lt.create("LI",{className:this.get("className"),click:function(s){e(!1),s.stopPropagation()},style:{height:this.getHeight()+"px"},"aria-label":this.get("title")});return lt.create("DIV",{click:function(s){e(!0),s.stopPropagation()},style:{width:this.getWidth()+"px",height:this.getHeight()+"px"},parent:n}),n}},wl=class extends In{constructor(t){super(),t=t||{},this._items=new ns;var e=[],n;this._items.on("add",(function(s){e.push({item:s.element,on:s.element.on("change",(function(){this.refresh()}).bind(this))}),n&&(clearTimeout(n),n=null),n=setTimeout((function(){this.refresh()}).bind(this),0)}).bind(this)),this._items.on("remove",(function(s){for(var r=0;r<e;r++)if(s.element===e[r].item){Ar(e[r].on),e.splice(r,1);break}n&&(clearTimeout(n),n=null),n=setTimeout((function(){this.refresh()}).bind(this),0)}).bind(this)),this._listElement=lt.create("UL",{className:"ol-legend"}),this._canvas=document.createElement("canvas"),this.setLayer(t.layer),this.set("maxWidth",t.maxWidth,!0),this.set("size",t.size||[40,25],!0),this.set("margin",t.margin===0?0:t.margin||10,!0),this._textStyle=t.textStyle||new qn({font:"16px sans-serif",fill:new ke({color:"#333"}),backgroundFill:new ke({color:"rgba(255,255,255,.8)"})}),this._title=new z1({title:t.title||"",className:"ol-title"}),t.titleStyle?this._titleStyle=t.titleStyle:(this._titleStyle=this._textStyle.clone(),this._titleStyle.setFont("bold "+this._titleStyle.getFont())),this.setStyle(t.style),t.items instanceof Array&&t.items.forEach((function(s){this.addItem(s)}).bind(this)),this.refresh()}static getLegendImage(t,e,n){t=t||{},typeof t.margin>"u"&&(t.margin=10);var s=t.size||[40,25];t.width&&(s[0]=t.width),t.heigth&&(s[1]=t.heigth),t.onload=t.onload||function(){setTimeout(function(){wl.getLegendImage(t,e,n)},100)};var r=s[0]+2*t.margin,o=t.lineHeight||s[1]+2*t.margin,a=t.pixelratio||Tl;e||(n=0,e=document.createElement("canvas"),e.width=r*a,e.height=o*a);var l=e.getContext("2d");l.save();var h=LP(l,{pixelRatio:a}),c=t.typeGeom,u,f=t.feature;!f&&c&&(/Point/.test(c)?f=new gi(new Qi([0,0])):/LineString/.test(c)?f=new gi(new cn([0,0])):f=new gi(new sr([[0,0]])),t.properties&&f.setProperties(t.properties)),f?(u=f.getStyle(),typeof u=="function"&&(u=u(f)),u||(u=typeof t.style=="function"?t.style(f):t.style||[]),c=f.getGeometry().getType()):u=[],u instanceof Array||(u=[u]);var d=r/2,g=o/2,p=s[0]/2,y=s[1]/2,_,x;if(c==="Point"){var b=null;for(_=0;x=u[_];_++){var L=x.getImage();if(L){var M=L.getPhoto?L.getPhoto():L.getImage();if(M&&M instanceof HTMLImageElement&&!M.naturalWidth&&(typeof t.onload=="function"&&M.addEventListener("load",function(){setTimeout(function(){t.onload()},100)}),L.load()),L.getAnchor){var k=L.getAnchor();if(k){var A=L.getSize(),T=k[0]-A[0],F=k[1]-A[1];b?Ny(b,[T,F,T+A[0],F+A[1]]):b=[T,F,T+A[0],F+A[1]]}}}}b&&(d=d+(b[2]+b[0])/2,g=g+(b[3]+b[1])/2)}for(g+=n||0,_=0;x=u[_];_++){h.setStyle(x),l.save();var q;switch(c){case Qi:case"Point":case"MultiPoint":{q=new Qi([d,g]);break}case cn:case"LineString":case"MultiLineString":{l.rect(t.margin*a,0,s[0]*a,e.height),l.clip(),q=new cn([[d-p,g],[d+p,g]]);break}case sr:case"Polygon":case"MultiPolygon":{q=new sr([[[d-p,g-y],[d+p,g-y],[d+p,g+y],[d-p,g+y],[d-p,g-y]]]);break}}x.getGeometryFunction()&&(q=x.getGeometryFunction()(new gi(q))),h.drawGeometry(q),l.restore()}return l.restore(),e}setTitle(t){this._title.setTitle(t),this.refresh()}getTitle(){return this._title.get("title")}setLayer(t){this._layerListener&&Ar(this._layerListener),this._layer=t,t?this._layerListener=t.on("change:visible",(function(){this.refresh()}).bind(this)):this._layerListener=null}getTextStyle(){return this._textStyle}set(t,e,n){super.set(t,e,n),n||this.refresh()}getListElement(){return this._listElement}getCanvas(){return this._canvas}setStyle(t){this._style=t,this.refresh()}addItem(t){t instanceof wl?(this._items.push(t),t.on("refresh",(function(){this.refresh(!0)}).bind(this))):t instanceof z1||t instanceof Xg?this._items.push(t):this._items.push(new z1(t))}removeItem(t){this._items.remove(t)}removeItemAt(t){this._items.removeAt(t)}getItems(){return this._items}_drawText(t,e,n,s){t.save(),t.scale(Tl,Tl),e=e||"";var r=e.split(`
`);r.length===1?t.fillText(e,n,s):(t.textBaseline="bottom",t.fillText(r[0],n,s),t.textBaseline="top",t.fillText(r[1],n,s)),t.restore()}_measureText(t,e){var n=(e||"").split(`
`);if(n.length===1)return t.measureText(e);var s=t.measureText(n[0]),r=t.measureText(n[1]);return{width:Math.max(s.width,r.width),height:s.height+r.height}}refresh(t){var e=this._listElement;if(e){e.innerHTML="";var n=this.get("margin"),s=this.get("size")[0]+2*n,r=this.get("lineHeight")||this.get("size")[1]+2*n,o=this.getCanvas(),a=o.getContext("2d");a.textAlign="left",a.textBaseline="middle";var l=Tl,h=Math.min(this.getWidth(),this.get("maxWidth")||1/0),c=this.getHeight();o.width=h*l,o.height=c*l,o.style.height=c+"px",a.textBaseline="middle",a.fillStyle=nr(this._textStyle.getFill().getColor()),this.getTitle()&&(e.appendChild(this._title.getElement([s,r],(function(d){this.dispatchEvent({type:"select",index:-1,symbol:d,item:this._title})}).bind(this))),a.font=this._titleStyle.getFont(),a.textAlign="center",this._drawText(a,this.getTitle(),o.width/l/2,r/2));var u=0;this.getTitle()&&(u=r);var f=0;this._items.forEach((function(d,g){if(d instanceof wl){if((!d._layer||d._layer.getVisible())&&d.getCanvas().height){a.drawImage(d.getCanvas(),0,u*l);for(var p=d._listElement.querySelectorAll("li"),y=0;y<p.length;y++){var _=p[y].cloneNode();_.innerHTML=p[y].innerHTML,e.appendChild(_),f++}u+=d.getHeight()}}else{if(d instanceof Xg){d.get("title")&&(e.appendChild(this._title.getElement([s,r],(function(M){this.dispatchEvent({type:"select",index:-1,symbol:M,item:this._title})}).bind(this))),a.font=d.get("textStyle")?d.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(d.get("className"))?(a.textAlign="center",this._drawText(a,d.get("title"),o.width/l/2,u+r/2)):this._drawText(a,d.get("title"),n,u+r/2),u+=r);var x=d.getImage();try{a.drawImage(x,0,0,x.naturalWidth,x.naturalHeight,0,u*l,d.getWidth()*l,d.getHeight()*l)}catch{}u+=d.getHeight()}else{var b=d.getProperties(),L=b.height||r;a.textAlign="left",b.feature||b.typeGeom?(o=this.getLegendImage(b,o,u),a.font=d.get("textStyle")?d.get("textStyle").getFont():this._textStyle.getFont(),this._drawText(a,d.get("title"),s+n,u+L/2)):(a.font=d.get("textStyle")?d.get("textStyle").getFont():this._titleStyle.getFont(),/\bcenter\b/.test(b.className)?(a.textAlign="center",this._drawText(a,d.get("title"),o.width/l/2,u+L/2)):this._drawText(a,d.get("title"),n,u+L/2)),u+=L}e.appendChild(d.getElement([s,r],(function(M){this.dispatchEvent({type:"select",index:g,symbol:M,item:d})}).bind(this))),f++}}).bind(this)),this.set("items",f,!0),this.dispatchEvent({type:"items",nb:f}),t||this.dispatchEvent({type:"refresh",width:s,height:(this._items.length+1)*r})}}getHeight(){var t=this.get("margin"),e=this.get("lineHeight")||this.get("size")[1]+2*t,n=this.getTitle()?e:0;return this._items.forEach(function(s){s instanceof wl?(!s._layer||s._layer.getVisible())&&(n+=s.getHeight()):s instanceof Xg?(s.get("title")&&(n+=e),n+=s.getHeight()):s.get("height")?n+=s.get("height")+2*t:n+=e}),n}getWidth(){var t=this.getCanvas(),e=t.getContext("2d"),n=this.get("margin"),s=this.get("size")[0]+2*n;e.font=this._titleStyle.getFont();var r=this._measureText(e,this.getTitle("title")).width;return this._items.forEach((function(o){o instanceof wl?(!o._layer||o._layer.getVisible())&&(r=Math.max(r,o.getWidth())):o instanceof Xg?(r=Math.max(r,o.getWidth()),o.get("title")&&(e.font=o.get("textStyle")?o.get("textStyle").getFont():this._titleStyle.getFont(),r=Math.max(r,this._measureText(e,o.get("title")).width))):o.get("feature")||o.get("typeGeom")?(e.font=o.get("textStyle")?o.get("textStyle").getFont():this._textStyle.getFont(),r=Math.max(r,this._measureText(e,o.get("title")).width+s)):(e.font=o.get("textStyle")?o.get("textStyle").getFont():this._titleStyle.getFont(),r=Math.max(r,this._measureText(e,o.get("title")).width))}).bind(this)),r+2*n}getLegendImage(t,e,n){t=t||{};var s=this.get("size");return wl.getLegendImage({className:t.className,feature:t.feature,typeGeom:t.typeGeom,style:t.style||this._style,properties:t.properties,margin:t.margin||this.get("margin"),size:[t.width||s[0],t.height||s[1]],lineHeight:t.lineHeight||this.get("lineHeight"),onload:(function(){this.refresh()}).bind(this)},e,n)}},hC=class extends Ya{constructor(t){t=t||{};var e=document.createElement("div");if(super({element:e,target:t.target}),t.target)e.className=t.className||"ol-legend";else{e.className=(t.className||"ol-legend")+" ol-unselectable ol-control"+(t.collapsible===!1?" ol-uncollapsible":" ol-collapsed");var n=document.createElement("button");n.setAttribute("type","button"),n.addEventListener("click",(function(){this.toggle()}).bind(this)),e.appendChild(n),n=document.createElement("button"),n.setAttribute("type","button"),n.className="ol-closebox",n.addEventListener("click",(function(){this.toggle()}).bind(this)),e.appendChild(n)}this._legend=t.legend,this._legend.getCanvas().className="ol-legendImg",e.appendChild(this._legend.getCanvas()),e.appendChild(this._legend.getListElement()),t.collapsible!==!1&&t.collapsed===!1&&this.show(),this._legend.on("select",(function(s){this.dispatchEvent(s)}).bind(this)),this._legend.on("refresh",(function(){if(this._onCanvas&&this.getMap())try{this.getMap().renderSync()}catch{}}).bind(this)),this._legend.on("items",(function(s){s.nb?(this.element.classList.remove("ol-empty"),this.element.title=t.title||"legend"):(this.element.classList.add("ol-empty"),this.element.title=t.emptyTitle||"no legend"),this.dispatchEvent(s)}).bind(this))}getLegend(){return this._legend}setCanvas(t){if(this._onCanvas=t,this.element.style.visibility=t?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch{}}onCanvas(){return!!this._onCanvas}_draw(t){if(this._onCanvas&&!this.element.classList.contains("ol-collapsed")){var e=this._legend.getCanvas(),n=this.getContext(t),s=n.canvas.height-e.height;n.save(),n.rect(0,s,e.width,e.height);var r="#fff";this._legend.getTextStyle().getBackgroundFill()&&(r=nr(this._legend.getTextStyle().getBackgroundFill().getColor())),n.fillStyle=n.strokeStyle=r,n.lineWidth=10,n.lineJoin="round",n.stroke(),n.clearRect(0,s,e.width,e.height),n.fill(),n.drawImage(e,0,s),n.restore()}}show(){if(this.element.classList.contains("ol-collapsed")&&(this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!1}),this.getMap()))try{this.getMap().renderSync()}catch{}}hide(){if(!this.element.classList.contains("ol-collapsed")&&(this.element.classList.add("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:!0}),this.getMap()))try{this.getMap().renderSync()}catch{}}collapse(t){t===!1?this.show():this.hide()}isCollapsed(){return this.element.classList.contains("ol-collapsed")}toggle(){if(this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"change:collapse",collapsed:this.element.classList.contains("ol-collapsed")}),this.getMap())try{this.getMap().renderSync()}catch{}}},UF=class extends Ms{constructor(t){t=t||{};var e=lt.create("DIV",{className:t.className||"ol-print"});super({element:e,target:t.target}),t.target||(e.classList.add("ol-unselectable","ol-control"),lt.create("BUTTON",{type:"button",title:t.title||"Print",click:(function(){this.print()}).bind(this),parent:e})),this.set("immediate",t.immediate),this.set("imageType",t.imageType||"image/jpeg"),this.set("quality",t.quality||.8),this.set("orientation",t.orientation)}toClipboard(t,e){try{t.canvas.toBlob(function(n){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},n.type,{value:n,enumerable:!0}))]),typeof e=="function"&&e(!0)}catch{typeof e=="function"&&e(!1)}})}catch{typeof e=="function"&&e(!1)}}copyMap(t,e){this.once("print",(function(n){this.toClipboard(n,e)}).bind(this)),this.print(t)}_getCanvas(t,e,n){var s;if(t.context)n=t.context.canvas;else{if(n)s=n.getContext("2d");else{n=document.createElement("canvas");var r=this.getMap().getSize();n.width=r[0],n.height=r[1],s=n.getContext("2d"),/jp.*g$/.test(e)&&(s.fillStyle=this.get("bgColor")||"white",s.fillRect(0,0,n.width,n.height))}this.getMap().getViewport().querySelectorAll(".ol-layers canvas, canvas.ol-fixedoverlay").forEach((function(o){if(o.width){if(s.save(),o.parentNode.style.opacity==="0")return;s.globalAlpha=parseFloat(o.parentNode.style.opacity)||1,s.globalCompositeOperation=lt.getStyle(o.parentNode,"mix-blend-mode"),s.filter=lt.getStyle(o.parentNode,"filter");var a=lt.getStyle(o,"transform")||lt.getStyle(o,"-webkit-transform");/^matrix/.test(a)?(a=a.replace(/^matrix\(|\)$/g,"").split(","),a.forEach(function(l,h){a[h]=parseFloat(l)}),s.transform(a[0],a[1],a[2],a[3],a[4],a[5]),s.drawImage(o,0,0)):s.drawImage(o,0,0,lt.getStyle(o,"width"),lt.getStyle(o,"height")),s.restore()}}).bind(this))}return n}fastPrint(t,e){t=t||{},this._ol6?requestAnimationFrame((function(){e(this._getCanvas({},t.imageType,t.canvas))}).bind(this)):(this.getMap().once("postcompose",(function(n){n.context||(this._ol6=!0),e(this._getCanvas(n,t.imageType,t.canvas))}).bind(this)),this.getMap().render())}print(t){t=t||{};var e=t.imageType||this.get("imageType"),n=t.quality||this.get("quality");if(this.getMap()){if(t.immediate!=="silent"&&this.dispatchEvent(Object.assign({type:"printing"},t)),!t.immediate){setTimeout((function(){t=Object.assign({},t),t.immediate="silent",this.print(t)}).bind(this),200);return}this.getMap().once(this.get("immediate")?"postcompose":"rendercomplete",(function(s){var r=this._getCanvas(s,e),o=t.size||[210,297],a=t.format||"a4",l,h,c,u=t.orient||this.get("orientation"),f=typeof t.margin=="number"?t.margin:10;if(r){u!=="landscape"&&u!=="portrait"&&(u=r.width>r.height?"landscape":"portrait"),u==="landscape"&&(o=[o[1],o[0]]);var d=Math.min((o[0]-2*f)/r.width,(o[1]-2*f)/r.height);l=d*r.width,h=d*r.height,c=[(o[0]-l)/2,(o[1]-h)/2]}var g;try{g=r?r.toDataURL(e,n):null}catch{this.dispatchEvent({type:"error",canvas:r});return}var p=Object.assign({type:"print",print:{format:a,orientation:u,unit:"mm",size:o,position:c,imageWidth:l,imageHeight:h},image:g,imageType:e,quality:n,canvas:r},t);this.dispatchEvent(p)}).bind(this)),this.getMap().render()}}},cC=class extends Ya{constructor(t){t=t||{};var e=lt.create("DIV",{className:(t.className||"")+" ol-control-title ol-unselectable",style:{display:"block",visibility:"hidden"}});super({element:e,style:t.style}),this.setTitle(t.title||""),this.setVisible(t.visible!==!1),this.element.style.font=this.getTextFont()}setStyle(t){super.setStyle(t),this.element&&(this.element.style.font=this.getTextFont()),this.getMap()&&this.getMap().render()}setTitle(t){if(this.element.textContent=t,this.set("title",t),this.getMap())try{this.getMap().renderSync()}catch{}}getTitle(){return this.get("title")}setVisible(t){if(this.element.style.display=t?"block":"none",this.getMap())try{this.getMap().renderSync()}catch{}}getVisible(){return this.element.style.display!=="none"}_draw(t){if(this.getVisible()){var e=this.getContext(t);if(e){var n=t.frameState.pixelRatio;e.save(),e.scale(n,n);var s=this.element.getBoundingClientRect(),r=this.getMap().getViewport().getBoundingClientRect(),o=this.getMap().getSize()[0]/r.width;e.translate(Math.round((s.left-r.left)*o),Math.round((s.top-r.top)*o));var a=this.element.clientHeight,l=this.element.clientWidth,h=l/2;e.beginPath(),e.fillStyle=nr(this.getFill().getColor()),e.rect(0,0,l,a),e.fill(),e.closePath(),e.beginPath(),e.fillStyle=nr(this.getTextFill().getColor()),e.strokeStyle=nr(this.getTextStroke().getColor()),e.lineWidth=this.getTextStroke().getWidth(),e.textAlign="center",e.textBaseline="middle",e.font=this.getTextFont(),e.lineJoin="round",e.lineWidth&&e.strokeText(this.getTitle(),h,a/2),e.fillText(this.getTitle(),h,a/2),e.closePath(),e.restore()}}}},G1=function(i,t){var e=i.getView(),n=e.getProjection(),s=e.getCenter(),r=i.getPixelFromCoordinate(s);r[1]+=1;var o=i.getCoordinateFromPixel(r),a=jd(Zi(s,n,"EPSG:4326"),Zi(o,n,"EPSG:4326"));return a*=96/.0254,a},WF=function(i,t,e){if(i&&t){var n=t;if(typeof t=="string"&&(t=t.replace(":","/").split("/"),n=t[1],n||(n=t[0]||""),n=n.replace(/[^\d]/g,""),n=parseInt(n),t[1])){var s=parseInt(t[0]);s&&(n/=s)}if(!n)return;var r=i.getView(),o=r.getProjection(),a=r.getCenter(),l=i.getPixelFromCoordinate(a);l[1]+=1;var h=i.getCoordinateFromPixel(l),c=jd(Zi(a,o,"EPSG:4326"),Zi(h,o,"EPSG:4326"));return c*=96/.0254,r.setResolution(r.getResolution()*n/c),n}},D5=class extends Ya{constructor(t){t=t||{};var e=document.createElement("div");e.className="ol-control ol-compassctrl ol-unselectable ol-hidden"+(t.className?" "+t.className:""),e.style.position="absolute",e.style.visibility="hidden";var n=t.style instanceof si?new Pe({stroke:t.style}):t.style;t.style||(n=new Pe({stroke:new si({width:0})})),super({element:e,style:n}),this.set("rotateVithView",t.rotateWithView!==!1),this.setVisible(t.visible!==!1),this.setImage(t.image||t.src)}setImage(t){if(t instanceof Image)this.img_=t,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}).bind(this);else if(typeof t=="string")switch(t){case"compact":{this.img_=this.compactCompass_(this.element.clientWidth,this.getStroke().getColor());break}case"default":{this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor());break}default:{this.img_=new Image,this.img_.onload=(function(){if(this.getMap())try{this.getMap().renderSync()}catch{}}).bind(this),this.img_.src=t;break}}else this.img_=this.defaultCompass_(this.element.clientWidth,this.getStroke().getColor())}compactCompass_(t,e){var n=document.createElement("canvas"),s=n.getContext("2d");t=n.width=n.height=t||150;var r=t/2;return s.translate(r,r),s.fillStyle=e||"#963",s.lineWidth=5,s.lineJoin=s.lineCap="round",s.font="bold "+r*.4+"px sans-serif",s.textBaseline="bottom",s.textAlign="center",s.strokeStyle="#fff",s.globalAlpha=.75,s.strokeText("N",0,-r/2),s.globalAlpha=1,s.fillText("N",0,-r/2),s.beginPath(),s.moveTo(0,r/4),s.lineTo(r/3,r/2),s.lineTo(0,-r/2),s.lineTo(-r/3,r/2),s.lineTo(0,r/4),s.lineWidth=12,s.fillStyle="#fff",s.globalAlpha=.75,s.fill(),s.stroke(),s.globalAlpha=1,s.fillStyle=s.strokeStyle=e||"#963",s.lineWidth=5,s.beginPath(),s.moveTo(0,r/4),s.lineTo(0,-r/2),s.lineTo(r/3,r/2),s.lineTo(0,r/4),s.fill(),s.stroke(),s.beginPath(),s.moveTo(0,r/4),s.lineTo(0,-r/2),s.lineTo(-r/3,r/2),s.lineTo(0,r/4),s.stroke(),n}defaultCompass_(t,e){var n=document.createElement("canvas"),s=n.getContext("2d");t=n.width=n.height=t||150;var r=t/2,o=.22*r;function a(h,c){s.fillStyle=e||"#963",s.beginPath(),s.moveTo(0,0),s.lineTo(h,0),s.lineTo(c,c),s.moveTo(0,0),s.lineTo(-h,0),s.lineTo(-c,-c),s.moveTo(0,0),s.lineTo(0,h),s.lineTo(-c,c),s.moveTo(0,0),s.lineTo(0,-h),s.lineTo(c,-c),s.moveTo(0,0),s.fill(),s.stroke()}function l(h,c){s.globalCompositeOperation="destination-out",s.fillStyle="#fff",s.beginPath(),s.moveTo(0,0),s.lineTo(h,0),s.lineTo(c,-c),s.moveTo(0,0),s.lineTo(-h,0),s.lineTo(-c,c),s.moveTo(0,0),s.lineTo(0,h),s.lineTo(c,c),s.moveTo(0,0),s.lineTo(0,-h),s.lineTo(-c,-c),s.moveTo(0,0),s.fill(),s.globalCompositeOperation="source-over",s.beginPath(),s.moveTo(0,0),s.lineTo(h,0),s.lineTo(c,-c),s.moveTo(0,0),s.lineTo(-h,0),s.lineTo(-c,c),s.moveTo(0,0),s.lineTo(0,h),s.lineTo(c,c),s.moveTo(0,0),s.lineTo(0,-h),s.lineTo(-c,-c),s.moveTo(0,0),s.stroke()}return s.translate(r,r),s.strokeStyle=e||"#963",s.lineWidth=1.5,s.beginPath(),s.arc(0,0,t*.41,0,2*Math.PI),s.arc(0,0,t*.44,0,2*Math.PI),s.stroke(),s.rotate(Math.PI/4),a(r*.9,o*.8),l(r*.9,o*.8),s.rotate(-Math.PI/4),a(r,o),l(r,o),n}getVisible(){return lt.getStyle(this.element,"display")==="block"}setVisible(t){t?this.element.classList.add("ol-visible"):this.element.classList.remove("ol-visible"),this.getMap()&&this.getMap().render()}_draw(t){var e=this.getContext(t);if(!(!e||!this.getVisible())){var n=e.canvas,s,r=[];for(s=0;s<8;s++)r[s]=[Math.cos(Math.PI*s/8),Math.sin(Math.PI*s/8)];var o=t.frameState.pixelRatio;e.save(),e.scale(o,o);var a=this.element.clientWidth,l=this.element.clientHeight,h={left:this.element.offsetLeft,top:this.element.offsetTop},c=this.img_,u=t.frameState.viewState.rotation;if(e.beginPath(),e.translate(h.left+a/2,h.top+l/2),this.get("rotateVithView")&&e.rotate(u),this.getStroke().getWidth()){e.beginPath(),e.strokeStyle=this.getStroke().getColor(),e.lineWidth=this.getStroke().getWidth();var f=Math.max(n.width,n.height);for(s=0;s<8;s++)e.moveTo(-r[s][0]*f,-r[s][1]*f),e.lineTo(r[s][0]*f,r[s][1]*f);e.stroke()}c.width&&e.drawImage(c,-a/2,-l/2,a,l),e.closePath(),e.restore()}}},oh=class extends Ms{constructor(t){t=t||{};var e=lt.create("DIV",{className:(t.className||"ol-print")+" ol-unselectable ol-control"});super({element:e}),this._lang=t.lang||"en",t.target||lt.create("BUTTON",{type:"button",title:t.title||"Print",click:(function(){this.print()}).bind(this),parent:e}),t.openWindow&&this.on("print",function(S){S.canvas&&window.open().document.write('<img src="'+S.canvas.toDataURL()+'"/>')}),t.target=lt.create("DIV");var n=this._printCtrl=new UF(t);n.on(["print","error","printing"],(function(S){this._printing(S)}).bind(this)),this._compass=new D5({src:t.northImage||"compact",visible:!1,className:"olext-print-compass",style:new si({color:"#333",width:0})});var s=this._printDialog=new zF({target:t.targetDialog||document.body,closeBox:!0,className:"ol-ext-print-dialog"}),r=s.getContentElement();this._input={};var o=lt.create("DIV",{className:"ol-print-param",parent:r});this._pages=[lt.create("DIV",{className:"ol-page"})];var a=lt.create("DIV",{className:"ol-map",parent:this._pages[0]});lt.create("DIV",{html:this._pages[0],className:"ol-print-map",parent:r}),lt.create("H2",{html:this.i18n("title"),parent:o});var l=lt.create("UL",{parent:o}),h=lt.create("LI",{className:"ol-orientation",parent:l});this._input.orientation={list:h};var c=lt.create("LABEL",{className:"portrait",parent:h});this._input.orientation.portrait=lt.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"portrait",checked:!0,on:{change:(function(S){this.setOrientation(S.target.value)}).bind(this)},parent:c}),lt.create("SPAN",{html:this.i18n("portrait"),parent:c}),c=lt.create("LABEL",{className:"landscape",parent:h}),this._input.orientation.landscape=lt.create("INPUT",{type:"radio",name:"ol-print-orientation",value:"landscape",on:{change:(function(S){this.setOrientation(S.target.value)}).bind(this)},parent:c}),lt.create("SPAN",{html:this.i18n("landscape"),parent:c});var u;h=lt.create("LI",{html:lt.create("LABEL",{html:this.i18n("size")}),className:"ol-size",parent:l});var f=this._input.size=lt.create("SELECT",{on:{change:(function(){this.setSize(f.value||F)}).bind(this)},parent:h});for(u in this.paperSize)lt.create("OPTION",{html:u+(this.paperSize[u]?" - "+this.paperSize[u][0]+"x"+this.paperSize[u][1]+" mm":this.i18n("custom")),value:u,parent:f});h=lt.create("LI",{html:lt.create("LABEL",{html:this.i18n("margin")}),className:"ol-margin",parent:l});var d=this._input.margin=lt.create("SELECT",{on:{change:(function(){this.setMargin(d.value)}).bind(this)},parent:h});for(u in this.marginSize)lt.create("OPTION",{html:this.i18n(u)+" - "+this.marginSize[u]+" mm",value:this.marginSize[u],parent:d});h=lt.create("LI",{html:lt.create("LABEL",{html:this.i18n("scale")}),className:"ol-scale",parent:l});var g=this._input.scale=lt.create("SELECT",{on:{change:(function(){this.setScale(parseInt(g.value))}).bind(this)},parent:h});Object.keys(this.scales).forEach((function(S){lt.create("OPTION",{html:this.scales[S],value:S,parent:g})}).bind(this)),h=lt.create("LI",{className:"ol-legend",parent:l});var p=lt.createSwitch({html:this.i18n("legend"),checked:!1,on:{change:(function(){R.legend.control.setCanvas(p.checked)}).bind(this)},parent:h});h=lt.create("LI",{className:"ol-print-north",parent:l});var y=this._input.north=lt.createSwitch({html:this.i18n("north"),checked:"checked",on:{change:(function(){y.checked?this._compass.element.classList.add("ol-print-compass"):this._compass.element.classList.remove("ol-print-compass"),this.getMap().render()}).bind(this)},parent:h});h=lt.create("LI",{className:"ol-print-title",parent:l});var _=lt.createSwitch({html:this.i18n("mapTitle"),checked:!1,on:{change:(function(S){R.title.control.setVisible(S.target.checked)}).bind(this)},parent:h}),x=lt.create("INPUT",{type:"text",placeholder:this.i18n("mapTitle"),on:{keydown:function(S){S.keyCode===13&&S.preventDefault()},keyup:function(){R.title.control.setTitle(x.value)},change:(function(){R.title.control.setTitle(x.value)}).bind(this)},parent:h}),b=lt.create("DIV",{className:"ol-user-param",parent:o});h=lt.create("LI",{className:"ol-saveas",parent:l}),lt.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:h});var L=lt.create("SELECT",{on:{change:(function(){var S=L.value;if(L.value="",!(this.formats[S].clipboard&&this._copyMap(S))){var O=typeof this.getSize()=="string"?this.getSize():null,E=Object.assign({format:O,size:O?this.paperSize[O]:null,orient:this.getOrientation(),margin:this.getMargin()},this.formats[S]);n.print(E)}}).bind(this)},parent:h});lt.create("OPTION",{html:this.i18n("saveas"),style:{display:"none"},value:"",parent:L}),this.formats.forEach((function(S,O){if(S.pdf){if(t.pdf===!1)return}else if(S.clipboard){if(t.copy===!1)return}else if(t.save===!1)return;lt.create("OPTION",{html:this.i18n(S.title),value:O,parent:L})}).bind(this)),L.querySelectorAll("option").length===1&&(L.style.display="none"),h=lt.create("LI",{className:"ol-savelegend",parent:l});var M=lt.create("DIV",{html:this.i18n("copied"),className:"ol-clipboard-copy",parent:h}),k=lt.create("SELECT",{on:{change:(function(){var S=R.legend.control.getLegend().getCanvas(),O=document.createElement("CANVAS");O.width=S.width,O.height=S.height;var E=O.getContext("2d");if(E.fillStyle="#fff",E.fillRect(0,0,O.width,O.height),E.drawImage(S,0,0),this.formats[k.value].clipboard)O.toBlob(function(et){try{navigator.clipboard.write([new window.ClipboardItem(Object.defineProperty({},et.type,{value:et,enumerable:!0}))]),M.classList.add("visible"),setTimeout(function(){M.classList.remove("visible")},1e3)}catch{}},"image/png");else{var U;try{U=O.toDataURL(this.formats[k.value].imageType,this.formats[k.value].quality);var X=typeof this.getSize()=="string"?this.getSize():"A4",Z=O.width/96*25.4,st=O.height/96*25.4,tt=this.paperSize[X];this.getOrientation()==="landscape"&&(tt=[tt[1],tt[0]]);var ot=[(tt[0]-Z)/2,(tt[1]-st)/2];this.dispatchEvent({type:"print",print:{legend:!0,format:X,orientation:this.getOrientation(),unit:"mm",size:this.paperSize[X],position:ot,imageWidth:Z,imageHeight:st},image:U,imageType:this.formats[k.value].imageType,pdf:this.formats[k.value].pdf,quality:this.formats[k.value].quality,canvas:O})}catch{}}k.value=""}).bind(this)},parent:h});lt.create("OPTION",{html:this.i18n("saveLegend"),style:{display:"none"},value:"",parent:k}),this.formats.forEach((function(S,O){lt.create("OPTION",{html:this.i18n(S.title),value:O,parent:k})}).bind(this));var A=lt.create("DIV",{className:"ol-ext-buttons",parent:o});lt.create("BUTTON",{html:this.i18n("printBt"),type:"submit",click:function(S){S.preventDefault(),window.print()},parent:A}),lt.create("BUTTON",{html:this.i18n("cancel"),type:"button",click:function(){s.hide()},parent:A}),lt.create("DIV",{html:this.i18n("errorMsg"),className:"ol-error",parent:o});var T,F,q,R={};s.on("show",(function(){this.dispatchEvent({type:"show",userElement:b,dialog:this._printDialog,page:this.getPage()});var S=this.getMap();S&&(document.body.classList.add("ol-print-document"),T=S.getTargetElement(),F=S.getSize(),typeof this.getSize()=="string"?this.setSize(this.getSize()):this.setSize(F),S.setTarget(a),q&&Ar(q),q=S.on("moveend",(function(){this.setScale(G1(S))}).bind(this)),this.setScale(G1(S)),R={},this.getMap().getControls().forEach((function(O){O instanceof hC&&(R.legend={control:O}),O instanceof cC&&(R.title={control:O}),O instanceof D5&&(R.compass?O.element.classList.remove("ol-print-compass"):(this._input.north.checked?O.element.classList.add("ol-print-compass"):O.element.classList.remove("ol-print-compass"),this._compass=O,R.compass={control:O}))}).bind(this)),R.title?(_.checked=R.title.isVisible=R.title.control.getVisible(),x.value=R.title.control.getTitle(),_.parentNode.parentNode.classList.remove("hidden")):_.parentNode.parentNode.classList.add("hidden"),R.legend?(R.legend.ison=R.legend.control.onCanvas(),R.legend.collapsed=R.legend.control.isCollapsed(),R.legend.control.collapse(!1),k.parentNode.classList.remove("hidden"),p.parentNode.parentNode.classList.remove("hidden"),p.checked=!R.legend.collapsed,R.legend.control.setCanvas(!R.legend.collapsed)):(k.parentNode.classList.add("hidden"),p.parentNode.parentNode.classList.add("hidden")))}).bind(this)),s.on("hide",(function(){document.body.classList.remove("ol-print-document"),T&&(this.getMap().setTarget(T),T=null,q&&Ar(q),R.title&&R.title.control.setVisible(R.title.isVisible),R.legend&&(R.legend.control.setCanvas(R.legend.ison),R.legend.control.collapse(R.legend.collapsed)),this.dispatchEvent({type:"hide"}))}).bind(this)),window.addEventListener("resize",(function(){this.setSize()}).bind(this)),t.saveAs&&this.on("print",function(S){S.pdf||S.canvas.toBlob(function(O){var E=(S.print.legend?"legend.":"map.")+S.imageType.replace("image/","");t.saveAs(O,E)},S.imageType,S.quality)}),t.jsPDF&&this.on("print",function(S){if(S.pdf){var O=new t.jsPDF({orientation:S.print.orientation,unit:S.print.unit,format:S.print.size});O.addImage(S.image,"JPEG",S.print.position[0],S.print.position[0],S.print.imageWidth,S.print.imageHeight),O.save(S.print.legend?"legend.pdf":"map.pdf")}})}static addLang(t,e){oh.prototype._labels[t]=e}isOpen(){return this._printDialog.isOpen()}i18n(t){var e=this._labels.en[t]||t;return this._labels[this._lang]&&this._labels[this._lang][t]&&(e=this._labels[this._lang][t]),e}getOrientation(){return this._orientation||"portrait"}setOrientation(t){this._orientation=t==="landscape"?"landscape":"portrait",this._printDialog.element.dataset.orientation=this._orientation,this._input.orientation[this._orientation].checked=!0,this.setSize()}getMargin(){return this._margin||0}setMargin(t){this._margin=t,this._input.margin.value=t,this.setSize()}getSize(){return this._size}setSize(t){if(this._printDialog.getContentElement().dataset.status="",t?this._size=t:t=this._size,!!t){if(typeof t=="string"){for(var e in this.paperSize)e&&new RegExp(e,"i").test(t)&&(t=e);this.paperSize[t]||(t=this._size="A4"),this._input.size.value=t,t=[Math.trunc(this.paperSize[t][0]*96/25.4),Math.trunc(this.paperSize[t][1]*96/25.4)],this.getOrientation()==="landscape"&&(t=[t[1],t[0]]),this.getPage().classList.remove("margin")}else this._input.size.value="",this.getPage().classList.add("margin");var n=this.getPage(),s=n.parentNode.getBoundingClientRect(),r=(s.width-40)/t[0],o=(s.height-40)/t[1],a=Math.min(r,o,1);n.style.width=t[0]+"px",n.style.height=t[1]+"px",n.style["-webkit-transform"]=n.style.transform="translate(-50%,-50%) scale("+a+")";var l=Math.round(5/a);n.style["-webkit-box-shadow"]=n.style["box-shadow"]=l+"px "+l+"px "+l+"px rgba(0,0,0,.6)",n.style.padding=this.getMargin()*96/25.4+"px",this.getMap()&&this.getMap().updateSize(),this.dispatchEvent({type:"dialog:refresh"})}}_printing(t){this._printDialog.getContentElement().dataset.status=t.type,t.clipboard||this.dispatchEvent(t)}_copyMap(t){var e=this._printDialog.element.querySelector(".ol-clipboard-copy");return this._printCtrl.copyMap(this.formats[t],function(n){n&&(e.classList.add("visible"),setTimeout(function(){e.classList.remove("visible")},1e3))}),!0}getContentElement(){return this._printDialog.getContentElement()}getUserElement(){return this._printDialog.getContentElement().querySelector(".ol-user-param")}getPage(){return this._pages[0]}setMap(t){this.getMap()&&(this.getMap().removeControl(this._compass),this.getMap().removeControl(this._printCtrl),this.getMap().removeControl(this._printDialog)),super.setMap(t),this.getMap()&&(this.getMap().addControl(this._compass),this.getMap().addControl(this._printCtrl),this.getMap().addControl(this._printDialog))}setScale(t){WF(this.getMap(),t),this._input.scale.value=" "+Math.round(t/100)*100}getScale(){return G1(this.getMap())}print(t){t=t||{},t.size&&this.setSize(t.size),t.scale&&this.setScale(t.scale),t.orientation&&this.setOrientation(t.orientation),t.margin&&this.setMargin(t.margin),this._printDialog.show()}getPrintControl(){return this._printCtrl}};oh.prototype._labels={en:{title:"Print",orientation:"Orientation",portrait:"Portrait",landscape:"Landscape",size:"Page size",custom:"screen size",margin:"Margin",scale:"Scale",legend:"Legend",north:"North arrow",mapTitle:"Map title",saveas:"Save as...",saveLegend:"Save legend...",copied:"✔ Copied to clipboard",errorMsg:"Can't save map canvas...",printBt:"Print...",clipboardFormat:"copy to clipboard...",jpegFormat:"save as jpeg",pngFormat:"save as png",pdfFormat:"save as pdf",none:"none",small:"small",large:"large",cancel:"cancel"},fr:{title:"Imprimer",orientation:"Orientation",portrait:"Portrait",landscape:"Paysage",size:"Taille du papier",custom:"taille écran",margin:"Marges",scale:"Echelle",legend:"Légende",north:"Flèche du nord",mapTitle:"Titre de la carte",saveas:"Enregistrer sous...",saveLegend:"Enregistrer la légende...",copied:"✔ Carte copiée",errorMsg:"Impossible d'enregistrer la carte",printBt:"Imprimer",clipboardFormat:"copier dans le presse-papier...",jpegFormat:"enregistrer un jpeg",pngFormat:"enregistrer un png",pdfFormat:"enregistrer un pdf",none:"aucune",small:"petites",large:"larges",cancel:"annuler"},de:{title:"Drucken",orientation:"Ausrichtung",portrait:"Hochformat",landscape:"Querformat",size:"Papierformat",custom:"Bildschirmgröße",margin:"Rand",scale:"Maßstab",legend:"Legende",north:"Nordpfeil",mapTitle:"Kartentitel",saveas:"Speichern als...",saveLegend:"Legende speichern...",copied:"✔ In die Zwischenablage kopiert",errorMsg:"Kann Karte nicht speichern...",printBt:"Drucken...",clipboardFormat:"in die Zwischenablage kopieren...",jpegFormat:"speichern als jpeg",pngFormat:"speichern als png",pdfFormat:"speichern als pdf",none:"kein",small:"klein",large:"groß",cancel:"abbrechen"},zh:{title:"打印",orientation:"方向",portrait:"纵向",landscape:"横向",size:"页面大小",custom:"屏幕大小",margin:"外边距",scale:"尺度",legend:"图例",north:"指北针",mapTitle:"地图名字",saveas:"保存为...",saveLegend:"保存图例为...",copied:"✔ 已复制到剪贴板",errorMsg:"无法保存地图...",printBt:"打印...",cancel:"取消"}};oh.prototype.paperSize={"":null,A0:[841,1189],A1:[594,841],A2:[420,594],A3:[297,420],A4:[210,297],"US Letter":[215.9,279.4],A5:[148,210],B4:[257,364],B5:[182,257]};oh.prototype.marginSize={none:0,small:5,large:10};oh.prototype.formats=[{title:"clipboardFormat",imageType:"image/png",clipboard:!0},{title:"jpegFormat",imageType:"image/jpeg",quality:.8},{title:"pngFormat",imageType:"image/png",quality:.8},{title:"pdfFormat",imageType:"image/jpeg",pdf:!0}];oh.prototype.scales={" 5000":"1/5.000"," 10000":"1/10.000"," 25000":"1/25.000"," 50000":"1/50.000"," 100000":"1/100.000"," 250000":"1/250.000"," 1000000":"1/1.000.000"};var qF=class extends m2{constructor(t){t=t||{},super(t),this.element.classList.add("ol-canvas-control"),this.setCanvas(!!t.canvas),t||(t={}),t.style||(t.style=new Pe),this.setStyle(t.style)}setCanvas(t){if(this.isCanvas_=t,t&&this.setCollapsed(!1),this.element.style.visibility=t?"hidden":"visible",this.getMap())try{this.getMap().renderSync()}catch{}}setStyle(t){var e=t.getText();this.font_=e?e.getFont():"10px sans-serif";var n=e?e.getStroke():null,s=e?e.getFill():null;this.fontStrokeStyle_=n?nr(n.getColor()):"#fff",this.fontFillStyle_=s?nr(s.getColor()):"#000",this.fontStrokeWidth_=n?n.getWidth():3,this.getMap()&&this.getMap().render()}setMap(t){Ya.prototype.getCanvas.call(this,t);var e=this.getMap();if(this._listener&&Ar(this._listener),this._listener=null,super.setMap(t),e)try{e.renderSync()}catch{}t&&(this._listener=t.on("postcompose",this.drawAttribution_.bind(this))),this.setCanvas(this.isCanvas_)}drawAttribution_(t){if(this.isCanvas_){var e=this.getContext(t);if(e){var n="";Array.prototype.slice.call(this.element.querySelectorAll("li")).filter(function(f){return f.style.display!=="none"}).map(function(f){n+=(n?" - ":"")+f.textContent});var s=t.frameState.pixelRatio;e.save(),e.scale(s,s);var r=this.element.getBoundingClientRect(),o=this.getMap().getViewport().getBoundingClientRect(),a=this.getMap().getSize()[0]/o.width;e.translate((r.left-o.left)*a,(r.top-o.top)*a);var l=this.element.clientHeight,h=this.element.clientWidth,c=lt.getStyle(this.element,"textAlign")||"center",u;switch(c){case"left":{u=0;break}case"right":{u=h;break}default:{u=h/2;break}}e.beginPath(),e.strokeStyle=this.fontStrokeStyle_,e.fillStyle=this.fontFillStyle_,e.lineWidth=this.fontStrokeWidth_,e.textAlign=c,e.textBaseline="middle",e.font=this.font_,e.lineJoin="round",e.strokeText(n,u,l/2),e.fillText(n,u,l/2),e.closePath(),e.restore()}}}getContext(t){return Ya.prototype.getContext.call(this,t)}},VF=class extends W6{constructor(t){super(t),this.element.classList.add("ol-canvas-control"),this.scaleHeight_=6,t||(t={}),t.style||(t.style=new Pe),this.setStyle(t.style)}setMap(t){Ya.prototype.getCanvas.call(this,t);var e=this.getMap();if(this._listener&&Ar(this._listener),this._listener=null,super.setMap(t),e)try{e.renderSync()}catch{}t&&(this._listener=t.on("postcompose",this.drawScale_.bind(this))),this.element.style.visibility="hidden",this.olscale=this.element.querySelector(".ol-scale-line-inner")}setStyle(t){var e=t.getStroke();this.strokeStyle_=e?nr(e.getColor()):"#000",this.strokeWidth_=e?e.getWidth():2;var n=t.getFill();this.fillStyle_=n?nr(n.getColor()):"#fff";var s=t.getText();this.font_=s?s.getFont():"10px Arial",e=s?s.getStroke():null,n=s?s.getFill():null,this.fontStrokeStyle_=e?nr(e.getColor()):this.fillStyle_,this.fontStrokeWidth_=e?e.getWidth():3,this.fontFillStyle_=n?nr(n.getColor()):this.strokeStyle_,this.getMap()&&this.getMap().render()}drawScale_(t){if(!(this.element.style.visibility!=="hidden"||lt.getStyle(this.element,"display")==="none")){var e=this.getContext(t);if(e){var n=parseInt(this.olscale.style.width);if(n){var s=this.olscale.textContent,r={left:this.element.offsetLeft,top:this.element.offsetTop},o=t.frameState.pixelRatio;e.save(),e.scale(o,o),r.top+=this.element.clientHeight-this.scaleHeight_,e.beginPath(),e.strokeStyle=this.fontStrokeStyle_,e.fillStyle=this.fontFillStyle_,e.lineWidth=this.fontStrokeWidth_,e.textAlign="center",e.textBaseline="bottom",e.font=this.font_,e.lineJoin="round",e.strokeText(s,r.left+n/2,r.top),e.fillText(s,r.left+n/2,r.top),e.closePath(),r.top+=2,e.lineWidth=this.strokeWidth_,e.strokeStyle=this.strokeStyle_;for(var a=4,l=parseInt(s);l%10===0;)l/=10;l%5===0&&(a=5);for(var h=0;h<a;h++)e.beginPath(),e.fillStyle=h%2?this.fillStyle_:this.strokeStyle_,e.rect(r.left+h*n/a,r.top,n/a,this.scaleHeight_),e.stroke(),e.fill(),e.closePath();e.restore()}}}}getContext(t){return Ya.prototype.getContext.call(this,t)}};function hi(i){"@babel/helpers - typeof";return hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hi(i)}var Un=Uint8Array,zs=Uint16Array,W2=Int32Array,tm=new Un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),em=new Un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),W_=new Un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),uC=function(i,t){for(var e=new zs(31),n=0;n<31;++n)e[n]=t+=1<<i[n-1];for(var s=new W2(e[30]),n=1;n<30;++n)for(var r=e[n];r<e[n+1];++r)s[r]=r-e[n]<<5|n;return{b:e,r:s}},dC=uC(tm,2),fC=dC.b,q_=dC.r;fC[28]=258,q_[258]=28;var gC=uC(em,0),HF=gC.b,B5=gC.r,V_=new zs(32768);for(var Si=0;Si<32768;++Si){var ba=(Si&43690)>>1|(Si&21845)<<1;ba=(ba&52428)>>2|(ba&13107)<<2,ba=(ba&61680)>>4|(ba&3855)<<4,V_[Si]=((ba&65280)>>8|(ba&255)<<8)>>1}var ro=function(i,t,e){for(var n=i.length,s=0,r=new zs(t);s<n;++s)i[s]&&++r[i[s]-1];var o=new zs(t);for(s=1;s<t;++s)o[s]=o[s-1]+r[s-1]<<1;var a;if(e){a=new zs(1<<t);var l=15-t;for(s=0;s<n;++s)if(i[s])for(var h=s<<4|i[s],c=t-i[s],u=o[i[s]-1]++<<c,f=u|(1<<c)-1;u<=f;++u)a[V_[u]>>l]=h}else for(a=new zs(n),s=0;s<n;++s)i[s]&&(a[s]=V_[o[i[s]-1]++]>>15-i[s]);return a},Xa=new Un(288);for(var Si=0;Si<144;++Si)Xa[Si]=8;for(var Si=144;Si<256;++Si)Xa[Si]=9;for(var Si=256;Si<280;++Si)Xa[Si]=7;for(var Si=280;Si<288;++Si)Xa[Si]=8;var rf=new Un(32);for(var Si=0;Si<32;++Si)rf[Si]=5;var YF=ro(Xa,9,0),XF=ro(Xa,9,1),$F=ro(rf,5,0),KF=ro(rf,5,1),U1=function(i){for(var t=i[0],e=1;e<i.length;++e)i[e]>t&&(t=i[e]);return t},_r=function(i,t,e){var n=t/8|0;return(i[n]|i[n+1]<<8)>>(t&7)&e},W1=function(i,t){var e=t/8|0;return(i[e]|i[e+1]<<8|i[e+2]<<16)>>(t&7)},q2=function(i){return(i+7)/8|0},pC=function(i,t,e){return(e==null||e>i.length)&&(e=i.length),new Un(i.subarray(t,e))},ZF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xr=function(i,t,e){var n=new Error(t||ZF[i]);if(n.code=i,Error.captureStackTrace&&Error.captureStackTrace(n,xr),!e)throw n;return n},JF=function(i,t,e,n){var s=i.length,r=0;if(!s||t.f&&!t.l)return e||new Un(0);var o=!e,a=o||t.i!=2,l=t.i;o&&(e=new Un(s*3));var h=function(Tt){var Wt=e.length;if(Tt>Wt){var Gt=new Un(Math.max(Wt*2,Tt));Gt.set(e),e=Gt}},c=t.f||0,u=t.p||0,f=t.b||0,d=t.l,g=t.d,p=t.m,y=t.n,_=s*8;do{if(!d){c=_r(i,u,1);var x=_r(i,u+1,3);if(u+=3,x)if(x==1)d=XF,g=KF,p=9,y=5;else if(x==2){var k=_r(i,u,31)+257,A=_r(i,u+10,15)+4,T=k+_r(i,u+5,31)+1;u+=14;for(var F=new Un(T),q=new Un(19),R=0;R<A;++R)q[W_[R]]=_r(i,u+R*3,7);u+=A*3;for(var S=U1(q),O=(1<<S)-1,E=ro(q,S,1),R=0;R<T;){var U=E[_r(i,u,O)];u+=U&15;var b=U>>4;if(b<16)F[R++]=b;else{var X=0,Z=0;for(b==16?(Z=3+_r(i,u,3),u+=2,X=F[R-1]):b==17?(Z=3+_r(i,u,7),u+=3):b==18&&(Z=11+_r(i,u,127),u+=7);Z--;)F[R++]=X}}var st=F.subarray(0,k),tt=F.subarray(k);p=U1(st),y=U1(tt),d=ro(st,p,1),g=ro(tt,y,1)}else xr(1);else{var b=q2(u)+4,L=i[b-4]|i[b-3]<<8,M=b+L;if(M>s){l&&xr(0);break}a&&h(f+L),e.set(i.subarray(b,M),f),t.b=f+=L,t.p=u=M*8,t.f=c;continue}if(u>_){l&&xr(0);break}}a&&h(f+131072);for(var ot=(1<<p)-1,et=(1<<y)-1,P=u;;P=u){var X=d[W1(i,u)&ot],H=X>>4;if(u+=X&15,u>_){l&&xr(0);break}if(X||xr(2),H<256)e[f++]=H;else if(H==256){P=u,d=null;break}else{var j=H-254;if(H>264){var R=H-257,K=tm[R];j=_r(i,u,(1<<K)-1)+fC[R],u+=K}var ht=g[W1(i,u)&et],ft=ht>>4;ht||xr(3),u+=ht&15;var tt=HF[ft];if(ft>3){var K=em[ft];tt+=W1(i,u)&(1<<K)-1,u+=K}if(u>_){l&&xr(0);break}a&&h(f+131072);var gt=f+j;if(f<tt){var _t=r-tt,Pt=Math.min(tt,gt);for(_t+f<0&&xr(3);f<Pt;++f)e[f]=n[_t+f]}for(;f<gt;++f)e[f]=e[f-tt]}}t.l=d,t.p=P,t.b=f,t.f=c,d&&(c=1,t.m=p,t.d=g,t.n=y)}while(!c);return f!=e.length&&o?pC(e,0,f):e.subarray(0,f)},Mo=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>8},Wu=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>8,i[n+2]|=e>>16},q1=function(i,t){for(var e=[],n=0;n<i.length;++n)i[n]&&e.push({s:n,f:i[n]});var s=e.length,r=e.slice();if(!s)return{t:_C,l:0};if(s==1){var o=new Un(e[0].s+1);return o[e[0].s]=1,{t:o,l:1}}e.sort(function(M,k){return M.f-k.f}),e.push({s:-1,f:25001});var a=e[0],l=e[1],h=0,c=1,u=2;for(e[0]={s:-1,f:a.f+l.f,l:a,r:l};c!=s-1;)a=e[e[h].f<e[u].f?h++:u++],l=e[h!=c&&e[h].f<e[u].f?h++:u++],e[c++]={s:-1,f:a.f+l.f,l:a,r:l};for(var f=r[0].s,n=1;n<s;++n)r[n].s>f&&(f=r[n].s);var d=new zs(f+1),g=H_(e[c-1],d,0);if(g>t){var n=0,p=0,y=g-t,_=1<<y;for(r.sort(function(k,A){return d[A.s]-d[k.s]||k.f-A.f});n<s;++n){var x=r[n].s;if(d[x]>t)p+=_-(1<<g-d[x]),d[x]=t;else break}for(p>>=y;p>0;){var b=r[n].s;d[b]<t?p-=1<<t-d[b]++-1:++n}for(;n>=0&&p;--n){var L=r[n].s;d[L]==t&&(--d[L],++p)}g=t}return{t:new Un(d),l:g}},H_=function(i,t,e){return i.s==-1?Math.max(H_(i.l,t,e+1),H_(i.r,t,e+1)):t[i.s]=e},j5=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new zs(++t),n=0,s=i[0],r=1,o=function(l){e[n++]=l},a=1;a<=t;++a)if(i[a]==s&&a!=t)++r;else{if(!s&&r>2){for(;r>138;r-=138)o(32754);r>2&&(o(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(o(s),--r;r>6;r-=6)o(8304);r>2&&(o(r-3<<5|8208),r=0)}for(;r--;)o(s);r=1,s=i[a]}return{c:e.subarray(0,n),n:t}},qu=function(i,t){for(var e=0,n=0;n<t.length;++n)e+=i[n]*t[n];return e},mC=function(i,t,e){var n=e.length,s=q2(t+2);i[s]=n&255,i[s+1]=n>>8,i[s+2]=i[s]^255,i[s+3]=i[s+1]^255;for(var r=0;r<n;++r)i[s+r+4]=e[r];return(s+4+n)*8},z5=function(i,t,e,n,s,r,o,a,l,h,c){Mo(t,c++,e),++s[256];for(var u=q1(s,15),f=u.t,d=u.l,g=q1(r,15),p=g.t,y=g.l,_=j5(f),x=_.c,b=_.n,L=j5(p),M=L.c,k=L.n,A=new zs(19),T=0;T<x.length;++T)++A[x[T]&31];for(var T=0;T<M.length;++T)++A[M[T]&31];for(var F=q1(A,7),q=F.t,R=F.l,S=19;S>4&&!q[W_[S-1]];--S);var O=h+5<<3,E=qu(s,Xa)+qu(r,rf)+o,U=qu(s,f)+qu(r,p)+o+14+3*S+qu(A,q)+2*A[16]+3*A[17]+7*A[18];if(l>=0&&O<=E&&O<=U)return mC(t,c,i.subarray(l,l+h));var X,Z,st,tt;if(Mo(t,c,1+(U<E)),c+=2,U<E){X=ro(f,d,0),Z=f,st=ro(p,y,0),tt=p;var ot=ro(q,R,0);Mo(t,c,b-257),Mo(t,c+5,k-1),Mo(t,c+10,S-4),c+=14;for(var T=0;T<S;++T)Mo(t,c+3*T,q[W_[T]]);c+=3*S;for(var et=[x,M],P=0;P<2;++P)for(var H=et[P],T=0;T<H.length;++T){var j=H[T]&31;Mo(t,c,ot[j]),c+=q[j],j>15&&(Mo(t,c,H[T]>>5&127),c+=H[T]>>12)}}else X=YF,Z=Xa,st=$F,tt=rf;for(var T=0;T<a;++T){var K=n[T];if(K>255){var j=K>>18&31;Wu(t,c,X[j+257]),c+=Z[j+257],j>7&&(Mo(t,c,K>>23&31),c+=tm[j]);var ht=K&31;Wu(t,c,st[ht]),c+=tt[ht],ht>3&&(Wu(t,c,K>>5&8191),c+=em[ht])}else Wu(t,c,X[K]),c+=Z[K]}return Wu(t,c,X[256]),c+Z[256]},QF=new W2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_C=new Un(0),tO=function(i,t,e,n,s,r){var o=r.z||i.length,a=new Un(n+o+5*(1+Math.ceil(o/7e3))+s),l=a.subarray(n,a.length-s),h=r.l,c=(r.r||0)&7;if(t){c&&(l[0]=r.r>>3);for(var u=QF[t-1],f=u>>13,d=u&8191,g=(1<<e)-1,p=r.p||new zs(32768),y=r.h||new zs(g+1),_=Math.ceil(e/3),x=2*_,b=function(N){return(i[N]^i[N+1]<<_^i[N+2]<<x)&g},L=new W2(25e3),M=new zs(288),k=new zs(32),A=0,T=0,F=r.i||0,q=0,R=r.w||0,S=0;F+2<o;++F){var O=b(F),E=F&32767,U=y[O];if(p[E]=U,y[O]=E,R<=F){var X=o-F;if((A>7e3||q>24576)&&(X>423||!h)){c=z5(i,l,0,L,M,k,T,q,S,F-S,c),q=A=T=0,S=F;for(var Z=0;Z<286;++Z)M[Z]=0;for(var Z=0;Z<30;++Z)k[Z]=0}var st=2,tt=0,ot=d,et=E-U&32767;if(X>2&&O==b(F-et))for(var P=Math.min(f,X)-1,H=Math.min(32767,F),j=Math.min(258,X);et<=H&&--ot&&E!=U;){if(i[F+st]==i[F+st-et]){for(var K=0;K<j&&i[F+K]==i[F+K-et];++K);if(K>st){if(st=K,tt=et,K>P)break;for(var ht=Math.min(et,K-2),ft=0,Z=0;Z<ht;++Z){var gt=F-et+Z&32767,_t=p[gt],Pt=gt-_t&32767;Pt>ft&&(ft=Pt,U=gt)}}}E=U,U=p[E],et+=E-U&32767}if(tt){L[q++]=268435456|q_[st]<<18|B5[tt];var Tt=q_[st]&31,Wt=B5[tt]&31;T+=tm[Tt]+em[Wt],++M[257+Tt],++k[Wt],R=F+st,++A}else L[q++]=i[F],++M[i[F]]}}for(F=Math.max(F,R);F<o;++F)L[q++]=i[F],++M[i[F]];c=z5(i,l,h,L,M,k,T,q,S,F-S,c),h||(r.r=c&7|l[c/8|0]<<3,c-=7,r.h=y,r.p=p,r.i=F,r.w=R)}else{for(var F=r.w||0;F<o+h;F+=65535){var Gt=F+65535;Gt>=o&&(l[c/8|0]=h,Gt=o),c=mC(l,c+1,i.subarray(F,Gt))}r.i=o}return pC(a,0,n+q2(c)+s)},yC=function(){var i=1,t=0;return{p:function(e){for(var n=i,s=t,r=e.length|0,o=0;o!=r;){for(var a=Math.min(o+2655,r);o<a;++o)s+=n+=e[o];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}i=n,t=s},d:function(){return i%=65521,t%=65521,(i&255)<<24|(i&65280)<<8|(t&255)<<8|t>>8}}},eO=function(i,t,e,n,s){if(!s&&(s={l:1},t.dictionary)){var r=t.dictionary.subarray(-32768),o=new Un(r.length+i.length);o.set(r),o.set(i,r.length),i=o,s.w=r.length}return tO(i,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+t.mem,e,n,s)},vC=function(i,t,e){for(;e;++t)i[t]=e,e>>>=8},iO=function(i,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;if(i[0]=120,i[1]=n<<6|(t.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,t.dictionary){var s=yC();s.p(t.dictionary),vC(i,2,s.d())}},nO=function(i,t){return((i[0]&15)!=8||i[0]>>4>7||(i[0]<<8|i[1])%31)&&xr(6,"invalid zlib data"),(i[1]>>5&1)==+!t&&xr(6,"invalid zlib data: "+(i[1]&32?"need":"unexpected")+" dictionary"),(i[1]>>3&4)+2};function Y_(i,t){t||(t={});var e=yC();e.p(i);var n=eO(i,t,t.dictionary?6:2,4);return iO(n,t),vC(n,n.length-4,e.d()),n}function sO(i,t){return JF(i.subarray(nO(i,t),-4),{i:2},t,t)}var rO=typeof TextDecoder<"u"&&new TextDecoder,oO=0;try{rO.decode(_C,{stream:!0}),oO=1}catch{}var me=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function V1(){me.console&&typeof me.console.log=="function"&&me.console.log.apply(me.console,arguments)}var fi={log:V1,warn:function(i){me.console&&(typeof me.console.warn=="function"?me.console.warn.apply(me.console,arguments):V1.call(null,arguments))},error:function(i){me.console&&(typeof me.console.error=="function"?me.console.error.apply(me.console,arguments):V1(i))}};function H1(i,t,e){var n=new XMLHttpRequest;n.open("GET",i),n.responseType="blob",n.onload=function(){Sl(n.response,t,e)},n.onerror=function(){fi.error("could not download file")},n.send()}function G5(i){var t=new XMLHttpRequest;t.open("HEAD",i,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function $g(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(t)}}var Md,X_,Sl=me.saveAs||((typeof window>"u"?"undefined":hi(window))!=="object"||window!==me?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,t,e){var n=me.URL||me.webkitURL,s=document.createElement("a");t=t||i.name||"download",s.download=t,s.rel="noopener",typeof i=="string"?(s.href=i,s.origin!==location.origin?G5(s.href)?H1(i,t,e):$g(s,s.target="_blank"):$g(s)):(s.href=n.createObjectURL(i),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){$g(s)},0))}:"msSaveOrOpenBlob"in navigator?function(i,t,e){if(t=t||i.name||"download",typeof i=="string")if(G5(i))H1(i,t,e);else{var n=document.createElement("a");n.href=i,n.target="_blank",setTimeout(function(){$g(n)})}else navigator.msSaveOrOpenBlob(function(s,r){return r===void 0?r={autoBom:!1}:hi(r)!=="object"&&(fi.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(i,e),t)}:function(i,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof i=="string")return H1(i,t,e);var s=i.type==="application/octet-stream",r=/constructor/i.test(me.HTMLElement)||me.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&r)&&(typeof FileReader>"u"?"undefined":hi(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var c=a.result;c=o?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=c:location=c,n=null},a.readAsDataURL(i)}else{var l=me.URL||me.webkitURL,h=l.createObjectURL(i);n?n.location=h:location.href=h,n=null,setTimeout(function(){l.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function xC(i){var t;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],n=0;n<e.length;n++){var s=e[n].re,r=e[n].process,o=s.exec(i);o&&(t=r(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),l=this.g.toString(16),h=this.b.toString(16);return a.length==1&&(a="0"+a),l.length==1&&(l="0"+l),h.length==1&&(h="0"+h),"#"+a+l+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Y1(i,t){var e=i[0],n=i[1],s=i[2],r=i[3];e=On(e,n,s,r,t[0],7,-680876936),r=On(r,e,n,s,t[1],12,-389564586),s=On(s,r,e,n,t[2],17,606105819),n=On(n,s,r,e,t[3],22,-1044525330),e=On(e,n,s,r,t[4],7,-176418897),r=On(r,e,n,s,t[5],12,1200080426),s=On(s,r,e,n,t[6],17,-1473231341),n=On(n,s,r,e,t[7],22,-45705983),e=On(e,n,s,r,t[8],7,1770035416),r=On(r,e,n,s,t[9],12,-1958414417),s=On(s,r,e,n,t[10],17,-42063),n=On(n,s,r,e,t[11],22,-1990404162),e=On(e,n,s,r,t[12],7,1804603682),r=On(r,e,n,s,t[13],12,-40341101),s=On(s,r,e,n,t[14],17,-1502002290),e=Dn(e,n=On(n,s,r,e,t[15],22,1236535329),s,r,t[1],5,-165796510),r=Dn(r,e,n,s,t[6],9,-1069501632),s=Dn(s,r,e,n,t[11],14,643717713),n=Dn(n,s,r,e,t[0],20,-373897302),e=Dn(e,n,s,r,t[5],5,-701558691),r=Dn(r,e,n,s,t[10],9,38016083),s=Dn(s,r,e,n,t[15],14,-660478335),n=Dn(n,s,r,e,t[4],20,-405537848),e=Dn(e,n,s,r,t[9],5,568446438),r=Dn(r,e,n,s,t[14],9,-1019803690),s=Dn(s,r,e,n,t[3],14,-187363961),n=Dn(n,s,r,e,t[8],20,1163531501),e=Dn(e,n,s,r,t[13],5,-1444681467),r=Dn(r,e,n,s,t[2],9,-51403784),s=Dn(s,r,e,n,t[7],14,1735328473),e=Bn(e,n=Dn(n,s,r,e,t[12],20,-1926607734),s,r,t[5],4,-378558),r=Bn(r,e,n,s,t[8],11,-2022574463),s=Bn(s,r,e,n,t[11],16,1839030562),n=Bn(n,s,r,e,t[14],23,-35309556),e=Bn(e,n,s,r,t[1],4,-1530992060),r=Bn(r,e,n,s,t[4],11,1272893353),s=Bn(s,r,e,n,t[7],16,-155497632),n=Bn(n,s,r,e,t[10],23,-1094730640),e=Bn(e,n,s,r,t[13],4,681279174),r=Bn(r,e,n,s,t[0],11,-358537222),s=Bn(s,r,e,n,t[3],16,-722521979),n=Bn(n,s,r,e,t[6],23,76029189),e=Bn(e,n,s,r,t[9],4,-640364487),r=Bn(r,e,n,s,t[12],11,-421815835),s=Bn(s,r,e,n,t[15],16,530742520),e=jn(e,n=Bn(n,s,r,e,t[2],23,-995338651),s,r,t[0],6,-198630844),r=jn(r,e,n,s,t[7],10,1126891415),s=jn(s,r,e,n,t[14],15,-1416354905),n=jn(n,s,r,e,t[5],21,-57434055),e=jn(e,n,s,r,t[12],6,1700485571),r=jn(r,e,n,s,t[3],10,-1894986606),s=jn(s,r,e,n,t[10],15,-1051523),n=jn(n,s,r,e,t[1],21,-2054922799),e=jn(e,n,s,r,t[8],6,1873313359),r=jn(r,e,n,s,t[15],10,-30611744),s=jn(s,r,e,n,t[6],15,-1560198380),n=jn(n,s,r,e,t[13],21,1309151649),e=jn(e,n,s,r,t[4],6,-145523070),r=jn(r,e,n,s,t[11],10,-1120210379),s=jn(s,r,e,n,t[2],15,718787259),n=jn(n,s,r,e,t[9],21,-343485551),i[0]=Ia(e,i[0]),i[1]=Ia(n,i[1]),i[2]=Ia(s,i[2]),i[3]=Ia(r,i[3])}function im(i,t,e,n,s,r){return t=Ia(Ia(t,i),Ia(n,r)),Ia(t<<s|t>>>32-s,e)}function On(i,t,e,n,s,r,o){return im(t&e|~t&n,i,t,s,r,o)}function Dn(i,t,e,n,s,r,o){return im(t&n|e&~n,i,t,s,r,o)}function Bn(i,t,e,n,s,r,o){return im(t^e^n,i,t,s,r,o)}function jn(i,t,e,n,s,r,o){return im(e^(t|~n),i,t,s,r,o)}function bC(i){var t,e=i.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=i.length;t+=64)Y1(n,aO(i.substring(t-64,t)));i=i.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)s[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Y1(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*e,Y1(n,s),n}function aO(i){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=i.charCodeAt(t)+(i.charCodeAt(t+1)<<8)+(i.charCodeAt(t+2)<<16)+(i.charCodeAt(t+3)<<24);return e}Md=me.atob.bind(me),X_=me.btoa.bind(me);var U5="0123456789abcdef".split("");function lO(i){for(var t="",e=0;e<4;e++)t+=U5[i>>8*e+4&15]+U5[i>>8*e&15];return t}function hO(i){return String.fromCharCode((255&i)>>0,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function $_(i){return bC(i).map(hO).join("")}var cO=function(i){for(var t=0;t<i.length;t++)i[t]=lO(i[t]);return i.join("")}(bC("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ia(i,t){if(cO){var e=(65535&i)+(65535&t);return(i>>16)+(t>>16)+(e>>16)<<16|65535&e}return i+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function K_(i,t){var e,n,s,r;if(i!==e){for(var o=(s=i,r=1+(256/i.length>>0),new Array(r+1).join(s)),a=[],l=0;l<256;l++)a[l]=l;var h=0;for(l=0;l<256;l++){var c=a[l];h=(h+c+o.charCodeAt(l))%256,a[l]=a[h],a[h]=c}e=i,n=a}else a=n;var u=t.length,f=0,d=0,g="";for(l=0;l<u;l++)d=(d+(c=a[f=(f+1)%256]))%256,a[f]=a[d],a[d]=c,o=a[(a[f]+a[d])%256],g+=String.fromCharCode(t.charCodeAt(l)^o);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var W5={print:4,modify:8,copy:16,"annot-forms":32};function rc(i,t,e,n){this.v=1,this.r=2;var s=192;i.forEach(function(a){if(W5.perm!==void 0)throw new Error("Invalid permission: "+a);s+=W5[a]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var r=(t+this.padding).substr(0,32),o=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(r,o),this.P=-(1+(255^s)),this.encryptionKey=$_(r+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=K_(this.encryptionKey,this.padding)}function oc(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var t="",e=i.length,n=0;n<e;n++){var s=i.charCodeAt(n);s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?t+="#"+("0"+s.toString(16)).slice(-2):t+=i[n]}return t}function q5(i){if(hi(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,s){if(s=s||!1,typeof e!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var r=Math.random().toString(35);return t[e][r]=[n,!!s],r},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var r in t[e]){var o=t[e][r];try{o[0].apply(i,n)}catch(a){me.console&&fi.error("jsPDF PubSub Error",a.message,a)}o[1]&&s.push(r)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function p0(i){if(!(this instanceof p0))return new p0(i);var t="opacity,stroke-opacity".split(",");for(var e in i)i.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=i[e]);this.id="",this.objectNumber=-1}function wC(i,t){this.gState=i,this.matrix=t,this.id="",this.objectNumber=-1}function Ll(i,t,e,n,s){if(!(this instanceof Ll))return new Ll(i,t,e,n,s);this.type=i==="axial"?2:3,this.coords=t,this.colors=e,wC.call(this,n,s)}function _c(i,t,e,n,s){if(!(this instanceof _c))return new _c(i,t,e,n,s);this.boundingBox=i,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,wC.call(this,n,s)}function pe(i){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],r=arguments[3],o=[],a=1,l=16,h="S",c=null;hi(i=i||{})==="object"&&(e=i.orientation,n=i.unit||n,s=i.format||s,r=i.compress||i.compressPdf||r,(c=i.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),a=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(t=i.precision),i.floatPrecision!==void 0&&(l=i.floatPrecision),h=i.defaultPathOperation||"S"),o=i.filters||(r===!0?["FlateEncode"]:o),n=n||"mm",e=(""+(e||"P")).toLowerCase();var u=i.putOnlyUsedFonts||!1,f={},d={internal:{},__private__:{}};d.__private__.PubSub=q5;var g="1.3",p=d.__private__.getPdfVersion=function(){return g};d.__private__.setPdfVersion=function(w){g=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var _=d.__private__.getPageFormat=function(w){return y[w]};s=s||"a4";var x={COMPAT:"compat",ADVANCED:"advanced"},b=x.COMPAT;function L(){this.saveGraphicsState(),z(new se(qt,0,0,-qt,0,sa()*qt).toString()+" cm"),this.setFontSize(this.getFontSize()/qt),h="n",b=x.ADVANCED}function M(){this.restoreGraphicsState(),h="S",b=x.COMPAT}var k=d.__private__.combineFontStyleAndFontWeight=function(w,B){if(w=="bold"&&B=="normal"||w=="bold"&&B==400||w=="normal"&&B=="italic"||w=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(w=B==400||B==="normal"?w==="italic"?"italic":"normal":B!=700&&B!=="bold"||w!=="normal"?(B==700?"bold":B)+""+w:"bold"),w};d.advancedAPI=function(w){var B=b===x.COMPAT;return B&&L.call(this),typeof w!="function"||(w(this),B&&M.call(this)),this},d.compatAPI=function(w){var B=b===x.ADVANCED;return B&&M.call(this),typeof w!="function"||(w(this),B&&L.call(this)),this},d.isAdvancedAPI=function(){return b===x.ADVANCED};var A,T=function(w){if(b!==x.ADVANCED)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=d.roundToPrecision=d.__private__.roundToPrecision=function(w,B){var nt=t||B;if(isNaN(w)||isNaN(nt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(nt).replace(/0+$/,"")};A=d.hpf=d.__private__.hpf=typeof l=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return F(w,l)}:l==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return F(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return F(w,16)};var q=d.f2=d.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return F(w,2)},R=d.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return F(w,3)},S=d.scale=d.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return b===x.COMPAT?w*qt:b===x.ADVANCED?w:void 0},O=function(w){return b===x.COMPAT?sa()-w:b===x.ADVANCED?w:void 0},E=function(w){return S(O(w))};d.__private__.setPrecision=d.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var U,X="00000000000000000000000000000000",Z=d.__private__.getFileId=function(){return X},st=d.__private__.setFileId=function(w){return X=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():X.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),c!==null&&(Nn=new rc(c.userPermissions,c.userPassword,c.ownerPassword,X)),X};d.setFileId=function(w){return st(w),this},d.getFileId=function(){return Z()};var tt=d.__private__.convertDateToPDFDate=function(w){var B=w.getTimezoneOffset(),nt=B<0?"+":"-",ct=Math.floor(Math.abs(B/60)),xt=Math.abs(B%60),Mt=[nt,j(ct),"'",j(xt),"'"].join("");return["D:",w.getFullYear(),j(w.getMonth()+1),j(w.getDate()),j(w.getHours()),j(w.getMinutes()),j(w.getSeconds()),Mt].join("")},ot=d.__private__.convertPDFDateToDate=function(w){var B=parseInt(w.substr(2,4),10),nt=parseInt(w.substr(6,2),10)-1,ct=parseInt(w.substr(8,2),10),xt=parseInt(w.substr(10,2),10),Mt=parseInt(w.substr(12,2),10),Dt=parseInt(w.substr(14,2),10);return new Date(B,nt,ct,xt,Mt,Dt,0)},et=d.__private__.setCreationDate=function(w){var B;if(w===void 0&&(w=new Date),w instanceof Date)B=tt(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=w}return U=B},P=d.__private__.getCreationDate=function(w){var B=U;return w==="jsDate"&&(B=ot(U)),B};d.setCreationDate=function(w){return et(w),this},d.getCreationDate=function(w){return P(w)};var H,j=d.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},K=d.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},ht=0,ft=[],gt=[],_t=0,Pt=[],Tt=[],Wt=!1,Gt=gt,N=function(){ht=0,_t=0,gt=[],ft=[],Pt=[],po=ti(),ar=ti()};d.__private__.setCustomOutputDestination=function(w){Wt=!0,Gt=w};var rt=function(w){Wt||(Gt=w)};d.__private__.resetCustomOutputDestination=function(){Wt=!1,Gt=gt};var z=d.__private__.out=function(w){return w=w.toString(),_t+=w.length+1,Gt.push(w),Gt},J=d.__private__.write=function(w){return z(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Y=d.__private__.getArrayBuffer=function(w){for(var B=w.length,nt=new ArrayBuffer(B),ct=new Uint8Array(nt);B--;)ct[B]=w.charCodeAt(B);return nt},it=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return it};var pt=i.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(w){return pt=b===x.ADVANCED?w/qt:w,this};var vt,at=d.__private__.getFontSize=d.getFontSize=function(){return b===x.COMPAT?pt:pt*qt},Et=i.R2L||!1;d.__private__.setR2L=d.setR2L=function(w){return Et=w,this},d.__private__.getR2L=d.getR2L=function(){return Et};var It,Ct=d.__private__.setZoomMode=function(w){var B=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))vt=w;else if(isNaN(w)){if(B.indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');vt=w}else vt=parseInt(w,10)};d.__private__.getZoomMode=function(){return vt};var jt,ie=d.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');It=w};d.__private__.getPageMode=function(){return It};var te=d.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');jt=w};d.__private__.getLayoutMode=function(){return jt},d.__private__.setDisplayMode=d.setDisplayMode=function(w,B,nt){return Ct(w),te(B),ie(nt),this};var ee={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(w){if(Object.keys(ee).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ee[w]},d.__private__.getDocumentProperties=function(){return ee},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(w){for(var B in ee)ee.hasOwnProperty(B)&&w[B]&&(ee[B]=w[B]);return this},d.__private__.setDocumentProperty=function(w,B){if(Object.keys(ee).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ee[w]=B};var be,qt,bi,he,pn,We={},Re={},Rn=[],Fe={},Vs={},ci={},tn={},ji=null,qe=0,_e=[],Ve=new q5(d),en=i.hotfixes||[],wi={},Ti={},zi=[],se=function w(B,nt,ct,xt,Mt,Dt){if(!(this instanceof w))return new w(B,nt,ct,xt,Mt,Dt);isNaN(B)&&(B=1),isNaN(nt)&&(nt=0),isNaN(ct)&&(ct=0),isNaN(xt)&&(xt=1),isNaN(Mt)&&(Mt=0),isNaN(Dt)&&(Dt=0),this._matrix=[B,nt,ct,xt,Mt,Dt]};Object.defineProperty(se.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(se.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(se.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(se.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(se.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(se.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(se.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(se.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(se.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(se.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(se.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(se.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(se.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(se.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(se.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(se.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),se.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(w)},se.prototype.multiply=function(w){var B=w.sx*this.sx+w.shy*this.shx,nt=w.sx*this.shy+w.shy*this.sy,ct=w.shx*this.sx+w.sy*this.shx,xt=w.shx*this.shy+w.sy*this.sy,Mt=w.tx*this.sx+w.ty*this.shx+this.tx,Dt=w.tx*this.shy+w.ty*this.sy+this.ty;return new se(B,nt,ct,xt,Mt,Dt)},se.prototype.decompose=function(){var w=this.sx,B=this.shy,nt=this.shx,ct=this.sy,xt=this.tx,Mt=this.ty,Dt=Math.sqrt(w*w+B*B),Zt=(w/=Dt)*nt+(B/=Dt)*ct;nt-=w*Zt,ct-=B*Zt;var ue=Math.sqrt(nt*nt+ct*ct);return Zt/=ue,w*(ct/=ue)<B*(nt/=ue)&&(w=-w,B=-B,Zt=-Zt,Dt=-Dt),{scale:new se(Dt,0,0,ue,0,0),translate:new se(1,0,0,1,xt,Mt),rotate:new se(w,B,-B,w,0,0),skew:new se(1,0,Zt,1,0,0)}},se.prototype.toString=function(w){return this.join(" ")},se.prototype.inversed=function(){var w=this.sx,B=this.shy,nt=this.shx,ct=this.sy,xt=this.tx,Mt=this.ty,Dt=1/(w*ct-B*nt),Zt=ct*Dt,ue=-B*Dt,Le=-nt*Dt,Ee=w*Dt;return new se(Zt,ue,Le,Ee,-Zt*xt-Le*Mt,-ue*xt-Ee*Mt)},se.prototype.applyToPoint=function(w){var B=w.x*this.sx+w.y*this.shx+this.tx,nt=w.x*this.shy+w.y*this.sy+this.ty;return new Sh(B,nt)},se.prototype.applyToRectangle=function(w){var B=this.applyToPoint(w),nt=this.applyToPoint(new Sh(w.x+w.w,w.y+w.h));return new mu(B.x,B.y,nt.x-B.x,nt.y-B.y)},se.prototype.clone=function(){var w=this.sx,B=this.shy,nt=this.shx,ct=this.sy,xt=this.tx,Mt=this.ty;return new se(w,B,nt,ct,xt,Mt)},d.Matrix=se;var Gi=d.matrixMult=function(w,B){return B.multiply(w)},nn=new se(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=nn;var Ne=function(w,B){if(!Vs[w]){var nt=(B instanceof Ll?"Sh":"P")+(Object.keys(Fe).length+1).toString(10);B.id=nt,Vs[w]=nt,Fe[nt]=B,Ve.publish("addPattern",B)}};d.ShadingPattern=Ll,d.TilingPattern=_c,d.addShadingPattern=function(w,B){return T("addShadingPattern()"),Ne(w,B),this},d.beginTilingPattern=function(w){T("beginTilingPattern()"),ng(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},d.endTilingPattern=function(w,B){T("endTilingPattern()"),B.stream=Tt[H].join(`
`),Ne(w,B),Ve.publish("endTilingPattern",B),zi.pop().restore()};var je=d.__private__.newObject=function(){var w=ti();return $n(w,!0),w},ti=d.__private__.newObjectDeferred=function(){return ht++,ft[ht]=function(){return _t},ht},$n=function(w,B){return B=typeof B=="boolean"&&B,ft[w]=_t,B&&z(w+" 0 obj"),w},ch=d.__private__.newAdditionalObject=function(){var w={objId:ti(),content:""};return Pt.push(w),w},po=ti(),ar=ti(),lr=d.__private__.decodeColorString=function(w){var B=w.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length===5&&(B[4]==="k"||B[4]==="K")&&(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var nt=parseFloat(B[0]);B=[nt,nt,nt,"r"]}for(var ct="#",xt=0;xt<3;xt++)ct+=("0"+Math.floor(255*parseFloat(B[xt])).toString(16)).slice(-2);return ct},hr=d.__private__.encodeColorString=function(w){var B;typeof w=="string"&&(w={ch1:w});var nt=w.ch1,ct=w.ch2,xt=w.ch3,Mt=w.ch4,Dt=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof nt=="string"&&nt.charAt(0)!=="#"){var Zt=new xC(nt);if(Zt.ok)nt=Zt.toHex();else if(!/^\d*\.?\d*$/.test(nt))throw new Error('Invalid color "'+nt+'" passed to jsPDF.encodeColorString.')}if(typeof nt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(nt)&&(nt="#"+nt[1]+nt[1]+nt[2]+nt[2]+nt[3]+nt[3]),typeof nt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(nt)){var ue=parseInt(nt.substr(1),16);nt=ue>>16&255,ct=ue>>8&255,xt=255&ue}if(ct===void 0||Mt===void 0&&nt===ct&&ct===xt)if(typeof nt=="string")B=nt+" "+Dt[0];else switch(w.precision){case 2:B=q(nt/255)+" "+Dt[0];break;case 3:default:B=R(nt/255)+" "+Dt[0]}else if(Mt===void 0||hi(Mt)==="object"){if(Mt&&!isNaN(Mt.a)&&Mt.a===0)return B=["1.","1.","1.",Dt[1]].join(" ");if(typeof nt=="string")B=[nt,ct,xt,Dt[1]].join(" ");else switch(w.precision){case 2:B=[q(nt/255),q(ct/255),q(xt/255),Dt[1]].join(" ");break;default:case 3:B=[R(nt/255),R(ct/255),R(xt/255),Dt[1]].join(" ")}}else if(typeof nt=="string")B=[nt,ct,xt,Mt,Dt[2]].join(" ");else switch(w.precision){case 2:B=[q(nt),q(ct),q(xt),q(Mt),Dt[2]].join(" ");break;case 3:default:B=[R(nt),R(ct),R(xt),R(Mt),Dt[2]].join(" ")}return B},Dr=d.__private__.getFilters=function(){return o},Hs=d.__private__.putStream=function(w){var B=(w=w||{}).data||"",nt=w.filters||Dr(),ct=w.alreadyAppliedFilters||[],xt=w.addLength1||!1,Mt=B.length,Dt=w.objectId,Zt=function(kn){return kn};if(c!==null&&Dt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(Zt=Nn.encryptor(Dt,0));var ue={};nt===!0&&(nt=["FlateEncode"]);var Le=w.additionalKeyValues||[],Ee=(ue=pe.API.processDataByFilters!==void 0?pe.API.processDataByFilters(B,nt):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(ct)?ct.join(" "):ct.toString());if(ue.data.length!==0&&(Le.push({key:"Length",value:ue.data.length}),xt===!0&&Le.push({key:"Length1",value:Mt})),Ee.length!=0)if(Ee.split("/").length-1==1)Le.push({key:"Filter",value:Ee});else{Le.push({key:"Filter",value:"["+Ee+"]"});for(var Ue=0;Ue<Le.length;Ue+=1)if(Le[Ue].key==="DecodeParms"){for(var Ai=[],Ni=0;Ni<ue.reverseChain.split("/").length-1;Ni+=1)Ai.push("null");Ai.push(Le[Ue].value),Le[Ue].value="["+Ai.join(" ")+"]"}}z("<<");for(var sn=0;sn<Le.length;sn++)z("/"+Le[sn].key+" "+Le[sn].value);z(">>"),ue.data.length!==0&&(z("stream"),z(Zt(ue.data)),z("endstream"))},Br=d.__private__.putPage=function(w){var B=w.number,nt=w.data,ct=w.objId,xt=w.contentsObjId;$n(ct,!0),z("<</Type /Page"),z("/Parent "+w.rootDictionaryObjId+" 0 R"),z("/Resources "+w.resourceDictionaryObjId+" 0 R"),z("/MediaBox ["+parseFloat(A(w.mediaBox.bottomLeftX))+" "+parseFloat(A(w.mediaBox.bottomLeftY))+" "+A(w.mediaBox.topRightX)+" "+A(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&z("/CropBox ["+A(w.cropBox.bottomLeftX)+" "+A(w.cropBox.bottomLeftY)+" "+A(w.cropBox.topRightX)+" "+A(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&z("/BleedBox ["+A(w.bleedBox.bottomLeftX)+" "+A(w.bleedBox.bottomLeftY)+" "+A(w.bleedBox.topRightX)+" "+A(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&z("/TrimBox ["+A(w.trimBox.bottomLeftX)+" "+A(w.trimBox.bottomLeftY)+" "+A(w.trimBox.topRightX)+" "+A(w.trimBox.topRightY)+"]"),w.artBox!==null&&z("/ArtBox ["+A(w.artBox.bottomLeftX)+" "+A(w.artBox.bottomLeftY)+" "+A(w.artBox.topRightX)+" "+A(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&z("/UserUnit "+w.userUnit),Ve.publish("putPage",{objId:ct,pageContext:_e[B],pageNumber:B,page:nt}),z("/Contents "+xt+" 0 R"),z(">>"),z("endobj");var Mt=nt.join(`
`);return b===x.ADVANCED&&(Mt+=`
Q`),$n(xt,!0),Hs({data:Mt,filters:Dr(),objectId:xt}),z("endobj"),ct},sl=d.__private__.putPages=function(){var w,B,nt=[];for(w=1;w<=qe;w++)_e[w].objId=ti(),_e[w].contentsObjId=ti();for(w=1;w<=qe;w++)nt.push(Br({number:w,data:Tt[w],objId:_e[w].objId,contentsObjId:_e[w].contentsObjId,mediaBox:_e[w].mediaBox,cropBox:_e[w].cropBox,bleedBox:_e[w].bleedBox,trimBox:_e[w].trimBox,artBox:_e[w].artBox,userUnit:_e[w].userUnit,rootDictionaryObjId:po,resourceDictionaryObjId:ar}));$n(po,!0),z("<</Type /Pages");var ct="/Kids [";for(B=0;B<qe;B++)ct+=nt[B]+" 0 R ";z(ct+"]"),z("/Count "+qe),z(">>"),z("endobj"),Ve.publish("postPutPages")},uh=function(w){Ve.publish("putFont",{font:w,out:z,newObject:je,putStream:Hs}),w.isAlreadyPutted!==!0&&(w.objectNumber=je(),z("<<"),z("/Type /Font"),z("/BaseFont /"+oc(w.postScriptName)),z("/Subtype /Type1"),typeof w.encoding=="string"&&z("/Encoding /"+w.encoding),z("/FirstChar 32"),z("/LastChar 255"),z(">>"),z("endobj"))},dh=function(){for(var w in We)We.hasOwnProperty(w)&&(u===!1||u===!0&&f.hasOwnProperty(w))&&uh(We[w])},fh=function(w){w.objectNumber=je();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[A(w.x),A(w.y),A(w.x+w.width),A(w.y+w.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var nt=w.pages[1].join(`
`);Hs({data:nt,additionalKeyValues:B,objectId:w.objectNumber}),z("endobj")},gh=function(){for(var w in wi)wi.hasOwnProperty(w)&&fh(wi[w])},jf=function(w,B){var nt,ct=[],xt=1/(B-1);for(nt=0;nt<1;nt+=xt)ct.push(nt);if(ct.push(1),w[0].offset!=0){var Mt={offset:0,color:w[0].color};w.unshift(Mt)}if(w[w.length-1].offset!=1){var Dt={offset:1,color:w[w.length-1].color};w.push(Dt)}for(var Zt="",ue=0,Le=0;Le<ct.length;Le++){for(nt=ct[Le];nt>w[ue+1].offset;)ue++;var Ee=w[ue].offset,Ue=(nt-Ee)/(w[ue+1].offset-Ee),Ai=w[ue].color,Ni=w[ue+1].color;Zt+=K(Math.round((1-Ue)*Ai[0]+Ue*Ni[0]).toString(16))+K(Math.round((1-Ue)*Ai[1]+Ue*Ni[1]).toString(16))+K(Math.round((1-Ue)*Ai[2]+Ue*Ni[2]).toString(16))}return Zt.trim()},bm=function(w,B){B||(B=21);var nt=je(),ct=jf(w.colors,B),xt=[];xt.push({key:"FunctionType",value:"0"}),xt.push({key:"Domain",value:"[0.0 1.0]"}),xt.push({key:"Size",value:"["+B+"]"}),xt.push({key:"BitsPerSample",value:"8"}),xt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),xt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Hs({data:ct,additionalKeyValues:xt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:nt}),z("endobj"),w.objectNumber=je(),z("<< /ShadingType "+w.type),z("/ColorSpace /DeviceRGB");var Mt="/Coords ["+A(parseFloat(w.coords[0]))+" "+A(parseFloat(w.coords[1]))+" ";w.type===2?Mt+=A(parseFloat(w.coords[2]))+" "+A(parseFloat(w.coords[3])):Mt+=A(parseFloat(w.coords[2]))+" "+A(parseFloat(w.coords[3]))+" "+A(parseFloat(w.coords[4]))+" "+A(parseFloat(w.coords[5])),z(Mt+="]"),w.matrix&&z("/Matrix ["+w.matrix.toString()+"]"),z("/Function "+nt+" 0 R"),z("/Extend [true true]"),z(">>"),z("endobj")},wm=function(w,B){var nt=ti(),ct=je();B.push({resourcesOid:nt,objectOid:ct}),w.objectNumber=ct;var xt=[];xt.push({key:"Type",value:"/Pattern"}),xt.push({key:"PatternType",value:"1"}),xt.push({key:"PaintType",value:"1"}),xt.push({key:"TilingType",value:"1"}),xt.push({key:"BBox",value:"["+w.boundingBox.map(A).join(" ")+"]"}),xt.push({key:"XStep",value:A(w.xStep)}),xt.push({key:"YStep",value:A(w.yStep)}),xt.push({key:"Resources",value:nt+" 0 R"}),w.matrix&&xt.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Hs({data:w.stream,additionalKeyValues:xt,objectId:w.objectNumber}),z("endobj")},ph=function(w){var B;for(B in Fe)Fe.hasOwnProperty(B)&&(Fe[B]instanceof Ll?bm(Fe[B]):Fe[B]instanceof _c&&wm(Fe[B],w))},zf=function(w){for(var B in w.objectNumber=je(),z("<<"),w)switch(B){case"opacity":z("/ca "+q(w[B]));break;case"stroke-opacity":z("/CA "+q(w[B]))}z(">>"),z("endobj")},Sm=function(){var w;for(w in ci)ci.hasOwnProperty(w)&&zf(ci[w])},ou=function(){for(var w in z("/XObject <<"),wi)wi.hasOwnProperty(w)&&wi[w].objectNumber>=0&&z("/"+w+" "+wi[w].objectNumber+" 0 R");Ve.publish("putXobjectDict"),z(">>")},Em=function(){Nn.oid=je(),z("<<"),z("/Filter /Standard"),z("/V "+Nn.v),z("/R "+Nn.r),z("/U <"+Nn.toHexString(Nn.U)+">"),z("/O <"+Nn.toHexString(Nn.O)+">"),z("/P "+Nn.P),z(">>"),z("endobj")},Gf=function(){for(var w in z("/Font <<"),We)We.hasOwnProperty(w)&&(u===!1||u===!0&&f.hasOwnProperty(w))&&z("/"+w+" "+We[w].objectNumber+" 0 R");z(">>")},Cm=function(){if(Object.keys(Fe).length>0){for(var w in z("/Shading <<"),Fe)Fe.hasOwnProperty(w)&&Fe[w]instanceof Ll&&Fe[w].objectNumber>=0&&z("/"+w+" "+Fe[w].objectNumber+" 0 R");Ve.publish("putShadingPatternDict"),z(">>")}},mh=function(w){if(Object.keys(Fe).length>0){for(var B in z("/Pattern <<"),Fe)Fe.hasOwnProperty(B)&&Fe[B]instanceof d.TilingPattern&&Fe[B].objectNumber>=0&&Fe[B].objectNumber<w&&z("/"+B+" "+Fe[B].objectNumber+" 0 R");Ve.publish("putTilingPatternDict"),z(">>")}},Lm=function(){if(Object.keys(ci).length>0){var w;for(w in z("/ExtGState <<"),ci)ci.hasOwnProperty(w)&&ci[w].objectNumber>=0&&z("/"+w+" "+ci[w].objectNumber+" 0 R");Ve.publish("putGStateDict"),z(">>")}},Ui=function(w){$n(w.resourcesOid,!0),z("<<"),z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gf(),Cm(),mh(w.objectOid),Lm(),ou(),z(">>"),z("endobj")},Uf=function(){var w=[];dh(),Sm(),gh(),ph(w),Ve.publish("putResources"),w.forEach(Ui),Ui({resourcesOid:ar,objectOid:Number.MAX_SAFE_INTEGER}),Ve.publish("postPutResources")},Wf=function(){Ve.publish("putAdditionalObjects");for(var w=0;w<Pt.length;w++){var B=Pt[w];$n(B.objId,!0),z(B.content),z("endobj")}Ve.publish("postPutAdditionalObjects")},qf=function(w){Re[w.fontName]=Re[w.fontName]||{},Re[w.fontName][w.fontStyle]=w.id},au=function(w,B,nt,ct,xt){var Mt={id:"F"+(Object.keys(We).length+1).toString(10),postScriptName:w,fontName:B,fontStyle:nt,encoding:ct,isStandardFont:xt||!1,metadata:{}};return Ve.publish("addFont",{font:Mt,instance:this}),We[Mt.id]=Mt,qf(Mt),Mt.id},Mm=function(w){for(var B=0,nt=it.length;B<nt;B++){var ct=au.call(this,w[B][0],w[B][1],w[B][2],it[B][3],!0);u===!1&&(f[ct]=!0);var xt=w[B][0].split("-");qf({id:ct,fontName:xt[0],fontStyle:xt[1]||""})}Ve.publish("addFonts",{fonts:We,dictionary:Re})},cr=function(w){return w.foo=function(){try{return w.apply(this,arguments)}catch(ct){var B=ct.stack||"";~B.indexOf(" at ")&&(B=B.split(" at ")[1]);var nt="Error in function "+B.split(`
`)[0].split("<")[0]+": "+ct.message;if(!me.console)throw new Error(nt);me.console.error(nt,ct),me.alert&&alert(nt)}},w.foo.bar=w,w.foo},_h=function(w,B){var nt,ct,xt,Mt,Dt,Zt,ue,Le,Ee;if(xt=(B=B||{}).sourceEncoding||"Unicode",Dt=B.outputEncoding,(B.autoencode||Dt)&&We[be].metadata&&We[be].metadata[xt]&&We[be].metadata[xt].encoding&&(Mt=We[be].metadata[xt].encoding,!Dt&&We[be].encoding&&(Dt=We[be].encoding),!Dt&&Mt.codePages&&(Dt=Mt.codePages[0]),typeof Dt=="string"&&(Dt=Mt[Dt]),Dt)){for(ue=!1,Zt=[],nt=0,ct=w.length;nt<ct;nt++)(Le=Dt[w.charCodeAt(nt)])?Zt.push(String.fromCharCode(Le)):Zt.push(w[nt]),Zt[nt].charCodeAt(0)>>8&&(ue=!0);w=Zt.join("")}for(nt=w.length;ue===void 0&&nt!==0;)w.charCodeAt(nt-1)>>8&&(ue=!0),nt--;if(!ue)return w;for(Zt=B.noBOM?[]:[254,255],nt=0,ct=w.length;nt<ct;nt++){if((Ee=(Le=w.charCodeAt(nt))>>8)>>8)throw new Error("Character at position "+nt+" of string '"+w+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(Ee),Zt.push(Le-(Ee<<8))}return String.fromCharCode.apply(void 0,Zt)},as=d.__private__.pdfEscape=d.pdfEscape=function(w,B){return _h(w,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},lu=d.__private__.beginPage=function(w){Tt[++qe]=[],_e[qe]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Hf(qe),rt(Tt[H])},Vf=function(w,B){var nt,ct,xt;switch(e=B||e,typeof w=="string"&&(nt=_(w.toLowerCase()),Array.isArray(nt)&&(ct=nt[0],xt=nt[1])),Array.isArray(w)&&(ct=w[0]*qt,xt=w[1]*qt),isNaN(ct)&&(ct=s[0],xt=s[1]),(ct>14400||xt>14400)&&(fi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ct=Math.min(14400,ct),xt=Math.min(14400,xt)),s=[ct,xt],e.substr(0,1)){case"l":xt>ct&&(s=[xt,ct]);break;case"p":ct>xt&&(s=[xt,ct])}lu(s),Jf(du),z(ur),gu!==0&&z(gu+" J"),pu!==0&&z(pu+" j"),Ve.publish("addPage",{pageNumber:qe})},Tm=function(w){w>0&&w<=qe&&(Tt.splice(w,1),_e.splice(w,1),qe--,H>qe&&(H=qe),this.setPage(H))},Hf=function(w){w>0&&w<=qe&&(H=w)},Am=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return Tt.length-1},Yf=function(w,B,nt){var ct,xt=void 0;return nt=nt||{},w=w!==void 0?w:We[be].fontName,B=B!==void 0?B:We[be].fontStyle,ct=w.toLowerCase(),Re[ct]!==void 0&&Re[ct][B]!==void 0?xt=Re[ct][B]:Re[w]!==void 0&&Re[w][B]!==void 0?xt=Re[w][B]:nt.disableWarning===!1&&fi.warn("Unable to look up font label for font '"+w+"', '"+B+"'. Refer to getFontList() for available fonts."),xt||nt.noFallback||(xt=Re.times[B])==null&&(xt=Re.times.normal),xt},Pm=d.__private__.putInfo=function(){var w=je(),B=function(ct){return ct};for(var nt in c!==null&&(B=Nn.encryptor(w,0)),z("<<"),z("/Producer ("+as(B("jsPDF "+pe.version))+")"),ee)ee.hasOwnProperty(nt)&&ee[nt]&&z("/"+nt.substr(0,1).toUpperCase()+nt.substr(1)+" ("+as(B(ee[nt]))+")");z("/CreationDate ("+as(B(U))+")"),z(">>"),z("endobj")},hu=d.__private__.putCatalog=function(w){var B=(w=w||{}).rootDictionaryObjId||po;switch(je(),z("<<"),z("/Type /Catalog"),z("/Pages "+B+" 0 R"),vt||(vt="fullwidth"),vt){case"fullwidth":z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":z("/OpenAction [3 0 R /Fit]");break;case"original":z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var nt=""+vt;nt.substr(nt.length-1)==="%"&&(vt=parseInt(vt)/100),typeof vt=="number"&&z("/OpenAction [3 0 R /XYZ null null "+q(vt)+"]")}switch(jt||(jt="continuous"),jt){case"continuous":z("/PageLayout /OneColumn");break;case"single":z("/PageLayout /SinglePage");break;case"two":case"twoleft":z("/PageLayout /TwoColumnLeft");break;case"tworight":z("/PageLayout /TwoColumnRight")}It&&z("/PageMode /"+It),Ve.publish("putCatalog"),z(">>"),z("endobj")},Im=d.__private__.putTrailer=function(){z("trailer"),z("<<"),z("/Size "+(ht+1)),z("/Root "+ht+" 0 R"),z("/Info "+(ht-1)+" 0 R"),c!==null&&z("/Encrypt "+Nn.oid+" 0 R"),z("/ID [ <"+X+"> <"+X+"> ]"),z(">>")},Rm=d.__private__.putHeader=function(){z("%PDF-"+g),z("%ºß¬à")},Nm=d.__private__.putXRef=function(){var w="0000000000";z("xref"),z("0 "+(ht+1)),z("0000000000 65535 f ");for(var B=1;B<=ht;B++)typeof ft[B]=="function"?z((w+ft[B]()).slice(-10)+" 00000 n "):ft[B]!==void 0?z((w+ft[B]).slice(-10)+" 00000 n "):z("0000000000 00000 n ")},mo=d.__private__.buildDocument=function(){N(),rt(gt),Ve.publish("buildDocument"),Rm(),sl(),Wf(),Uf(),c!==null&&Em(),Pm(),hu();var w=_t;return Nm(),Im(),z("startxref"),z(""+w),z("%%EOF"),rt(Tt[H]),gt.join(`
`)},yh=d.__private__.getBlob=function(w){return new Blob([Y(w)],{type:"application/pdf"})},vh=d.output=d.__private__.output=cr(function(w,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",w){case void 0:return mo();case"save":d.save(B.filename);break;case"arraybuffer":return Y(mo());case"blob":return yh(mo());case"bloburi":case"bloburl":if(me.URL!==void 0&&typeof me.URL.createObjectURL=="function")return me.URL&&me.URL.createObjectURL(yh(mo()))||void 0;fi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var nt="",ct=mo();try{nt=X_(ct)}catch{nt=X_(unescape(encodeURIComponent(ct)))}return"data:application/pdf;filename="+B.filename+";base64,"+nt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(me)==="[object Window]"){var xt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(xt=B.pdfObjectUrl,Mt="");var Dt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+xt+'"'+Mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",Zt=me.open();return Zt!==null&&Zt.document.write(Dt),Zt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(me)==="[object Window]"){var ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',Le=me.open();if(Le!==null){Le.document.write(ue);var Ee=this;Le.document.documentElement.querySelector("#pdfViewer").onload=function(){Le.document.title=B.filename,Le.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ee.output("bloburl"))}}return Le}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(me)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',Ai=me.open();if(Ai!==null&&(Ai.document.write(Ue),Ai.document.title=B.filename),Ai||typeof safari>"u")return Ai;break;case"datauri":case"dataurl":return me.document.location.href=this.output("datauristring",B);default:return null}}),Xf=function(w){return Array.isArray(en)===!0&&en.indexOf(w)>-1};switch(n){case"pt":qt=1;break;case"mm":qt=72/25.4;break;case"cm":qt=72/2.54;break;case"in":qt=72;break;case"px":qt=Xf("px_scaling")==1?.75:96/72;break;case"pc":case"em":qt=12;break;case"ex":qt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qt=n}var Nn=null;et(),st();var km=function(w){return c!==null?Nn.encryptor(w,0):function(B){return B}},$f=d.__private__.getPageInfo=d.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_e[w].objId,pageNumber:w,pageContext:_e[w]}},we=d.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in _e)if(_e[B].objId===w)break;return $f(B)},Fm=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:_e[H].objId,pageNumber:H,pageContext:_e[H]}};d.addPage=function(){return Vf.apply(this,arguments),this},d.setPage=function(){return Hf.apply(this,arguments),rt.call(this,Tt[H]),this},d.insertPage=function(w){return this.addPage(),this.movePage(H,w),this},d.movePage=function(w,B){var nt,ct;if(w>B){nt=Tt[w],ct=_e[w];for(var xt=w;xt>B;xt--)Tt[xt]=Tt[xt-1],_e[xt]=_e[xt-1];Tt[B]=nt,_e[B]=ct,this.setPage(B)}else if(w<B){nt=Tt[w],ct=_e[w];for(var Mt=w;Mt<B;Mt++)Tt[Mt]=Tt[Mt+1],_e[Mt]=_e[Mt+1];Tt[B]=nt,_e[B]=ct,this.setPage(B)}return this},d.deletePage=function(){return Tm.apply(this,arguments),this},d.__private__.text=d.text=function(w,B,nt,ct,xt){var Mt,Dt,Zt,ue,Le,Ee,Ue,Ai,Ni,sn=(ct=ct||{}).scope||this;if(typeof w=="number"&&typeof B=="number"&&(typeof nt=="string"||Array.isArray(nt))){var kn=nt;nt=B,B=w,w=kn}if(arguments[3]instanceof se?(T("The transform parameter of text() with a Matrix value"),Ni=xt):(Zt=arguments[4],ue=arguments[5],hi(Ue=arguments[3])==="object"&&Ue!==null||(typeof Zt=="string"&&(ue=Zt,Zt=null),typeof Ue=="string"&&(ue=Ue,Ue=null),typeof Ue=="number"&&(Zt=Ue,Ue=null),ct={flags:Ue,angle:Zt,align:ue})),isNaN(B)||isNaN(nt)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return sn;var mn="",dr=!1,Is=typeof ct.lineHeightFactor=="number"?ct.lineHeightFactor:ol,Gr=sn.internal.scaleFactor;function sg(mi){return mi=mi.split("	").join(Array(ct.TabLen||9).join(" ")),as(mi,Ue)}function xu(mi){for(var _i,qi=mi.concat(),un=[],bo=qi.length;bo--;)typeof(_i=qi.shift())=="string"?un.push(_i):Array.isArray(mi)&&(_i.length===1||_i[1]===void 0&&_i[2]===void 0)?un.push(_i[0]):un.push([_i[0],_i[1],_i[2]]);return un}function bu(mi,_i){var qi;if(typeof mi=="string")qi=_i(mi)[0];else if(Array.isArray(mi)){for(var un,bo,Au=mi.concat(),kh=[],hg=Au.length;hg--;)typeof(un=Au.shift())=="string"?kh.push(_i(un)[0]):Array.isArray(un)&&typeof un[0]=="string"&&(bo=_i(un[0],un[1],un[2]),kh.push([bo[0],bo[1],bo[2]]));qi=kh}return qi}var Ch=!1,wu=!0;if(typeof w=="string")Ch=!0;else if(Array.isArray(w)){var Su=w.concat();Dt=[];for(var Lh,Ln=Su.length;Ln--;)(typeof(Lh=Su.shift())!="string"||Array.isArray(Lh)&&typeof Lh[0]!="string")&&(wu=!1);Ch=wu}if(Ch===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var Mh=pt/sn.internal.scaleFactor,Th=Mh*(Is-1);switch(ct.baseline){case"bottom":nt-=Th;break;case"top":nt+=Mh-Th;break;case"hanging":nt+=Mh-2*Th;break;case"middle":nt+=Mh/2-Th}if((Ee=ct.maxWidth||0)>0&&(typeof w=="string"?w=sn.splitTextToSize(w,Ee):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(mi,_i){return mi.concat(sn.splitTextToSize(_i,Ee))},[]))),Mt={text:w,x:B,y:nt,options:ct,mutex:{pdfEscape:as,activeFontKey:be,fonts:We,activeFontSize:pt}},Ve.publish("preProcessText",Mt),w=Mt.text,Zt=(ct=Mt.options).angle,!(Ni instanceof se)&&Zt&&typeof Zt=="number"){Zt*=Math.PI/180,ct.rotationDirection===0&&(Zt=-Zt),b===x.ADVANCED&&(Zt=-Zt);var Ah=Math.cos(Zt),Eu=Math.sin(Zt);Ni=new se(Ah,Eu,-Eu,Ah,0,0)}else Zt&&Zt instanceof se&&(Ni=Zt);b!==x.ADVANCED||Ni||(Ni=nn),(Le=ct.charSpace||wh)!==void 0&&(mn+=A(S(Le))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ai=ct.horizontalScale)!==void 0&&(mn+=A(100*Ai)+` Tz
`),ct.lang;var ls=-1,Vm=ct.renderingMode!==void 0?ct.renderingMode:ct.stroke,Cu=sn.internal.getCurrentPageInfo().pageContext;switch(Vm){case 0:case!1:case"fill":ls=0;break;case 1:case!0:case"stroke":ls=1;break;case 2:case"fillThenStroke":ls=2;break;case 3:case"invisible":ls=3;break;case 4:case"fillAndAddForClipping":ls=4;break;case 5:case"strokeAndAddPathForClipping":ls=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ls=6;break;case 7:case"addToPathForClipping":ls=7}var rg=Cu.usedRenderingMode!==void 0?Cu.usedRenderingMode:-1;ls!==-1?mn+=ls+` Tr
`:rg!==-1&&(mn+=`0 Tr
`),ls!==-1&&(Cu.usedRenderingMode=ls),ue=ct.align||"left";var Ys,Ph=pt*Is,og=sn.internal.pageSize.getWidth(),ag=We[be];Le=ct.charSpace||wh,Ee=ct.maxWidth||0,Ue=Object.assign({autoencode:!0,noBOM:!0},ct.flags);var ra=[],hl=function(mi){return sn.getStringUnitWidth(mi,{font:ag,charSpace:Le,fontSize:pt,doKerning:!1})*pt/Gr};if(Object.prototype.toString.call(w)==="[object Array]"){var hs;Dt=xu(w),ue!=="left"&&(Ys=Dt.map(hl));var Kn,oa=0;if(ue==="right"){B-=Ys[0],w=[],Ln=Dt.length;for(var yo=0;yo<Ln;yo++)yo===0?(Kn=zr(B),hs=_o(nt)):(Kn=S(oa-Ys[yo]),hs=-Ph),w.push([Dt[yo],Kn,hs]),oa=Ys[yo]}else if(ue==="center"){B-=Ys[0]/2,w=[],Ln=Dt.length;for(var vo=0;vo<Ln;vo++)vo===0?(Kn=zr(B),hs=_o(nt)):(Kn=S((oa-Ys[vo])/2),hs=-Ph),w.push([Dt[vo],Kn,hs]),oa=Ys[vo]}else if(ue==="left"){w=[],Ln=Dt.length;for(var Ih=0;Ih<Ln;Ih++)w.push(Dt[Ih])}else if(ue==="justify"&&ag.encoding==="Identity-H"){w=[],Ln=Dt.length,Ee=Ee!==0?Ee:og;for(var xo=0,Wi=0;Wi<Ln;Wi++)if(hs=Wi===0?_o(nt):-Ph,Kn=Wi===0?zr(B):xo,Wi<Ln-1){var Lu=S((Ee-Ys[Wi])/(Dt[Wi].split(" ").length-1)),Zn=Dt[Wi].split(" ");w.push([Zn[0]+" ",Kn,hs]),xo=0;for(var Xs=1;Xs<Zn.length;Xs++){var Rh=(hl(Zn[Xs-1]+" "+Zn[Xs])-hl(Zn[Xs]))*Gr+Lu;Xs==Zn.length-1?w.push([Zn[Xs],Rh,0]):w.push([Zn[Xs]+" ",Rh,0]),xo-=Rh}}else w.push([Dt[Wi],Kn,hs]);w.push(["",xo,0])}else{if(ue!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],Ln=Dt.length,Ee=Ee!==0?Ee:og,Wi=0;Wi<Ln;Wi++)hs=Wi===0?_o(nt):-Ph,Kn=Wi===0?zr(B):0,Wi<Ln-1?ra.push(A(S((Ee-Ys[Wi])/(Dt[Wi].split(" ").length-1)))):ra.push(0),w.push([Dt[Wi],Kn,hs])}}var lg=typeof ct.R2L=="boolean"?ct.R2L:Et;lg===!0&&(w=bu(w,function(mi,_i,qi){return[mi.split("").reverse().join(""),_i,qi]})),Mt={text:w,x:B,y:nt,options:ct,mutex:{pdfEscape:as,activeFontKey:be,fonts:We,activeFontSize:pt}},Ve.publish("postProcessText",Mt),w=Mt.text,dr=Mt.mutex.isHex||!1;var Mu=We[be].encoding;Mu!=="WinAnsiEncoding"&&Mu!=="StandardEncoding"||(w=bu(w,function(mi,_i,qi){return[sg(mi),_i,qi]})),Dt=xu(w),w=[];for(var cl,ul,aa,dl=0,Nh=1,fl=Array.isArray(Dt[0])?Nh:dl,la="",Tu=function(mi,_i,qi){var un="";return qi instanceof se?(qi=typeof ct.angle=="number"?Gi(qi,new se(1,0,0,1,mi,_i)):Gi(new se(1,0,0,1,mi,_i),qi),b===x.ADVANCED&&(qi=Gi(new se(1,0,0,-1,0,0),qi)),un=qi.join(" ")+` Tm
`):un=A(mi)+" "+A(_i)+` Td
`,un},$s=0;$s<Dt.length;$s++){switch(la="",fl){case Nh:aa=(dr?"<":"(")+Dt[$s][0]+(dr?">":")"),cl=parseFloat(Dt[$s][1]),ul=parseFloat(Dt[$s][2]);break;case dl:aa=(dr?"<":"(")+Dt[$s]+(dr?">":")"),cl=zr(B),ul=_o(nt)}ra!==void 0&&ra[$s]!==void 0&&(la=ra[$s]+` Tw
`),$s===0?w.push(la+Tu(cl,ul,Ni)+aa):fl===dl?w.push(la+aa):fl===Nh&&w.push(la+Tu(cl,ul,Ni)+aa)}w=fl===dl?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Ks=`BT
/`;return Ks+=be+" "+pt+` Tf
`,Ks+=A(pt*Is)+` TL
`,Ks+=al+`
`,Ks+=mn,Ks+=w,z(Ks+="ET"),f[be]=!0,sn};var Om=d.__private__.clip=d.clip=function(w){return z(w==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Om("evenodd")},d.__private__.discardPath=d.discardPath=function(){return z("n"),this};var jr=d.__private__.isValidStyle=function(w){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(B=!0),B};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(w){return jr(w)&&(h=w),this};var Kf=d.__private__.getStyle=d.getStyle=function(w){var B=h;switch(w){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=w}return B},Zf=d.close=function(){return z("h"),this};d.stroke=function(){return z("S"),this},d.fill=function(w){return xh("f",w),this},d.fillEvenOdd=function(w){return xh("f*",w),this},d.fillStroke=function(w){return xh("B",w),this},d.fillStrokeEvenOdd=function(w){return xh("B*",w),this};var xh=function(w,B){hi(B)==="object"?Bm(B,w):z(w)},cu=function(w){w===null||b===x.ADVANCED&&w===void 0||(w=Kf(w),z(w))};function Dm(w,B,nt,ct,xt){var Mt=new _c(B||this.boundingBox,nt||this.xStep,ct||this.yStep,this.gState,xt||this.matrix);Mt.stream=this.stream;var Dt=w+"$$"+this.cloneIndex+++"$$";return Ne(Dt,Mt),Mt}var Bm=function(w,B){var nt=Vs[w.key],ct=Fe[nt];if(ct instanceof Ll)z("q"),z(jm(B)),ct.gState&&d.setGState(ct.gState),z(w.matrix.toString()+" cm"),z("/"+nt+" sh"),z("Q");else if(ct instanceof _c){var xt=new se(1,0,0,-1,0,sa());w.matrix&&(xt=xt.multiply(w.matrix||nn),nt=Dm.call(ct,w.key,w.boundingBox,w.xStep,w.yStep,xt).id),z("q"),z("/Pattern cs"),z("/"+nt+" scn"),ct.gState&&d.setGState(ct.gState),z(B),z("Q")}},jm=function(w){switch(w){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},uu=d.moveTo=function(w,B){return z(A(S(w))+" "+A(E(B))+" m"),this},rl=d.lineTo=function(w,B){return z(A(S(w))+" "+A(E(B))+" l"),this},ia=d.curveTo=function(w,B,nt,ct,xt,Mt){return z([A(S(w)),A(E(B)),A(S(nt)),A(E(ct)),A(S(xt)),A(E(Mt)),"c"].join(" ")),this};d.__private__.line=d.line=function(w,B,nt,ct,xt){if(isNaN(w)||isNaN(B)||isNaN(nt)||isNaN(ct)||!jr(xt))throw new Error("Invalid arguments passed to jsPDF.line");return b===x.COMPAT?this.lines([[nt-w,ct-B]],w,B,[1,1],xt||"S"):this.lines([[nt-w,ct-B]],w,B,[1,1]).stroke()},d.__private__.lines=d.lines=function(w,B,nt,ct,xt,Mt){var Dt,Zt,ue,Le,Ee,Ue,Ai,Ni,sn,kn,mn,dr;if(typeof w=="number"&&(dr=nt,nt=B,B=w,w=dr),ct=ct||[1,1],Mt=Mt||!1,isNaN(B)||isNaN(nt)||!Array.isArray(w)||!Array.isArray(ct)||!jr(xt)||typeof Mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(uu(B,nt),Dt=ct[0],Zt=ct[1],Le=w.length,kn=B,mn=nt,ue=0;ue<Le;ue++)(Ee=w[ue]).length===2?(kn=Ee[0]*Dt+kn,mn=Ee[1]*Zt+mn,rl(kn,mn)):(Ue=Ee[0]*Dt+kn,Ai=Ee[1]*Zt+mn,Ni=Ee[2]*Dt+kn,sn=Ee[3]*Zt+mn,kn=Ee[4]*Dt+kn,mn=Ee[5]*Zt+mn,ia(Ue,Ai,Ni,sn,kn,mn));return Mt&&Zf(),cu(xt),this},d.path=function(w){for(var B=0;B<w.length;B++){var nt=w[B],ct=nt.c;switch(nt.op){case"m":uu(ct[0],ct[1]);break;case"l":rl(ct[0],ct[1]);break;case"c":ia.apply(this,ct);break;case"h":Zf()}}return this},d.__private__.rect=d.rect=function(w,B,nt,ct,xt){if(isNaN(w)||isNaN(B)||isNaN(nt)||isNaN(ct)||!jr(xt))throw new Error("Invalid arguments passed to jsPDF.rect");return b===x.COMPAT&&(ct=-ct),z([A(S(w)),A(E(B)),A(S(nt)),A(S(ct)),"re"].join(" ")),cu(xt),this},d.__private__.triangle=d.triangle=function(w,B,nt,ct,xt,Mt,Dt){if(isNaN(w)||isNaN(B)||isNaN(nt)||isNaN(ct)||isNaN(xt)||isNaN(Mt)||!jr(Dt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[nt-w,ct-B],[xt-nt,Mt-ct],[w-xt,B-Mt]],w,B,[1,1],Dt,!0),this},d.__private__.roundedRect=d.roundedRect=function(w,B,nt,ct,xt,Mt,Dt){if(isNaN(w)||isNaN(B)||isNaN(nt)||isNaN(ct)||isNaN(xt)||isNaN(Mt)||!jr(Dt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Zt=4/3*(Math.SQRT2-1);return xt=Math.min(xt,.5*nt),Mt=Math.min(Mt,.5*ct),this.lines([[nt-2*xt,0],[xt*Zt,0,xt,Mt-Mt*Zt,xt,Mt],[0,ct-2*Mt],[0,Mt*Zt,-xt*Zt,Mt,-xt,Mt],[2*xt-nt,0],[-xt*Zt,0,-xt,-Mt*Zt,-xt,-Mt],[0,2*Mt-ct],[0,-Mt*Zt,xt*Zt,-Mt,xt,-Mt]],w+xt,B,[1,1],Dt,!0),this},d.__private__.ellipse=d.ellipse=function(w,B,nt,ct,xt){if(isNaN(w)||isNaN(B)||isNaN(nt)||isNaN(ct)||!jr(xt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Mt=4/3*(Math.SQRT2-1)*nt,Dt=4/3*(Math.SQRT2-1)*ct;return uu(w+nt,B),ia(w+nt,B-Dt,w+Mt,B-ct,w,B-ct),ia(w-Mt,B-ct,w-nt,B-Dt,w-nt,B),ia(w-nt,B+Dt,w-Mt,B+ct,w,B+ct),ia(w+Mt,B+ct,w+nt,B+Dt,w+nt,B),cu(xt),this},d.__private__.circle=d.circle=function(w,B,nt,ct){if(isNaN(w)||isNaN(B)||isNaN(nt)||!jr(ct))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,B,nt,nt,ct)},d.setFont=function(w,B,nt){return nt&&(B=k(B,nt)),be=Yf(w,B,{disableWarning:!1}),this};var zm=d.__private__.getFont=d.getFont=function(){return We[Yf.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var w,B,nt={};for(w in Re)if(Re.hasOwnProperty(w))for(B in nt[w]=[],Re[w])Re[w].hasOwnProperty(B)&&nt[w].push(B);return nt},d.addFont=function(w,B,nt,ct,xt){var Mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Mt.indexOf(arguments[3])!==-1?xt=arguments[3]:arguments[3]&&Mt.indexOf(arguments[3])==-1&&(nt=k(nt,ct)),xt=xt||"Identity-H",au.call(this,w,B,nt,xt)};var ol,du=i.lineWidth||.200025,bh=d.__private__.getLineWidth=d.getLineWidth=function(){return du},Jf=d.__private__.setLineWidth=d.setLineWidth=function(w){return du=w,z(A(S(w))+" w"),this};d.__private__.setLineDash=pe.API.setLineDash=pe.API.setLineDashPattern=function(w,B){if(w=w||[],B=B||0,isNaN(B)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(nt){return A(S(nt))}).join(" "),B=A(S(B)),z("["+w+"] "+B+" d"),this};var Qf=d.__private__.getLineHeight=d.getLineHeight=function(){return pt*ol};d.__private__.getLineHeight=d.getLineHeight=function(){return pt*ol};var tg=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(ol=w),this},eg=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return ol};tg(i.lineHeight);var zr=d.__private__.getHorizontalCoordinate=function(w){return S(w)},_o=d.__private__.getVerticalCoordinate=function(w){return b===x.ADVANCED?w:_e[H].mediaBox.topRightY-_e[H].mediaBox.bottomLeftY-S(w)},Gm=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(w){return A(zr(w))},na=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(w){return A(_o(w))},ur=i.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return lr(ur)},d.__private__.setStrokeColor=d.setDrawColor=function(w,B,nt,ct){return ur=hr({ch1:w,ch2:B,ch3:nt,ch4:ct,pdfColorType:"draw",precision:2}),z(ur),this};var fu=i.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return lr(fu)},d.__private__.setFillColor=d.setFillColor=function(w,B,nt,ct){return fu=hr({ch1:w,ch2:B,ch3:nt,ch4:ct,pdfColorType:"fill",precision:2}),z(fu),this};var al=i.textColor||"0 g",Um=d.__private__.getTextColor=d.getTextColor=function(){return lr(al)};d.__private__.setTextColor=d.setTextColor=function(w,B,nt,ct){return al=hr({ch1:w,ch2:B,ch3:nt,ch4:ct,pdfColorType:"text",precision:3}),this};var wh=i.charSpace,Wm=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(wh||0)};d.__private__.setCharSpace=d.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return wh=w,this};var gu=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(w){var B=d.CapJoinStyles[w];if(B===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gu=B,z(B+" J"),this};var pu=0;d.__private__.setLineJoin=d.setLineJoin=function(w){var B=d.CapJoinStyles[w];if(B===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pu=B,z(B+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return z(A(S(w))+" M"),this},d.GState=p0,d.setGState=function(w){(w=typeof w=="string"?ci[tn[w]]:ig(null,w)).equals(ji)||(z("/"+w.id+" gs"),ji=w)};var ig=function(w,B){if(!w||!tn[w]){var nt=!1;for(var ct in ci)if(ci.hasOwnProperty(ct)&&ci[ct].equals(B)){nt=!0;break}if(nt)B=ci[ct];else{var xt="GS"+(Object.keys(ci).length+1).toString(10);ci[xt]=B,B.id=xt}return w&&(tn[w]=B.id),Ve.publish("addGState",B),B}};d.addGState=function(w,B){return ig(w,B),this},d.saveGraphicsState=function(){return z("q"),Rn.push({key:be,size:pt,color:al}),this},d.restoreGraphicsState=function(){z("Q");var w=Rn.pop();return be=w.key,pt=w.size,al=w.color,ji=null,this},d.setCurrentTransformationMatrix=function(w){return z(w.toString()+" cm"),this},d.comment=function(w){return z("#"+w),this};var Sh=function(w,B){var nt=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return nt},set:function(Mt){isNaN(Mt)||(nt=parseFloat(Mt))}});var ct=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ct},set:function(Mt){isNaN(Mt)||(ct=parseFloat(Mt))}});var xt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return xt},set:function(Mt){xt=Mt.toString()}}),this},mu=function(w,B,nt,ct){Sh.call(this,w,B),this.type="rect";var xt=nt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return xt},set:function(Dt){isNaN(Dt)||(xt=parseFloat(Dt))}});var Mt=ct||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Mt},set:function(Dt){isNaN(Dt)||(Mt=parseFloat(Dt))}}),this},_u=function(){this.page=qe,this.currentPage=H,this.pages=Tt.slice(0),this.pagesContext=_e.slice(0),this.x=bi,this.y=he,this.matrix=pn,this.width=ll(H),this.height=sa(H),this.outputDestination=Gt,this.id="",this.objectNumber=-1};_u.prototype.restore=function(){qe=this.page,H=this.currentPage,_e=this.pagesContext,Tt=this.pages,bi=this.x,he=this.y,pn=this.matrix,yu(H,this.width),vu(H,this.height),Gt=this.outputDestination};var ng=function(w,B,nt,ct,xt){zi.push(new _u),qe=H=0,Tt=[],bi=w,he=B,pn=xt,lu([nt,ct])},qm=function(w){if(Ti[w])zi.pop().restore();else{var B=new _u,nt="Xo"+(Object.keys(wi).length+1).toString(10);B.id=nt,Ti[w]=nt,wi[nt]=B,Ve.publish("addFormObject",B),zi.pop().restore()}};for(var Eh in d.beginFormObject=function(w,B,nt,ct,xt){return ng(w,B,nt,ct,xt),this},d.endFormObject=function(w){return qm(w),this},d.doFormObject=function(w,B){var nt=wi[Ti[w]];return z("q"),z(B.toString()+" cm"),z("/"+nt.id+" Do"),z("Q"),this},d.getFormObject=function(w){var B=wi[Ti[w]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},d.save=function(w,B){return w=w||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(Sl(yh(mo()),w),typeof Sl.unload=="function"&&me.setTimeout&&setTimeout(Sl.unload,911),this):new Promise(function(nt,ct){try{var xt=Sl(yh(mo()),w);typeof Sl.unload=="function"&&me.setTimeout&&setTimeout(Sl.unload,911),nt(xt)}catch(Mt){ct(Mt.message)}})},pe.API)pe.API.hasOwnProperty(Eh)&&(Eh==="events"&&pe.API.events.length?function(w,B){var nt,ct,xt;for(xt=B.length-1;xt!==-1;xt--)nt=B[xt][0],ct=B[xt][1],w.subscribe.apply(w,[nt].concat(typeof ct=="function"?[ct]:ct))}(Ve,pe.API.events):d[Eh]=pe.API[Eh]);var ll=d.getPageWidth=function(w){return(_e[w=w||H].mediaBox.topRightX-_e[w].mediaBox.bottomLeftX)/qt},yu=d.setPageWidth=function(w,B){_e[w].mediaBox.topRightX=B*qt+_e[w].mediaBox.bottomLeftX},sa=d.getPageHeight=function(w){return(_e[w=w||H].mediaBox.topRightY-_e[w].mediaBox.bottomLeftY)/qt},vu=d.setPageHeight=function(w,B){_e[w].mediaBox.topRightY=B*qt+_e[w].mediaBox.bottomLeftY};return d.internal={pdfEscape:as,getStyle:Kf,getFont:zm,getFontSize:at,getCharSpace:Wm,getTextColor:Um,getLineHeight:Qf,getLineHeightFactor:eg,getLineWidth:bh,write:J,getHorizontalCoordinate:zr,getVerticalCoordinate:_o,getCoordinateString:Gm,getVerticalCoordinateString:na,collections:{},newObject:je,newAdditionalObject:ch,newObjectDeferred:ti,newObjectDeferredBegin:$n,getFilters:Dr,putStream:Hs,events:Ve,scaleFactor:qt,pageSize:{getWidth:function(){return ll(H)},setWidth:function(w){yu(H,w)},getHeight:function(){return sa(H)},setHeight:function(w){vu(H,w)}},encryptionOptions:c,encryption:Nn,getEncryptor:km,output:vh,getNumberOfPages:Am,pages:Tt,out:z,f2:q,f3:R,getPageInfo:$f,getPageInfoByObjId:we,getCurrentPageInfo:Fm,getPDFVersion:p,Point:Sh,Rectangle:mu,Matrix:se,hasHotfix:Xf},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return ll(H)},set:function(w){yu(H,w)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return sa(H)},set:function(w){vu(H,w)},enumerable:!0,configurable:!0}),Mm.call(d,it),be="F1",Vf(s,e),Ve.publish("initialized"),d}rc.prototype.lsbFirstWord=function(i){return String.fromCharCode(i>>0&255,i>>8&255,i>>16&255,i>>24&255)},rc.prototype.toHexString=function(i){return i.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},rc.prototype.hexToBytes=function(i){for(var t=[],e=0;e<i.length;e+=2)t.push(String.fromCharCode(parseInt(i.substr(e,2),16)));return t.join("")},rc.prototype.processOwnerPassword=function(i,t){return K_($_(t).substr(0,5),i)},rc.prototype.encryptor=function(i,t){var e=$_(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return K_(e,n)}},p0.prototype.equals=function(i){var t,e="id,objectNumber,equals";if(!i||hi(i)!==hi(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!i.hasOwnProperty(t)||this[t]!==i[t])return!1;n++}for(t in i)i.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},pe.API={events:[]},pe.version="2.5.2";var Fi=pe.API,V2=1,ah=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kh=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ce=function(i){return i.toFixed(2)},wa=function(i){return i.toFixed(5)};Fi.__acroform__={};var As=function(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i},V5=function(i){return i*V2},Vr=function(i){var t=new EC,e=ne.internal.getHeight(i)||0,n=ne.internal.getWidth(i)||0;return t.BBox=[0,0,Number(Ce(n)),Number(Ce(e))],t},uO=Fi.__acroform__.setBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|=1<<t},dO=Fi.__acroform__.clearBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&=~(1<<t)},fO=Fi.__acroform__.getBit=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<t?1:0},Xi=Fi.__acroform__.getBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return fO(i,t-1)},$i=Fi.__acroform__.setBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return uO(i,t-1)},Ki=Fi.__acroform__.clearBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return dO(i,t-1)},gO=Fi.__acroform__.calculateCoordinates=function(i,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=i[0],r=i[1],o=i[2],a=i[3],l={};return l.lowerLeft_X=e(s)||0,l.lowerLeft_Y=n(r+a)||0,l.upperRight_X=e(s+o)||0,l.upperRight_Y=n(r)||0,[Number(Ce(l.lowerLeft_X)),Number(Ce(l.lowerLeft_Y)),Number(Ce(l.upperRight_X)),Number(Ce(l.upperRight_Y))]},pO=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var t=[],e=i._V||i.DV,n=Z_(i,e),s=i.scope.internal.getFont(i.fontName,i.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(i.scope.__private__.encodeColorString(i.color)),t.push("/"+s+" "+Ce(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var r=Vr(i);return r.scope=i.scope,r.stream=t.join(`
`),r}},Z_=function(i,t){var e=i.fontSize===0?i.maxFontSize:i.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=i.multiline?s.map(function(R){return R.split(`
`)}):s.map(function(R){return[R]});var r=e,o=ne.internal.getHeight(i)||0;o=o<0?-o:o;var a=ne.internal.getWidth(i)||0;a=a<0?-a:a;var l=function(R,S,O){if(R+1<s.length){var E=S+" "+s[R+1][0];return Kg(E,i,O).width<=a-4}return!1};r++;t:for(;r>0;){t="",r--;var h,c,u=Kg("3",i,r).height,f=i.multiline?o-r:(o-u)/2,d=f+=2,g=0,p=0,y=0;if(r<=0){t=`(...) Tj
`,t+="% Width of Text: "+Kg(t,i,r=12).width+", FieldWidth:"+a+`
`;break}for(var _="",x=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var L=!1;if(s[b].length!==1&&y!==s[b].length-1){if((u+2)*(x+2)+2>o)continue t;_+=s[b][y],L=!0,p=b,b--}else{_=(_+=s[b][y]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var M=parseInt(b),k=l(M,_,r),A=b>=s.length-1;if(k&&!A){_+=" ",y=0;continue}if(k||A){if(A)p=M;else if(i.multiline&&(u+2)*(x+2)+2>o)continue t}else{if(!i.multiline||(u+2)*(x+2)+2>o)continue t;p=M}}for(var T="",F=g;F<=p;F++){var q=s[F];if(i.multiline){if(F===p){T+=q[y]+" ",y=(y+1)%q.length;continue}if(F===g){T+=q[q.length-1]+" ";continue}}T+=q[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,c=Kg(T,i,r).width,i.textAlign){case"right":h=a-c-2;break;case"center":h=(a-c)/2;break;case"left":default:h=2}t+=Ce(h)+" "+Ce(d)+` Td
`,t+="("+ah(T)+`) Tj
`,t+=-Ce(h)+` 0 Td
`,d=-(r+2),c=0,g=L?p:p+1,x++,_=""}break}return n.text=t,n.fontSize=r,n},Kg=function(i,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(i,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:s}},mO={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},_O=function(i,t){var e={type:"reference",object:i};t.internal.getPageInfo(i.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(i.page).pageContext.annotations.push(e)},yO=function(i,t){for(var e in i)if(i.hasOwnProperty(e)){var n=e,s=i[e];t.internal.newObjectDeferredBegin(s.objId,!0),hi(s)==="object"&&typeof s.putStream=="function"&&s.putStream(),delete i[n]}},vO=function(i,t){if(t.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(Nr.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(mO)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");V2=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new CC,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var r=n[s];r.objId=void 0,r.hasAnnotation&&_O(r,e)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(e){(function(n,s){var r=!n;for(var o in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var a=n[o],l=[],h=a.Rect;if(a.Rect&&(a.Rect=gO(a.Rect,s)),s.internal.newObjectDeferredBegin(a.objId,!0),a.DA=ne.createDefaultAppearanceStream(a),hi(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(l=a.getKeyValueListForStream()),a.Rect=h,a.hasAppearanceStream&&!a.appearanceStreamContent){var c=pO(a);l.push({key:"AP",value:"<</N "+c+">>"}),s.internal.acroformPlugin.xForms.push(c)}if(a.appearanceStreamContent){var u="";for(var f in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(f)){var d=a.appearanceStreamContent[f];if(u+="/"+f+" ",u+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var o in d)if(d.hasOwnProperty(o)){var g=d[o];typeof g=="function"&&(g=g.call(s,a)),u+="/"+o+" "+g+" ",s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g)}}else typeof(g=d)=="function"&&(g=g.call(s,a)),u+="/"+o+" "+g,s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g);u+=">>"}l.push({key:"AP",value:`<<
`+u+">>"})}s.internal.putStream({additionalKeyValues:l,objectId:a.objId}),s.internal.out("endobj")}r&&yO(s.internal.acroformPlugin.xForms,s)})(e,i)}),i.internal.acroformPlugin.isInitialized=!0}},SC=Fi.__acroform__.arrayToPdfArray=function(i,t,e){var n=function(o){return o};if(Array.isArray(i)){for(var s="[",r=0;r<i.length;r++)switch(r!==0&&(s+=" "),hi(i[r])){case"boolean":case"number":case"object":s+=i[r].toString();break;case"string":i[r].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),s+="("+ah(n(i[r].toString()))+")"):s+=i[r].toString()}return s+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},X1=function(i,t,e){var n=function(s){return s};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(i=i||"").toString(),i="("+ah(n(i))+")"},to=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};to.prototype.toString=function(){return this.objId+" 0 R"},to.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},to.prototype.getKeyValueListForStream=function(){var i=[],t=Object.getOwnPropertyNames(this).filter(function(r){return r!="content"&&r!="appearanceStreamContent"&&r!="scope"&&r!="objId"&&r.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],s=this[n];s&&(Array.isArray(s)?i.push({key:n,value:SC(s,this.objId,this.scope)}):s instanceof to?(s.scope=this.scope,i.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&i.push({key:n,value:s}))}return i};var EC=function(){to.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){i=e.trim()},get:function(){return i||null}})};As(EC,to);var CC=function(){to.call(this);var i,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+ah(e(i))+")"}},set:function(e){i=e}})};As(CC,to);var Nr=function i(){to.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Xi(t,3)},set:function(_){_?this.F=$i(t,3):this.F=Ki(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');e=_}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(_){n=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(_){n[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(_){n[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(_){n[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(_){n[3]=_}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var r=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!r||r.length<1){if(this instanceof m0)return;r="FieldObject"+i.FieldNum++}var _=function(x){return x};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+ah(_(r))+")"},set:function(_){r=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return r},set:function(_){r=_}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(_){a=_}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(_){l=_}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/V2:h},set:function(_){h=_}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(_){c=_}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof m0||this instanceof Dl))return X1(u,this.objId,this.scope)},set:function(_){_=_.toString(),u=_}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof wn?f:X1(f,this.objId,this.scope)},set:function(_){_=_.toString(),f=this instanceof wn?_:_.substr(0,1)==="("?Kh(_.substr(1,_.length-2)):Kh(_)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn?Kh(f.substr(1,f.length-1)):f},set:function(_){_=_.toString(),f=this instanceof wn?"/"+_:_}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof wn?d:X1(d,this.objId,this.scope)},set:function(_){_=_.toString(),d=this instanceof wn?_:_.substr(0,1)==="("?Kh(_.substr(1,_.length-2)):Kh(_)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn?Kh(d.substr(1,d.length-1)):d},set:function(_){_=_.toString(),d=this instanceof wn?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(_){_=!!_,p=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(_){g=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,1)},set:function(_){_?this.Ff=$i(this.Ff,1):this.Ff=Ki(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,2)},set:function(_){_?this.Ff=$i(this.Ff,2):this.Ff=Ki(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,3)},set:function(_){_?this.Ff=$i(this.Ff,3):this.Ff=Ki(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');y=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(y){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};As(Nr,to);var wc=function(){Nr.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return SC(t,this.objId,this.scope)},set:function(e){var n,s;s=[],typeof(n=e)=="string"&&(s=function(r,o,a){a||(a=1);for(var l,h=[];l=o.exec(r);)h.push(l[a]);return h}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,18)},set:function(e){e?this.Ff=$i(this.Ff,18):this.Ff=Ki(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=$i(this.Ff,19):this.Ff=Ki(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,20)},set:function(e){e?(this.Ff=$i(this.Ff,20),t.sort()):this.Ff=Ki(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,22)},set:function(e){e?this.Ff=$i(this.Ff,22):this.Ff=Ki(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,23)},set:function(e){e?this.Ff=$i(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,27)},set:function(e){e?this.Ff=$i(this.Ff,27):this.Ff=Ki(this.Ff,27)}}),this.hasAppearanceStream=!1};As(wc,Nr);var Sc=function(){wc.call(this),this.fontName="helvetica",this.combo=!1};As(Sc,wc);var Ec=function(){Sc.call(this),this.combo=!0};As(Ec,Sc);var Ep=function(){Ec.call(this),this.edit=!0};As(Ep,Ec);var wn=function(){Nr.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,15)},set:function(e){e?this.Ff=$i(this.Ff,15):this.Ff=Ki(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,16)},set:function(e){e?this.Ff=$i(this.Ff,16):this.Ff=Ki(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,17)},set:function(e){e?this.Ff=$i(this.Ff,17):this.Ff=Ki(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,26)},set:function(e){e?this.Ff=$i(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var i,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(r){return r};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+ah(e(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(e){hi(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(e){i="/"+e}})};As(wn,Nr);var Cp=function(){wn.call(this),this.pushButton=!0};As(Cp,wn);var Cc=function(){wn.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t!==void 0?t:[]}})};As(Cc,wn);var m0=function(){var i,t;Nr.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(s){i=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(a){return a};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var r,o=[];for(r in o.push("<<"),n)o.push("/"+r+" ("+ah(s(n[r]))+")");return o.push(">>"),o.join(`
`)},set:function(s){hi(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(s){e="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ne.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};As(m0,Nr),Cc.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=i.createAppearanceStream(e.optionName),e.caption=i.getCA()}},Cc.prototype.createOption=function(i){var t=new m0;return t.Parent=this,t.optionName=i,this.Kids.push(t),xO.call(this.scope,t),t};var Lp=function(){wn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ne.CheckBox.createAppearanceStream()};As(Lp,wn);var Dl=function(){Nr.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,13)},set:function(t){t?this.Ff=$i(this.Ff,13):this.Ff=Ki(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,21)},set:function(t){t?this.Ff=$i(this.Ff,21):this.Ff=Ki(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,23)},set:function(t){t?this.Ff=$i(this.Ff,23):this.Ff=Ki(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,24)},set:function(t){t?this.Ff=$i(this.Ff,24):this.Ff=Ki(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,25)},set:function(t){t?this.Ff=$i(this.Ff,25):this.Ff=Ki(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,26)},set:function(t){t?this.Ff=$i(this.Ff,26):this.Ff=Ki(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){Number.isInteger(t)&&(i=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};As(Dl,Nr);var Mp=function(){Dl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Xi(this.Ff,14)},set:function(i){i?this.Ff=$i(this.Ff,14):this.Ff=Ki(this.Ff,14)}}),this.password=!0};As(Mp,Dl);var ne={CheckBox:{createAppearanceStream:function(){return{N:{On:ne.CheckBox.YesNormal},D:{On:ne.CheckBox.YesPushDown,Off:ne.CheckBox.OffPushDown}}},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=i.scope.internal.getFont(i.fontName,i.fontStyle).id,s=i.scope.__private__.encodeColorString(i.color),r=Z_(i,i.caption);return e.push("0.749023 g"),e.push("0 0 "+Ce(ne.internal.getWidth(i))+" "+Ce(ne.internal.getHeight(i))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+Ce(r.fontSize)+" Tf "+s),e.push("BT"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),s=[],r=ne.internal.getHeight(i),o=ne.internal.getWidth(i),a=Z_(i,i.caption);return s.push("1 g"),s.push("0 0 "+Ce(o)+" "+Ce(r)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Ce(o-1)+" "+Ce(r-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+e+" "+Ce(a.fontSize)+" Tf "+n),s.push(a.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Ce(ne.internal.getWidth(i))+" "+Ce(ne.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(i){var t={D:{Off:ne.RadioButton.Circle.OffPushDown},N:{}};return t.N[i]=ne.RadioButton.Circle.YesNormal,t.D[i]=ne.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=ne.internal.getWidth(i)<=ne.internal.getHeight(i)?ne.internal.getWidth(i)/4:ne.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var s=ne.internal.Bezier_C,r=Number((n*s).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+wa(ne.internal.getWidth(i)/2)+" "+wa(ne.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+r+" "+r+" "+n+" 0 "+n+" c"),e.push("-"+r+" "+n+" -"+n+" "+r+" -"+n+" 0 c"),e.push("-"+n+" -"+r+" -"+r+" -"+n+" 0 -"+n+" c"),e.push(r+" -"+n+" "+n+" -"+r+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=ne.internal.getWidth(i)<=ne.internal.getHeight(i)?ne.internal.getWidth(i)/4:ne.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),r=Number((s*ne.internal.Bezier_C).toFixed(5)),o=Number((n*ne.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+wa(ne.internal.getWidth(i)/2)+" "+wa(ne.internal.getHeight(i)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+r+" "+r+" "+s+" 0 "+s+" c"),e.push("-"+r+" "+s+" -"+s+" "+r+" -"+s+" 0 c"),e.push("-"+s+" -"+r+" -"+r+" -"+s+" 0 -"+s+" c"),e.push(r+" -"+s+" "+s+" -"+r+" "+s+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+wa(ne.internal.getWidth(i)/2)+" "+wa(ne.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),e.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),e.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),e.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=ne.internal.getWidth(i)<=ne.internal.getHeight(i)?ne.internal.getWidth(i)/4:ne.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),r=Number((s*ne.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+wa(ne.internal.getWidth(i)/2)+" "+wa(ne.internal.getHeight(i)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+r+" "+r+" "+s+" 0 "+s+" c"),e.push("-"+r+" "+s+" -"+s+" "+r+" -"+s+" 0 c"),e.push("-"+s+" -"+r+" -"+r+" -"+s+" 0 -"+s+" c"),e.push(r+" -"+s+" "+s+" -"+r+" "+s+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(i){var t={D:{Off:ne.RadioButton.Cross.OffPushDown},N:{}};return t.N[i]=ne.RadioButton.Cross.YesNormal,t.D[i]=ne.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(i){var t=Vr(i);t.scope=i.scope;var e=[],n=ne.internal.calculateCross(i);return e.push("q"),e.push("1 1 "+Ce(ne.internal.getWidth(i)-2)+" "+Ce(ne.internal.getHeight(i)-2)+" re"),e.push("W"),e.push("n"),e.push(Ce(n.x1.x)+" "+Ce(n.x1.y)+" m"),e.push(Ce(n.x2.x)+" "+Ce(n.x2.y)+" l"),e.push(Ce(n.x4.x)+" "+Ce(n.x4.y)+" m"),e.push(Ce(n.x3.x)+" "+Ce(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=ne.internal.calculateCross(i),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ce(ne.internal.getWidth(i))+" "+Ce(ne.internal.getHeight(i))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ce(ne.internal.getWidth(i)-2)+" "+Ce(ne.internal.getHeight(i)-2)+" re"),n.push("W"),n.push("n"),n.push(Ce(e.x1.x)+" "+Ce(e.x1.y)+" m"),n.push(Ce(e.x2.x)+" "+Ce(e.x2.y)+" l"),n.push(Ce(e.x4.x)+" "+Ce(e.x4.y)+" m"),n.push(Ce(e.x3.x)+" "+Ce(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(i){var t=Vr(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Ce(ne.internal.getWidth(i))+" "+Ce(ne.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(i){var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,e=i.scope.__private__.encodeColorString(i.color);return"/"+t+" "+i.fontSize+" Tf "+e}};ne.internal={Bezier_C:.551915024494,calculateCross:function(i){var t=ne.internal.getWidth(i),e=ne.internal.getHeight(i),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},ne.internal.getWidth=function(i){var t=0;return hi(i)==="object"&&(t=V5(i.Rect[2])),t},ne.internal.getHeight=function(i){var t=0;return hi(i)==="object"&&(t=V5(i.Rect[3])),t};var xO=Fi.addField=function(i){if(vO(this,i),!(i instanceof Nr))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=i).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};Fi.AcroFormChoiceField=wc,Fi.AcroFormListBox=Sc,Fi.AcroFormComboBox=Ec,Fi.AcroFormEditBox=Ep,Fi.AcroFormButton=wn,Fi.AcroFormPushButton=Cp,Fi.AcroFormRadioButton=Cc,Fi.AcroFormCheckBox=Lp,Fi.AcroFormTextField=Dl,Fi.AcroFormPasswordField=Mp,Fi.AcroFormAppearance=ne,Fi.AcroForm={ChoiceField:wc,ListBox:Sc,ComboBox:Ec,EditBox:Ep,Button:wn,PushButton:Cp,RadioButton:Cc,CheckBox:Lp,TextField:Dl,PasswordField:Mp,Appearance:ne},pe.AcroForm={ChoiceField:wc,ListBox:Sc,ComboBox:Ec,EditBox:Ep,Button:wn,PushButton:Cp,RadioButton:Cc,CheckBox:Lp,TextField:Dl,PasswordField:Mp,Appearance:ne};function LC(i){return i.reduce(function(t,e,n){return t[e]=n,t},{})}(function(i){i.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=i.__addimage__.getImageFileTypeByImageData=function(R,S){var O,E,U,X,Z,st=t;if((S=S||t)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(k(R))for(Z in e)for(U=e[Z],O=0;O<U.length;O+=1){for(X=!0,E=0;E<U[O].length;E+=1)if(U[O][E]!==void 0&&U[O][E]!==R[E]){X=!1;break}if(X===!0){st=Z;break}}else for(Z in e)for(U=e[Z],O=0;O<U.length;O+=1){for(X=!0,E=0;E<U[O].length;E+=1)if(U[O][E]!==void 0&&U[O][E]!==R.charCodeAt(E)){X=!1;break}if(X===!0){st=Z;break}}return st===t&&S!==t&&(st=S),st},s=function R(S){for(var O=this.internal.write,E=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);S.objectId=this.internal.newObject();var X=[];if(X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Image"}),X.push({key:"Width",value:S.width}),X.push({key:"Height",value:S.height}),S.colorSpace===y.INDEXED?X.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(S.palette.length/3-1)+" "+("sMask"in S&&S.sMask!==void 0?S.objectId+2:S.objectId+1)+" 0 R]"}):(X.push({key:"ColorSpace",value:"/"+S.colorSpace}),S.colorSpace===y.DEVICE_CMYK&&X.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),X.push({key:"BitsPerComponent",value:S.bitsPerComponent}),"decodeParameters"in S&&S.decodeParameters!==void 0&&X.push({key:"DecodeParms",value:"<<"+S.decodeParameters+">>"}),"transparency"in S&&Array.isArray(S.transparency)){for(var Z="",st=0,tt=S.transparency.length;st<tt;st++)Z+=S.transparency[st]+" "+S.transparency[st]+" ";X.push({key:"Mask",value:"["+Z+"]"})}S.sMask!==void 0&&X.push({key:"SMask",value:S.objectId+1+" 0 R"});var ot=S.filter!==void 0?["/"+S.filter]:void 0;if(E({data:S.data,additionalKeyValues:X,alreadyAppliedFilters:ot,objectId:S.objectId}),O("endobj"),"sMask"in S&&S.sMask!==void 0){var et="/Predictor "+S.predictor+" /Colors 1 /BitsPerComponent "+S.bitsPerComponent+" /Columns "+S.width,P={width:S.width,height:S.height,colorSpace:"DeviceGray",bitsPerComponent:S.bitsPerComponent,decodeParameters:et,data:S.sMask};"filter"in S&&(P.filter=S.filter),R.call(this,P)}if(S.colorSpace===y.INDEXED){var H=this.internal.newObject();E({data:T(new Uint8Array(S.palette)),objectId:H}),O("endobj")}},r=function(){var R=this.internal.collections.addImage_images;for(var S in R)s.call(this,R[S])},o=function(){var R,S=this.internal.collections.addImage_images,O=this.internal.write;for(var E in S)O("/I"+(R=S[E]).index,R.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",r),this.internal.events.subscribe("putXobjectDict",o))},l=function(){var R=this.internal.collections.addImage_images;return a.call(this),R},h=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(R){return typeof i["process"+R.toUpperCase()]=="function"},u=function(R){return hi(R)==="object"&&R.nodeType===1},f=function(R,S){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var O=""+R.getAttribute("src");if(O.indexOf("data:image/")===0)return Md(unescape(O).split("base64,").pop());var E=i.loadFile(O,!0);if(E!==void 0)return E}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var U;switch(S){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;case"JPEG":case"JPG":default:U="image/jpeg"}return Md(R.toDataURL(U,1).split("base64,").pop())}},d=function(R){var S=this.internal.collections.addImage_images;if(S){for(var O in S)if(R===S[O].alias)return S[O]}},g=function(R,S,O){return R||S||(R=-96,S=-96),R<0&&(R=-1*O.width*72/R/this.internal.scaleFactor),S<0&&(S=-1*O.height*72/S/this.internal.scaleFactor),R===0&&(R=S*O.width/O.height),S===0&&(S=R*O.height/O.width),[R,S]},p=function(R,S,O,E,U,X){var Z=g.call(this,O,E,U),st=this.internal.getCoordinateString,tt=this.internal.getVerticalCoordinateString,ot=l.call(this);if(O=Z[0],E=Z[1],ot[U.index]=U,X){X*=Math.PI/180;var et=Math.cos(X),P=Math.sin(X),H=function(K){return K.toFixed(4)},j=[H(et),H(P),H(-1*P),H(et),0,0,"cm"]}this.internal.write("q"),X?(this.internal.write([1,"0","0",1,st(R),tt(S+E),"cm"].join(" ")),this.internal.write(j.join(" ")),this.internal.write([st(O),"0","0",st(E),"0","0","cm"].join(" "))):this.internal.write([st(O),"0","0",st(E),st(R),tt(S+E),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},y=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},x=i.__addimage__.sHashCode=function(R){var S,O,E=0;if(typeof R=="string")for(O=R.length,S=0;S<O;S++)E=(E<<5)-E+R.charCodeAt(S),E|=0;else if(k(R))for(O=R.byteLength/2,S=0;S<O;S++)E=(E<<5)-E+R[S],E|=0;return E},b=i.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var S=!0;return R.length===0&&(S=!1),R.length%4!=0&&(S=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(S=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(S=!1),S},L=i.__addimage__.extractImageFromDataUrl=function(R){var S=(R=R||"").split("base64,"),O=null;if(S.length===2){var E=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(S[0]);Array.isArray(E)&&(O={mimeType:E[1],charset:E[2],data:S[1]})}return O},M=i.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};i.__addimage__.isArrayBuffer=function(R){return M()&&R instanceof ArrayBuffer};var k=i.__addimage__.isArrayBufferView=function(R){return M()&&typeof Uint32Array<"u"&&(R instanceof Int8Array||R instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)},A=i.__addimage__.binaryStringToUint8Array=function(R){for(var S=R.length,O=new Uint8Array(S),E=0;E<S;E++)O[E]=R.charCodeAt(E);return O},T=i.__addimage__.arrayBufferToBinaryString=function(R){for(var S="",O=k(R)?R:new Uint8Array(R),E=0;E<O.length;E+=8192)S+=String.fromCharCode.apply(null,O.subarray(E,E+8192));return S};i.addImage=function(){var R,S,O,E,U,X,Z,st,tt;if(typeof arguments[1]=="number"?(S=t,O=arguments[1],E=arguments[2],U=arguments[3],X=arguments[4],Z=arguments[5],st=arguments[6],tt=arguments[7]):(S=arguments[1],O=arguments[2],E=arguments[3],U=arguments[4],X=arguments[5],Z=arguments[6],st=arguments[7],tt=arguments[8]),hi(R=arguments[0])==="object"&&!u(R)&&"imageData"in R){var ot=R;R=ot.imageData,S=ot.format||S||t,O=ot.x||O||0,E=ot.y||E||0,U=ot.w||ot.width||U,X=ot.h||ot.height||X,Z=ot.alias||Z,st=ot.compression||st,tt=ot.rotation||ot.angle||tt}var et=this.internal.getFilters();if(st===void 0&&et.indexOf("FlateEncode")!==-1&&(st="SLOW"),isNaN(O)||isNaN(E))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var P=F.call(this,R,S,Z,st);return p.call(this,O,E,U,X,P,tt),this};var F=function(R,S,O,E){var U,X,Z;if(typeof R=="string"&&n(R)===t){R=unescape(R);var st=q(R,!1);(st!==""||(st=i.loadFile(R,!0))!==void 0)&&(R=st)}if(u(R)&&(R=f(R,S)),S=n(R,S),!c(S))throw new Error("addImage does not support files of type '"+S+"', please ensure that a plugin for '"+S+"' support is added.");if(((Z=O)==null||Z.length===0)&&(O=function(tt){return typeof tt=="string"||k(tt)?x(tt):k(tt.data)?x(tt.data):null}(R)),(U=d.call(this,O))||(M()&&(R instanceof Uint8Array||S==="RGBA"||(X=R,R=A(R))),U=this["process"+S.toUpperCase()](R,h.call(this),O,function(tt){return tt&&typeof tt=="string"&&(tt=tt.toUpperCase()),tt in i.image_compression?tt:_.NONE}(E),X)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},q=i.__addimage__.convertBase64ToBinaryString=function(R,S){var O;S=typeof S!="boolean"||S;var E,U="";if(typeof R=="string"){E=(O=L(R))!==null?O.data:R;try{U=Md(E)}catch(X){if(S)throw b(E)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+X.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return U};i.getImageProperties=function(R){var S,O,E="";if(u(R)&&(R=f(R)),typeof R=="string"&&n(R)===t&&((E=q(R,!1))===""&&(E=i.loadFile(R)||""),R=E),O=n(R),!c(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(!M()||R instanceof Uint8Array||(R=A(R)),!(S=this["process"+O.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return S.fileType=O,S}})(pe.API),function(i){var t=function(e){if(e!==void 0&&e!="")return!0};pe.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(e){for(var n,s,r,o=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),h=e.pageContext.annotations,c=!1,u=0;u<h.length&&!c;u++)switch((n=h[u]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var f=0;f<h.length;f++){n=h[f];var d=this.internal.pdfEscape,g=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(p.objId),x=n.title||"Note";r="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+d(_(n.contents))+")",r+=" /Popup "+y.objId+" 0 R",r+=" /P "+l.objId+" 0 R",r+=" /T ("+d(_(x))+") >>",p.content=r;var b=p.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(r+=" /Open true"),r+=" >>",y.content=r,this.internal.write(p.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+o(n.bounds.x)+" "+a(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var L=n.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+d(g(n.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+L+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(n.options.name){var M=this.annotations._nameMap[n.options.name];n.options.pageNumber=M.page,n.options.top=M.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",r="",n.options.url)r="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+d(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,r+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var k=a(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),r+=" /XYZ "+n.options.left+" "+k+" "+n.options.zoom+"]"}r!=""&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),i.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},i.link=function(e,n,s,r,o){var a=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:l(e),y:h(n),w:l(e+s),h:h(n+r)},options:o,type:"link"})},i.textWithLink=function(e,n,s,r){var o,a,l=this.getTextWidth(e),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(r.maxWidth!==void 0){a=r.maxWidth;var c=this.splitTextToSize(e,a).length;o=Math.ceil(h*c)}else a=l,o=h;return this.text(e,n,s,r),s+=.2*h,r.align==="center"&&(n-=l/2),r.align==="right"&&(n-=l),this.link(n,s-h,a,o,r),l},i.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}}(pe.API),function(i){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];i.__arabicParser__={};var r=i.__arabicParser__.isInArabicSubstitutionA=function(p){return t[p.charCodeAt(0)]!==void 0},o=i.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},a=i.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&r(p)&&t[p.charCodeAt(0)].length<=2},l=i.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&r(p)&&t[p.charCodeAt(0)].length>=1};var h=i.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&r(p)&&t[p.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&r(p)&&t[p.charCodeAt(0)].length>=3};var c=i.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&r(p)&&t[p.charCodeAt(0)].length==4},u=i.__arabicParser__.resolveLigatures=function(p){var y=0,_=e,x="",b=0;for(y=0;y<p.length;y+=1)_[p.charCodeAt(y)]!==void 0?(b++,typeof(_=_[p.charCodeAt(y)])=="number"&&(x+=String.fromCharCode(_),_=e,b=0),y===p.length-1&&(_=e,x+=p.charAt(y-(b-1)),y-=b-1,b=0)):(_=e,x+=p.charAt(y-b),y-=b,b=0);return x};i.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&n[p.charCodeAt(0)]!==void 0};var f=i.__arabicParser__.getCorrectForm=function(p,y,_){return o(p)?r(p)===!1?-1:!h(p)||!o(y)&&!o(_)||!o(_)&&a(y)||a(p)&&!o(y)||a(p)&&l(y)||a(p)&&a(y)?0:c(p)&&o(y)&&!a(y)&&o(_)&&h(_)?3:a(p)||!o(_)?1:2:-1},d=function(p){var y=0,_=0,x=0,b="",L="",M="",k=(p=p||"").split("\\s+"),A=[];for(y=0;y<k.length;y+=1){for(A.push(""),_=0;_<k[y].length;_+=1)b=k[y][_],L=k[y][_-1],M=k[y][_+1],o(b)?(x=f(b,L,M),A[y]+=x!==-1?String.fromCharCode(t[b.charCodeAt(0)][x]):b):A[y]+=b;A[y]=u(A[y])}return A.join(" ")},g=i.__arabicParser__.processArabic=i.processArabic=function(){var p,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(y)){var x=0;for(_=[],x=0;x<y.length;x+=1)Array.isArray(y[x])?_.push([d(y[x][0]),y[x][1],y[x][2]]):_.push([d(y[x])]);p=_}else p=d(y);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};i.events.push(["preProcessText",g])}(pe.API),pe.API.autoPrint=function(i){var t;switch((i=i||{}).variant=i.variant||"non-conform",i.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(i){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(a){e=a}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(a){n=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(a){s=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(a){r=a}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(a){o=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var s;if((e=e||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(pe.API),function(i){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new r,this.internal.__cell__.pages=1},r=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(p){l=p}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var u=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(p){g=p}}),this};r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},r.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},i.getTextDimensions=function(l,h){n.call(this);var c=(h=h||{}).fontSize||this.getFontSize(),u=h.font||this.getFont(),f=h.scaleFactor||this.internal.scaleFactor,d=0,g=0,p=0,y=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var _=h.maxWidth;_>0?typeof l=="string"?l=this.splitTextToSize(l,_):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(b,L){return b.concat(y.splitTextToSize(L,_))},[])):l=Array.isArray(l)?l:[l];for(var x=0;x<l.length;x++)d<(p=this.getStringUnitWidth(l[x],{font:u})*c)&&(d=p);return d!==0&&(g=l.length),{w:d/=f,h:Math.max((g*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/f,0)}},i.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new r(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=i.cell=function(){var l;l=arguments[0]instanceof r?arguments[0]:new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,u=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===l.lineNumber?(l.x=(h.x||0)+(h.width||0),l.y=h.y||0):h.y+h.height+l.height+u.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=u.top,d&&f&&(this.printHeaderRow(l.lineNumber,!0),l.y+=f[0].height)):l.y=h.y+h.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-c,l.y+c,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+c,{align:"center",baseline:"top",maxWidth:l.width-c-c}):this.text(l.text,l.x+c,l.y+c,{align:"left",baseline:"top",maxWidth:l.width-c-c})),this.internal.__cell__.lastCell=l,this};i.table=function(l,h,c,u,f){if(n.call(this),!c)throw new Error("No data for PDF table.");var d,g,p,y,_=[],x=[],b=[],L={},M={},k=[],A=[],T=(f=f||{}).autoSize||!1,F=f.printHeaders!==!1,q=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,R=f.margins||Object.assign({width:this.getPageWidth()},t),S=typeof f.padding=="number"?f.padding:3,O=f.headerBackgroundColor||"#c8c8c8",E=f.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=F,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=q,this.internal.__cell__.padding=S,this.internal.__cell__.headerBackgroundColor=O,this.internal.__cell__.headerTextColor=E,this.setFontSize(q),u==null)x=_=Object.keys(c[0]),b=_.map(function(){return"left"});else if(Array.isArray(u)&&hi(u[0])==="object")for(_=u.map(function(ot){return ot.name}),x=u.map(function(ot){return ot.prompt||ot.name||""}),b=u.map(function(ot){return ot.align||"left"}),d=0;d<u.length;d+=1)M[u[d].name]=u[d].width*(19.049976/25.4);else Array.isArray(u)&&typeof u[0]=="string"&&(x=_=u,b=_.map(function(){return"left"}));if(T||Array.isArray(u)&&typeof u[0]=="string")for(d=0;d<_.length;d+=1){for(L[y=_[d]]=c.map(function(ot){return ot[y]}),this.setFont(void 0,"bold"),k.push(this.getTextDimensions(x[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=L[y],this.setFont(void 0,"normal"),p=0;p<g.length;p+=1)k.push(this.getTextDimensions(g[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);M[y]=Math.max.apply(null,k)+S+S,k=[]}if(F){var U={};for(d=0;d<_.length;d+=1)U[_[d]]={},U[_[d]].text=x[d],U[_[d]].align=b[d];var X=a.call(this,U,M);A=_.map(function(ot){return new r(l,h,M[ot],X,U[ot].text,void 0,U[ot].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var Z=u.reduce(function(ot,et){return ot[et.name]=et.align,ot},{});for(d=0;d<c.length;d+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:d,data:c[d]},this);var st=a.call(this,c[d],M);for(p=0;p<_.length;p+=1){var tt=c[d][_[p]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:d,col:p,data:tt},this),o.call(this,new r(l,h,M[_[p]],st,tt,d+2,Z[_[p]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=h,this};var a=function(l,h){var c=this.internal.__cell__.padding,u=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(l).map(function(d){var g=l[d];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,h[d]-c-c)},this).map(function(d){return this.getLineHeightFactor()*d.length*u/f+c+c},this).reduce(function(d,g){return Math.max(d,g)},0)};i.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},i.printHeaderRow=function(l,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var u=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new r(u[0],u[1],u[2],u[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){c=this.internal.__cell__.tableHeaderRow[d].clone(),h&&(c.y=this.internal.__cell__.margins.top||0,f.push(c)),c.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,c),this.setTextColor(g)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),e=!1}}(pe.API);var MC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},TC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],J_=LC(TC),AC=[100,200,300,400,500,600,700,800,900],bO=LC(AC);function Q_(i){var t=i.family.replace(/"|'/g,"").toLowerCase(),e=function(r){return MC[r=r||"normal"]?r:"normal"}(i.style),n=function(r){if(!r)return 400;if(typeof r=="number")return r>=100&&r<=900&&r%100==0?r:400;if(/^\d00$/.test(r))return parseInt(r);switch(r){case"bold":return 700;case"normal":default:return 400}}(i.weight),s=function(r){return typeof J_[r=r||"normal"]=="number"?r:"normal"}(i.stretch);return{family:t,style:e,weight:n,stretch:s,src:i.src||[],ref:i.ref||{name:t,style:[s,e,n].join(" ")}}}function H5(i,t,e,n){var s;for(s=e;s>=0&&s<t.length;s+=n)if(i[t[s]])return i[t[s]];for(s=e;s>=0&&s<t.length;s-=n)if(i[t[s]])return i[t[s]]}var wO={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Y5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function X5(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function SO(i,t,e){for(var n=(e=e||{}).defaultFontFamily||"times",s=Object.assign({},wO,e.genericFontFamilies||{}),r=null,o=null,a=0;a<t.length;++a)if(s[(r=Q_(t[a])).family]&&(r.family=s[r.family]),i.hasOwnProperty(r.family)){o=i[r.family];break}if(!(o=o||i[n]))throw new Error("Could not find a font-family for the rule '"+X5(r)+"' and default family '"+n+"'.");if(o=function(l,h){if(h[l])return h[l];var c=J_[l],u=c<=J_.normal?-1:1,f=H5(h,TC,c,u);if(!f)throw new Error("Could not find a matching font-stretch value for "+l);return f}(r.stretch,o),o=function(l,h){if(h[l])return h[l];for(var c=MC[l],u=0;u<c.length;++u)if(h[c[u]])return h[c[u]];throw new Error("Could not find a matching font-style for "+l)}(r.style,o),!(o=function(l,h){if(h[l])return h[l];if(l===400&&h[500])return h[500];if(l===500&&h[400])return h[400];var c=bO[l],u=H5(h,AC,c,l<400?-1:1);if(!u)throw new Error("Could not find a matching font-weight for value "+l);return u}(r.weight,o)))throw new Error("Failed to resolve a font for the rule '"+X5(r)+"'.");return o}function $5(i){return i.trimLeft()}function EO(i,t){for(var e=0;e<i.length;){if(i.charAt(e)===t)return[i.substring(0,e),i.substring(e+1)];e+=1}return null}function CO(i){var t=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],i.substring(t[0].length)]}var Zg,K5,Z5,$1=["times"];(function(i){var t,e,n,s,r,o,a,l,h,c=function(P){return P=P||{},this.isStrokeTransparent=P.isStrokeTransparent||!1,this.strokeOpacity=P.strokeOpacity||1,this.strokeStyle=P.strokeStyle||"#000000",this.fillStyle=P.fillStyle||"#000000",this.isFillTransparent=P.isFillTransparent||!1,this.fillOpacity=P.fillOpacity||1,this.font=P.font||"10px sans-serif",this.textBaseline=P.textBaseline||"alphabetic",this.textAlign=P.textAlign||"left",this.lineWidth=P.lineWidth||1,this.lineJoin=P.lineJoin||"miter",this.lineCap=P.lineCap||"butt",this.path=P.path||[],this.transform=P.transform!==void 0?P.transform.clone():new l,this.globalCompositeOperation=P.globalCompositeOperation||"normal",this.globalAlpha=P.globalAlpha||1,this.clip_path=P.clip_path||[],this.currentPoint=P.currentPoint||new o,this.miterLimit=P.miterLimit||10,this.lastPoint=P.lastPoint||new o,this.lineDashOffset=P.lineDashOffset||0,this.lineDash=P.lineDash||[],this.margin=P.margin||[0,0,0,0],this.prevPageLastElemOffset=P.prevPageLastElemOffset||0,this.ignoreClearRect=typeof P.ignoreClearRect!="boolean"||P.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,o=this.internal.Point,a=this.internal.Rectangle,l=this.internal.Matrix,h=new c}]);var u=function(P){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var H=P;Object.defineProperty(this,"pdf",{get:function(){return H}});var j=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return j},set:function(rt){j=!!rt}});var K=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return K},set:function(rt){K=!!rt}});var ht=0;Object.defineProperty(this,"posX",{get:function(){return ht},set:function(rt){isNaN(rt)||(ht=rt)}});var ft=0;Object.defineProperty(this,"posY",{get:function(){return ft},set:function(rt){isNaN(rt)||(ft=rt)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(rt){var z;typeof rt=="number"?z=[rt,rt,rt,rt]:((z=new Array(4))[0]=rt[0],z[1]=rt.length>=2?rt[1]:z[0],z[2]=rt.length>=3?rt[2]:z[0],z[3]=rt.length>=4?rt[3]:z[1]),h.margin=z}});var gt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return gt},set:function(rt){gt=rt}});var _t=0;Object.defineProperty(this,"lastBreak",{get:function(){return _t},set:function(rt){_t=rt}});var Pt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Pt},set:function(rt){Pt=rt}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(rt){rt instanceof c&&(h=rt)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(rt){h.path=rt}});var Tt=[];Object.defineProperty(this,"ctxStack",{get:function(){return Tt},set:function(rt){Tt=rt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(rt){var z;z=f(rt),this.ctx.fillStyle=z.style,this.ctx.isFillTransparent=z.a===0,this.ctx.fillOpacity=z.a,this.pdf.setFillColor(z.r,z.g,z.b,{a:z.a}),this.pdf.setTextColor(z.r,z.g,z.b,{a:z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(rt){var z=f(rt);this.ctx.strokeStyle=z.style,this.ctx.isStrokeTransparent=z.a===0,this.ctx.strokeOpacity=z.a,z.a===0?this.pdf.setDrawColor(255,255,255):(z.a,this.pdf.setDrawColor(z.r,z.g,z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(rt){["butt","round","square"].indexOf(rt)!==-1&&(this.ctx.lineCap=rt,this.pdf.setLineCap(rt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(rt){isNaN(rt)||(this.ctx.lineWidth=rt,this.pdf.setLineWidth(rt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(rt){["bevel","round","miter"].indexOf(rt)!==-1&&(this.ctx.lineJoin=rt,this.pdf.setLineJoin(rt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(rt){isNaN(rt)||(this.ctx.miterLimit=rt,this.pdf.setMiterLimit(rt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(rt){this.ctx.textBaseline=rt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(rt){["right","end","center","left","start"].indexOf(rt)!==-1&&(this.ctx.textAlign=rt)}});var Wt=null;function Gt(rt,z){if(Wt===null){var J=function(Y){var it=[];return Object.keys(Y).forEach(function(pt){Y[pt].forEach(function(vt){var at=null;switch(vt){case"bold":at={family:pt,weight:"bold"};break;case"italic":at={family:pt,style:"italic"};break;case"bolditalic":at={family:pt,weight:"bold",style:"italic"};break;case"":case"normal":at={family:pt}}at!==null&&(at.ref={name:pt,style:vt},it.push(at))})}),it}(rt.getFontList());Wt=function(Y){for(var it={},pt=0;pt<Y.length;++pt){var vt=Q_(Y[pt]),at=vt.family,Et=vt.stretch,It=vt.style,Ct=vt.weight;it[at]=it[at]||{},it[at][Et]=it[at][Et]||{},it[at][Et][It]=it[at][Et][It]||{},it[at][Et][It][Ct]=vt}return it}(J.concat(z))}return Wt}var N=null;Object.defineProperty(this,"fontFaces",{get:function(){return N},set:function(rt){Wt=null,N=rt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(rt){var z;if(this.ctx.font=rt,(z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(rt))!==null){var J=z[1],Y=(z[2],z[3]),it=z[4],pt=(z[5],z[6]),vt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(it)[2];it=Math.floor(vt==="px"?parseFloat(it)*this.pdf.internal.scaleFactor:vt==="em"?parseFloat(it)*this.pdf.getFontSize():parseFloat(it)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(it);var at=function(ee){var be,qt,bi=[],he=ee.trim();if(he==="")return $1;if(he in Y5)return[Y5[he]];for(;he!=="";){switch(qt=null,be=(he=$5(he)).charAt(0)){case'"':case"'":qt=EO(he.substring(1),be);break;default:qt=CO(he)}if(qt===null||(bi.push(qt[0]),(he=$5(qt[1]))!==""&&he.charAt(0)!==","))return $1;he=he.replace(/^,/,"")}return bi}(pt);if(this.fontFaces){var Et=SO(Gt(this.pdf,this.fontFaces),at.map(function(ee){return{family:ee,stretch:"normal",weight:Y,style:J}}));this.pdf.setFont(Et.ref.name,Et.ref.style)}else{var It="";(Y==="bold"||parseInt(Y,10)>=700||J==="bold")&&(It="bold"),J==="italic"&&(It+="italic"),It.length===0&&(It="normal");for(var Ct="",jt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ie=0;ie<at.length;ie++){if(this.pdf.internal.getFont(at[ie],It,{noFallback:!0,disableWarning:!0})!==void 0){Ct=at[ie];break}if(It==="bolditalic"&&this.pdf.internal.getFont(at[ie],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ct=at[ie],It="bold";else if(this.pdf.internal.getFont(at[ie],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ct=at[ie],It="normal";break}}if(Ct===""){for(var te=0;te<at.length;te++)if(jt[at[te]]){Ct=jt[at[te]];break}}Ct=Ct===""?"Times":Ct,this.pdf.setFont(Ct,It)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(rt){this.ctx.globalCompositeOperation=rt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(rt){this.ctx.globalAlpha=rt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(rt){this.ctx.lineDashOffset=rt,et.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(rt){this.ctx.lineDash=rt,et.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(rt){this.ctx.ignoreClearRect=!!rt}})};u.prototype.setLineDash=function(P){this.lineDash=P},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){L.call(this,"fill",!1)},u.prototype.stroke=function(){L.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(P,H){if(isNaN(P)||isNaN(H))throw fi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var j=this.ctx.transform.applyToPoint(new o(P,H));this.path.push({type:"mt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(P,H)},u.prototype.closePath=function(){var P=new o(0,0),H=0;for(H=this.path.length-1;H!==-1;H--)if(this.path[H].type==="begin"&&hi(this.path[H+1])==="object"&&typeof this.path[H+1].x=="number"){P=new o(this.path[H+1].x,this.path[H+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(P.x,P.y)},u.prototype.lineTo=function(P,H){if(isNaN(P)||isNaN(H))throw fi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var j=this.ctx.transform.applyToPoint(new o(P,H));this.path.push({type:"lt",x:j.x,y:j.y}),this.ctx.lastPoint=new o(j.x,j.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),L.call(this,null,!0)},u.prototype.quadraticCurveTo=function(P,H,j,K){if(isNaN(j)||isNaN(K)||isNaN(P)||isNaN(H))throw fi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ht=this.ctx.transform.applyToPoint(new o(j,K)),ft=this.ctx.transform.applyToPoint(new o(P,H));this.path.push({type:"qct",x1:ft.x,y1:ft.y,x:ht.x,y:ht.y}),this.ctx.lastPoint=new o(ht.x,ht.y)},u.prototype.bezierCurveTo=function(P,H,j,K,ht,ft){if(isNaN(ht)||isNaN(ft)||isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K))throw fi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var gt=this.ctx.transform.applyToPoint(new o(ht,ft)),_t=this.ctx.transform.applyToPoint(new o(P,H)),Pt=this.ctx.transform.applyToPoint(new o(j,K));this.path.push({type:"bct",x1:_t.x,y1:_t.y,x2:Pt.x,y2:Pt.y,x:gt.x,y:gt.y}),this.ctx.lastPoint=new o(gt.x,gt.y)},u.prototype.arc=function(P,H,j,K,ht,ft){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K)||isNaN(ht))throw fi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ft=!!ft,!this.ctx.transform.isIdentity){var gt=this.ctx.transform.applyToPoint(new o(P,H));P=gt.x,H=gt.y;var _t=this.ctx.transform.applyToPoint(new o(0,j)),Pt=this.ctx.transform.applyToPoint(new o(0,0));j=Math.sqrt(Math.pow(_t.x-Pt.x,2)+Math.pow(_t.y-Pt.y,2))}Math.abs(ht-K)>=2*Math.PI&&(K=0,ht=2*Math.PI),this.path.push({type:"arc",x:P,y:H,radius:j,startAngle:K,endAngle:ht,counterclockwise:ft})},u.prototype.arcTo=function(P,H,j,K,ht){throw new Error("arcTo not implemented.")},u.prototype.rect=function(P,H,j,K){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K))throw fi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(P,H),this.lineTo(P+j,H),this.lineTo(P+j,H+K),this.lineTo(P,H+K),this.lineTo(P,H),this.lineTo(P+j,H),this.lineTo(P,H)},u.prototype.fillRect=function(P,H,j,K){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K))throw fi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var ht={};this.lineCap!=="butt"&&(ht.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ht.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(P,H,j,K),this.fill(),ht.hasOwnProperty("lineCap")&&(this.lineCap=ht.lineCap),ht.hasOwnProperty("lineJoin")&&(this.lineJoin=ht.lineJoin)}},u.prototype.strokeRect=function(P,H,j,K){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K))throw fi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(P,H,j,K),this.stroke())},u.prototype.clearRect=function(P,H,j,K){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K))throw fi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(P,H,j,K))},u.prototype.save=function(P){P=typeof P!="boolean"||P;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("q");if(this.pdf.setPage(H),P){this.ctx.fontSize=this.pdf.internal.getFontSize();var K=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=K}},u.prototype.restore=function(P){P=typeof P!="boolean"||P;for(var H=this.pdf.internal.getCurrentPageInfo().pageNumber,j=0;j<this.pdf.internal.getNumberOfPages();j++)this.pdf.setPage(j+1),this.pdf.internal.out("Q");this.pdf.setPage(H),P&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(P){var H,j,K,ht;if(P.isCanvasGradient===!0&&(P=P.getColor()),!P)return{r:0,g:0,b:0,a:0,style:P};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(P))H=0,j=0,K=0,ht=0;else{var ft=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(P);if(ft!==null)H=parseInt(ft[1]),j=parseInt(ft[2]),K=parseInt(ft[3]),ht=1;else if((ft=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(P))!==null)H=parseInt(ft[1]),j=parseInt(ft[2]),K=parseInt(ft[3]),ht=parseFloat(ft[4]);else{if(ht=1,typeof P=="string"&&P.charAt(0)!=="#"){var gt=new xC(P);P=gt.ok?gt.toHex():"#000000"}P.length===4?(H=P.substring(1,2),H+=H,j=P.substring(2,3),j+=j,K=P.substring(3,4),K+=K):(H=P.substring(1,3),j=P.substring(3,5),K=P.substring(5,7)),H=parseInt(H,16),j=parseInt(j,16),K=parseInt(K,16)}}return{r:H,g:j,b:K,a:ht,style:P}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};u.prototype.fillText=function(P,H,j,K){if(isNaN(H)||isNaN(j)||typeof P!="string")throw fi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(K=isNaN(K)?void 0:K,!d.call(this)){var ht=st(this.ctx.transform.rotation),ft=this.ctx.transform.scaleX;S.call(this,{text:P,x:H,y:j,scale:ft,angle:ht,align:this.textAlign,maxWidth:K})}},u.prototype.strokeText=function(P,H,j,K){if(isNaN(H)||isNaN(j)||typeof P!="string")throw fi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){K=isNaN(K)?void 0:K;var ht=st(this.ctx.transform.rotation),ft=this.ctx.transform.scaleX;S.call(this,{text:P,x:H,y:j,scale:ft,renderingMode:"stroke",angle:ht,align:this.textAlign,maxWidth:K})}},u.prototype.measureText=function(P){if(typeof P!="string")throw fi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var H=this.pdf,j=this.pdf.internal.scaleFactor,K=H.internal.getFontSize(),ht=H.getStringUnitWidth(P)*K/H.internal.scaleFactor,ft=function(gt){var _t=(gt=gt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return _t}}),this};return new ft({width:ht*=Math.round(96*j/72*1e4)/1e4})},u.prototype.scale=function(P,H){if(isNaN(P)||isNaN(H))throw fi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var j=new l(P,0,0,H,0,0);this.ctx.transform=this.ctx.transform.multiply(j)},u.prototype.rotate=function(P){if(isNaN(P))throw fi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var H=new l(Math.cos(P),Math.sin(P),-Math.sin(P),Math.cos(P),0,0);this.ctx.transform=this.ctx.transform.multiply(H)},u.prototype.translate=function(P,H){if(isNaN(P)||isNaN(H))throw fi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var j=new l(1,0,0,1,P,H);this.ctx.transform=this.ctx.transform.multiply(j)},u.prototype.transform=function(P,H,j,K,ht,ft){if(isNaN(P)||isNaN(H)||isNaN(j)||isNaN(K)||isNaN(ht)||isNaN(ft))throw fi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var gt=new l(P,H,j,K,ht,ft);this.ctx.transform=this.ctx.transform.multiply(gt)},u.prototype.setTransform=function(P,H,j,K,ht,ft){P=isNaN(P)?1:P,H=isNaN(H)?0:H,j=isNaN(j)?0:j,K=isNaN(K)?1:K,ht=isNaN(ht)?0:ht,ft=isNaN(ft)?0:ft,this.ctx.transform=new l(P,H,j,K,ht,ft)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(P,H,j,K,ht,ft,gt,_t,Pt){var Tt=this.pdf.getImageProperties(P),Wt=1,Gt=1,N=1,rt=1;K!==void 0&&_t!==void 0&&(N=_t/K,rt=Pt/ht,Wt=Tt.width/K*_t/K,Gt=Tt.height/ht*Pt/ht),ft===void 0&&(ft=H,gt=j,H=0,j=0),K!==void 0&&_t===void 0&&(_t=K,Pt=ht),K===void 0&&_t===void 0&&(_t=Tt.width,Pt=Tt.height);for(var z,J=this.ctx.transform.decompose(),Y=st(J.rotate.shx),it=new l,pt=(it=(it=(it=it.multiply(J.translate)).multiply(J.skew)).multiply(J.scale)).applyToRectangle(new a(ft-H*N,gt-j*rt,K*Wt,ht*Gt)),vt=y.call(this,pt),at=[],Et=0;Et<vt.length;Et+=1)at.indexOf(vt[Et])===-1&&at.push(vt[Et]);if(b(at),this.autoPaging)for(var It=at[0],Ct=at[at.length-1],jt=It;jt<Ct+1;jt++){this.pdf.setPage(jt);var ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],te=jt===1?this.posY+this.margin[0]:this.margin[0],ee=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],be=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qt=jt===1?0:ee+(jt-2)*be;if(this.ctx.clip_path.length!==0){var bi=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(z,this.posX+this.margin[3],-qt+te+this.ctx.prevPageLastElemOffset),M.call(this,"fill",!0),this.path=bi}var he=JSON.parse(JSON.stringify(pt));he=x([he],this.posX+this.margin[3],-qt+te+this.ctx.prevPageLastElemOffset)[0];var pn=(jt>It||jt<Ct)&&p.call(this);pn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ie,be,null).clip().discardPath()),this.pdf.addImage(P,"JPEG",he.x,he.y,he.w,he.h,null,null,Y),pn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(P,"JPEG",pt.x,pt.y,pt.w,pt.h,null,null,Y)};var y=function(P,H,j){var K=[];H=H||this.pdf.internal.pageSize.width,j=j||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ht=this.posY+this.ctx.prevPageLastElemOffset;switch(P.type){default:case"mt":case"lt":K.push(Math.floor((P.y+ht)/j)+1);break;case"arc":K.push(Math.floor((P.y+ht-P.radius)/j)+1),K.push(Math.floor((P.y+ht+P.radius)/j)+1);break;case"qct":var ft=tt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x,P.y);K.push(Math.floor((ft.y+ht)/j)+1),K.push(Math.floor((ft.y+ft.h+ht)/j)+1);break;case"bct":var gt=ot(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x2,P.y2,P.x,P.y);K.push(Math.floor((gt.y+ht)/j)+1),K.push(Math.floor((gt.y+gt.h+ht)/j)+1);break;case"rect":K.push(Math.floor((P.y+ht)/j)+1),K.push(Math.floor((P.y+P.h+ht)/j)+1)}for(var _t=0;_t<K.length;_t+=1)for(;this.pdf.internal.getNumberOfPages()<K[_t];)_.call(this);return K},_=function(){var P=this.fillStyle,H=this.strokeStyle,j=this.font,K=this.lineCap,ht=this.lineWidth,ft=this.lineJoin;this.pdf.addPage(),this.fillStyle=P,this.strokeStyle=H,this.font=j,this.lineCap=K,this.lineWidth=ht,this.lineJoin=ft},x=function(P,H,j){for(var K=0;K<P.length;K++)switch(P[K].type){case"bct":P[K].x2+=H,P[K].y2+=j;case"qct":P[K].x1+=H,P[K].y1+=j;case"mt":case"lt":case"arc":default:P[K].x+=H,P[K].y+=j}return P},b=function(P){return P.sort(function(H,j){return H-j})},L=function(P,H){for(var j,K,ht=this.fillStyle,ft=this.strokeStyle,gt=this.lineCap,_t=this.lineWidth,Pt=Math.abs(_t*this.ctx.transform.scaleX),Tt=this.lineJoin,Wt=JSON.parse(JSON.stringify(this.path)),Gt=JSON.parse(JSON.stringify(this.path)),N=[],rt=0;rt<Gt.length;rt++)if(Gt[rt].x!==void 0)for(var z=y.call(this,Gt[rt]),J=0;J<z.length;J+=1)N.indexOf(z[J])===-1&&N.push(z[J]);for(var Y=0;Y<N.length;Y++)for(;this.pdf.internal.getNumberOfPages()<N[Y];)_.call(this);if(b(N),this.autoPaging)for(var it=N[0],pt=N[N.length-1],vt=it;vt<pt+1;vt++){this.pdf.setPage(vt),this.fillStyle=ht,this.strokeStyle=ft,this.lineCap=gt,this.lineWidth=Pt,this.lineJoin=Tt;var at=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Et=vt===1?this.posY+this.margin[0]:this.margin[0],It=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],jt=vt===1?0:It+(vt-2)*Ct;if(this.ctx.clip_path.length!==0){var ie=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(j,this.posX+this.margin[3],-jt+Et+this.ctx.prevPageLastElemOffset),M.call(this,P,!0),this.path=ie}if(K=JSON.parse(JSON.stringify(Wt)),this.path=x(K,this.posX+this.margin[3],-jt+Et+this.ctx.prevPageLastElemOffset),H===!1||vt===0){var te=(vt>it||vt<pt)&&p.call(this);te&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],at,Ct,null).clip().discardPath()),M.call(this,P,H),te&&this.pdf.restoreGraphicsState()}this.lineWidth=_t}else this.lineWidth=Pt,M.call(this,P,H),this.lineWidth=_t;this.path=Wt},M=function(P,H){if((P!=="stroke"||H||!g.call(this))&&(P==="stroke"||H||!d.call(this))){for(var j,K,ht=[],ft=this.path,gt=0;gt<ft.length;gt++){var _t=ft[gt];switch(_t.type){case"begin":ht.push({begin:!0});break;case"close":ht.push({close:!0});break;case"mt":ht.push({start:_t,deltas:[],abs:[]});break;case"lt":var Pt=ht.length;if(ft[gt-1]&&!isNaN(ft[gt-1].x)&&(j=[_t.x-ft[gt-1].x,_t.y-ft[gt-1].y],Pt>0)){for(;Pt>=0;Pt--)if(ht[Pt-1].close!==!0&&ht[Pt-1].begin!==!0){ht[Pt-1].deltas.push(j),ht[Pt-1].abs.push(_t);break}}break;case"bct":j=[_t.x1-ft[gt-1].x,_t.y1-ft[gt-1].y,_t.x2-ft[gt-1].x,_t.y2-ft[gt-1].y,_t.x-ft[gt-1].x,_t.y-ft[gt-1].y],ht[ht.length-1].deltas.push(j);break;case"qct":var Tt=ft[gt-1].x+2/3*(_t.x1-ft[gt-1].x),Wt=ft[gt-1].y+2/3*(_t.y1-ft[gt-1].y),Gt=_t.x+2/3*(_t.x1-_t.x),N=_t.y+2/3*(_t.y1-_t.y),rt=_t.x,z=_t.y;j=[Tt-ft[gt-1].x,Wt-ft[gt-1].y,Gt-ft[gt-1].x,N-ft[gt-1].y,rt-ft[gt-1].x,z-ft[gt-1].y],ht[ht.length-1].deltas.push(j);break;case"arc":ht.push({deltas:[],abs:[],arc:!0}),Array.isArray(ht[ht.length-1].abs)&&ht[ht.length-1].abs.push(_t)}}K=H?null:P==="stroke"?"stroke":"fill";for(var J=!1,Y=0;Y<ht.length;Y++)if(ht[Y].arc)for(var it=ht[Y].abs,pt=0;pt<it.length;pt++){var vt=it[pt];vt.type==="arc"?T.call(this,vt.x,vt.y,vt.radius,vt.startAngle,vt.endAngle,vt.counterclockwise,void 0,H,!J):O.call(this,vt.x,vt.y),J=!0}else if(ht[Y].close===!0)this.pdf.internal.out("h"),J=!1;else if(ht[Y].begin!==!0){var at=ht[Y].start.x,Et=ht[Y].start.y;E.call(this,ht[Y].deltas,at,Et),J=!0}K&&F.call(this,K),H&&q.call(this)}},k=function(P){var H=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,j=H*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return P-j;case"top":return P+H-j;case"hanging":return P+H-2*j;case"middle":return P+H/2-j;case"ideographic":return P;case"alphabetic":default:return P}},A=function(P){return P+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var P=function(){};return P.colorStops=[],P.addColorStop=function(H,j){this.colorStops.push([H,j])},P.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},P.isCanvasGradient=!0,P},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(P,H,j,K,ht,ft,gt,_t,Pt){for(var Tt=X.call(this,j,K,ht,ft),Wt=0;Wt<Tt.length;Wt++){var Gt=Tt[Wt];Wt===0&&(Pt?R.call(this,Gt.x1+P,Gt.y1+H):O.call(this,Gt.x1+P,Gt.y1+H)),U.call(this,P,H,Gt.x2,Gt.y2,Gt.x3,Gt.y3,Gt.x4,Gt.y4)}_t?q.call(this):F.call(this,gt)},F=function(P){switch(P){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},q=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(P,H){this.pdf.internal.out(e(P)+" "+n(H)+" m")},S=function(P){var H;switch(P.align){case"right":case"end":H="right";break;case"center":H="center";break;case"left":case"start":default:H="left"}var j=this.pdf.getTextDimensions(P.text),K=k.call(this,P.y),ht=A.call(this,K)-j.h,ft=this.ctx.transform.applyToPoint(new o(P.x,K)),gt=this.ctx.transform.decompose(),_t=new l;_t=(_t=(_t=_t.multiply(gt.translate)).multiply(gt.skew)).multiply(gt.scale);for(var Pt,Tt,Wt,Gt=this.ctx.transform.applyToRectangle(new a(P.x,K,j.w,j.h)),N=_t.applyToRectangle(new a(P.x,ht,j.w,j.h)),rt=y.call(this,N),z=[],J=0;J<rt.length;J+=1)z.indexOf(rt[J])===-1&&z.push(rt[J]);if(b(z),this.autoPaging)for(var Y=z[0],it=z[z.length-1],pt=Y;pt<it+1;pt++){this.pdf.setPage(pt);var vt=pt===1?this.posY+this.margin[0]:this.margin[0],at=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Et=this.pdf.internal.pageSize.height-this.margin[2],It=Et-this.margin[0],Ct=this.pdf.internal.pageSize.width-this.margin[1],jt=Ct-this.margin[3],ie=pt===1?0:at+(pt-2)*It;if(this.ctx.clip_path.length!==0){var te=this.path;Pt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=x(Pt,this.posX+this.margin[3],-1*ie+vt),M.call(this,"fill",!0),this.path=te}var ee=x([JSON.parse(JSON.stringify(N))],this.posX+this.margin[3],-ie+vt+this.ctx.prevPageLastElemOffset)[0];P.scale>=.01&&(Tt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Tt*P.scale),Wt=this.lineWidth,this.lineWidth=Wt*P.scale);var be=this.autoPaging!=="text";if(be||ee.y+ee.h<=Et){if(be||ee.y>=vt&&ee.x<=Ct){var qt=be?P.text:this.pdf.splitTextToSize(P.text,P.maxWidth||Ct-ee.x)[0],bi=x([JSON.parse(JSON.stringify(Gt))],this.posX+this.margin[3],-ie+vt+this.ctx.prevPageLastElemOffset)[0],he=be&&(pt>Y||pt<it)&&p.call(this);he&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,It,null).clip().discardPath()),this.pdf.text(qt,bi.x,bi.y,{angle:P.angle,align:H,renderingMode:P.renderingMode}),he&&this.pdf.restoreGraphicsState()}}else ee.y<Et&&(this.ctx.prevPageLastElemOffset+=Et-ee.y);P.scale>=.01&&(this.pdf.setFontSize(Tt),this.lineWidth=Wt)}else P.scale>=.01&&(Tt=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Tt*P.scale),Wt=this.lineWidth,this.lineWidth=Wt*P.scale),this.pdf.text(P.text,ft.x+this.posX,ft.y+this.posY,{angle:P.angle,align:H,renderingMode:P.renderingMode,maxWidth:P.maxWidth}),P.scale>=.01&&(this.pdf.setFontSize(Tt),this.lineWidth=Wt)},O=function(P,H,j,K){j=j||0,K=K||0,this.pdf.internal.out(e(P+j)+" "+n(H+K)+" l")},E=function(P,H,j){return this.pdf.lines(P,H,j,null,null)},U=function(P,H,j,K,ht,ft,gt,_t){this.pdf.internal.out([t(s(j+P)),t(r(K+H)),t(s(ht+P)),t(r(ft+H)),t(s(gt+P)),t(r(_t+H)),"c"].join(" "))},X=function(P,H,j,K){for(var ht=2*Math.PI,ft=Math.PI/2;H>j;)H-=ht;var gt=Math.abs(j-H);gt<ht&&K&&(gt=ht-gt);for(var _t=[],Pt=K?-1:1,Tt=H;gt>1e-5;){var Wt=Tt+Pt*Math.min(gt,ft);_t.push(Z.call(this,P,Tt,Wt)),gt-=Math.abs(Wt-Tt),Tt=Wt}return _t},Z=function(P,H,j){var K=(j-H)/2,ht=P*Math.cos(K),ft=P*Math.sin(K),gt=ht,_t=-ft,Pt=gt*gt+_t*_t,Tt=Pt+gt*ht+_t*ft,Wt=4/3*(Math.sqrt(2*Pt*Tt)-Tt)/(gt*ft-_t*ht),Gt=gt-Wt*_t,N=_t+Wt*gt,rt=Gt,z=-N,J=K+H,Y=Math.cos(J),it=Math.sin(J);return{x1:P*Math.cos(H),y1:P*Math.sin(H),x2:Gt*Y-N*it,y2:Gt*it+N*Y,x3:rt*Y-z*it,y3:rt*it+z*Y,x4:P*Math.cos(j),y4:P*Math.sin(j)}},st=function(P){return 180*P/Math.PI},tt=function(P,H,j,K,ht,ft){var gt=P+.5*(j-P),_t=H+.5*(K-H),Pt=ht+.5*(j-ht),Tt=ft+.5*(K-ft),Wt=Math.min(P,ht,gt,Pt),Gt=Math.max(P,ht,gt,Pt),N=Math.min(H,ft,_t,Tt),rt=Math.max(H,ft,_t,Tt);return new a(Wt,N,Gt-Wt,rt-N)},ot=function(P,H,j,K,ht,ft,gt,_t){var Pt,Tt,Wt,Gt,N,rt,z,J,Y,it,pt,vt,at,Et,It=j-P,Ct=K-H,jt=ht-j,ie=ft-K,te=gt-ht,ee=_t-ft;for(Tt=0;Tt<41;Tt++)Y=(z=(Wt=P+(Pt=Tt/40)*It)+Pt*((N=j+Pt*jt)-Wt))+Pt*(N+Pt*(ht+Pt*te-N)-z),it=(J=(Gt=H+Pt*Ct)+Pt*((rt=K+Pt*ie)-Gt))+Pt*(rt+Pt*(ft+Pt*ee-rt)-J),Tt==0?(pt=Y,vt=it,at=Y,Et=it):(pt=Math.min(pt,Y),vt=Math.min(vt,it),at=Math.max(at,Y),Et=Math.max(Et,it));return new a(Math.round(pt),Math.round(vt),Math.round(at-pt),Math.round(Et-vt))},et=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var P,H,j=(P=this.ctx.lineDash,H=this.ctx.lineDashOffset,JSON.stringify({lineDash:P,lineDashOffset:H}));this.prevLineDash!==j&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=j)}}})(pe.API),function(i){var t=function(r){var o,a,l,h,c,u,f,d,g,p;for(a=[],l=0,h=(r+=o="\0\0\0\0".slice(r.length%4||4)).length;h>l;l+=4)(c=(r.charCodeAt(l)<<24)+(r.charCodeAt(l+1)<<16)+(r.charCodeAt(l+2)<<8)+r.charCodeAt(l+3))!==0?(u=(c=((c=((c=((c=(c-(p=c%85))/85)-(g=c%85))/85)-(d=c%85))/85)-(f=c%85))/85)%85,a.push(u+33,f+33,d+33,g+33,p+33)):a.push(122);return function(y,_){for(var x=_;x>0;x--)y.pop()}(a,o.length),String.fromCharCode.apply(String,a)+"~>"},e=function(r){var o,a,l,h,c,u=String,f="length",d=255,g="charCodeAt",p="slice",y="replace";for(r[p](-2),r=r[p](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),l=[],h=0,c=(r+=o="uuuuu"[p](r[f]%5||5))[f];c>h;h+=5)a=52200625*(r[g](h)-33)+614125*(r[g](h+1)-33)+7225*(r[g](h+2)-33)+85*(r[g](h+3)-33)+(r[g](h+4)-33),l.push(d&a>>24,d&a>>16,d&a>>8,d&a);return function(_,x){for(var b=x;b>0;b--)_.pop()}(l,o[f]),u.fromCharCode.apply(u,l)},n=function(r){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((r=r.replace(/\s/g,"")).indexOf(">")!==-1&&(r=r.substr(0,r.indexOf(">"))),r.length%2&&(r+="0"),o.test(r)===!1)return"";for(var a="",l=0;l<r.length;l+=2)a+=String.fromCharCode("0x"+(r[l]+r[l+1]));return a},s=function(r){for(var o=new Uint8Array(r.length),a=r.length;a--;)o[a]=r.charCodeAt(a);return r=(o=Y_(o)).reduce(function(l,h){return l+String.fromCharCode(h)},"")};i.processDataByFilters=function(r,o){var a=0,l=r||"",h=[];for(typeof(o=o||[])=="string"&&(o=[o]),a=0;a<o.length;a+=1)switch(o[a]){case"ASCII85Decode":case"/ASCII85Decode":l=e(l),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=s(l),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[a]+'" is not implemented')}return{data:l,reverseChain:h.reverse().join(" ")}}}(pe.API),function(i){i.loadFile=function(t,e,n){return function(s,r,o){r=r!==!1,o=typeof o=="function"?o:function(){};var a=void 0;try{a=function(l,h,c){var u=new XMLHttpRequest,f=0,d=function(g){var p=g.length,y=[],_=String.fromCharCode;for(f=0;f<p;f+=1)y.push(_(255&g.charCodeAt(f)));return y.join("")};if(u.open("GET",l,!h),u.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(u.onload=function(){u.status===200?c(d(this.responseText)):c(void 0)}),u.send(null),h&&u.status===200)return d(u.responseText)}(s,r,o)}catch{}return a}(t,e,n)},i.loadImageFile=i.loadFile}(pe.API),function(i){function t(){return(me.html2canvas?Promise.resolve(me.html2canvas):O_(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function e(){return(me.DOMPurify?Promise.resolve(me.DOMPurify):O_(()=>import("./purify.es-DGIRlouP.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var a=hi(o);return a==="undefined"?"undefined":a==="string"||o instanceof String?"string":a==="number"||o instanceof Number?"number":a==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":a==="object"?"object":"unknown"},s=function(o,a){var l=document.createElement(o);for(var h in a.className&&(l.className=a.className),a.innerHTML&&a.dompurify&&(l.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)l.style[h]=a.style[h];return l},r=function o(a){var l=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),h=o.convert(Promise.resolve(),l);return h=(h=h.setProgress(1,o,1,[o])).set(a)};(r.prototype=Object.create(Promise.prototype)).constructor=r,r.convert=function(o,a){return o.__proto__=a||r.prototype,o},r.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},r.prototype.from=function(o,a){return this.then(function(){switch(a=a||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(e).then(function(l){return this.set({src:s("div",{innerHTML:o,dompurify:l})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},r.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},r.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function l(h,c){for(var u=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),f=h.firstChild;f;f=f.nextSibling)c!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,c));return h.nodeType===1&&(h.nodeName==="CANVAS"?(u.width=h.width,u.height=h.height,u.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(u.value=h.value),u.addEventListener("load",function(){u.scrollTop=h.scrollTop,u.scrollLeft=h.scrollLeft},!0)),u}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},r.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,a(this.prop.container,l)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},r.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(a){var l=this.opt.jsPDF,h=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,u=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete u.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=h,h)for(var f=0;f<h.length;++f){var d=h[f],g=d.src.find(function(p){return p.format==="truetype"});g&&l.addFont(g.url,d.ref.name,d.ref.style)}return u.windowHeight=u.windowHeight||0,u.windowHeight=u.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):u.windowHeight,l.context2d.save(!0),a(this.prop.container,u)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},r.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},r.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},r.prototype.output=function(o,a,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(o,a):this.outputPdf(o,a)},r.prototype.outputPdf=function(o,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,a)})},r.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},r.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},r.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},r.prototype.set=function(o){if(n(o)!=="object")return this;var a=Object.keys(o||{}).map(function(l){if(l in r.template.prop)return function(){this.prop[l]=o[l]};switch(l){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[l]=o[l]}}},this);return this.then(function(){return this.thenList(a)})},r.prototype.get=function(o,a){return this.then(function(){var l=o in r.template.prop?this.prop[o]:this.opt[o];return a?a(l):l})},r.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},r.prototype.setPageSize=function(o){function a(l,h){return Math.floor(l*h/72*96)}return this.then(function(){(o=o||pe.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:a(o.inner.width,o.k),height:a(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},r.prototype.setProgress=function(o,a,l,h){return o!=null&&(this.progress.val=o),a!=null&&(this.progress.state=a),l!=null&&(this.progress.n=l),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},r.prototype.updateProgress=function(o,a,l,h){return this.setProgress(o?this.progress.val+o:null,a||null,l?this.progress.n+l:null,h?this.progress.stack.concat(h):null)},r.prototype.then=function(o,a){var l=this;return this.thenCore(o,a,function(h,c){return l.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(u){return l.updateProgress(null,h),u}).then(h,c).then(function(u){return l.updateProgress(1),u})})},r.prototype.thenCore=function(o,a,l){l=l||Promise.prototype.then,o&&(o=o.bind(this)),a&&(a=a.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:r.convert(Object.assign({},this),Promise.prototype),c=l.call(h,o,a);return r.convert(c,this.__proto__)},r.prototype.thenExternal=function(o,a){return Promise.prototype.then.call(this,o,a)},r.prototype.thenList=function(o){var a=this;return o.forEach(function(l){a=a.thenCore(l)}),a},r.prototype.catch=function(o){o&&(o=o.bind(this));var a=Promise.prototype.catch.call(this,o);return r.convert(a,this)},r.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},r.prototype.error=function(o){return this.then(function(){throw new Error(o)})},r.prototype.using=r.prototype.set,r.prototype.saveAs=r.prototype.save,r.prototype.export=r.prototype.output,r.prototype.run=r.prototype.then,pe.getPageSize=function(o,a,l){if(hi(o)==="object"){var h=o;o=h.orientation,a=h.unit||a,l=h.format||l}a=a||"mm",l=l||"a4",o=(""+(o||"P")).toLowerCase();var c,u=(""+l).toLowerCase(),f={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+a}var d,g=0,p=0;if(f.hasOwnProperty(u))g=f[u][1]/c,p=f[u][0]/c;else try{g=l[1],p=l[0]}catch{throw new Error("Invalid format: "+l)}if(o==="p"||o==="portrait")o="p",p>g&&(d=p,p=g,g=d);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>p&&(d=p,p=g,g=d)}return{width:p,height:g,unit:a,k:c,orientation:o}},i.html=function(o,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(Q_):null;var l=new r(a);return a.worker?l:l.from(o).doCallback()}}(pe.API),pe.API.addJS=function(i){return Z5=i,this.internal.events.subscribe("postPutResources",function(){Zg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Zg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),K5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Z5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Zg!==void 0&&K5!==void 0&&this.internal.out("/Names <</JavaScript "+Zg+" 0 R>>")}),this},function(i){var t;i.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=e.outline.render().split(/\r\n/),r=0;r<s.length;r++){var o=s[r],a=n.exec(o);if(a!=null){var l=a[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,c=[];for(r=0;r<h;r++){var u=e.internal.newObject();c.push(u);var f=e.internal.getPageInfo(r+1);e.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var d=e.internal.newObject();for(e.internal.write("<< /Names [ "),r=0;r<c.length;r++)e.internal.write("(page_"+(r+1)+")"+c[r]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+d+" 0 R"),e.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),i.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,s,r){var o={title:s,options:r,children:[]};return n==null&&(n=this.root),n.children.push(o),o},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<n.children.length;r++){var o=n.children[r];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),r>0&&this.line("/Prev "+this.makeRef(n.children[r-1])),r<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[r+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var a=this.count=this.count_r({count:0},o);if(a>0&&this.line("/Count "+a),o.options&&o.options.pageNumber){var l=e.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,s){for(var r=0;r<s.children.length;r++)n.count++,this.count_r(n,s.children[r]);return n.count}}])}(pe.API),function(i){var t=[192,193,194,195,196,197,198,199];i.processJPEG=function(e,n,s,r,o,a){var l,h=this.decode.DCT_DECODE,c=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=o||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(l=function(u){for(var f,d=256*u.charCodeAt(4)+u.charCodeAt(5),g=u.length,p={width:0,height:0,numcomponents:1},y=4;y<g;y+=2){if(y+=d,t.indexOf(u.charCodeAt(y+1))!==-1){f=256*u.charCodeAt(y+5)+u.charCodeAt(y+6),p={width:256*u.charCodeAt(y+7)+u.charCodeAt(y+8),height:f,numcomponents:u.charCodeAt(y+9)};break}d=256*u.charCodeAt(y+2)+u.charCodeAt(y+3)}return p}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}c={data:e,width:l.width,height:l.height,colorSpace:a,bitsPerComponent:8,filter:h,index:n,alias:s}}return c}}(pe.API);var Zh,Jg,J5,Q5,tb,LO=function(){var i,t,e;function n(r){var o,a,l,h,c,u,f,d,g,p,y,_,x,b;for(this.data=r,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},u=null;;){switch(o=this.readUInt32(),g=(function(){var L,M;for(M=[],L=0;L<4;++L)M.push(String.fromCharCode(this.data[this.pos++]));return M}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":u&&this.animation.frames.push(u),this.pos+=4,u={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),h=this.readUInt16()||100,u.delay=1e3*c/h,u.disposeOp=this.data[this.pos++],u.blendOp=this.data[this.pos++],u.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,o-=4),r=(u!=null?u.data:void 0)||this.imgData,_=0;0<=o?_<o:_>o;0<=o?++_:--_)r.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((p=l-this.transparency.indexed.length)>0)for(x=0;0<=p?x<p:x>p;0<=p?++x:--x)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":f=(y=this.read(o)).indexOf(0),d=String.fromCharCode.apply(String,y.slice(0,f)),this.text[d]=String.fromCharCode.apply(String,y.slice(f+1));break;case"IEND":return u&&this.animation.frames.push(u),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(b=this.colorType)===4||b===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(r){var o,a;for(a=[],o=0;0<=r?o<r:o>r;0<=r?++o:--o)a.push(this.data[this.pos++]);return a},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(r){var o=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*o),l=0,h=this;if(r==null&&(r=this.imgData),r.length===0)return new Uint8Array(0);function c(u,f,d,g){var p,y,_,x,b,L,M,k,A,T,F,q,R,S,O,E,U,X,Z,st,tt,ot=Math.ceil((h.width-u)/d),et=Math.ceil((h.height-f)/g),P=h.width==ot&&h.height==et;for(S=o*ot,q=P?a:new Uint8Array(S*et),L=r.length,R=0,y=0;R<et&&l<L;){switch(r[l++]){case 0:for(x=U=0;U<S;x=U+=1)q[y++]=r[l++];break;case 1:for(x=X=0;X<S;x=X+=1)p=r[l++],b=x<o?0:q[y-o],q[y++]=(p+b)%256;break;case 2:for(x=Z=0;Z<S;x=Z+=1)p=r[l++],_=(x-x%o)/o,O=R&&q[(R-1)*S+_*o+x%o],q[y++]=(O+p)%256;break;case 3:for(x=st=0;st<S;x=st+=1)p=r[l++],_=(x-x%o)/o,b=x<o?0:q[y-o],O=R&&q[(R-1)*S+_*o+x%o],q[y++]=(p+Math.floor((b+O)/2))%256;break;case 4:for(x=tt=0;tt<S;x=tt+=1)p=r[l++],_=(x-x%o)/o,b=x<o?0:q[y-o],R===0?O=E=0:(O=q[(R-1)*S+_*o+x%o],E=_&&q[(R-1)*S+(_-1)*o+x%o]),M=b+O-E,k=Math.abs(M-b),T=Math.abs(M-O),F=Math.abs(M-E),A=k<=T&&k<=F?b:T<=F?O:E,q[y++]=(p+A)%256;break;default:throw new Error("Invalid filter algorithm: "+r[l-1])}if(!P){var H=((f+R*g)*h.width+u)*o,j=R*S;for(x=0;x<ot;x+=1){for(var K=0;K<o;K+=1)a[H++]=q[j++];H+=(d-1)*o}}R++}}return r=sO(r),h.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),a},n.prototype.decodePalette=function(){var r,o,a,l,h,c,u,f,d;for(a=this.palette,c=this.transparency.indexed||[],h=new Uint8Array((c.length||0)+a.length),l=0,r=0,o=u=0,f=a.length;u<f;o=u+=3)h[l++]=a[o],h[l++]=a[o+1],h[l++]=a[o+2],h[l++]=(d=c[r++])!=null?d:255;return h},n.prototype.copyToImageData=function(r,o){var a,l,h,c,u,f,d,g,p,y,_;if(l=this.colors,p=null,a=this.hasAlphaChannel,this.palette.length&&(p=(_=this._decodedPalette)!=null?_:this._decodedPalette=this.decodePalette(),l=4,a=!0),g=(h=r.data||r).length,u=p||o,c=f=0,l===1)for(;c<g;)d=p?4*o[c/4]:f,y=u[d++],h[c++]=y,h[c++]=y,h[c++]=y,h[c++]=a?u[d++]:255,f=d;else for(;c<g;)d=p?4*o[c/4]:f,h[c++]=u[d++],h[c++]=u[d++],h[c++]=u[d++],h[c++]=a?u[d++]:255,f=d},n.prototype.decode=function(){var r;return r=new Uint8Array(this.width*this.height*4),this.copyToImageData(r,this.decodePixels()),r};var s=function(){if(Object.prototype.toString.call(me)==="[object Window]"){try{t=me.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return s(),i=function(r){var o;if(s()===!0)return e.width=r.width,e.height=r.height,e.clearRect(0,0,r.width,r.height),e.putImageData(r,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(r){var o,a,l,h,c,u,f,d;if(this.animation){for(d=[],a=c=0,u=(f=this.animation.frames).length;c<u;a=++c)o=f[a],l=r.createImageData(o.width,o.height),h=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(l,h),o.imageData=l,d.push(o.image=i(l));return d}},n.prototype.renderFrame=function(r,o){var a,l,h;return a=(l=this.animation.frames)[o],h=l[o-1],o===0&&r.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?r.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&r.putImageData(h.imageData,h.xOffset,h.yOffset),a.blendOp===0&&r.clearRect(a.xOffset,a.yOffset,a.width,a.height),r.drawImage(a.image,a.xOffset,a.yOffset)},n.prototype.animate=function(r){var o,a,l,h,c,u,f=this;return a=0,u=this.animation,h=u.numFrames,l=u.frames,c=u.numPlays,(o=function(){var d,g;if(d=a++%h,g=l[d],f.renderFrame(r,d),h>1&&a/h<c)return f.animation._timeout=setTimeout(o,g.delay)})()},n.prototype.stopAnimation=function(){var r;return clearTimeout((r=this.animation)!=null?r._timeout:void 0)},n.prototype.render=function(r){var o,a;return r._png&&r._png.stopAnimation(),r._png=this,r.width=this.width,r.height=this.height,o=r.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(a=o.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),o.putImageData(a,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function MO(i){var t=0;if(i[t++]!==71||i[t++]!==73||i[t++]!==70||i[t++]!==56||(i[t++]+1&253)!=56||i[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=i[t++]|i[t++]<<8,n=i[t++]|i[t++]<<8,s=i[t++],r=s>>7,o=1<<(7&s)+1;i[t++],i[t++];var a=null,l=null;r&&(a=t,l=o,t+=3*o);var h=!0,c=[],u=0,f=null,d=0,g=null;for(this.width=e,this.height=n;h&&t<i.length;)switch(i[t++]){case 33:switch(i[t++]){case 255:if(i[t]!==11||i[t+1]==78&&i[t+2]==69&&i[t+3]==84&&i[t+4]==83&&i[t+5]==67&&i[t+6]==65&&i[t+7]==80&&i[t+8]==69&&i[t+9]==50&&i[t+10]==46&&i[t+11]==48&&i[t+12]==3&&i[t+13]==1&&i[t+16]==0)t+=14,g=i[t++]|i[t++]<<8,t++;else for(t+=12;;){if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;case 249:if(i[t++]!==4||i[t+4]!==0)throw new Error("Invalid graphics extension block.");var p=i[t++];u=i[t++]|i[t++]<<8,f=i[t++],!(1&p)&&(f=null),d=p>>2&7,t++;break;case 254:for(;;){if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;default:throw new Error("Unknown graphic control label: 0x"+i[t-1].toString(16))}break;case 44:var y=i[t++]|i[t++]<<8,_=i[t++]|i[t++]<<8,x=i[t++]|i[t++]<<8,b=i[t++]|i[t++]<<8,L=i[t++],M=L>>6&1,k=1<<(7&L)+1,A=a,T=l,F=!1;L>>7&&(F=!0,A=t,T=k,t+=3*k);var q=t;for(t++;;){var R;if(!((R=i[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}c.push({x:y,y:_,width:x,height:b,has_local_palette:F,palette_offset:A,palette_size:T,data_offset:q,data_length:t-q,transparent_index:f,interlaced:!!M,delay:u,disposal:d});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+i[t-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(S){if(S<0||S>=c.length)throw new Error("Frame index out of range.");return c[S]},this.decodeAndBlitFrameBGRA=function(S,O){var E=this.frameInfo(S),U=E.width*E.height,X=new Uint8Array(U);eb(i,E.data_offset,X,U);var Z=E.palette_offset,st=E.transparent_index;st===null&&(st=256);var tt=E.width,ot=e-tt,et=tt,P=4*(E.y*e+E.x),H=4*((E.y+E.height)*e+E.x),j=P,K=4*ot;E.interlaced===!0&&(K+=4*e*7);for(var ht=8,ft=0,gt=X.length;ft<gt;++ft){var _t=X[ft];if(et===0&&(et=tt,(j+=K)>=H&&(K=4*ot+4*e*(ht-1),j=P+(tt+ot)*(ht<<1),ht>>=1)),_t===st)j+=4;else{var Pt=i[Z+3*_t],Tt=i[Z+3*_t+1],Wt=i[Z+3*_t+2];O[j++]=Wt,O[j++]=Tt,O[j++]=Pt,O[j++]=255}--et}},this.decodeAndBlitFrameRGBA=function(S,O){var E=this.frameInfo(S),U=E.width*E.height,X=new Uint8Array(U);eb(i,E.data_offset,X,U);var Z=E.palette_offset,st=E.transparent_index;st===null&&(st=256);var tt=E.width,ot=e-tt,et=tt,P=4*(E.y*e+E.x),H=4*((E.y+E.height)*e+E.x),j=P,K=4*ot;E.interlaced===!0&&(K+=4*e*7);for(var ht=8,ft=0,gt=X.length;ft<gt;++ft){var _t=X[ft];if(et===0&&(et=tt,(j+=K)>=H&&(K=4*ot+4*e*(ht-1),j=P+(tt+ot)*(ht<<1),ht>>=1)),_t===st)j+=4;else{var Pt=i[Z+3*_t],Tt=i[Z+3*_t+1],Wt=i[Z+3*_t+2];O[j++]=Pt,O[j++]=Tt,O[j++]=Wt,O[j++]=255}--et}}}function eb(i,t,e,n){for(var s=i[t++],r=1<<s,o=r+1,a=o+1,l=s+1,h=(1<<l)-1,c=0,u=0,f=0,d=i[t++],g=new Int32Array(4096),p=null;;){for(;c<16&&d!==0;)u|=i[t++]<<c,c+=8,d===1?d=i[t++]:--d;if(c<l)break;var y=u&h;if(u>>=l,c-=l,y!==r){if(y===o)break;for(var _=y<a?y:p,x=0,b=_;b>r;)b=g[b]>>8,++x;var L=b;if(f+x+(_!==y?1:0)>n)return void fi.log("Warning, gif stream longer than expected.");e[f++]=L;var M=f+=x;for(_!==y&&(e[f++]=L),b=_;x--;)b=g[b],e[--M]=255&b,b>>=8;p!==null&&a<4096&&(g[a++]=p<<8|L,a>=h+1&&l<12&&(++l,h=h<<1|1)),p=y}else a=o+1,h=(1<<(l=s+1))-1,p=null}return f!==n&&fi.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function K1(i){var t,e,n,s,r,o=Math.floor,a=new Array(64),l=new Array(64),h=new Array(64),c=new Array(64),u=new Array(65535),f=new Array(65535),d=new Array(64),g=new Array(64),p=[],y=0,_=7,x=new Array(64),b=new Array(64),L=new Array(64),M=new Array(256),k=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],S=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function X(P,H){for(var j=0,K=0,ht=new Array,ft=1;ft<=16;ft++){for(var gt=1;gt<=P[ft];gt++)ht[H[K]]=[],ht[H[K]][0]=j,ht[H[K]][1]=ft,K++,j++;j*=2}return ht}function Z(P){for(var H=P[0],j=P[1]-1;j>=0;)H&1<<j&&(y|=1<<_),j--,--_<0&&(y==255?(st(255),st(0)):st(y),_=7,y=0)}function st(P){p.push(P)}function tt(P){st(P>>8&255),st(255&P)}function ot(P,H,j,K,ht){for(var ft,gt=ht[0],_t=ht[240],Pt=function(it,pt){var vt,at,Et,It,Ct,jt,ie,te,ee,be,qt=0;for(ee=0;ee<8;++ee){vt=it[qt],at=it[qt+1],Et=it[qt+2],It=it[qt+3],Ct=it[qt+4],jt=it[qt+5],ie=it[qt+6];var bi=vt+(te=it[qt+7]),he=vt-te,pn=at+ie,We=at-ie,Re=Et+jt,Rn=Et-jt,Fe=It+Ct,Vs=It-Ct,ci=bi+Fe,tn=bi-Fe,ji=pn+Re,qe=pn-Re;it[qt]=ci+ji,it[qt+4]=ci-ji;var _e=.707106781*(qe+tn);it[qt+2]=tn+_e,it[qt+6]=tn-_e;var Ve=.382683433*((ci=Vs+Rn)-(qe=We+he)),en=.5411961*ci+Ve,wi=1.306562965*qe+Ve,Ti=.707106781*(ji=Rn+We),zi=he+Ti,se=he-Ti;it[qt+5]=se+en,it[qt+3]=se-en,it[qt+1]=zi+wi,it[qt+7]=zi-wi,qt+=8}for(qt=0,ee=0;ee<8;++ee){vt=it[qt],at=it[qt+8],Et=it[qt+16],It=it[qt+24],Ct=it[qt+32],jt=it[qt+40],ie=it[qt+48];var Gi=vt+(te=it[qt+56]),nn=vt-te,Ne=at+ie,je=at-ie,ti=Et+jt,$n=Et-jt,ch=It+Ct,po=It-Ct,ar=Gi+ch,lr=Gi-ch,hr=Ne+ti,Dr=Ne-ti;it[qt]=ar+hr,it[qt+32]=ar-hr;var Hs=.707106781*(Dr+lr);it[qt+16]=lr+Hs,it[qt+48]=lr-Hs;var Br=.382683433*((ar=po+$n)-(Dr=je+nn)),sl=.5411961*ar+Br,uh=1.306562965*Dr+Br,dh=.707106781*(hr=$n+je),fh=nn+dh,gh=nn-dh;it[qt+40]=gh+sl,it[qt+24]=gh-sl,it[qt+8]=fh+uh,it[qt+56]=fh-uh,qt++}for(ee=0;ee<64;++ee)be=it[ee]*pt[ee],d[ee]=be>0?be+.5|0:be-.5|0;return d}(P,H),Tt=0;Tt<64;++Tt)g[A[Tt]]=Pt[Tt];var Wt=g[0]-j;j=g[0],Wt==0?Z(K[0]):(Z(K[f[ft=32767+Wt]]),Z(u[ft]));for(var Gt=63;Gt>0&&g[Gt]==0;)Gt--;if(Gt==0)return Z(gt),j;for(var N,rt=1;rt<=Gt;){for(var z=rt;g[rt]==0&&rt<=Gt;)++rt;var J=rt-z;if(J>=16){N=J>>4;for(var Y=1;Y<=N;++Y)Z(_t);J&=15}ft=32767+g[rt],Z(ht[(J<<4)+f[ft]]),Z(u[ft]),rt++}return Gt!=63&&Z(gt),j}function et(P){P=Math.min(Math.max(P,1),100),r!=P&&(function(H){for(var j=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;K<64;K++){var ht=o((j[K]*H+50)/100);ht=Math.min(Math.max(ht,1),255),a[A[K]]=ht}for(var ft=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],gt=0;gt<64;gt++){var _t=o((ft[gt]*H+50)/100);_t=Math.min(Math.max(_t,1),255),l[A[gt]]=_t}for(var Pt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Tt=0,Wt=0;Wt<8;Wt++)for(var Gt=0;Gt<8;Gt++)h[Tt]=1/(a[A[Tt]]*Pt[Wt]*Pt[Gt]*8),c[Tt]=1/(l[A[Tt]]*Pt[Wt]*Pt[Gt]*8),Tt++}(P<50?Math.floor(5e3/P):Math.floor(200-2*P)),r=P)}this.encode=function(P,H){H&&et(H),p=new Array,y=0,_=7,tt(65496),tt(65504),tt(16),st(74),st(70),st(73),st(70),st(0),st(1),st(1),st(0),tt(1),tt(1),st(0),st(0),function(){tt(65499),tt(132),st(0);for(var at=0;at<64;at++)st(a[at]);st(1);for(var Et=0;Et<64;Et++)st(l[Et])}(),function(at,Et){tt(65472),tt(17),st(8),tt(Et),tt(at),st(3),st(1),st(17),st(0),st(2),st(17),st(1),st(3),st(17),st(1)}(P.width,P.height),function(){tt(65476),tt(418),st(0);for(var at=0;at<16;at++)st(T[at+1]);for(var Et=0;Et<=11;Et++)st(F[Et]);st(16);for(var It=0;It<16;It++)st(q[It+1]);for(var Ct=0;Ct<=161;Ct++)st(R[Ct]);st(1);for(var jt=0;jt<16;jt++)st(S[jt+1]);for(var ie=0;ie<=11;ie++)st(O[ie]);st(17);for(var te=0;te<16;te++)st(E[te+1]);for(var ee=0;ee<=161;ee++)st(U[ee])}(),tt(65498),tt(12),st(3),st(1),st(0),st(2),st(17),st(3),st(17),st(0),st(63),st(0);var j=0,K=0,ht=0;y=0,_=7,this.encode.displayName="_encode_";for(var ft,gt,_t,Pt,Tt,Wt,Gt,N,rt,z=P.data,J=P.width,Y=P.height,it=4*J,pt=0;pt<Y;){for(ft=0;ft<it;){for(Tt=it*pt+ft,Gt=-1,N=0,rt=0;rt<64;rt++)Wt=Tt+(N=rt>>3)*it+(Gt=4*(7&rt)),pt+N>=Y&&(Wt-=it*(pt+1+N-Y)),ft+Gt>=it&&(Wt-=ft+Gt-it+4),gt=z[Wt++],_t=z[Wt++],Pt=z[Wt++],x[rt]=(k[gt]+k[_t+256>>0]+k[Pt+512>>0]>>16)-128,b[rt]=(k[gt+768>>0]+k[_t+1024>>0]+k[Pt+1280>>0]>>16)-128,L[rt]=(k[gt+1280>>0]+k[_t+1536>>0]+k[Pt+1792>>0]>>16)-128;j=ot(x,h,j,t,n),K=ot(b,c,K,e,s),ht=ot(L,c,ht,e,s),ft+=32}pt+=8}if(_>=0){var vt=[];vt[1]=_+1,vt[0]=(1<<_+1)-1,Z(vt)}return tt(65497),new Uint8Array(p)},i=i||50,function(){for(var P=String.fromCharCode,H=0;H<256;H++)M[H]=P(H)}(),t=X(T,F),e=X(S,O),n=X(q,R),s=X(E,U),function(){for(var P=1,H=2,j=1;j<=15;j++){for(var K=P;K<H;K++)f[32767+K]=j,u[32767+K]=[],u[32767+K][1]=j,u[32767+K][0]=K;for(var ht=-(H-1);ht<=-P;ht++)f[32767+ht]=j,u[32767+ht]=[],u[32767+ht][1]=j,u[32767+ht][0]=H-1+ht;P<<=1,H<<=1}}(),function(){for(var P=0;P<256;P++)k[P]=19595*P,k[P+256>>0]=38470*P,k[P+512>>0]=7471*P+32768,k[P+768>>0]=-11059*P,k[P+1024>>0]=-21709*P,k[P+1280>>0]=32768*P+8421375,k[P+1536>>0]=-27439*P,k[P+1792>>0]=-5329*P}(),et(i)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function yr(i,t){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function ib(i){function t(T){if(!T)throw Error("assert :P")}function e(T,F,q){for(var R=0;4>R;R++)if(T[F+R]!=q.charCodeAt(R))return!0;return!1}function n(T,F,q,R,S){for(var O=0;O<S;O++)T[F+O]=q[R+O]}function s(T,F,q,R){for(var S=0;S<R;S++)T[F+S]=q}function r(T){return new Int32Array(T)}function o(T,F){for(var q=[],R=0;R<T;R++)q.push(new F);return q}function a(T,F){var q=[];return function R(S,O,E){for(var U=E[O],X=0;X<U&&(S.push(E.length>O+1?[]:new F),!(E.length<O+1));X++)R(S[X],O+1,E)}(q,0,T),q}var l=function(){var T=this;function F(m,v){for(var C=1<<v-1>>>0;m&C;)C>>>=1;return C?(m&C-1)+C:m}function q(m,v,C,I,D){t(!(I%C));do m[v+(I-=C)]=D;while(0<I)}function R(m,v,C,I,D){if(t(2328>=D),512>=D)var G=r(512);else if((G=r(D))==null)return 0;return function(W,V,$,Q,ut,wt){var St,yt,kt=V,Lt=1<<$,dt=r(16),mt=r(16);for(t(ut!=0),t(Q!=null),t(W!=null),t(0<$),yt=0;yt<ut;++yt){if(15<Q[yt])return 0;++dt[Q[yt]]}if(dt[0]==ut)return 0;for(mt[1]=0,St=1;15>St;++St){if(dt[St]>1<<St)return 0;mt[St+1]=mt[St]+dt[St]}for(yt=0;yt<ut;++yt)St=Q[yt],0<Q[yt]&&(wt[mt[St]++]=yt);if(mt[15]==1)return(Q=new S).g=0,Q.value=wt[0],q(W,kt,1,Lt,Q),Lt;var Rt,Ot=-1,Nt=Lt-1,Qt=0,Ht=1,ge=1,Yt=1<<$;for(yt=0,St=1,ut=2;St<=$;++St,ut<<=1){if(Ht+=ge<<=1,0>(ge-=dt[St]))return 0;for(;0<dt[St];--dt[St])(Q=new S).g=St,Q.value=wt[yt++],q(W,kt+Qt,ut,Yt,Q),Qt=F(Qt,St)}for(St=$+1,ut=2;15>=St;++St,ut<<=1){if(Ht+=ge<<=1,0>(ge-=dt[St]))return 0;for(;0<dt[St];--dt[St]){if(Q=new S,(Qt&Nt)!=Ot){for(kt+=Yt,Rt=1<<(Ot=St)-$;15>Ot&&!(0>=(Rt-=dt[Ot]));)++Ot,Rt<<=1;Lt+=Yt=1<<(Rt=Ot-$),W[V+(Ot=Qt&Nt)].g=Rt+$,W[V+Ot].value=kt-V-Ot}Q.g=St-$,Q.value=wt[yt++],q(W,kt+(Qt>>$),ut,Yt,Q),Qt=F(Qt,St)}}return Ht!=2*mt[15]-1?0:Lt}(m,v,C,I,D,G)}function S(){this.value=this.g=0}function O(){this.value=this.g=0}function E(){this.G=o(5,S),this.H=r(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ln,O)}function U(m,v,C,I){t(m!=null),t(v!=null),t(2147483648>I),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=v,m.pa=C,m.Jd=v,m.Yc=C+I,m.Zc=4<=I?C+I-4+1:C,ft(m)}function X(m,v){for(var C=0;0<v--;)C|=_t(m,128)<<v;return C}function Z(m,v){var C=X(m,v);return gt(m)?-C:C}function st(m,v,C,I){var D,G=0;for(t(m!=null),t(v!=null),t(4294967288>I),m.Sb=I,m.Ra=0,m.u=0,m.h=0,4<I&&(I=4),D=0;D<I;++D)G+=v[C+D]<<8*D;m.Ra=G,m.bb=I,m.oa=v,m.pa=C}function tt(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Ah-8>>>0,++m.bb,m.u-=8;j(m)&&(m.h=1,m.u=0)}function ot(m,v){if(t(0<=v),!m.h&&v<=Th){var C=H(m)&Mh[v];return m.u+=v,tt(m),C}return m.h=1,m.u=0}function et(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function P(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(m){return m.Ra>>>(m.u&Ah-1)>>>0}function j(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Ah}function K(m,v){m.u=v,m.h=j(m)}function ht(m){m.u>=Eu&&(t(m.u>=Eu),tt(m))}function ft(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function gt(m){return X(m,1)}function _t(m,v){var C=m.Ca;0>m.b&&ft(m);var I=m.b,D=C*v>>>8,G=(m.I>>>I>D)+0;for(G?(C-=D,m.I-=D+1<<I>>>0):C=D+1,I=C,D=0;256<=I;)D+=8,I>>=8;return I=7^D+ls[I],m.b-=I,m.Ca=(C<<I)-1,G}function Pt(m,v,C){m[v+0]=C>>24&255,m[v+1]=C>>16&255,m[v+2]=C>>8&255,m[v+3]=C>>0&255}function Tt(m,v){return m[v+0]<<0|m[v+1]<<8}function Wt(m,v){return Tt(m,v)|m[v+2]<<16}function Gt(m,v){return Tt(m,v)|Tt(m,v+2)<<16}function N(m,v){var C=1<<v;return t(m!=null),t(0<v),m.X=r(C),m.X==null?0:(m.Mb=32-v,m.Xa=v,1)}function rt(m,v){t(m!=null),t(v!=null),t(m.Xa==v.Xa),n(v.X,0,m.X,0,1<<v.Xa)}function z(){this.X=[],this.Xa=this.Mb=0}function J(m,v,C,I){t(C!=null),t(I!=null);var D=C[0],G=I[0];return D==0&&(D=(m*G+v/2)/v),G==0&&(G=(v*D+m/2)/m),0>=D||0>=G?0:(C[0]=D,I[0]=G,1)}function Y(m,v){return m+(1<<v)-1>>>v}function it(m,v){return((4278255360&m)+(4278255360&v)>>>0&4278255360)+((16711935&m)+(16711935&v)>>>0&16711935)>>>0}function pt(m,v){T[v]=function(C,I,D,G,W,V,$){var Q;for(Q=0;Q<W;++Q){var ut=T[m](V[$+Q-1],D,G+Q);V[$+Q]=it(C[I+Q],ut)}}}function vt(){this.ud=this.hd=this.jd=0}function at(m,v){return((4278124286&(m^v))>>>1)+(m&v)>>>0}function Et(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function It(m,v){return Et(m+(m-v+.5>>1))}function Ct(m,v,C){return Math.abs(v-C)-Math.abs(m-C)}function jt(m,v,C,I,D,G,W){for(I=G[W-1],C=0;C<D;++C)G[W+C]=I=it(m[v+C],I)}function ie(m,v,C,I,D){var G;for(G=0;G<C;++G){var W=m[v+G],V=W>>8&255,$=16711935&($=($=16711935&W)+((V<<16)+V));I[D+G]=(4278255360&W)+$>>>0}}function te(m,v){v.jd=m>>0&255,v.hd=m>>8&255,v.ud=m>>16&255}function ee(m,v,C,I,D,G){var W;for(W=0;W<I;++W){var V=v[C+W],$=V>>>8,Q=V,ut=255&(ut=(ut=V>>>16)+((m.jd<<24>>24)*($<<24>>24)>>>5));Q=255&(Q=(Q=Q+((m.hd<<24>>24)*($<<24>>24)>>>5))+((m.ud<<24>>24)*(ut<<24>>24)>>>5)),D[G+W]=(4278255360&V)+(ut<<16)+Q}}function be(m,v,C,I,D){T[v]=function(G,W,V,$,Q,ut,wt,St,yt){for($=wt;$<St;++$)for(wt=0;wt<yt;++wt)Q[ut++]=D(V[I(G[W++])])},T[m]=function(G,W,V,$,Q,ut,wt){var St=8>>G.b,yt=G.Ea,kt=G.K[0],Lt=G.w;if(8>St)for(G=(1<<G.b)-1,Lt=(1<<St)-1;W<V;++W){var dt,mt=0;for(dt=0;dt<yt;++dt)dt&G||(mt=I($[Q++])),ut[wt++]=D(kt[mt&Lt]),mt>>=St}else T["VP8LMapColor"+C]($,Q,kt,Lt,ut,wt,W,V,yt)}}function qt(m,v,C,I,D){for(C=v+C;v<C;){var G=m[v++];I[D++]=G>>16&255,I[D++]=G>>8&255,I[D++]=G>>0&255}}function bi(m,v,C,I,D){for(C=v+C;v<C;){var G=m[v++];I[D++]=G>>16&255,I[D++]=G>>8&255,I[D++]=G>>0&255,I[D++]=G>>24&255}}function he(m,v,C,I,D){for(C=v+C;v<C;){var G=(W=m[v++])>>16&240|W>>12&15,W=W>>0&240|W>>28&15;I[D++]=G,I[D++]=W}}function pn(m,v,C,I,D){for(C=v+C;v<C;){var G=(W=m[v++])>>16&248|W>>13&7,W=W>>5&224|W>>3&31;I[D++]=G,I[D++]=W}}function We(m,v,C,I,D){for(C=v+C;v<C;){var G=m[v++];I[D++]=G>>0&255,I[D++]=G>>8&255,I[D++]=G>>16&255}}function Re(m,v,C,I,D,G){if(G==0)for(C=v+C;v<C;)Pt(I,((G=m[v++])[0]>>24|G[1]>>8&65280|G[2]<<8&16711680|G[3]<<24)>>>0),D+=32;else n(I,D,m,v,C)}function Rn(m,v){T[v][0]=T[m+"0"],T[v][1]=T[m+"1"],T[v][2]=T[m+"2"],T[v][3]=T[m+"3"],T[v][4]=T[m+"4"],T[v][5]=T[m+"5"],T[v][6]=T[m+"6"],T[v][7]=T[m+"7"],T[v][8]=T[m+"8"],T[v][9]=T[m+"9"],T[v][10]=T[m+"10"],T[v][11]=T[m+"11"],T[v][12]=T[m+"12"],T[v][13]=T[m+"13"],T[v][14]=T[m+"0"],T[v][15]=T[m+"0"]}function Fe(m){return m==Xm||m==$m||m==pg||m==Km}function Vs(){this.eb=[],this.size=this.A=this.fb=0}function ci(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function tn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Vs,this.f.kb=new ci,this.sd=null}function ji(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function qe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _e(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Ve(m,v){var C=m.T,I=v.ba.f.RGBA,D=I.eb,G=I.fb+m.ka*I.A,W=Js[v.ba.S],V=m.y,$=m.O,Q=m.f,ut=m.N,wt=m.ea,St=m.W,yt=v.cc,kt=v.dc,Lt=v.Mc,dt=v.Nc,mt=m.ka,Rt=m.ka+m.T,Ot=m.U,Nt=Ot+1>>1;for(mt==0?W(V,$,null,null,Q,ut,wt,St,Q,ut,wt,St,D,G,null,null,Ot):(W(v.ec,v.fc,V,$,yt,kt,Lt,dt,Q,ut,wt,St,D,G-I.A,D,G,Ot),++C);mt+2<Rt;mt+=2)yt=Q,kt=ut,Lt=wt,dt=St,ut+=m.Rc,St+=m.Rc,G+=2*I.A,W(V,($+=2*m.fa)-m.fa,V,$,yt,kt,Lt,dt,Q,ut,wt,St,D,G-I.A,D,G,Ot);return $+=m.fa,m.j+Rt<m.o?(n(v.ec,v.fc,V,$,Ot),n(v.cc,v.dc,Q,ut,Nt),n(v.Mc,v.Nc,wt,St,Nt),C--):1&Rt||W(V,$,null,null,Q,ut,wt,St,Q,ut,wt,St,D,G+I.A,null,null,Ot),C}function en(m,v,C){var I=m.F,D=[m.J];if(I!=null){var G=m.U,W=v.ba.S,V=W==gg||W==pg;v=v.ba.f.RGBA;var $=[0],Q=m.ka;$[0]=m.T,m.Kb&&(Q==0?--$[0]:(--Q,D[0]-=m.width),m.j+m.ka+m.T==m.o&&($[0]=m.o-m.j-Q));var ut=v.eb;Q=v.fb+Q*v.A,m=_i(I,D[0],m.width,G,$,ut,Q+(V?0:3),v.A),t(C==$),m&&Fe(W)&&Ks(ut,Q,V,G,$,v.A)}return 0}function wi(m){var v=m.ma,C=v.ba.S,I=11>C,D=C==dg||C==fg||C==gg||C==Ym||C==12||Fe(C);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!wu(v.Oa,m,D?11:12))return 0;if(D&&Fe(C)&&Dt(),m.da)alert("todo:use_scaling");else{if(I){if(v.Ib=_e,m.Kb){if(C=m.U+1>>1,v.memory=r(m.U+2*C),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+m.U,v.Mc=v.cc,v.Nc=v.dc+C,v.Ib=Ve,Dt()}}else alert("todo:EmitYUV");D&&(v.Jb=en,I&&xt())}if(I&&!Wv){for(m=0;256>m;++m)Z3[m]=89858*(m-128)+_g>>mg,tM[m]=-22014*(m-128)+_g,Q3[m]=-45773*(m-128),J3[m]=113618*(m-128)+_g>>mg;for(m=Iu;m<Qm;++m)v=76283*(m-16)+_g>>mg,eM[m-Iu]=Is(v,255),iM[m-Iu]=Is(v+8>>4,15);Wv=1}return 1}function Ti(m){var v=m.ma,C=m.U,I=m.T;return t(!(1&m.ka)),0>=C||0>=I?0:(C=v.Ib(m,v),v.Jb!=null&&v.Jb(m,v,C),v.Dc+=C,1)}function zi(m){m.ma.memory=null}function se(m,v,C,I){return ot(m,8)!=47?0:(v[0]=ot(m,14)+1,C[0]=ot(m,14)+1,I[0]=ot(m,1),ot(m,3)!=0?0:!m.h)}function Gi(m,v){if(4>m)return m+1;var C=m-2>>1;return(2+(1&m)<<C)+ot(v,C)+1}function nn(m,v){return 120<v?v-120:1<=(C=((C=D3[v-1])>>4)*m+(8-(15&C)))?C:1;var C}function Ne(m,v,C){var I=H(C),D=m[v+=255&I].g-8;return 0<D&&(K(C,C.u+8),I=H(C),v+=m[v].value,v+=I&(1<<D)-1),K(C,C.u+m[v].g),m[v].value}function je(m,v,C){return C.g+=m.g,C.value+=m.value<<v>>>0,t(8>=C.g),m.g}function ti(m,v,C){var I=m.xc;return t((v=I==0?0:m.vc[m.md*(C>>I)+(v>>I)])<m.Wb),m.Ya[v]}function $n(m,v,C,I){var D=m.ab,G=m.c*v,W=m.C;v=W+v;var V=C,$=I;for(I=m.Ta,C=m.Ua;0<D--;){var Q=m.gc[D],ut=W,wt=v,St=V,yt=$,kt=($=I,V=C,Q.Ea);switch(t(ut<wt),t(wt<=Q.nc),Q.hc){case 2:rg(St,yt,(wt-ut)*kt,$,V);break;case 0:var Lt=ut,dt=wt,mt=$,Rt=V,Ot=(Yt=Q).Ea;Lt==0&&(Vm(St,yt,null,null,1,mt,Rt),jt(St,yt+1,0,0,Ot-1,mt,Rt+1),yt+=Ot,Rt+=Ot,++Lt);for(var Nt=1<<Yt.b,Qt=Nt-1,Ht=Y(Ot,Yt.b),ge=Yt.K,Yt=Yt.w+(Lt>>Yt.b)*Ht;Lt<dt;){var Ze=ge,oi=Yt,He=1;for(Cu(St,yt,mt,Rt-Ot,1,mt,Rt);He<Ot;){var Oe=(He&~Qt)+Nt;Oe>Ot&&(Oe=Ot),(0,ra[Ze[oi++]>>8&15])(St,yt+ +He,mt,Rt+He-Ot,Oe-He,mt,Rt+He),He=Oe}yt+=Ot,Rt+=Ot,++Lt&Qt||(Yt+=Ht)}wt!=Q.nc&&n($,V-kt,$,V+(wt-ut-1)*kt,kt);break;case 1:for(kt=St,dt=yt,Ot=(St=Q.Ea)-(Rt=St&~(mt=(yt=1<<Q.b)-1)),Lt=Y(St,Q.b),Nt=Q.K,Q=Q.w+(ut>>Q.b)*Lt;ut<wt;){for(Qt=Nt,Ht=Q,ge=new vt,Yt=dt+Rt,Ze=dt+St;dt<Yt;)te(Qt[Ht++],ge),hl(ge,kt,dt,yt,$,V),dt+=yt,V+=yt;dt<Ze&&(te(Qt[Ht++],ge),hl(ge,kt,dt,Ot,$,V),dt+=Ot,V+=Ot),++ut&mt||(Q+=Lt)}break;case 3:if(St==$&&yt==V&&0<Q.b){for(dt=$,St=kt=V+(wt-ut)*kt-(Rt=(wt-ut)*Y(Q.Ea,Q.b)),yt=$,mt=V,Lt=[],Rt=(Ot=Rt)-1;0<=Rt;--Rt)Lt[Rt]=yt[mt+Rt];for(Rt=Ot-1;0<=Rt;--Rt)dt[St+Rt]=Lt[Rt];Ys(Q,ut,wt,$,kt,$,V)}else Ys(Q,ut,wt,St,yt,$,V)}V=I,$=C}$!=C&&n(I,C,V,$,G)}function ch(m,v){var C=m.V,I=m.Ba+m.c*m.C,D=v-m.C;if(t(v<=m.l.o),t(16>=D),0<D){var G=m.l,W=m.Ta,V=m.Ua,$=G.width;if($n(m,D,C,I),D=V=[V],t((C=m.C)<(I=v)),t(G.v<G.va),I>G.o&&(I=G.o),C<G.j){var Q=G.j-C;C=G.j,D[0]+=Q*$}if(C>=I?C=0:(D[0]+=4*G.v,G.ka=C-G.j,G.U=G.va-G.v,G.T=I-C,C=1),C){if(V=V[0],11>(C=m.ca).S){var ut=C.f.RGBA,wt=(I=C.S,D=G.U,G=G.T,Q=ut.eb,ut.A),St=G;for(ut=ut.fb+m.Ma*ut.A;0<St--;){var yt=W,kt=V,Lt=D,dt=Q,mt=ut;switch(I){case ug:hs(yt,kt,Lt,dt,mt);break;case dg:Kn(yt,kt,Lt,dt,mt);break;case Xm:Kn(yt,kt,Lt,dt,mt),Ks(dt,mt,0,Lt,1,0);break;case Nv:vo(yt,kt,Lt,dt,mt);break;case fg:Re(yt,kt,Lt,dt,mt,1);break;case $m:Re(yt,kt,Lt,dt,mt,1),Ks(dt,mt,0,Lt,1,0);break;case gg:Re(yt,kt,Lt,dt,mt,0);break;case pg:Re(yt,kt,Lt,dt,mt,0),Ks(dt,mt,1,Lt,1,0);break;case Ym:oa(yt,kt,Lt,dt,mt);break;case Km:oa(yt,kt,Lt,dt,mt),mi(dt,mt,Lt,1,0);break;case kv:yo(yt,kt,Lt,dt,mt);break;default:t(0)}V+=$,ut+=wt}m.Ma+=G}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=C.height)}}m.C=v,t(m.C<=m.i)}function po(m){var v;if(0<m.ua)return 0;for(v=0;v<m.Wb;++v){var C=m.Ya[v].G,I=m.Ya[v].H;if(0<C[1][I[1]+0].g||0<C[2][I[2]+0].g||0<C[3][I[3]+0].g)return 0}return 1}function ar(m,v,C,I,D,G){if(m.Z!=0){var W=m.qd,V=m.rd;for(t(ca[m.Z]!=null);v<C;++v)ca[m.Z](W,V,I,D,I,D,G),W=I,V=D,D+=G;m.qd=W,m.rd=V}}function lr(m,v){var C=m.l.ma,I=C.Z==0||C.Z==1?m.l.j:m.C;if(I=m.C<I?I:m.C,t(v<=m.l.o),v>I){var D=m.l.width,G=C.ca,W=C.tb+D*I,V=m.V,$=m.Ba+m.c*I,Q=m.gc;t(m.ab==1),t(Q[0].hc==3),og(Q[0],I,v,V,$,G,W),ar(C,I,v,G,W,D)}m.C=m.Ma=v}function hr(m,v,C,I,D,G,W){var V=m.$/I,$=m.$%I,Q=m.m,ut=m.s,wt=C+m.$,St=wt;D=C+I*D;var yt=C+I*G,kt=280+ut.ua,Lt=m.Pb?V:16777216,dt=0<ut.ua?ut.Wa:null,mt=ut.wc,Rt=wt<yt?ti(ut,$,V):null;t(m.C<G),t(yt<=D);var Ot=!1;t:for(;;){for(;Ot||wt<yt;){var Nt=0;if(V>=Lt){var Qt=wt-C;t((Lt=m).Pb),Lt.wd=Lt.m,Lt.xd=Qt,0<Lt.s.ua&&rt(Lt.s.Wa,Lt.s.vb),Lt=V+j3}if($&mt||(Rt=ti(ut,$,V)),t(Rt!=null),Rt.Qb&&(v[wt]=Rt.qb,Ot=!0),!Ot)if(ht(Q),Rt.jc){Nt=Q,Qt=v;var Ht=wt,ge=Rt.pd[H(Nt)&Ln-1];t(Rt.jc),256>ge.g?(K(Nt,Nt.u+ge.g),Qt[Ht]=ge.value,Nt=0):(K(Nt,Nt.u+ge.g-256),t(256<=ge.value),Nt=ge.value),Nt==0&&(Ot=!0)}else Nt=Ne(Rt.G[0],Rt.H[0],Q);if(Q.h)break;if(Ot||256>Nt){if(!Ot)if(Rt.nd)v[wt]=(Rt.qb|Nt<<8)>>>0;else{if(ht(Q),Ot=Ne(Rt.G[1],Rt.H[1],Q),ht(Q),Qt=Ne(Rt.G[2],Rt.H[2],Q),Ht=Ne(Rt.G[3],Rt.H[3],Q),Q.h)break;v[wt]=(Ht<<24|Ot<<16|Nt<<8|Qt)>>>0}if(Ot=!1,++wt,++$>=I&&($=0,++V,W!=null&&V<=G&&!(V%16)&&W(m,V),dt!=null))for(;St<wt;)Nt=v[St++],dt.X[(506832829*Nt&4294967295)>>>dt.Mb]=Nt}else if(280>Nt){if(Nt=Gi(Nt-256,Q),Qt=Ne(Rt.G[4],Rt.H[4],Q),ht(Q),Qt=nn(I,Qt=Gi(Qt,Q)),Q.h)break;if(wt-C<Qt||D-wt<Nt)break t;for(Ht=0;Ht<Nt;++Ht)v[wt+Ht]=v[wt+Ht-Qt];for(wt+=Nt,$+=Nt;$>=I;)$-=I,++V,W!=null&&V<=G&&!(V%16)&&W(m,V);if(t(wt<=D),$&mt&&(Rt=ti(ut,$,V)),dt!=null)for(;St<wt;)Nt=v[St++],dt.X[(506832829*Nt&4294967295)>>>dt.Mb]=Nt}else{if(!(Nt<kt))break t;for(Ot=Nt-280,t(dt!=null);St<wt;)Nt=v[St++],dt.X[(506832829*Nt&4294967295)>>>dt.Mb]=Nt;Nt=wt,t(!(Ot>>>(Qt=dt).Xa)),v[Nt]=Qt.X[Ot],Ot=!0}Ot||t(Q.h==j(Q))}if(m.Pb&&Q.h&&wt<D)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&rt(m.s.vb,m.s.Wa);else{if(Q.h)break t;W!=null&&W(m,V>G?G:V),m.a=0,m.$=wt-C}return 1}return m.a=3,0}function Dr(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var v=m.Wa;v!=null&&(v.X=null),m.vb=null,t(m!=null)}function Hs(){var m=new qm;return m==null?null:(m.a=0,m.xb=Dv,Rn("Predictor","VP8LPredictors"),Rn("Predictor","VP8LPredictors_C"),Rn("PredictorAdd","VP8LPredictorsAdd"),Rn("PredictorAdd","VP8LPredictorsAdd_C"),rg=ie,hl=ee,hs=qt,Kn=bi,oa=he,yo=pn,vo=We,T.VP8LMapColor32b=Ph,T.VP8LMapColor8b=ag,m)}function Br(m,v,C,I,D){var G=1,W=[m],V=[v],$=I.m,Q=I.s,ut=null,wt=0;t:for(;;){if(C)for(;G&&ot($,1);){var St=W,yt=V,kt=I,Lt=1,dt=kt.m,mt=kt.gc[kt.ab],Rt=ot(dt,2);if(kt.Oc&1<<Rt)G=0;else{switch(kt.Oc|=1<<Rt,mt.hc=Rt,mt.Ea=St[0],mt.nc=yt[0],mt.K=[null],++kt.ab,t(4>=kt.ab),Rt){case 0:case 1:mt.b=ot(dt,3)+2,Lt=Br(Y(mt.Ea,mt.b),Y(mt.nc,mt.b),0,kt,mt.K),mt.K=mt.K[0];break;case 3:var Ot,Nt=ot(dt,8)+1,Qt=16<Nt?0:4<Nt?1:2<Nt?2:3;if(St[0]=Y(mt.Ea,Qt),mt.b=Qt,Ot=Lt=Br(Nt,1,0,kt,mt.K)){var Ht,ge=Nt,Yt=mt,Ze=1<<(8>>Yt.b),oi=r(Ze);if(oi==null)Ot=0;else{var He=Yt.K[0],Oe=Yt.w;for(oi[0]=Yt.K[0][0],Ht=1;Ht<1*ge;++Ht)oi[Ht]=it(He[Oe+Ht],oi[Ht-1]);for(;Ht<4*Ze;++Ht)oi[Ht]=0;Yt.K[0]=null,Yt.K[0]=oi,Ot=1}}Lt=Ot;break;case 2:break;default:t(0)}G=Lt}}if(W=W[0],V=V[0],G&&ot($,1)&&!(G=1<=(wt=ot($,4))&&11>=wt)){I.a=3;break t}var di;if(di=G)e:{var ui,Me,rn,cs=I,on=W,us=V,ai=wt,Ns=C,ks=cs.m,_n=cs.s,Mn=[null],Jn=1,Qs=0,Ur=B3[ai];i:for(;;){if(Ns&&ot(ks,1)){var yn=ot(ks,3)+2,So=Y(on,yn),gl=Y(us,yn),Fh=So*gl;if(!Br(So,gl,0,cs,Mn))break i;for(Mn=Mn[0],_n.xc=yn,ui=0;ui<Fh;++ui){var ua=Mn[ui]>>8&65535;Mn[ui]=ua,ua>=Jn&&(Jn=ua+1)}}if(ks.h)break i;for(Me=0;5>Me;++Me){var ki=Fv[Me];!Me&&0<ai&&(ki+=1<<ai),Qs<ki&&(Qs=ki)}var t1=o(Jn*Ur,S),Hv=Jn,Yv=o(Hv,E);if(Yv==null)var vg=null;else t(65536>=Hv),vg=Yv;var Ru=r(Qs);if(vg==null||Ru==null||t1==null){cs.a=1;break i}var xg=t1;for(ui=rn=0;ui<Jn;++ui){var gr=vg[ui],Oh=gr.G,Dh=gr.H,Xv=0,bg=1,$v=0;for(Me=0;5>Me;++Me){ki=Fv[Me],Oh[Me]=xg,Dh[Me]=rn,!Me&&0<ai&&(ki+=1<<ai);s:{var wg,e1=ki,Sg=cs,Nu=Ru,rM=xg,oM=rn,i1=0,da=Sg.m,aM=ot(da,1);if(s(Nu,0,0,e1),aM){var lM=ot(da,1)+1,hM=ot(da,1),Kv=ot(da,hM==0?1:8);Nu[Kv]=1,lM==2&&(Nu[Kv=ot(da,8)]=1);var Eg=1}else{var Zv=r(19),Jv=ot(da,4)+4;if(19<Jv){Sg.a=3;var Cg=0;break s}for(wg=0;wg<Jv;++wg)Zv[O3[wg]]=ot(da,3);var n1=void 0,ku=void 0,Qv=Sg,cM=Zv,Lg=e1,tx=Nu,s1=0,fa=Qv.m,ex=8,ix=o(128,S);n:for(;R(ix,0,7,cM,19);){if(ot(fa,1)){var uM=2+2*ot(fa,3);if((n1=2+ot(fa,uM))>Lg)break n}else n1=Lg;for(ku=0;ku<Lg&&n1--;){ht(fa);var nx=ix[0+(127&H(fa))];K(fa,fa.u+nx.g);var Bh=nx.value;if(16>Bh)tx[ku++]=Bh,Bh!=0&&(ex=Bh);else{var dM=Bh==16,sx=Bh-16,fM=k3[sx],rx=ot(fa,N3[sx])+fM;if(ku+rx>Lg)break n;for(var gM=dM?ex:0;0<rx--;)tx[ku++]=gM}}s1=1;break n}s1||(Qv.a=3),Eg=s1}(Eg=Eg&&!da.h)&&(i1=R(rM,oM,8,Nu,e1)),Eg&&i1!=0?Cg=i1:(Sg.a=3,Cg=0)}if(Cg==0)break i;if(bg&&F3[Me]==1&&(bg=xg[rn].g==0),Xv+=xg[rn].g,rn+=Cg,3>=Me){var Fu,r1=Ru[0];for(Fu=1;Fu<ki;++Fu)Ru[Fu]>r1&&(r1=Ru[Fu]);$v+=r1}}if(gr.nd=bg,gr.Qb=0,bg&&(gr.qb=(Oh[3][Dh[3]+0].value<<24|Oh[1][Dh[1]+0].value<<16|Oh[2][Dh[2]+0].value)>>>0,Xv==0&&256>Oh[0][Dh[0]+0].value&&(gr.Qb=1,gr.qb+=Oh[0][Dh[0]+0].value<<8)),gr.jc=!gr.Qb&&6>$v,gr.jc){var Mg,Eo=gr;for(Mg=0;Mg<Ln;++Mg){var ga=Mg,pa=Eo.pd[ga],Tg=Eo.G[0][Eo.H[0]+ga];256<=Tg.value?(pa.g=Tg.g+256,pa.value=Tg.value):(pa.g=0,pa.value=0,ga>>=je(Tg,8,pa),ga>>=je(Eo.G[1][Eo.H[1]+ga],16,pa),ga>>=je(Eo.G[2][Eo.H[2]+ga],0,pa),je(Eo.G[3][Eo.H[3]+ga],24,pa))}}}_n.vc=Mn,_n.Wb=Jn,_n.Ya=vg,_n.yc=t1,di=1;break e}di=0}if(!(G=di)){I.a=3;break t}if(0<wt){if(Q.ua=1<<wt,!N(Q.Wa,wt)){I.a=1,G=0;break t}}else Q.ua=0;var o1=I,ox=W,pM=V,a1=o1.s,l1=a1.xc;if(o1.c=ox,o1.i=pM,a1.md=Y(ox,l1),a1.wc=l1==0?-1:(1<<l1)-1,C){I.xb=H3;break t}if((ut=r(W*V))==null){I.a=1,G=0;break t}G=(G=hr(I,ut,0,W,V,V,null))&&!$.h;break t}return G?(D!=null?D[0]=ut:(t(ut==null),t(C)),I.$=0,C||Dr(Q)):Dr(Q),G}function sl(m,v){var C=m.c*m.i,I=C+v+16*v;return t(m.c<=v),m.V=r(I),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+C+v,1)}function uh(m,v){var C=m.C,I=v-C,D=m.V,G=m.Ba+m.c*C;for(t(v<=m.l.o);0<I;){var W=16<I?16:I,V=m.l.ma,$=m.l.width,Q=$*W,ut=V.ca,wt=V.tb+$*C,St=m.Ta,yt=m.Ua;$n(m,W,D,G),qi(St,yt,ut,wt,Q),ar(V,C,C+W,ut,wt,$),I-=W,D+=W*m.c,C+=W}t(C==v),m.C=m.Ma=v}function dh(){this.ub=this.yd=this.td=this.Rb=0}function fh(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gh(){this.Fb=this.Bb=this.Cb=0,this.Zb=r(4),this.Lb=r(4)}function jf(){this.Yb=function(){var m=[];return function v(C,I,D){for(var G=D[I],W=0;W<G&&(C.push(D.length>I+1?[]:0),!(D.length<I+1));W++)v(C[W],I+1,D)}(m,0,[3,11]),m}()}function bm(){this.jb=r(3),this.Wc=a([4,8],jf),this.Xc=a([4,17],jf)}function wm(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new r(4),this.od=new r(4)}function ph(){this.ld=this.La=this.dd=this.tc=0}function zf(){this.Na=this.la=0}function Sm(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ou(){this.ad=r(384),this.Za=0,this.Ob=r(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Em(){this.uc=this.M=this.Nb=0,this.wa=Array(new ph),this.Y=0,this.ya=Array(new ou),this.aa=0,this.l=new mh}function Gf(){this.y=r(16),this.f=r(8),this.ea=r(8)}function Cm(){this.cb=this.a=0,this.sc="",this.m=new et,this.Od=new dh,this.Kc=new fh,this.ed=new wm,this.Qa=new gh,this.Ic=this.$c=this.Aa=0,this.D=new Em,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,et),this.ia=0,this.pb=o(4,Sm),this.Pa=new bm,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gf),this.Hd=0,this.rb=Array(new zf),this.sb=0,this.wa=Array(new ph),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ou),this.L=this.aa=0,this.gd=a([4,2],ph),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function mh(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Lm(){var m=new Cm;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Pu||(Pu=qf)),m}function Ui(m,v,C){return m.a==0&&(m.a=v,m.sc=C,m.cb=0),0}function Uf(m,v,C){return 3<=C&&m[v+0]==157&&m[v+1]==1&&m[v+2]==42}function Wf(m,v){if(m==null)return 0;if(m.a=0,m.sc="OK",v==null)return Ui(m,2,"null VP8Io passed to VP8GetHeaders()");var C=v.data,I=v.w,D=v.ha;if(4>D)return Ui(m,7,"Truncated header.");var G=C[I+0]|C[I+1]<<8|C[I+2]<<16,W=m.Od;if(W.Rb=!(1&G),W.td=G>>1&7,W.yd=G>>4&1,W.ub=G>>5,3<W.td)return Ui(m,3,"Incorrect keyframe parameters.");if(!W.yd)return Ui(m,4,"Frame not displayable.");I+=3,D-=3;var V=m.Kc;if(W.Rb){if(7>D)return Ui(m,7,"cannot parse picture header");if(!Uf(C,I,D))return Ui(m,3,"Bad code word");V.c=16383&(C[I+4]<<8|C[I+3]),V.Td=C[I+4]>>6,V.i=16383&(C[I+6]<<8|C[I+5]),V.Ud=C[I+6]>>6,I+=7,D-=7,m.za=V.c+15>>4,m.Ub=V.i+15>>4,v.width=V.c,v.height=V.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,s((G=m.Pa).jb,0,255,G.jb.length),t((G=m.Qa)!=null),G.Cb=0,G.Bb=0,G.Fb=1,s(G.Zb,0,0,G.Zb.length),s(G.Lb,0,0,G.Lb)}if(W.ub>D)return Ui(m,7,"bad partition length");U(G=m.m,C,I,W.ub),I+=W.ub,D-=W.ub,W.Rb&&(V.Ld=gt(G),V.Kd=gt(G)),V=m.Qa;var $,Q=m.Pa;if(t(G!=null),t(V!=null),V.Cb=gt(G),V.Cb){if(V.Bb=gt(G),gt(G)){for(V.Fb=gt(G),$=0;4>$;++$)V.Zb[$]=gt(G)?Z(G,7):0;for($=0;4>$;++$)V.Lb[$]=gt(G)?Z(G,6):0}if(V.Bb)for($=0;3>$;++$)Q.jb[$]=gt(G)?X(G,8):255}else V.Bb=0;if(G.Ka)return Ui(m,3,"cannot parse segment header");if((V=m.ed).zd=gt(G),V.Tb=X(G,6),V.wb=X(G,3),V.Pc=gt(G),V.Pc&&gt(G)){for(Q=0;4>Q;++Q)gt(G)&&(V.vd[Q]=Z(G,6));for(Q=0;4>Q;++Q)gt(G)&&(V.od[Q]=Z(G,6))}if(m.L=V.Tb==0?0:V.zd?1:2,G.Ka)return Ui(m,3,"cannot parse filter header");var ut=D;if(D=$=I,I=$+ut,V=ut,m.Xb=(1<<X(m.m,2))-1,ut<3*(Q=m.Xb))C=7;else{for($+=3*Q,V-=3*Q,ut=0;ut<Q;++ut){var wt=C[D+0]|C[D+1]<<8|C[D+2]<<16;wt>V&&(wt=V),U(m.Jc[+ut],C,$,wt),$+=wt,V-=wt,D+=3}U(m.Jc[+Q],C,$,V),C=$<I?0:5}if(C!=0)return Ui(m,C,"cannot parse partitions");for(C=X($=m.m,7),D=gt($)?Z($,4):0,I=gt($)?Z($,4):0,V=gt($)?Z($,4):0,Q=gt($)?Z($,4):0,$=gt($)?Z($,4):0,ut=m.Qa,wt=0;4>wt;++wt){if(ut.Cb){var St=ut.Zb[wt];ut.Fb||(St+=C)}else{if(0<wt){m.pb[wt]=m.pb[0];continue}St=C}var yt=m.pb[wt];yt.Sc[0]=Zm[Is(St+D,127)],yt.Sc[1]=Jm[Is(St+0,127)],yt.Eb[0]=2*Zm[Is(St+I,127)],yt.Eb[1]=101581*Jm[Is(St+V,127)]>>16,8>yt.Eb[1]&&(yt.Eb[1]=8),yt.Qc[0]=Zm[Is(St+Q,117)],yt.Qc[1]=Jm[Is(St+$,127)],yt.lc=St+$}if(!W.Rb)return Ui(m,4,"Not a key frame.");for(gt(G),W=m.Pa,C=0;4>C;++C){for(D=0;8>D;++D)for(I=0;3>I;++I)for(V=0;11>V;++V)Q=_t(G,q3[C][D][I][V])?X(G,8):U3[C][D][I][V],W.Wc[C][D].Yb[I][V]=Q;for(D=0;17>D;++D)W.Xc[C][D]=W.Wc[C][V3[D]]}return m.kc=gt(G),m.kc&&(m.Bd=X(G,8)),m.cb=1}function qf(m,v,C,I,D,G,W){var V=v[D].Yb[C];for(C=0;16>D;++D){if(!_t(m,V[C+0]))return D;for(;!_t(m,V[C+1]);)if(V=v[++D].Yb[0],C=0,D==16)return 16;var $=v[D+1].Yb;if(_t(m,V[C+2])){var Q=m,ut=0;if(_t(Q,(St=V)[(wt=C)+3]))if(_t(Q,St[wt+6])){for(V=0,wt=2*(ut=_t(Q,St[wt+8]))+(St=_t(Q,St[wt+9+ut])),ut=0,St=z3[wt];St[V];++V)ut+=ut+_t(Q,St[V]);ut+=3+(8<<wt)}else _t(Q,St[wt+7])?(ut=7+2*_t(Q,165),ut+=_t(Q,145)):ut=5+_t(Q,159);else ut=_t(Q,St[wt+4])?3+_t(Q,St[wt+5]):2;V=$[2]}else ut=1,V=$[1];$=W+G3[D],0>(Q=m).b&&ft(Q);var wt,St=Q.b,yt=(wt=Q.Ca>>1)-(Q.I>>St)>>31;--Q.b,Q.Ca+=yt,Q.Ca|=1,Q.I-=(wt+1&yt)<<St,G[$]=((ut^yt)-yt)*I[(0<D)+0]}return 16}function au(m){var v=m.rb[m.sb-1];v.la=0,v.Na=0,s(m.zc,0,0,m.zc.length),m.ja=0}function Mm(m,v){if(m==null)return 0;if(v==null)return Ui(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!Wf(m,v))return 0;if(t(m.cb),v.ac==null||v.ac(v)){v.ob&&(m.L=0);var C=yg[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=v.v-C>>4,m.zb=v.j-C>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=v.o+15+C>>4,m.Hb=v.va+15+C>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var I=m.ed;for(C=0;4>C;++C){var D;if(m.Qa.Cb){var G=m.Qa.Lb[C];m.Qa.Fb||(G+=I.Tb)}else G=I.Tb;for(D=0;1>=D;++D){var W=m.gd[C][D],V=G;if(I.Pc&&(V+=I.vd[0],D&&(V+=I.od[0])),0<(V=0>V?0:63<V?63:V)){var $=V;0<I.wb&&($=4<I.wb?$>>2:$>>1)>9-I.wb&&($=9-I.wb),1>$&&($=1),W.dd=$,W.tc=2*V+$,W.ld=40<=V?2:15<=V?1:0}else W.tc=0;W.La=D}}}C=0}else Ui(m,6,"Frame setup failed"),C=m.a;if(C=C==0){if(C){m.$c=0,0<m.Aa||(m.Ic=sM);t:{C=m.Ic,I=4*($=m.za);var Q=32*$,ut=$+1,wt=0<m.L?$*(0<m.Aa?2:1):0,St=(m.Aa==2?2:1)*$;if((W=I+832+(D=3*(16*C+yg[m.L])/2*Q)+(G=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=W)C=0;else{if(W>m.Vb){if(m.Vb=0,m.Ec=r(W),m.Fc=0,m.Ec==null){C=Ui(m,1,"no memory during frame initialization.");break t}m.Vb=W}W=m.Ec,V=m.Fc,m.Ac=W,m.Bc=V,V+=I,m.Gd=o(Q,Gf),m.Hd=0,m.rb=o(ut+1,zf),m.sb=1,m.wa=wt?o(wt,ph):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=$),t(!0),m.oc=W,m.pc=V,V+=832,m.ya=o(St,ou),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=$),m.R=16*$,m.B=8*$,$=(Q=yg[m.L])*m.R,Q=Q/2*m.B,m.sa=W,m.ta=V+$,m.qa=m.sa,m.ra=m.ta+16*C*m.R+Q,m.Ha=m.qa,m.Ia=m.ra+8*C*m.B+Q,m.$c=0,V+=D,m.mb=G?W:null,m.nb=G?V:null,t(V+G<=m.Fc+m.Vb),au(m),s(m.Ac,m.Bc,0,I),C=1}}if(C){if(v.ka=0,v.y=m.sa,v.O=m.ta,v.f=m.qa,v.N=m.ra,v.ea=m.Ha,v.Vd=m.Ia,v.fa=m.R,v.Rc=m.B,v.F=null,v.J=0,!hg){for(C=-255;255>=C;++C)un[255+C]=0>C?-C:C;for(C=-1020;1020>=C;++C)bo[1020+C]=-128>C?-128:127<C?127:C;for(C=-112;112>=C;++C)Au[112+C]=-16>C?-16:15<C?15:C;for(C=-255;510>=C;++C)kh[255+C]=0>C?0:255<C?255:C;hg=1}Ih=Pm,xo=Tm,Lu=Hf,Zn=Am,Xs=Yf,Wi=Vf,Rh=fu,lg=al,Mu=Wm,cl=gu,ul=Um,aa=wh,dl=pu,Nh=ig,fl=eg,la=zr,Tu=_o,$s=Gm,fr[0]=jr,fr[1]=Im,fr[2]=Fm,fr[3]=Om,fr[4]=Kf,fr[5]=xh,fr[6]=Zf,fr[7]=cu,fr[8]=Bm,fr[9]=Dm,ha[0]=Xf,ha[1]=Nm,ha[2]=mo,ha[3]=yh,ha[4]=Nn,ha[5]=km,ha[6]=$f,wo[0]=ia,wo[1]=Rm,wo[2]=jm,wo[3]=uu,wo[4]=ol,wo[5]=zm,wo[6]=du,C=1}else C=0}C&&(C=function(yt,kt){for(yt.M=0;yt.M<yt.Va;++yt.M){var Lt,dt=yt.Jc[yt.M&yt.Xb],mt=yt.m,Rt=yt;for(Lt=0;Lt<Rt.za;++Lt){var Ot=mt,Nt=Rt,Qt=Nt.Ac,Ht=Nt.Bc+4*Lt,ge=Nt.zc,Yt=Nt.ya[Nt.aa+Lt];if(Nt.Qa.Bb?Yt.$b=_t(Ot,Nt.Pa.jb[0])?2+_t(Ot,Nt.Pa.jb[2]):_t(Ot,Nt.Pa.jb[1]):Yt.$b=0,Nt.kc&&(Yt.Ad=_t(Ot,Nt.Bd)),Yt.Za=!_t(Ot,145)+0,Yt.Za){var Ze=Yt.Ob,oi=0;for(Nt=0;4>Nt;++Nt){var He,Oe=ge[0+Nt];for(He=0;4>He;++He){Oe=W3[Qt[Ht+He]][Oe];for(var di=Ov[_t(Ot,Oe[0])];0<di;)di=Ov[2*di+_t(Ot,Oe[di])];Oe=-di,Qt[Ht+He]=Oe}n(Ze,oi,Qt,Ht,4),oi+=4,ge[0+Nt]=Oe}}else Oe=_t(Ot,156)?_t(Ot,128)?1:3:_t(Ot,163)?2:0,Yt.Ob[0]=Oe,s(Qt,Ht,Oe,4),s(ge,0,Oe,4);Yt.Dd=_t(Ot,142)?_t(Ot,114)?_t(Ot,183)?1:3:2:0}if(Rt.m.Ka)return Ui(yt,7,"Premature end-of-partition0 encountered.");for(;yt.ja<yt.za;++yt.ja){if(Rt=dt,Ot=(mt=yt).rb[mt.sb-1],Qt=mt.rb[mt.sb+mt.ja],Lt=mt.ya[mt.aa+mt.ja],Ht=mt.kc?Lt.Ad:0)Ot.la=Qt.la=0,Lt.Za||(Ot.Na=Qt.Na=0),Lt.Hc=0,Lt.Gc=0,Lt.ia=0;else{var ui,Me;if(Ot=Qt,Qt=Rt,Ht=mt.Pa.Xc,ge=mt.ya[mt.aa+mt.ja],Yt=mt.pb[ge.$b],Nt=ge.ad,Ze=0,oi=mt.rb[mt.sb-1],Oe=He=0,s(Nt,Ze,0,384),ge.Za)var rn=0,cs=Ht[3];else{di=r(16);var on=Ot.Na+oi.Na;if(on=Pu(Qt,Ht[1],on,Yt.Eb,0,di,0),Ot.Na=oi.Na=(0<on)+0,1<on)Ih(di,0,Nt,Ze);else{var us=di[0]+3>>3;for(di=0;256>di;di+=16)Nt[Ze+di]=us}rn=1,cs=Ht[0]}var ai=15&Ot.la,Ns=15&oi.la;for(di=0;4>di;++di){var ks=1&Ns;for(us=Me=0;4>us;++us)ai=ai>>1|(ks=(on=Pu(Qt,cs,on=ks+(1&ai),Yt.Sc,rn,Nt,Ze))>rn)<<7,Me=Me<<2|(3<on?3:1<on?2:Nt[Ze+0]!=0),Ze+=16;ai>>=4,Ns=Ns>>1|ks<<7,He=(He<<8|Me)>>>0}for(cs=ai,rn=Ns>>4,ui=0;4>ui;ui+=2){for(Me=0,ai=Ot.la>>4+ui,Ns=oi.la>>4+ui,di=0;2>di;++di){for(ks=1&Ns,us=0;2>us;++us)on=ks+(1&ai),ai=ai>>1|(ks=0<(on=Pu(Qt,Ht[2],on,Yt.Qc,0,Nt,Ze)))<<3,Me=Me<<2|(3<on?3:1<on?2:Nt[Ze+0]!=0),Ze+=16;ai>>=2,Ns=Ns>>1|ks<<5}Oe|=Me<<4*ui,cs|=ai<<4<<ui,rn|=(240&Ns)<<ui}Ot.la=cs,oi.la=rn,ge.Hc=He,ge.Gc=Oe,ge.ia=43690&Oe?0:Yt.ia,Ht=!(He|Oe)}if(0<mt.L&&(mt.wa[mt.Y+mt.ja]=mt.gd[Lt.$b][Lt.Za],mt.wa[mt.Y+mt.ja].La|=!Ht),Rt.Ka)return Ui(yt,7,"Premature end-of-file encountered.")}if(au(yt),mt=kt,Rt=1,Lt=(dt=yt).D,Ot=0<dt.L&&dt.M>=dt.zb&&dt.M<=dt.Va,dt.Aa==0)t:{if(Lt.M=dt.M,Lt.uc=Ot,bu(dt,Lt),Rt=1,Lt=(Me=dt.D).Nb,Ot=(Oe=yg[dt.L])*dt.R,Qt=Oe/2*dt.B,di=16*Lt*dt.R,us=8*Lt*dt.B,Ht=dt.sa,ge=dt.ta-Ot+di,Yt=dt.qa,Nt=dt.ra-Qt+us,Ze=dt.Ha,oi=dt.Ia-Qt+us,Ns=(ai=Me.M)==0,He=ai>=dt.Va-1,dt.Aa==2&&bu(dt,Me),Me.uc)for(ks=(on=dt).D.M,t(on.D.uc),Me=on.yb;Me<on.Hb;++Me){rn=Me,cs=ks;var _n=(Mn=(ki=on).D).Nb;ui=ki.R;var Mn=Mn.wa[Mn.Y+rn],Jn=ki.sa,Qs=ki.ta+16*_n*ui+16*rn,Ur=Mn.dd,yn=Mn.tc;if(yn!=0)if(t(3<=yn),ki.L==1)0<rn&&la(Jn,Qs,ui,yn+4),Mn.La&&$s(Jn,Qs,ui,yn),0<cs&&fl(Jn,Qs,ui,yn+4),Mn.La&&Tu(Jn,Qs,ui,yn);else{var So=ki.B,gl=ki.qa,Fh=ki.ra+8*_n*So+8*rn,ua=ki.Ha,ki=ki.Ia+8*_n*So+8*rn;_n=Mn.ld,0<rn&&(lg(Jn,Qs,ui,yn+4,Ur,_n),cl(gl,Fh,ua,ki,So,yn+4,Ur,_n)),Mn.La&&(aa(Jn,Qs,ui,yn,Ur,_n),Nh(gl,Fh,ua,ki,So,yn,Ur,_n)),0<cs&&(Rh(Jn,Qs,ui,yn+4,Ur,_n),Mu(gl,Fh,ua,ki,So,yn+4,Ur,_n)),Mn.La&&(ul(Jn,Qs,ui,yn,Ur,_n),dl(gl,Fh,ua,ki,So,yn,Ur,_n))}}if(dt.ia&&alert("todo:DitherRow"),mt.put!=null){if(Me=16*ai,ai=16*(ai+1),Ns?(mt.y=dt.sa,mt.O=dt.ta+di,mt.f=dt.qa,mt.N=dt.ra+us,mt.ea=dt.Ha,mt.W=dt.Ia+us):(Me-=Oe,mt.y=Ht,mt.O=ge,mt.f=Yt,mt.N=Nt,mt.ea=Ze,mt.W=oi),He||(ai-=Oe),ai>mt.o&&(ai=mt.o),mt.F=null,mt.J=null,dt.Fa!=null&&0<dt.Fa.length&&Me<ai&&(mt.J=vu(dt,mt,Me,ai-Me),mt.F=dt.mb,mt.F==null&&mt.F.length==0)){Rt=Ui(dt,3,"Could not decode alpha data.");break t}Me<mt.j&&(Oe=mt.j-Me,Me=mt.j,t(!(1&Oe)),mt.O+=dt.R*Oe,mt.N+=dt.B*(Oe>>1),mt.W+=dt.B*(Oe>>1),mt.F!=null&&(mt.J+=mt.width*Oe)),Me<ai&&(mt.O+=mt.v,mt.N+=mt.v>>1,mt.W+=mt.v>>1,mt.F!=null&&(mt.J+=mt.v),mt.ka=Me-mt.j,mt.U=mt.va-mt.v,mt.T=ai-Me,Rt=mt.put(mt))}Lt+1!=dt.Ic||He||(n(dt.sa,dt.ta-Ot,Ht,ge+16*dt.R,Ot),n(dt.qa,dt.ra-Qt,Yt,Nt+8*dt.B,Qt),n(dt.Ha,dt.Ia-Qt,Ze,oi+8*dt.B,Qt))}if(!Rt)return Ui(yt,6,"Output aborted.")}return 1}(m,v)),v.bc!=null&&v.bc(v),C&=1}return C?(m.cb=0,C):0}function cr(m,v,C,I,D){D=m[v+C+32*I]+(D>>3),m[v+C+32*I]=-256&D?0>D?0:255:D}function _h(m,v,C,I,D,G){cr(m,v,0,C,I+D),cr(m,v,1,C,I+G),cr(m,v,2,C,I-G),cr(m,v,3,C,I-D)}function as(m){return(20091*m>>16)+m}function lu(m,v,C,I){var D,G=0,W=r(16);for(D=0;4>D;++D){var V=m[v+0]+m[v+8],$=m[v+0]-m[v+8],Q=(35468*m[v+4]>>16)-as(m[v+12]),ut=as(m[v+4])+(35468*m[v+12]>>16);W[G+0]=V+ut,W[G+1]=$+Q,W[G+2]=$-Q,W[G+3]=V-ut,G+=4,v++}for(D=G=0;4>D;++D)V=(m=W[G+0]+4)+W[G+8],$=m-W[G+8],Q=(35468*W[G+4]>>16)-as(W[G+12]),cr(C,I,0,0,V+(ut=as(W[G+4])+(35468*W[G+12]>>16))),cr(C,I,1,0,$+Q),cr(C,I,2,0,$-Q),cr(C,I,3,0,V-ut),G++,I+=32}function Vf(m,v,C,I){var D=m[v+0]+4,G=35468*m[v+4]>>16,W=as(m[v+4]),V=35468*m[v+1]>>16;_h(C,I,0,D+W,m=as(m[v+1]),V),_h(C,I,1,D+G,m,V),_h(C,I,2,D-G,m,V),_h(C,I,3,D-W,m,V)}function Tm(m,v,C,I,D){lu(m,v,C,I),D&&lu(m,v+16,C,I+4)}function Hf(m,v,C,I){xo(m,v+0,C,I,1),xo(m,v+32,C,I+128,1)}function Am(m,v,C,I){var D;for(m=m[v+0]+4,D=0;4>D;++D)for(v=0;4>v;++v)cr(C,I,v,D,m)}function Yf(m,v,C,I){m[v+0]&&Zn(m,v+0,C,I),m[v+16]&&Zn(m,v+16,C,I+4),m[v+32]&&Zn(m,v+32,C,I+128),m[v+48]&&Zn(m,v+48,C,I+128+4)}function Pm(m,v,C,I){var D,G=r(16);for(D=0;4>D;++D){var W=m[v+0+D]+m[v+12+D],V=m[v+4+D]+m[v+8+D],$=m[v+4+D]-m[v+8+D],Q=m[v+0+D]-m[v+12+D];G[0+D]=W+V,G[8+D]=W-V,G[4+D]=Q+$,G[12+D]=Q-$}for(D=0;4>D;++D)W=(m=G[0+4*D]+3)+G[3+4*D],V=G[1+4*D]+G[2+4*D],$=G[1+4*D]-G[2+4*D],Q=m-G[3+4*D],C[I+0]=W+V>>3,C[I+16]=Q+$>>3,C[I+32]=W-V>>3,C[I+48]=Q-$>>3,I+=64}function hu(m,v,C){var I,D=v-32,G=Rs,W=255-m[D-1];for(I=0;I<C;++I){var V,$=G,Q=W+m[v-1];for(V=0;V<C;++V)m[v+V]=$[Q+m[D+V]];v+=32}}function Im(m,v){hu(m,v,4)}function Rm(m,v){hu(m,v,8)}function Nm(m,v){hu(m,v,16)}function mo(m,v){var C;for(C=0;16>C;++C)n(m,v+32*C,m,v-32,16)}function yh(m,v){var C;for(C=16;0<C;--C)s(m,v,m[v-1],16),v+=32}function vh(m,v,C){var I;for(I=0;16>I;++I)s(v,C+32*I,m,16)}function Xf(m,v){var C,I=16;for(C=0;16>C;++C)I+=m[v-1+32*C]+m[v+C-32];vh(I>>5,m,v)}function Nn(m,v){var C,I=8;for(C=0;16>C;++C)I+=m[v-1+32*C];vh(I>>4,m,v)}function km(m,v){var C,I=8;for(C=0;16>C;++C)I+=m[v+C-32];vh(I>>4,m,v)}function $f(m,v){vh(128,m,v)}function we(m,v,C){return m+2*v+C+2>>2}function Fm(m,v){var C,I=v-32;for(I=new Uint8Array([we(m[I-1],m[I+0],m[I+1]),we(m[I+0],m[I+1],m[I+2]),we(m[I+1],m[I+2],m[I+3]),we(m[I+2],m[I+3],m[I+4])]),C=0;4>C;++C)n(m,v+32*C,I,0,I.length)}function Om(m,v){var C=m[v-1],I=m[v-1+32],D=m[v-1+64],G=m[v-1+96];Pt(m,v+0,16843009*we(m[v-1-32],C,I)),Pt(m,v+32,16843009*we(C,I,D)),Pt(m,v+64,16843009*we(I,D,G)),Pt(m,v+96,16843009*we(D,G,G))}function jr(m,v){var C,I=4;for(C=0;4>C;++C)I+=m[v+C-32]+m[v-1+32*C];for(I>>=3,C=0;4>C;++C)s(m,v+32*C,I,4)}function Kf(m,v){var C=m[v-1+0],I=m[v-1+32],D=m[v-1+64],G=m[v-1-32],W=m[v+0-32],V=m[v+1-32],$=m[v+2-32],Q=m[v+3-32];m[v+0+96]=we(I,D,m[v-1+96]),m[v+1+96]=m[v+0+64]=we(C,I,D),m[v+2+96]=m[v+1+64]=m[v+0+32]=we(G,C,I),m[v+3+96]=m[v+2+64]=m[v+1+32]=m[v+0+0]=we(W,G,C),m[v+3+64]=m[v+2+32]=m[v+1+0]=we(V,W,G),m[v+3+32]=m[v+2+0]=we($,V,W),m[v+3+0]=we(Q,$,V)}function Zf(m,v){var C=m[v+1-32],I=m[v+2-32],D=m[v+3-32],G=m[v+4-32],W=m[v+5-32],V=m[v+6-32],$=m[v+7-32];m[v+0+0]=we(m[v+0-32],C,I),m[v+1+0]=m[v+0+32]=we(C,I,D),m[v+2+0]=m[v+1+32]=m[v+0+64]=we(I,D,G),m[v+3+0]=m[v+2+32]=m[v+1+64]=m[v+0+96]=we(D,G,W),m[v+3+32]=m[v+2+64]=m[v+1+96]=we(G,W,V),m[v+3+64]=m[v+2+96]=we(W,V,$),m[v+3+96]=we(V,$,$)}function xh(m,v){var C=m[v-1+0],I=m[v-1+32],D=m[v-1+64],G=m[v-1-32],W=m[v+0-32],V=m[v+1-32],$=m[v+2-32],Q=m[v+3-32];m[v+0+0]=m[v+1+64]=G+W+1>>1,m[v+1+0]=m[v+2+64]=W+V+1>>1,m[v+2+0]=m[v+3+64]=V+$+1>>1,m[v+3+0]=$+Q+1>>1,m[v+0+96]=we(D,I,C),m[v+0+64]=we(I,C,G),m[v+0+32]=m[v+1+96]=we(C,G,W),m[v+1+32]=m[v+2+96]=we(G,W,V),m[v+2+32]=m[v+3+96]=we(W,V,$),m[v+3+32]=we(V,$,Q)}function cu(m,v){var C=m[v+0-32],I=m[v+1-32],D=m[v+2-32],G=m[v+3-32],W=m[v+4-32],V=m[v+5-32],$=m[v+6-32],Q=m[v+7-32];m[v+0+0]=C+I+1>>1,m[v+1+0]=m[v+0+64]=I+D+1>>1,m[v+2+0]=m[v+1+64]=D+G+1>>1,m[v+3+0]=m[v+2+64]=G+W+1>>1,m[v+0+32]=we(C,I,D),m[v+1+32]=m[v+0+96]=we(I,D,G),m[v+2+32]=m[v+1+96]=we(D,G,W),m[v+3+32]=m[v+2+96]=we(G,W,V),m[v+3+64]=we(W,V,$),m[v+3+96]=we(V,$,Q)}function Dm(m,v){var C=m[v-1+0],I=m[v-1+32],D=m[v-1+64],G=m[v-1+96];m[v+0+0]=C+I+1>>1,m[v+2+0]=m[v+0+32]=I+D+1>>1,m[v+2+32]=m[v+0+64]=D+G+1>>1,m[v+1+0]=we(C,I,D),m[v+3+0]=m[v+1+32]=we(I,D,G),m[v+3+32]=m[v+1+64]=we(D,G,G),m[v+3+64]=m[v+2+64]=m[v+0+96]=m[v+1+96]=m[v+2+96]=m[v+3+96]=G}function Bm(m,v){var C=m[v-1+0],I=m[v-1+32],D=m[v-1+64],G=m[v-1+96],W=m[v-1-32],V=m[v+0-32],$=m[v+1-32],Q=m[v+2-32];m[v+0+0]=m[v+2+32]=C+W+1>>1,m[v+0+32]=m[v+2+64]=I+C+1>>1,m[v+0+64]=m[v+2+96]=D+I+1>>1,m[v+0+96]=G+D+1>>1,m[v+3+0]=we(V,$,Q),m[v+2+0]=we(W,V,$),m[v+1+0]=m[v+3+32]=we(C,W,V),m[v+1+32]=m[v+3+64]=we(I,C,W),m[v+1+64]=m[v+3+96]=we(D,I,C),m[v+1+96]=we(G,D,I)}function jm(m,v){var C;for(C=0;8>C;++C)n(m,v+32*C,m,v-32,8)}function uu(m,v){var C;for(C=0;8>C;++C)s(m,v,m[v-1],8),v+=32}function rl(m,v,C){var I;for(I=0;8>I;++I)s(v,C+32*I,m,8)}function ia(m,v){var C,I=8;for(C=0;8>C;++C)I+=m[v+C-32]+m[v-1+32*C];rl(I>>4,m,v)}function zm(m,v){var C,I=4;for(C=0;8>C;++C)I+=m[v+C-32];rl(I>>3,m,v)}function ol(m,v){var C,I=4;for(C=0;8>C;++C)I+=m[v-1+32*C];rl(I>>3,m,v)}function du(m,v){rl(128,m,v)}function bh(m,v,C){var I=m[v-C],D=m[v+0],G=3*(D-I)+Hm[1020+m[v-2*C]-m[v+C]],W=cg[112+(G+4>>3)];m[v-C]=Rs[255+I+cg[112+(G+3>>3)]],m[v+0]=Rs[255+D-W]}function Jf(m,v,C,I){var D=m[v+0],G=m[v+C];return Zs[255+m[v-2*C]-m[v-C]]>I||Zs[255+G-D]>I}function Qf(m,v,C,I){return 4*Zs[255+m[v-C]-m[v+0]]+Zs[255+m[v-2*C]-m[v+C]]<=I}function tg(m,v,C,I,D){var G=m[v-3*C],W=m[v-2*C],V=m[v-C],$=m[v+0],Q=m[v+C],ut=m[v+2*C],wt=m[v+3*C];return 4*Zs[255+V-$]+Zs[255+W-Q]>I?0:Zs[255+m[v-4*C]-G]<=D&&Zs[255+G-W]<=D&&Zs[255+W-V]<=D&&Zs[255+wt-ut]<=D&&Zs[255+ut-Q]<=D&&Zs[255+Q-$]<=D}function eg(m,v,C,I){var D=2*I+1;for(I=0;16>I;++I)Qf(m,v+I,C,D)&&bh(m,v+I,C)}function zr(m,v,C,I){var D=2*I+1;for(I=0;16>I;++I)Qf(m,v+I*C,1,D)&&bh(m,v+I*C,1)}function _o(m,v,C,I){var D;for(D=3;0<D;--D)eg(m,v+=4*C,C,I)}function Gm(m,v,C,I){var D;for(D=3;0<D;--D)zr(m,v+=4,C,I)}function na(m,v,C,I,D,G,W,V){for(G=2*G+1;0<D--;){if(tg(m,v,C,G,W))if(Jf(m,v,C,V))bh(m,v,C);else{var $=m,Q=v,ut=C,wt=$[Q-2*ut],St=$[Q-ut],yt=$[Q+0],kt=$[Q+ut],Lt=$[Q+2*ut],dt=27*(Rt=Hm[1020+3*(yt-St)+Hm[1020+wt-kt]])+63>>7,mt=18*Rt+63>>7,Rt=9*Rt+63>>7;$[Q-3*ut]=Rs[255+$[Q-3*ut]+Rt],$[Q-2*ut]=Rs[255+wt+mt],$[Q-ut]=Rs[255+St+dt],$[Q+0]=Rs[255+yt-dt],$[Q+ut]=Rs[255+kt-mt],$[Q+2*ut]=Rs[255+Lt-Rt]}v+=I}}function ur(m,v,C,I,D,G,W,V){for(G=2*G+1;0<D--;){if(tg(m,v,C,G,W))if(Jf(m,v,C,V))bh(m,v,C);else{var $=m,Q=v,ut=C,wt=$[Q-ut],St=$[Q+0],yt=$[Q+ut],kt=cg[112+((Lt=3*(St-wt))+4>>3)],Lt=cg[112+(Lt+3>>3)],dt=kt+1>>1;$[Q-2*ut]=Rs[255+$[Q-2*ut]+dt],$[Q-ut]=Rs[255+wt+Lt],$[Q+0]=Rs[255+St-kt],$[Q+ut]=Rs[255+yt-dt]}v+=I}}function fu(m,v,C,I,D,G){na(m,v,C,1,16,I,D,G)}function al(m,v,C,I,D,G){na(m,v,1,C,16,I,D,G)}function Um(m,v,C,I,D,G){var W;for(W=3;0<W;--W)ur(m,v+=4*C,C,1,16,I,D,G)}function wh(m,v,C,I,D,G){var W;for(W=3;0<W;--W)ur(m,v+=4,1,C,16,I,D,G)}function Wm(m,v,C,I,D,G,W,V){na(m,v,D,1,8,G,W,V),na(C,I,D,1,8,G,W,V)}function gu(m,v,C,I,D,G,W,V){na(m,v,1,D,8,G,W,V),na(C,I,1,D,8,G,W,V)}function pu(m,v,C,I,D,G,W,V){ur(m,v+4*D,D,1,8,G,W,V),ur(C,I+4*D,D,1,8,G,W,V)}function ig(m,v,C,I,D,G,W,V){ur(m,v+4,1,D,8,G,W,V),ur(C,I+4,1,D,8,G,W,V)}function Sh(){this.ba=new tn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new qe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function mu(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function _u(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ng(){this.ua=0,this.Wa=new z,this.vb=new z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new E,this.yc=new S}function qm(){this.xb=this.a=0,this.l=new mh,this.ca=new tn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new P,this.Pb=0,this.wd=new P,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ng,this.ab=0,this.gc=o(4,_u),this.Oc=0}function Eh(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new mh,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ll(m,v,C,I,D,G,W){for(m=m==null?0:m[v+0],v=0;v<W;++v)D[G+v]=m+C[I+v]&255,m=D[G+v]}function yu(m,v,C,I,D,G,W){var V;if(m==null)ll(null,null,C,I,D,G,W);else for(V=0;V<W;++V)D[G+V]=m[v+V]+C[I+V]&255}function sa(m,v,C,I,D,G,W){if(m==null)ll(null,null,C,I,D,G,W);else{var V,$=m[v+0],Q=$,ut=$;for(V=0;V<W;++V)Q=ut+($=m[v+V])-Q,ut=C[I+V]+(-256&Q?0>Q?0:255:Q)&255,Q=$,D[G+V]=ut}}function vu(m,v,C,I){var D=v.width,G=v.o;if(t(m!=null&&v!=null),0>C||0>=I||C+I>G)return null;if(!m.Cc){if(m.ga==null){var W;if(m.ga=new Eh,(W=m.ga==null)||(W=v.width*v.o,t(m.Gb.length==0),m.Gb=r(W),m.Uc=0,m.Gb==null?W=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,W=1),W=!W),!W){W=m.ga;var V=m.Fa,$=m.P,Q=m.qc,ut=m.mb,wt=m.nb,St=$+1,yt=Q-1,kt=W.l;if(t(V!=null&&ut!=null&&v!=null),ca[0]=null,ca[1]=ll,ca[2]=yu,ca[3]=sa,W.ca=ut,W.tb=wt,W.c=v.width,W.i=v.height,t(0<W.c&&0<W.i),1>=Q)v=0;else if(W.$a=V[$+0]>>0&3,W.Z=V[$+0]>>2&3,W.Lc=V[$+0]>>4&3,$=V[$+0]>>6&3,0>W.$a||1<W.$a||4<=W.Z||1<W.Lc||$)v=0;else if(kt.put=Ti,kt.ac=wi,kt.bc=zi,kt.ma=W,kt.width=v.width,kt.height=v.height,kt.Da=v.Da,kt.v=v.v,kt.va=v.va,kt.j=v.j,kt.o=v.o,W.$a)t:{t(W.$a==1),v=Hs();e:for(;;){if(v==null){v=0;break t}if(t(W!=null),W.mc=v,v.c=W.c,v.i=W.i,v.l=W.l,v.l.ma=W,v.l.width=W.c,v.l.height=W.i,v.a=0,st(v.m,V,St,yt),!Br(W.c,W.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&po(v.s)?(W.ic=1,V=v.c*v.i,v.Ta=null,v.Ua=0,v.V=r(V),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(W.ic=0,v=sl(v,W.c)),!v))break e;v=1;break t}W.mc=null,v=0}else v=yt>=W.c*W.i;W=!v}if(W)return null;m.ga.Lc!=1?m.Ga=0:I=G-C}t(m.ga!=null),t(C+I<=G);t:{if(v=(V=m.ga).c,G=V.l.o,V.$a==0){if(St=m.rc,yt=m.Vc,kt=m.Fa,$=m.P+1+C*v,Q=m.mb,ut=m.nb+C*v,t($<=m.P+m.qc),V.Z!=0)for(t(ca[V.Z]!=null),W=0;W<I;++W)ca[V.Z](St,yt,kt,$,Q,ut,v),St=Q,yt=ut,ut+=v,$+=v;else for(W=0;W<I;++W)n(Q,ut,kt,$,v),St=Q,yt=ut,ut+=v,$+=v;m.rc=St,m.Vc=yt}else{if(t(V.mc!=null),v=C+I,t((W=V.mc)!=null),t(v<=W.i),W.C>=v)v=1;else if(V.ic||xt(),V.ic){V=W.V,St=W.Ba,yt=W.c;var Lt=W.i,dt=(kt=1,$=W.$/yt,Q=W.$%yt,ut=W.m,wt=W.s,W.$),mt=yt*Lt,Rt=yt*v,Ot=wt.wc,Nt=dt<Rt?ti(wt,Q,$):null;t(dt<=mt),t(v<=Lt),t(po(wt));e:for(;;){for(;!ut.h&&dt<Rt;){if(Q&Ot||(Nt=ti(wt,Q,$)),t(Nt!=null),ht(ut),256>(Lt=Ne(Nt.G[0],Nt.H[0],ut)))V[St+dt]=Lt,++dt,++Q>=yt&&(Q=0,++$<=v&&!($%16)&&lr(W,$));else{if(!(280>Lt)){kt=0;break e}Lt=Gi(Lt-256,ut);var Qt,Ht=Ne(Nt.G[4],Nt.H[4],ut);if(ht(ut),!(dt>=(Ht=nn(yt,Ht=Gi(Ht,ut)))&&mt-dt>=Lt)){kt=0;break e}for(Qt=0;Qt<Lt;++Qt)V[St+dt+Qt]=V[St+dt+Qt-Ht];for(dt+=Lt,Q+=Lt;Q>=yt;)Q-=yt,++$<=v&&!($%16)&&lr(W,$);dt<Rt&&Q&Ot&&(Nt=ti(wt,Q,$))}t(ut.h==j(ut))}lr(W,$>v?v:$);break e}!kt||ut.h&&dt<mt?(kt=0,W.a=ut.h?5:3):W.$=dt,v=kt}else v=hr(W,W.V,W.Ba,W.c,W.i,v,uh);if(!v){I=0;break t}}C+I>=G&&(m.Cc=1),I=1}if(!I)return null;if(m.Cc&&((I=m.ga)!=null&&(I.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+C*D}function w(m,v,C,I,D,G){for(;0<D--;){var W,V=m,$=v+(C?1:0),Q=m,ut=v+(C?0:3);for(W=0;W<I;++W){var wt=Q[ut+4*W];wt!=255&&(wt*=32897,V[$+4*W+0]=V[$+4*W+0]*wt>>23,V[$+4*W+1]=V[$+4*W+1]*wt>>23,V[$+4*W+2]=V[$+4*W+2]*wt>>23)}v+=G}}function B(m,v,C,I,D){for(;0<I--;){var G;for(G=0;G<C;++G){var W=m[v+2*G+0],V=15&(Q=m[v+2*G+1]),$=4369*V,Q=(240&Q|Q>>4)*$>>16;m[v+2*G+0]=(240&W|W>>4)*$>>16&240|(15&W|W<<4)*$>>16>>4&15,m[v+2*G+1]=240&Q|V}v+=D}}function nt(m,v,C,I,D,G,W,V){var $,Q,ut=255;for(Q=0;Q<D;++Q){for($=0;$<I;++$){var wt=m[v+$];G[W+4*$]=wt,ut&=wt}v+=C,W+=V}return ut!=255}function ct(m,v,C,I,D){var G;for(G=0;G<D;++G)C[I+G]=m[v+G]>>8}function xt(){Ks=w,mi=B,_i=nt,qi=ct}function Mt(m,v,C){T[m]=function(I,D,G,W,V,$,Q,ut,wt,St,yt,kt,Lt,dt,mt,Rt,Ot){var Nt,Qt=Ot-1>>1,Ht=V[$+0]|Q[ut+0]<<16,ge=wt[St+0]|yt[kt+0]<<16;t(I!=null);var Yt=3*Ht+ge+131074>>2;for(v(I[D+0],255&Yt,Yt>>16,Lt,dt),G!=null&&(Yt=3*ge+Ht+131074>>2,v(G[W+0],255&Yt,Yt>>16,mt,Rt)),Nt=1;Nt<=Qt;++Nt){var Ze=V[$+Nt]|Q[ut+Nt]<<16,oi=wt[St+Nt]|yt[kt+Nt]<<16,He=Ht+Ze+ge+oi+524296,Oe=He+2*(Ze+ge)>>3;Yt=Oe+Ht>>1,Ht=(He=He+2*(Ht+oi)>>3)+Ze>>1,v(I[D+2*Nt-1],255&Yt,Yt>>16,Lt,dt+(2*Nt-1)*C),v(I[D+2*Nt-0],255&Ht,Ht>>16,Lt,dt+(2*Nt-0)*C),G!=null&&(Yt=He+ge>>1,Ht=Oe+oi>>1,v(G[W+2*Nt-1],255&Yt,Yt>>16,mt,Rt+(2*Nt-1)*C),v(G[W+2*Nt+0],255&Ht,Ht>>16,mt,Rt+(2*Nt+0)*C)),Ht=Ze,ge=oi}1&Ot||(Yt=3*Ht+ge+131074>>2,v(I[D+Ot-1],255&Yt,Yt>>16,Lt,dt+(Ot-1)*C),G!=null&&(Yt=3*ge+Ht+131074>>2,v(G[W+Ot-1],255&Yt,Yt>>16,mt,Rt+(Ot-1)*C)))}}function Dt(){Js[ug]=Y3,Js[dg]=Bv,Js[Nv]=X3,Js[fg]=jv,Js[gg]=zv,Js[Ym]=Gv,Js[kv]=$3,Js[Xm]=Bv,Js[$m]=jv,Js[pg]=zv,Js[Km]=Gv}function Zt(m){return m&~K3?0>m?0:255:m>>Uv}function ue(m,v){return Zt((19077*m>>8)+(26149*v>>8)-14234)}function Le(m,v,C){return Zt((19077*m>>8)-(6419*v>>8)-(13320*C>>8)+8708)}function Ee(m,v){return Zt((19077*m>>8)+(33050*v>>8)-17685)}function Ue(m,v,C,I,D){I[D+0]=ue(m,C),I[D+1]=Le(m,v,C),I[D+2]=Ee(m,v)}function Ai(m,v,C,I,D){I[D+0]=Ee(m,v),I[D+1]=Le(m,v,C),I[D+2]=ue(m,C)}function Ni(m,v,C,I,D){var G=Le(m,v,C);v=G<<3&224|Ee(m,v)>>3,I[D+0]=248&ue(m,C)|G>>5,I[D+1]=v}function sn(m,v,C,I,D){var G=240&Ee(m,v)|15;I[D+0]=240&ue(m,C)|Le(m,v,C)>>4,I[D+1]=G}function kn(m,v,C,I,D){I[D+0]=255,Ue(m,v,C,I,D+1)}function mn(m,v,C,I,D){Ai(m,v,C,I,D),I[D+3]=255}function dr(m,v,C,I,D){Ue(m,v,C,I,D),I[D+3]=255}function Is(m,v){return 0>m?0:m>v?v:m}function Gr(m,v,C){T[m]=function(I,D,G,W,V,$,Q,ut,wt){for(var St=ut+(-2&wt)*C;ut!=St;)v(I[D+0],G[W+0],V[$+0],Q,ut),v(I[D+1],G[W+0],V[$+0],Q,ut+C),D+=2,++W,++$,ut+=2*C;1&wt&&v(I[D+0],G[W+0],V[$+0],Q,ut)}}function sg(m,v,C){return C==0?m==0?v==0?6:5:v==0?4:0:C}function xu(m,v,C,I,D){switch(m>>>30){case 3:xo(v,C,I,D,0);break;case 2:Wi(v,C,I,D);break;case 1:Zn(v,C,I,D)}}function bu(m,v){var C,I,D=v.M,G=v.Nb,W=m.oc,V=m.pc+40,$=m.oc,Q=m.pc+584,ut=m.oc,wt=m.pc+600;for(C=0;16>C;++C)W[V+32*C-1]=129;for(C=0;8>C;++C)$[Q+32*C-1]=129,ut[wt+32*C-1]=129;for(0<D?W[V-1-32]=$[Q-1-32]=ut[wt-1-32]=129:(s(W,V-32-1,127,21),s($,Q-32-1,127,9),s(ut,wt-32-1,127,9)),I=0;I<m.za;++I){var St=v.ya[v.aa+I];if(0<I){for(C=-1;16>C;++C)n(W,V+32*C-4,W,V+32*C+12,4);for(C=-1;8>C;++C)n($,Q+32*C-4,$,Q+32*C+4,4),n(ut,wt+32*C-4,ut,wt+32*C+4,4)}var yt=m.Gd,kt=m.Hd+I,Lt=St.ad,dt=St.Hc;if(0<D&&(n(W,V-32,yt[kt].y,0,16),n($,Q-32,yt[kt].f,0,8),n(ut,wt-32,yt[kt].ea,0,8)),St.Za){var mt=W,Rt=V-32+16;for(0<D&&(I>=m.za-1?s(mt,Rt,yt[kt].y[15],4):n(mt,Rt,yt[kt+1].y,0,4)),C=0;4>C;C++)mt[Rt+128+C]=mt[Rt+256+C]=mt[Rt+384+C]=mt[Rt+0+C];for(C=0;16>C;++C,dt<<=2)mt=W,Rt=V+qv[C],fr[St.Ob[C]](mt,Rt),xu(dt,Lt,16*+C,mt,Rt)}else if(mt=sg(I,D,St.Ob[0]),ha[mt](W,V),dt!=0)for(C=0;16>C;++C,dt<<=2)xu(dt,Lt,16*+C,W,V+qv[C]);for(C=St.Gc,mt=sg(I,D,St.Dd),wo[mt]($,Q),wo[mt](ut,wt),dt=Lt,mt=$,Rt=Q,255&(St=C>>0)&&(170&St?Lu(dt,256,mt,Rt):Xs(dt,256,mt,Rt)),St=ut,dt=wt,255&(C>>=8)&&(170&C?Lu(Lt,320,St,dt):Xs(Lt,320,St,dt)),D<m.Ub-1&&(n(yt[kt].y,0,W,V+480,16),n(yt[kt].f,0,$,Q+224,8),n(yt[kt].ea,0,ut,wt+224,8)),C=8*G*m.B,yt=m.sa,kt=m.ta+16*I+16*G*m.R,Lt=m.qa,St=m.ra+8*I+C,dt=m.Ha,mt=m.Ia+8*I+C,C=0;16>C;++C)n(yt,kt+C*m.R,W,V+32*C,16);for(C=0;8>C;++C)n(Lt,St+C*m.B,$,Q+32*C,8),n(dt,mt+C*m.B,ut,wt+32*C,8)}}function Ch(m,v,C,I,D,G,W,V,$){var Q=[0],ut=[0],wt=0,St=$!=null?$.kd:0,yt=$??new mu;if(m==null||12>C)return 7;yt.data=m,yt.w=v,yt.ha=C,v=[v],C=[C],yt.gb=[yt.gb];t:{var kt=v,Lt=C,dt=yt.gb;if(t(m!=null),t(Lt!=null),t(dt!=null),dt[0]=0,12<=Lt[0]&&!e(m,kt[0],"RIFF")){if(e(m,kt[0]+8,"WEBP")){dt=3;break t}var mt=Gt(m,kt[0]+4);if(12>mt||4294967286<mt){dt=3;break t}if(St&&mt>Lt[0]-8){dt=7;break t}dt[0]=mt,kt[0]+=12,Lt[0]-=12}dt=0}if(dt!=0)return dt;for(mt=0<yt.gb[0],C=C[0];;){t:{var Rt=m;Lt=v,dt=C;var Ot=Q,Nt=ut,Qt=kt=[0];if((Yt=wt=[wt])[0]=0,8>dt[0])dt=7;else{if(!e(Rt,Lt[0],"VP8X")){if(Gt(Rt,Lt[0]+4)!=10){dt=3;break t}if(18>dt[0]){dt=7;break t}var Ht=Gt(Rt,Lt[0]+8),ge=1+Wt(Rt,Lt[0]+12);if(2147483648<=ge*(Rt=1+Wt(Rt,Lt[0]+15))){dt=3;break t}Qt!=null&&(Qt[0]=Ht),Ot!=null&&(Ot[0]=ge),Nt!=null&&(Nt[0]=Rt),Lt[0]+=18,dt[0]-=18,Yt[0]=1}dt=0}}if(wt=wt[0],kt=kt[0],dt!=0)return dt;if(Lt=!!(2&kt),!mt&&wt)return 3;if(G!=null&&(G[0]=!!(16&kt)),W!=null&&(W[0]=Lt),V!=null&&(V[0]=0),W=Q[0],kt=ut[0],wt&&Lt&&$==null){dt=0;break}if(4>C){dt=7;break}if(mt&&wt||!mt&&!wt&&!e(m,v[0],"ALPH")){C=[C],yt.na=[yt.na],yt.P=[yt.P],yt.Sa=[yt.Sa];t:{Ht=m,dt=v,mt=C;var Yt=yt.gb;Ot=yt.na,Nt=yt.P,Qt=yt.Sa,ge=22,t(Ht!=null),t(mt!=null),Rt=dt[0];var Ze=mt[0];for(t(Ot!=null),t(Qt!=null),Ot[0]=null,Nt[0]=null,Qt[0]=0;;){if(dt[0]=Rt,mt[0]=Ze,8>Ze){dt=7;break t}var oi=Gt(Ht,Rt+4);if(4294967286<oi){dt=3;break t}var He=8+oi+1&-2;if(ge+=He,0<Yt&&ge>Yt){dt=3;break t}if(!e(Ht,Rt,"VP8 ")||!e(Ht,Rt,"VP8L")){dt=0;break t}if(Ze[0]<He){dt=7;break t}e(Ht,Rt,"ALPH")||(Ot[0]=Ht,Nt[0]=Rt+8,Qt[0]=oi),Rt+=He,Ze-=He}}if(C=C[0],yt.na=yt.na[0],yt.P=yt.P[0],yt.Sa=yt.Sa[0],dt!=0)break}C=[C],yt.Ja=[yt.Ja],yt.xa=[yt.xa];t:if(Yt=m,dt=v,mt=C,Ot=yt.gb[0],Nt=yt.Ja,Qt=yt.xa,Ht=dt[0],Rt=!e(Yt,Ht,"VP8 "),ge=!e(Yt,Ht,"VP8L"),t(Yt!=null),t(mt!=null),t(Nt!=null),t(Qt!=null),8>mt[0])dt=7;else{if(Rt||ge){if(Yt=Gt(Yt,Ht+4),12<=Ot&&Yt>Ot-12){dt=3;break t}if(St&&Yt>mt[0]-8){dt=7;break t}Nt[0]=Yt,dt[0]+=8,mt[0]-=8,Qt[0]=ge}else Qt[0]=5<=mt[0]&&Yt[Ht+0]==47&&!(Yt[Ht+4]>>5),Nt[0]=mt[0];dt=0}if(C=C[0],yt.Ja=yt.Ja[0],yt.xa=yt.xa[0],v=v[0],dt!=0)break;if(4294967286<yt.Ja)return 3;if(V==null||Lt||(V[0]=yt.xa?2:1),W=[W],kt=[kt],yt.xa){if(5>C){dt=7;break}V=W,St=kt,Lt=G,m==null||5>C?m=0:5<=C&&m[v+0]==47&&!(m[v+4]>>5)?(mt=[0],Yt=[0],Ot=[0],st(Nt=new P,m,v,C),se(Nt,mt,Yt,Ot)?(V!=null&&(V[0]=mt[0]),St!=null&&(St[0]=Yt[0]),Lt!=null&&(Lt[0]=Ot[0]),m=1):m=0):m=0}else{if(10>C){dt=7;break}V=kt,m==null||10>C||!Uf(m,v+3,C-3)?m=0:(St=m[v+0]|m[v+1]<<8|m[v+2]<<16,Lt=16383&(m[v+7]<<8|m[v+6]),m=16383&(m[v+9]<<8|m[v+8]),1&St||3<(St>>1&7)||!(St>>4&1)||St>>5>=yt.Ja||!Lt||!m?m=0:(W&&(W[0]=Lt),V&&(V[0]=m),m=1))}if(!m||(W=W[0],kt=kt[0],wt&&(Q[0]!=W||ut[0]!=kt)))return 3;$!=null&&($[0]=yt,$.offset=v-$.w,t(4294967286>v-$.w),t($.offset==$.ha-C));break}return dt==0||dt==7&&wt&&$==null?(G!=null&&(G[0]|=yt.na!=null&&0<yt.na.length),I!=null&&(I[0]=W),D!=null&&(D[0]=kt),0):dt}function wu(m,v,C){var I=v.width,D=v.height,G=0,W=0,V=I,$=D;if(v.Da=m!=null&&0<m.Da,v.Da&&(V=m.cd,$=m.bd,G=m.v,W=m.j,11>C||(G&=-2,W&=-2),0>G||0>W||0>=V||0>=$||G+V>I||W+$>D))return 0;if(v.v=G,v.j=W,v.va=G+V,v.o=W+$,v.U=V,v.T=$,v.da=m!=null&&0<m.da,v.da){if(!J(V,$,C=[m.ib],G=[m.hb]))return 0;v.ib=C[0],v.hb=G[0]}return v.ob=m!=null&&m.ob,v.Kb=m==null||!m.Sd,v.da&&(v.ob=v.ib<3*I/4&&v.hb<3*D/4,v.Kb=0),1}function Su(m){if(m==null)return 2;if(11>m.S){var v=m.f.RGBA;v.fb+=(m.height-1)*v.A,v.A=-v.A}else v=m.f.kb,m=m.height,v.O+=(m-1)*v.fa,v.fa=-v.fa,v.N+=(m-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(m-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(m-1)*v.lb,v.lb=-v.lb);return 0}function Lh(m,v,C,I){if(I==null||0>=m||0>=v)return 2;if(C!=null){if(C.Da){var D=C.cd,G=C.bd,W=-2&C.v,V=-2&C.j;if(0>W||0>V||0>=D||0>=G||W+D>m||V+G>v)return 2;m=D,v=G}if(C.da){if(!J(m,v,D=[C.ib],G=[C.hb]))return 2;m=D[0],v=G[0]}}I.width=m,I.height=v;t:{var $=I.width,Q=I.height;if(m=I.S,0>=$||0>=Q||!(m>=ug&&13>m))m=2;else{if(0>=I.Rd&&I.sd==null){W=G=D=v=0;var ut=(V=$*Vv[m])*Q;if(11>m||(G=(Q+1)/2*(v=($+1)/2),m==12&&(W=(D=$)*Q)),(Q=r(ut+2*G+W))==null){m=1;break t}I.sd=Q,11>m?(($=I.f.RGBA).eb=Q,$.fb=0,$.A=V,$.size=ut):(($=I.f.kb).y=Q,$.O=0,$.fa=V,$.Fd=ut,$.f=Q,$.N=0+ut,$.Ab=v,$.Cd=G,$.ea=Q,$.W=0+ut+G,$.Db=v,$.Ed=G,m==12&&($.F=Q,$.J=0+ut+2*G),$.Tc=W,$.lb=D)}if(v=1,D=I.S,G=I.width,W=I.height,D>=ug&&13>D)if(11>D)m=I.f.RGBA,v&=(V=Math.abs(m.A))*(W-1)+G<=m.size,v&=V>=G*Vv[D],v&=m.eb!=null;else{m=I.f.kb,V=(G+1)/2,ut=(W+1)/2,$=Math.abs(m.fa),Q=Math.abs(m.Ab);var wt=Math.abs(m.Db),St=Math.abs(m.lb),yt=St*(W-1)+G;v&=$*(W-1)+G<=m.Fd,v&=Q*(ut-1)+V<=m.Cd,v=(v&=wt*(ut-1)+V<=m.Ed)&$>=G&Q>=V&wt>=V,v&=m.y!=null,v&=m.f!=null,v&=m.ea!=null,D==12&&(v&=St>=G,v&=yt<=m.Tc,v&=m.F!=null)}else v=0;m=v?0:2}}return m!=0||C!=null&&C.fd&&(m=Su(I)),m}var Ln=64,Mh=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Th=24,Ah=32,Eu=8,ls=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];pt("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(m){return m},T.Predictor2=function(m,v,C){return v[C+0]},T.Predictor3=function(m,v,C){return v[C+1]},T.Predictor4=function(m,v,C){return v[C-1]},T.Predictor5=function(m,v,C){return at(at(m,v[C+1]),v[C+0])},T.Predictor6=function(m,v,C){return at(m,v[C-1])},T.Predictor7=function(m,v,C){return at(m,v[C+0])},T.Predictor8=function(m,v,C){return at(v[C-1],v[C+0])},T.Predictor9=function(m,v,C){return at(v[C+0],v[C+1])},T.Predictor10=function(m,v,C){return at(at(m,v[C-1]),at(v[C+0],v[C+1]))},T.Predictor11=function(m,v,C){var I=v[C+0];return 0>=Ct(I>>24&255,m>>24&255,(v=v[C-1])>>24&255)+Ct(I>>16&255,m>>16&255,v>>16&255)+Ct(I>>8&255,m>>8&255,v>>8&255)+Ct(255&I,255&m,255&v)?I:m},T.Predictor12=function(m,v,C){var I=v[C+0];return(Et((m>>24&255)+(I>>24&255)-((v=v[C-1])>>24&255))<<24|Et((m>>16&255)+(I>>16&255)-(v>>16&255))<<16|Et((m>>8&255)+(I>>8&255)-(v>>8&255))<<8|Et((255&m)+(255&I)-(255&v)))>>>0},T.Predictor13=function(m,v,C){var I=v[C-1];return(It((m=at(m,v[C+0]))>>24&255,I>>24&255)<<24|It(m>>16&255,I>>16&255)<<16|It(m>>8&255,I>>8&255)<<8|It(m>>0&255,I>>0&255))>>>0};var Vm=T.PredictorAdd0;T.PredictorAdd1=jt,pt("Predictor2","PredictorAdd2"),pt("Predictor3","PredictorAdd3"),pt("Predictor4","PredictorAdd4"),pt("Predictor5","PredictorAdd5"),pt("Predictor6","PredictorAdd6"),pt("Predictor7","PredictorAdd7"),pt("Predictor8","PredictorAdd8"),pt("Predictor9","PredictorAdd9"),pt("Predictor10","PredictorAdd10"),pt("Predictor11","PredictorAdd11"),pt("Predictor12","PredictorAdd12"),pt("Predictor13","PredictorAdd13");var Cu=T.PredictorAdd2;be("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),be("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var rg,Ys=T.ColorIndexInverseTransform,Ph=T.MapARGB,og=T.VP8LColorIndexInverseTransformAlpha,ag=T.MapAlpha,ra=T.VP8LPredictorsAdd=[];ra.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var hl,hs,Kn,oa,yo,vo,Ih,xo,Wi,Lu,Zn,Xs,Rh,lg,Mu,cl,ul,aa,dl,Nh,fl,la,Tu,$s,Ks,mi,_i,qi,un=r(511),bo=r(2041),Au=r(225),kh=r(767),hg=0,Hm=bo,cg=Au,Rs=kh,Zs=un,ug=0,dg=1,Nv=2,fg=3,gg=4,Ym=5,kv=6,Xm=7,$m=8,pg=9,Km=10,N3=[2,3,7],k3=[3,3,11],Fv=[280,256,256,256,40],F3=[0,1,1,1,0],O3=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],D3=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],B3=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],j3=8,Zm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Jm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Pu=null,z3=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],G3=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ov=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],U3=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],W3=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],q3=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],V3=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ha=[],fr=[],wo=[],H3=1,Dv=2,ca=[],Js=[];Mt("UpsampleRgbLinePair",Ue,3),Mt("UpsampleBgrLinePair",Ai,3),Mt("UpsampleRgbaLinePair",dr,4),Mt("UpsampleBgraLinePair",mn,4),Mt("UpsampleArgbLinePair",kn,4),Mt("UpsampleRgba4444LinePair",sn,2),Mt("UpsampleRgb565LinePair",Ni,2);var Y3=T.UpsampleRgbLinePair,X3=T.UpsampleBgrLinePair,Bv=T.UpsampleRgbaLinePair,jv=T.UpsampleBgraLinePair,zv=T.UpsampleArgbLinePair,Gv=T.UpsampleRgba4444LinePair,$3=T.UpsampleRgb565LinePair,mg=16,_g=1<<mg-1,Iu=-227,Qm=482,Uv=6,K3=(256<<Uv)-1,Wv=0,Z3=r(256),J3=r(256),Q3=r(256),tM=r(256),eM=r(Qm-Iu),iM=r(Qm-Iu);Gr("YuvToRgbRow",Ue,3),Gr("YuvToBgrRow",Ai,3),Gr("YuvToRgbaRow",dr,4),Gr("YuvToBgraRow",mn,4),Gr("YuvToArgbRow",kn,4),Gr("YuvToRgba4444Row",sn,2),Gr("YuvToRgb565Row",Ni,2);var qv=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],yg=[0,2,8],nM=[8,7,6,4,4,2,2,2,1,1,1,1],sM=1;this.WebPDecodeRGBA=function(m,v,C,I,D){var G=dg,W=new Sh,V=new tn;W.ba=V,V.S=G,V.width=[V.width],V.height=[V.height];var $=V.width,Q=V.height,ut=new ji;if(ut==null||m==null)var wt=2;else t(ut!=null),wt=Ch(m,v,C,ut.width,ut.height,ut.Pd,ut.Qd,ut.format,null);if(wt!=0?$=0:($!=null&&($[0]=ut.width[0]),Q!=null&&(Q[0]=ut.height[0]),$=1),$){V.width=V.width[0],V.height=V.height[0],I!=null&&(I[0]=V.width),D!=null&&(D[0]=V.height);t:{if(I=new mh,(D=new mu).data=m,D.w=v,D.ha=C,D.kd=1,v=[0],t(D!=null),((m=Ch(D.data,D.w,D.ha,null,null,null,v,null,D))==0||m==7)&&v[0]&&(m=4),(v=m)==0){if(t(W!=null),I.data=D.data,I.w=D.w+D.offset,I.ha=D.ha-D.offset,I.put=Ti,I.ac=wi,I.bc=zi,I.ma=W,D.xa){if((m=Hs())==null){W=1;break t}if(function(St,yt){var kt=[0],Lt=[0],dt=[0];e:for(;;){if(St==null)return 0;if(yt==null)return St.a=2,0;if(St.l=yt,St.a=0,st(St.m,yt.data,yt.w,yt.ha),!se(St.m,kt,Lt,dt)){St.a=3;break e}if(St.xb=Dv,yt.width=kt[0],yt.height=Lt[0],!Br(kt[0],Lt[0],1,St,null))break e;return 1}return t(St.a!=0),0}(m,I)){if(I=(v=Lh(I.width,I.height,W.Oa,W.ba))==0){e:{I=m;i:for(;;){if(I==null){I=0;break e}if(t(I.s.yc!=null),t(I.s.Ya!=null),t(0<I.s.Wb),t((C=I.l)!=null),t((D=C.ma)!=null),I.xb!=0){if(I.ca=D.ba,I.tb=D.tb,t(I.ca!=null),!wu(D.Oa,C,fg)){I.a=2;break i}if(!sl(I,C.width)||C.da)break i;if((C.da||Fe(I.ca.S))&&xt(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&xt()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!N(I.s.vb,I.s.Wa.Xa)){I.a=1;break i}I.xb=0}if(!hr(I,I.V,I.Ba,I.c,I.i,C.o,ch))break i;D.Dc=I.Ma,I=1;break e}t(I.a!=0),I=0}I=!I}I&&(v=m.a)}else v=m.a}else{if((m=new Lm)==null){W=1;break t}if(m.Fa=D.na,m.P=D.P,m.qc=D.Sa,Wf(m,I)){if((v=Lh(I.width,I.height,W.Oa,W.ba))==0){if(m.Aa=0,C=W.Oa,t((D=m)!=null),C!=null){if(0<($=0>($=C.Md)?0:100<$?255:255*$/100)){for(Q=ut=0;4>Q;++Q)12>(wt=D.pb[Q]).lc&&(wt.ia=$*nM[0>wt.lc?0:wt.lc]>>3),ut|=wt.ia;ut&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=C.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}Mm(m,I)||(v=m.a)}}else v=m.a}v==0&&W.Oa!=null&&W.Oa.fd&&(v=Su(W.ba))}W=v}G=W!=0?null:11>G?V.f.RGBA.eb:V.f.kb.y}else G=null;return G};var Vv=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(T,F){for(var q="",R=0;R<4;R++)q+=String.fromCharCode(T[F++]);return q}function c(T,F){return(T[F+0]<<0|T[F+1]<<8|T[F+2]<<16)>>>0}function u(T,F){return(T[F+0]<<0|T[F+1]<<8|T[F+2]<<16|T[F+3]<<24)>>>0}new l;var f=[0],d=[0],g=[],p=new l,y=i,_=function(T,F){var q={},R=0,S=!1,O=0,E=0;if(q.frames=[],!function(H,j,K,ht){for(var ft=0;ft<ht;ft++)if(H[j+ft]!=K.charCodeAt(ft))return!0;return!1}(T,F,"RIFF",4)){var U,X;for(u(T,F+=4),F+=8;F<T.length;){var Z=h(T,F),st=u(T,F+=4);F+=4;var tt=st+(1&st);switch(Z){case"VP8 ":case"VP8L":q.frames[R]===void 0&&(q.frames[R]={}),(P=q.frames[R]).src_off=S?E:F-8,P.src_size=O+st+8,R++,S&&(S=!1,O=0,E=0);break;case"VP8X":(P=q.header={}).feature_flags=T[F];var ot=F+4;P.canvas_width=1+c(T,ot),ot+=3,P.canvas_height=1+c(T,ot),ot+=3;break;case"ALPH":S=!0,O=tt+8,E=F-8;break;case"ANIM":(P=q.header).bgcolor=u(T,F),ot=F+4,P.loop_count=(U=T)[(X=ot)+0]<<0|U[X+1]<<8,ot+=2;break;case"ANMF":var et,P;(P=q.frames[R]={}).offset_x=2*c(T,F),F+=3,P.offset_y=2*c(T,F),F+=3,P.width=1+c(T,F),F+=3,P.height=1+c(T,F),F+=3,P.duration=c(T,F),F+=3,et=T[F++],P.dispose=1&et,P.blend=et>>1&1}Z!="ANMF"&&(F+=tt)}return q}}(y,0);_.response=y,_.rgbaoutput=!0,_.dataurl=!1;var x=_.header?_.header:null,b=_.frames?_.frames:null;if(x){x.loop_counter=x.loop_count,f=[x.canvas_height],d=[x.canvas_width];for(var L=0;L<b.length&&b[L].blend!=0;L++);}var M=b[0],k=p.WebPDecodeRGBA(y,M.src_off,M.src_size,d,f);M.rgba=k,M.imgwidth=d[0],M.imgheight=f[0];for(var A=0;A<d[0]*f[0]*4;A++)g[A]=k[A];return this.width=d,this.height=f,this.data=g,this}(function(i){var t=function(){return typeof Y_=="function"},e=function(f,d,g,p){var y=4,_=o;switch(p){case i.image_compression.FAST:y=1,_=r;break;case i.image_compression.MEDIUM:y=6,_=a;break;case i.image_compression.SLOW:y=9,_=l}f=n(f,d,g,_);var x=Y_(f,{level:y});return i.__addimage__.arrayBufferToBinaryString(x)},n=function(f,d,g,p){for(var y,_,x,b=f.length/d,L=new Uint8Array(f.length+b),M=c(),k=0;k<b;k+=1){if(x=k*d,y=f.subarray(x,x+d),p)L.set(p(y,g,_),x+k);else{for(var A,T=M.length,F=[];A<T;A+=1)F[A]=M[A](y,g,_);var q=u(F.concat());L.set(F[q],x+k)}_=y}return L},s=function(f){var d=Array.apply([],f);return d.unshift(0),d},r=function(f,d){var g,p=[],y=f.length;p[0]=1;for(var _=0;_<y;_+=1)g=f[_-d]||0,p[_+1]=f[_]-g+256&255;return p},o=function(f,d,g){var p,y=[],_=f.length;y[0]=2;for(var x=0;x<_;x+=1)p=g&&g[x]||0,y[x+1]=f[x]-p+256&255;return y},a=function(f,d,g){var p,y,_=[],x=f.length;_[0]=3;for(var b=0;b<x;b+=1)p=f[b-d]||0,y=g&&g[b]||0,_[b+1]=f[b]+256-(p+y>>>1)&255;return _},l=function(f,d,g){var p,y,_,x,b=[],L=f.length;b[0]=4;for(var M=0;M<L;M+=1)p=f[M-d]||0,y=g&&g[M]||0,_=g&&g[M-d]||0,x=h(p,y,_),b[M+1]=f[M]-x+256&255;return b},h=function(f,d,g){if(f===d&&d===g)return f;var p=Math.abs(d-g),y=Math.abs(f-g),_=Math.abs(f+d-g-g);return p<=y&&p<=_?f:y<=_?d:g},c=function(){return[s,r,o,a,l]},u=function(f){var d=f.map(function(g){return g.reduce(function(p,y){return p+Math.abs(y)},0)});return d.indexOf(Math.min.apply(null,d))};i.processPNG=function(f,d,g,p){var y,_,x,b,L,M,k,A,T,F,q,R,S,O,E,U=this.decode.FLATE_DECODE,X="";if(this.__addimage__.isArrayBuffer(f)&&(f=new Uint8Array(f)),this.__addimage__.isArrayBufferView(f)){if(f=(x=new LO(f)).imgData,_=x.bits,y=x.colorSpace,L=x.colors,[4,6].indexOf(x.colorType)!==-1){if(x.bits===8){T=(A=x.pixelBitlength==32?new Uint32Array(x.decodePixels().buffer):x.pixelBitlength==16?new Uint16Array(x.decodePixels().buffer):new Uint8Array(x.decodePixels().buffer)).length,q=new Uint8Array(T*x.colors),F=new Uint8Array(T);var Z,st=x.pixelBitlength-x.bits;for(O=0,E=0;O<T;O++){for(S=A[O],Z=0;Z<st;)q[E++]=S>>>Z&255,Z+=x.bits;F[O]=S>>>Z&255}}if(x.bits===16){T=(A=new Uint32Array(x.decodePixels().buffer)).length,q=new Uint8Array(T*(32/x.pixelBitlength)*x.colors),F=new Uint8Array(T*(32/x.pixelBitlength)),R=x.colors>1,O=0,E=0;for(var tt=0;O<T;)S=A[O++],q[E++]=S>>>0&255,R&&(q[E++]=S>>>16&255,S=A[O++],q[E++]=S>>>0&255),F[tt++]=S>>>16&255;_=8}p!==i.image_compression.NONE&&t()?(f=e(q,x.width*x.colors,x.colors,p),k=e(F,x.width,1,p)):(f=q,k=F,U=void 0)}if(x.colorType===3&&(y=this.color_spaces.INDEXED,M=x.palette,x.transparency.indexed)){var ot=x.transparency.indexed,et=0;for(O=0,T=ot.length;O<T;++O)et+=ot[O];if((et/=255)===T-1&&ot.indexOf(0)!==-1)b=[ot.indexOf(0)];else if(et!==T){for(A=x.decodePixels(),F=new Uint8Array(A.length),O=0,T=A.length;O<T;O++)F[O]=ot[A[O]];k=e(F,x.width,1)}}var P=function(H){var j;switch(H){case i.image_compression.FAST:j=11;break;case i.image_compression.MEDIUM:j=13;break;case i.image_compression.SLOW:j=14;break;default:j=12}return j}(p);return U===this.decode.FLATE_DECODE&&(X="/Predictor "+P+" "),X+="/Colors "+L+" /BitsPerComponent "+_+" /Columns "+x.width,(this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),(k&&this.__addimage__.isArrayBuffer(k)||this.__addimage__.isArrayBufferView(k))&&(k=this.__addimage__.arrayBufferToBinaryString(k)),{alias:g,data:f,index:d,filter:U,decodeParameters:X,transparency:b,palette:M,sMask:k,predictor:P,width:x.width,height:x.height,bitsPerComponent:_,colorSpace:y}}}})(pe.API),function(i){i.processGIF89A=function(t,e,n,s){var r=new MO(t),o=r.width,a=r.height,l=[];r.decodeAndBlitFrameRGBA(0,l);var h={data:l,width:o,height:a},c=new K1(100).encode(h,100);return i.processJPEG.call(this,c,e,n,s)},i.processGIF87A=i.processGIF89A}(pe.API),yr.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var t=0;t<i;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:e,quad:r}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yr.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[i]()}catch(e){fi.log("bit decode error:"+e)}},yr.prototype.bit1=function(){var i,t=Math.ceil(this.width/8),e=t%4;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,s=0;s<t;s++)for(var r=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*s*4,a=0;a<8&&8*s+a<this.width;a++){var l=this.palette[r>>7-a&1];this.data[o+4*a]=l.blue,this.data[o+4*a+1]=l.green,this.data[o+4*a+2]=l.red,this.data[o+4*a+3]=255}e!==0&&(this.pos+=4-e)}},yr.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),t=i%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<i;s++){var r=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*s*4,a=r>>4,l=15&r,h=this.palette[a];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*s+1>=this.width)break;h=this.palette[l],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},yr.prototype.bit8=function(){for(var i=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),r=e*this.width*4+4*n;if(s<this.palette.length){var o=this.palette[s];this.data[r]=o.red,this.data[r+1]=o.green,this.data[r+2]=o.blue,this.data[r+3]=255}else this.data[r]=255,this.data[r+1]=255,this.data[r+2]=255,this.data[r+3]=255}i!==0&&(this.pos+=4-i)}},yr.prototype.bit15=function(){for(var i=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var r=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(r&t)/t*255|0,a=(r>>5&t)/t*255|0,l=(r>>10&t)/t*255|0,h=r>>15?255:0,c=n*this.width*4+4*s;this.data[c]=l,this.data[c+1]=a,this.data[c+2]=o,this.data[c+3]=h}this.pos+=i}},yr.prototype.bit16=function(){for(var i=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(o&t)/t*255|0,l=(o>>5&e)/e*255|0,h=(o>>11)/t*255|0,c=s*this.width*4+4*r;this.data[c]=h,this.data[c+1]=l,this.data[c+2]=a,this.data[c+3]=255}this.pos+=i}},yr.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=r,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},yr.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*e;this.data[a]=r,this.data[a+1]=s,this.data[a+2]=n,this.data[a+3]=o}},yr.prototype.getData=function(){return this.data},function(i){i.processBMP=function(t,e,n,s){var r=new yr(t,!1),o=r.width,a=r.height,l={data:r.getData(),width:o,height:a},h=new K1(100).encode(l,100);return i.processJPEG.call(this,h,e,n,s)}}(pe.API),ib.prototype.getData=function(){return this.data},function(i){i.processWEBP=function(t,e,n,s){var r=new ib(t),o=r.width,a=r.height,l={data:r.getData(),width:o,height:a},h=new K1(100).encode(l,100);return i.processJPEG.call(this,h,e,n,s)}}(pe.API),pe.API.processRGBA=function(i,t,e){for(var n=i.data,s=n.length,r=new Uint8Array(s/4*3),o=new Uint8Array(s/4),a=0,l=0,h=0;h<s;h+=4){var c=n[h],u=n[h+1],f=n[h+2],d=n[h+3];r[a++]=c,r[a++]=u,r[a++]=f,o[l++]=d}var g=this.__addimage__.arrayBufferToBinaryString(r);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},pe.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Zh=pe.API,Jg=Zh.getCharWidthsArray=function(i,t){var e,n,s=(t=t||{}).font||this.internal.getFont(),r=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:s.metadata.Unicode.widths,l=a.fof?a.fof:1,h=t.kerning?t.kerning:s.metadata.Unicode.kerning,c=h.fof?h.fof:1,u=t.doKerning!==!1,f=0,d=i.length,g=0,p=a[0]||l,y=[];for(e=0;e<d;e++)n=i.charCodeAt(e),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+o*(1e3/r)||0)/1e3):(f=u&&hi(h[n])==="object"&&!isNaN(parseInt(h[n][g],10))?h[n][g]/c:0,y.push((a[n]||p)/l+f)),g=n;return y},J5=Zh.getStringUnitWidth=function(i,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Zh.processArabic&&(i=Zh.processArabic(i)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(i,e,s)/e:Jg.apply(this,arguments).reduce(function(r,o){return r+o},0)},Q5=function(i,t,e,n){for(var s=[],r=0,o=i.length,a=0;r!==o&&a+t[r]<e;)a+=t[r],r++;s.push(i.slice(0,r));var l=r;for(a=0;r!==o;)a+t[r]>n&&(s.push(i.slice(l,r)),a=0,l=r),a+=t[r],r++;return l!==r&&s.push(i.slice(l,r)),s},tb=function(i,t,e){e||(e={});var n,s,r,o,a,l,h,c=[],u=[c],f=e.textIndent||0,d=0,g=0,p=i.split(" "),y=Jg.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?p[0].length+2:e.lineIndent||0){var _=Array(l).join(" "),x=[];p.map(function(L){(L=L.split(/\s*\n/)).length>1?x=x.concat(L.map(function(M,k){return(k&&M.length?`
`:"")+M})):x.push(L[0])}),p=x,l=J5.apply(this,[_,e])}for(r=0,o=p.length;r<o;r++){var b=0;if(n=p[r],l&&n[0]==`
`&&(n=n.substr(1),b=1),f+d+(g=(s=Jg.apply(this,[n,e])).reduce(function(L,M){return L+M},0))>t||b){if(g>t){for(a=Q5.apply(this,[n,s,t-(f+d),t]),c.push(a.shift()),c=[a.pop()];a.length;)u.push([a.shift()]);g=s.slice(n.length-(c[0]?c[0].length:0)).reduce(function(L,M){return L+M},0)}else c=[n];u.push(c),f=g+l,d=y}else c.push(n),f+=d+g,d=y}return h=l?function(L,M){return(M?_:"")+L.join(" ")}:function(L){return L.join(" ")},u.map(h)},Zh.splitTextToSize=function(i,t,e){var n,s=(e=e||{}).fontSize||this.internal.getFontSize(),r=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var u=this.internal.getFont(c.fontName,c.fontStyle);return u.metadata.Unicode?{widths:u.metadata.Unicode.widths||{0:1},kerning:u.metadata.Unicode.kerning||{}}:{font:u.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);n=Array.isArray(i)?i:String(i).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;r.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/s:0,r.lineIndent=e.lineIndent;var a,l,h=[];for(a=0,l=n.length;a<l;a++)h=h.concat(tb.apply(this,[n[a],o,r]));return h},function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},n={},s=0;s<t.length;s++)e[t[s]]="0123456789abcdef"[s],n["0123456789abcdef"[s]]=t[s];var r=function(u){return"0x"+parseInt(u,10).toString(16)},o=i.__fontmetrics__.compress=function(u){var f,d,g,p,y=["{"];for(var _ in u){if(f=u[_],isNaN(parseInt(_,10))?d="'"+_+"'":(_=parseInt(_,10),d=(d=r(_).slice(2)).slice(0,-1)+n[d.slice(-1)]),typeof f=="number")f<0?(g=r(f).slice(3),p="-"):(g=r(f).slice(2),p=""),g=p+g.slice(0,-1)+n[g.slice(-1)];else{if(hi(f)!=="object")throw new Error("Don't know what to do with value type "+hi(f)+".");g=o(f)}y.push(d+g)}return y.push("}"),y.join("")},a=i.__fontmetrics__.uncompress=function(u){if(typeof u!="string")throw new Error("Invalid argument passed to uncompress.");for(var f,d,g,p,y={},_=1,x=y,b=[],L="",M="",k=u.length-1,A=1;A<k;A+=1)(p=u[A])=="'"?f?(g=f.join(""),f=void 0):f=[]:f?f.push(p):p=="{"?(b.push([x,g]),x={},g=void 0):p=="}"?((d=b.pop())[0][d[1]]=x,g=void 0,x=d[0]):p=="-"?_=-1:g===void 0?e.hasOwnProperty(p)?(L+=e[p],g=parseInt(L,16)*_,_=1,L=""):L+=p:e.hasOwnProperty(p)?(M+=e[p],x[g]=parseInt(M,16)*_,_=1,g=void 0,M=""):M+=p;return y},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},c={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(u){var f=u.font,d=c.Unicode[f.postScriptName];d&&(f.metadata.Unicode={},f.metadata.Unicode.widths=d.widths,f.metadata.Unicode.kerning=d.kerning);var g=h.Unicode[f.postScriptName];g&&(f.metadata.Unicode.encoding=g,f.encoding=g.codePages[0])}])}(pe.API),function(i){var t=function(e){for(var n=e.length,s=new Uint8Array(n),r=0;r<n;r++)s[r]=e.charCodeAt(r);return s};i.API.events.push(["addFont",function(e){var n=void 0,s=e.font,r=e.instance;if(!s.isStandardFont){if(r===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=r.existsFileInVFS(s.postScriptName)===!1?r.loadFile(s.postScriptName):r.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(Md(a)),o.metadata=i.API.TTFFont.open(a),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,n)}}])}(pe),function(i){function t(){return(me.canvg?Promise.resolve(me.canvg):O_(()=>import("./index.es-XseexwNV.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}pe.API.addSvgAsImage=function(e,n,s,r,o,a,l,h){if(isNaN(n)||isNaN(s))throw fi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(o))throw fi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=o;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return t().then(function(g){return g.fromString(u,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(f)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),n,s,r,o,l,h)})}}(),pe.API.putTotalPages=function(i){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,e);return this},pe.API.viewerPreferences=function(i,t){var e;i=i||{},t=t||!1;var n,s,r,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(o),l=[],h=0,c=0,u=0;function f(g,p){var y,_=!1;for(y=0;y<g.length;y+=1)g[y]===p&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var d=a.length;for(u=0;u<d;u+=1)e[a[u]].value=e[a[u]].defaultValue,e[a[u]].explicitSet=!1}if(hi(i)==="object"){for(s in i)if(r=i[s],f(a,s)&&r!==void 0){if(e[s].type==="boolean"&&typeof r=="boolean")e[s].value=r;else if(e[s].type==="name"&&f(e[s].valueSet,r))e[s].value=r;else if(e[s].type==="integer"&&Number.isInteger(r))e[s].value=r;else if(e[s].type==="array"){for(h=0;h<r.length;h+=1)if(n=!0,r[h].length===1&&typeof r[h][0]=="number")l.push(String(r[h]-1));else if(r[h].length>1){for(c=0;c<r[h].length;c+=1)typeof r[h][c]!="number"&&(n=!1);n===!0&&l.push([r[h][0]-1,r[h][1]-1].join(" "))}e[s].value="["+l.join(" ")+"]"}else e[s].value=e[s].defaultValue;e[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,p=[];for(g in e)e[g].explicitSet===!0&&(e[g].type==="name"?p.push("/"+g+" /"+e[g].value):p.push("/"+g+" "+e[g].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(i){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),h=r.length+o.length+a.length+s.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(s+r+o+a+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(pe.API),function(i){var t=i.API,e=t.pdfEscape16=function(r,o){for(var a,l=o.metadata.Unicode.widths,h=["","0","00","000","0000"],c=[""],u=0,f=r.length;u<f;++u){if(a=o.metadata.characterToGlyph(r.charCodeAt(u)),o.metadata.glyIdsUsed.push(a),o.metadata.toUnicode[a]=r.charCodeAt(u),l.indexOf(a)==-1&&(l.push(a),l.push([parseInt(o.metadata.widthOfGlyph(a),10)])),a=="0")return c.join("");a=a.toString(16),c.push(h[4-a.length],a)}return c.join("")},n=function(r){var o,a,l,h,c,u,f;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],u=0,f=(a=Object.keys(r).sort(function(d,g){return d-g})).length;u<f;u++)o=a[u],l.length>=100&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),r[o]!==void 0&&r[o]!==null&&typeof r[o].toString=="function"&&(h=("0000"+r[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+h+">"));return l.length&&(c+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(r){(function(o){var a=o.font,l=o.out,h=o.newObject,c=o.putStream;if(a.metadata instanceof i.API.TTFFont&&a.encoding==="Identity-H"){for(var u=a.metadata.Unicode.widths,f=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),d="",g=0;g<f.length;g++)d+=String.fromCharCode(f[g]);var p=h();c({data:d,addLength1:!0,objectId:p}),l("endobj");var y=h();c({data:n(a.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var _=h();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+oc(a.fontName)),l("/FontFile2 "+p+" 0 R"),l("/FontBBox "+i.API.PDFObject.convert(a.metadata.bbox)),l("/Flags "+a.metadata.flags),l("/StemV "+a.metadata.stemV),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l(">>"),l("endobj");var x=h();l("<<"),l("/Type /Font"),l("/BaseFont /"+oc(a.fontName)),l("/FontDescriptor "+_+" 0 R"),l("/W "+i.API.PDFObject.convert(u)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+a.encoding+")"),l(">>"),l(">>"),l("endobj"),a.objectNumber=h(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+y+" 0 R"),l("/BaseFont /"+oc(a.fontName)),l("/Encoding /"+a.encoding),l("/DescendantFonts ["+x+" 0 R]"),l(">>"),l("endobj"),a.isAlreadyPutted=!0}})(r)}]),t.events.push(["putFont",function(r){(function(o){var a=o.font,l=o.out,h=o.newObject,c=o.putStream;if(a.metadata instanceof i.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var u=a.metadata.rawData,f="",d=0;d<u.length;d++)f+=String.fromCharCode(u[d]);var g=h();c({data:f,addLength1:!0,objectId:g}),l("endobj");var p=h();c({data:n(a.metadata.toUnicode),addLength1:!0,objectId:p}),l("endobj");var y=h();l("<<"),l("/Descent "+a.metadata.decender),l("/CapHeight "+a.metadata.capHeight),l("/StemV "+a.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+i.API.PDFObject.convert(a.metadata.bbox)),l("/FontName /"+oc(a.fontName)),l("/ItalicAngle "+a.metadata.italicAngle),l("/Ascent "+a.metadata.ascender),l(">>"),l("endobj"),a.objectNumber=h();for(var _=0;_<a.metadata.hmtx.widths.length;_++)a.metadata.hmtx.widths[_]=parseInt(a.metadata.hmtx.widths[_]*(1e3/a.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+oc(a.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),l("endobj"),a.isAlreadyPutted=!0}})(r)}]);var s=function(r){var o,a=r.text||"",l=r.x,h=r.y,c=r.options||{},u=r.mutex||{},f=u.pdfEscape,d=u.activeFontKey,g=u.fonts,p=d,y="",_=0,x="",b=g[p].encoding;if(g[p].encoding!=="Identity-H")return{text:a,x:l,y:h,options:c,mutex:u};for(x=a,p=d,Array.isArray(a)&&(x=a[0]),_=0;_<x.length;_+=1)g[p].metadata.hasOwnProperty("cmap")&&(o=g[p].metadata.cmap.unicode.codeMap[x[_].charCodeAt(0)]),o||x[_].charCodeAt(0)<256&&g[p].metadata.hasOwnProperty("Unicode")?y+=x[_]:y+="";var L="";return parseInt(p.slice(1))<14||b==="WinAnsiEncoding"?L=f(y,p).split("").map(function(M){return M.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(L=e(y,g[p])),u.isHex=!0,{text:L,x:l,y:h,options:c,mutex:u}};t.events.push(["postProcessText",function(r){var o=r.text||"",a=[],l={text:o,x:r.x,y:r.y,options:r.options,mutex:r.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?a.push([s(Object.assign({},l,{text:o[h][0]})).text,o[h][1],o[h][2]]):a.push(s(Object.assign({},l,{text:o[h]})).text);r.text=a}else r.text=s(Object.assign({},l,{text:o})).text}])}(pe),function(i){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},i.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},i.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(pe.API),function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(n){var s,r,o,a,l,h,c,u=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),x=!1,b=0;this.__bidiEngine__={};var L=function(R){var S=R.charCodeAt(),O=S>>8,E=p[O];return E!==void 0?u[256*E+(255&S)]:O===252||O===253?"AL":_.test(O)?"L":O===8?"R":"N"},M=function(R){for(var S,O=0;O<R.length;O++){if((S=L(R.charAt(O)))==="L")return!1;if(S==="R")return!0}return!1},k=function(R,S,O,E){var U,X,Z,st,tt=S[E];switch(tt){case"L":case"R":x=!1;break;case"N":case"AN":break;case"EN":x&&(tt="AN");break;case"AL":x=!0,tt="R";break;case"WS":tt="N";break;case"CS":E<1||E+1>=S.length||(U=O[E-1])!=="EN"&&U!=="AN"||(X=S[E+1])!=="EN"&&X!=="AN"?tt="N":x&&(X="AN"),tt=X===U?X:"N";break;case"ES":tt=(U=E>0?O[E-1]:"B")==="EN"&&E+1<S.length&&S[E+1]==="EN"?"EN":"N";break;case"ET":if(E>0&&O[E-1]==="EN"){tt="EN";break}if(x){tt="N";break}for(Z=E+1,st=S.length;Z<st&&S[Z]==="ET";)Z++;tt=Z<st&&S[Z]==="EN"?"EN":"N";break;case"NSM":if(o&&!a){for(st=S.length,Z=E+1;Z<st&&S[Z]==="NSM";)Z++;if(Z<st){var ot=R[E],et=ot>=1425&&ot<=2303||ot===64286;if(U=S[Z],et&&(U==="R"||U==="AL")){tt="R";break}}}tt=E<1||(U=S[E-1])==="B"?"N":O[E-1];break;case"B":x=!1,s=!0,tt=b;break;case"S":r=!0,tt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":x=!1;break;case"BN":tt="N"}return tt},A=function(R,S,O){var E=R.split("");return O&&T(E,O,{hiLevel:b}),E.reverse(),S&&S.reverse(),E.join("")},T=function(R,S,O){var E,U,X,Z,st,tt=-1,ot=R.length,et=0,P=[],H=b?d:f,j=[];for(x=!1,s=!1,r=!1,U=0;U<ot;U++)j[U]=L(R[U]);for(X=0;X<ot;X++){if(st=et,P[X]=k(R,j,P,X),E=240&(et=H[st][g[P[X]]]),et&=15,S[X]=Z=H[et][5],E>0)if(E===16){for(U=tt;U<X;U++)S[U]=1;tt=-1}else tt=-1;if(H[et][6])tt===-1&&(tt=X);else if(tt>-1){for(U=tt;U<X;U++)S[U]=Z;tt=-1}j[X]==="B"&&(S[X]=0),O.hiLevel|=Z}r&&function(K,ht,ft){for(var gt=0;gt<ft;gt++)if(K[gt]==="S"){ht[gt]=b;for(var _t=gt-1;_t>=0&&K[_t]==="WS";_t--)ht[_t]=b}}(j,S,ot)},F=function(R,S,O,E,U){if(!(U.hiLevel<R)){if(R===1&&b===1&&!s)return S.reverse(),void(O&&O.reverse());for(var X,Z,st,tt,ot=S.length,et=0;et<ot;){if(E[et]>=R){for(st=et+1;st<ot&&E[st]>=R;)st++;for(tt=et,Z=st-1;tt<Z;tt++,Z--)X=S[tt],S[tt]=S[Z],S[Z]=X,O&&(X=O[tt],O[tt]=O[Z],O[Z]=X);et=st}et++}}},q=function(R,S,O){var E=R.split(""),U={hiLevel:b};return O||(O=[]),T(E,O,U),function(X,Z,st){if(st.hiLevel!==0&&c)for(var tt,ot=0;ot<X.length;ot++)Z[ot]===1&&(tt=y.indexOf(X[ot]))>=0&&(X[ot]=y[tt+1])}(E,O,U),F(2,E,S,O,U),F(1,E,S,O,U),E.join("")};return this.__bidiEngine__.doBidiReorder=function(R,S,O){if(function(U,X){if(X)for(var Z=0;Z<U.length;Z++)X[Z]=Z;a===void 0&&(a=M(U)),h===void 0&&(h=M(U))}(R,S),o||!l||h)if(o&&l&&a^h)b=a?1:0,R=A(R,S,O);else if(!o&&l&&h)b=a?1:0,R=q(R,S,O),R=A(R,S);else if(!o||a||l||h){if(o&&!l&&a^h)R=A(R,S),a?(b=0,R=q(R,S,O)):(b=1,R=q(R,S,O),R=A(R,S));else if(o&&a&&!l&&h)b=1,R=q(R,S,O),R=A(R,S);else if(!o&&!l&&a^h){var E=c;a?(b=1,R=q(R,S,O),b=0,c=!1,R=q(R,S,O),c=E):(b=0,R=q(R,S,O),R=A(R,S),b=1,c=!1,R=q(R,S,O),c=E,R=A(R,S))}}else b=0,R=q(R,S,O);else b=a?1:0,R=q(R,S,O);return R},this.__bidiEngine__.setOptions=function(R){R&&(o=R.isInputVisual,l=R.isOutputVisual,a=R.isInputRtl,h=R.isOutputRtl,c=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(n){var s=n.text,r=(n.x,n.y,n.options||{}),o=(n.mutex,r.lang,[]);if(r.isInputVisual=typeof r.isInputVisual!="boolean"||r.isInputVisual,e.setOptions(r),Object.prototype.toString.call(s)==="[object Array]"){var a=0;for(o=[],a=0;a<s.length;a+=1)Object.prototype.toString.call(s[a])==="[object Array]"?o.push([e.doBidiReorder(s[a][0]),s[a][1],s[a][2]]):o.push([e.doBidiReorder(s[a])]);n.text=o}else n.text=e.doBidiReorder(s);e.setOptions({isInputVisual:!0})}])}(pe),pe.API.TTFFont=function(){function i(t){var e;if(this.rawData=t,e=this.contents=new $a(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new UO(this),this.registerTTF()}return i.open=function(t){return new i(t)},i.prototype.parse=function(){return this.directory=new TO(this.contents),this.head=new PO(this),this.name=new FO(this),this.cmap=new PC(this),this.toUnicode={},this.hhea=new IO(this),this.maxp=new OO(this),this.hmtx=new DO(this),this.post=new NO(this),this.os2=new RO(this),this.loca=new GO(this),this.glyf=new BO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var t,e,n,s,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,a,l,h;for(h=[],o=0,a=(l=this.bbox).length;o<a;o++)t=l[o],h.push(Math.round(t*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(e=s>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(r=this.familyClass)===1||r===2||r===3||r===4||r===5||r===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},i.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},i.prototype.widthOfString=function(t,e,n){var s,r,o,a;for(o=0,r=0,a=(t=""+t).length;0<=a?r<a:r>a;r=0<=a?++r:--r)s=t.charCodeAt(r),o+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/e)||0;return o*(e/1e3)},i.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},i}();var kr,$a=function(){function i(t){this.data=t??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(t){return this.data[this.pos++]=t},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},i.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},i.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},i.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},i.prototype.writeString=function(t){var e,n,s;for(s=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)s.push(this.writeByte(t.charCodeAt(e)));return s},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(t){return this.writeInt16(t)},i.prototype.readLongLong=function(){var t,e,n,s,r,o,a,l;return t=this.readByte(),e=this.readByte(),n=this.readByte(),s=this.readByte(),r=this.readByte(),o=this.readByte(),a=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^r)+65536*(255^o)+256*(255^a)+(255^l)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*s+16777216*r+65536*o+256*a+l},i.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(t){return this.writeInt32(t)},i.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},i.prototype.write=function(t){var e,n,s,r;for(r=[],n=0,s=t.length;n<s;n++)e=t[n],r.push(this.writeByte(e));return r},i}(),TO=function(){var i;function t(e){var n,s,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},s=0,r=this.tableCount;0<=r?s<r:s>r;s=0<=r?++s:--s)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,s,r,o,a,l,h,c,u,f,d,g,p;for(p in d=Object.keys(e).length,l=Math.log(2),u=16*Math.floor(Math.log(d)/l),o=Math.floor(u/l),c=16*d-u,(s=new $a).writeInt(this.scalarType),s.writeShort(d),s.writeShort(u),s.writeShort(o),s.writeShort(c),r=16*d,h=s.pos+r,a=null,g=[],e)for(f=e[p],s.writeString(p),s.writeInt(i(f)),s.writeInt(h),s.writeInt(f.length),g=g.concat(f),p==="head"&&(a=h),h+=f.length;h%4;)g.push(0),h++;return s.write(g),n=2981146554-i(s.data),s.pos=a+8,s.writeUInt32(n),s.data},i=function(e){var n,s,r,o;for(e=IC.call(e);e.length%4;)e.push(0);for(r=new $a(e),s=0,n=0,o=e.length;n<o;n=n+=4)s+=r.readUInt32();return 4294967295&s},t}(),AO={}.hasOwnProperty,fo=function(i,t){for(var e in t)AO.call(t,e)&&(i[e]=t[e]);function n(){this.constructor=i}return n.prototype=t.prototype,i.prototype=new n,i.__super__=t.prototype,i};kr=function(){function i(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i}();var PO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var n;return(n=new $a).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(e),n.writeShort(this.glyphDataFormat),n.data},t}(),nb=function(){function i(t,e){var n,s,r,o,a,l,h,c,u,f,d,g,p,y,_,x,b;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),u=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),f=d/2,t.pos+=6,r=function(){var L,M;for(M=[],l=L=0;0<=f?L<f:L>f;l=0<=f?++L:--L)M.push(t.readUInt16());return M}(),t.pos+=2,p=function(){var L,M;for(M=[],l=L=0;0<=f?L<f:L>f;l=0<=f?++L:--L)M.push(t.readUInt16());return M}(),h=function(){var L,M;for(M=[],l=L=0;0<=f?L<f:L>f;l=0<=f?++L:--L)M.push(t.readUInt16());return M}(),c=function(){var L,M;for(M=[],l=L=0;0<=f?L<f:L>f;l=0<=f?++L:--L)M.push(t.readUInt16());return M}(),s=(this.length-t.pos+this.offset)/2,a=function(){var L,M;for(M=[],l=L=0;0<=s?L<s:L>s;l=0<=s?++L:--L)M.push(t.readUInt16());return M}(),l=_=0,b=r.length;_<b;l=++_)for(y=r[l],n=x=g=p[l];g<=y?x<=y:x>=y;n=g<=y?++x:--x)c[l]===0?o=n+h[l]:(o=a[c[l]/2+(n-g)-(f-l)]||0)!==0&&(o+=h[l]),this.codeMap[n]=65535&o}t.pos=u}return i.encode=function(t,e){var n,s,r,o,a,l,h,c,u,f,d,g,p,y,_,x,b,L,M,k,A,T,F,q,R,S,O,E,U,X,Z,st,tt,ot,et,P,H,j,K,ht,ft,gt,_t,Pt,Tt,Wt;switch(E=new $a,o=Object.keys(t).sort(function(Gt,N){return Gt-N}),e){case"macroman":for(p=0,y=function(){var Gt=[];for(g=0;g<256;++g)Gt.push(0);return Gt}(),x={0:0},r={},U=0,tt=o.length;U<tt;U++)x[_t=t[s=o[U]]]==null&&(x[_t]=++p),r[s]={old:t[s],new:x[t[s]]},y[s]=x[t[s]];return E.writeUInt16(1),E.writeUInt16(0),E.writeUInt32(12),E.writeUInt16(0),E.writeUInt16(262),E.writeUInt16(0),E.write(y),{charMap:r,subtable:E.data,maxGlyphID:p+1};case"unicode":for(S=[],u=[],b=0,x={},n={},_=h=null,X=0,ot=o.length;X<ot;X++)x[M=t[s=o[X]]]==null&&(x[M]=++b),n[s]={old:M,new:x[M]},a=x[M]-s,_!=null&&a===h||(_&&u.push(_),S.push(s),h=a),_=s;for(_&&u.push(_),u.push(65535),S.push(65535),q=2*(F=S.length),T=2*Math.pow(Math.log(F)/Math.LN2,2),f=Math.log(T/2)/Math.LN2,A=2*F-T,l=[],k=[],d=[],g=Z=0,et=S.length;Z<et;g=++Z){if(R=S[g],c=u[g],R===65535){l.push(0),k.push(0);break}if(R-(O=n[R].new)>=32768)for(l.push(0),k.push(2*(d.length+F-g)),s=st=R;R<=c?st<=c:st>=c;s=R<=c?++st:--st)d.push(n[s].new);else l.push(O-R),k.push(0)}for(E.writeUInt16(3),E.writeUInt16(1),E.writeUInt32(12),E.writeUInt16(4),E.writeUInt16(16+8*F+2*d.length),E.writeUInt16(0),E.writeUInt16(q),E.writeUInt16(T),E.writeUInt16(f),E.writeUInt16(A),ft=0,P=u.length;ft<P;ft++)s=u[ft],E.writeUInt16(s);for(E.writeUInt16(0),gt=0,H=S.length;gt<H;gt++)s=S[gt],E.writeUInt16(s);for(Pt=0,j=l.length;Pt<j;Pt++)a=l[Pt],E.writeUInt16(a);for(Tt=0,K=k.length;Tt<K;Tt++)L=k[Tt],E.writeUInt16(L);for(Wt=0,ht=d.length;Wt<ht;Wt++)p=d[Wt],E.writeUInt16(p);return{charMap:n,subtable:E.data,maxGlyphID:b+1}}},i}(),PC=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="cmap",t.prototype.parse=function(e){var n,s,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n=new nb(e,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(e,n){var s,r;return n==null&&(n="macroman"),s=nb.encode(e,n),(r=new $a).writeUInt16(0),r.writeUInt16(1),s.table=r.data.concat(s.subtable),s},t}(),IO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),RO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var n,s;for(s=[],n=0;n<10;++n)s.push(e.readByte());return s}(),this.charRange=function(){var n,s;for(s=[],n=0;n<4;++n)s.push(e.readInt());return s}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var n,s;for(s=[],n=0;n<2;n=++n)s.push(e.readInt());return s}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),NO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="post",t.prototype.parse=function(e){var n,s,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var o;for(s=e.readUInt16(),this.glyphNameIndex=[],o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)n=e.readByte(),r.push(this.names.push(e.readString(n)));return r;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 196608:break;case 262144:return this.map=(function(){var a,l,h;for(h=[],o=a=0,l=this.file.maxp.numGlyphs;0<=l?a<l:a>l;o=0<=l?++a:--a)h.push(e.readUInt32());return h}).call(this)}},t}(),kO=function(i,t){this.raw=i,this.length=i.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},FO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="name",t.prototype.parse=function(e){var n,s,r,o,a,l,h,c,u,f,d;for(e.pos=this.offset,e.readShort(),n=e.readShort(),l=e.readShort(),s=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+l+e.readShort()});for(h={},o=u=0,f=s.length;u<f;o=++u)r=s[o],e.pos=r.offset,c=e.readString(r.length),a=new kO(c,r),h[d=r.nameID]==null&&(h[d]=[]),h[r.nameID].push(a);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},t}(),OO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),DO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="hmtx",t.prototype.parse=function(e){var n,s,r,o,a,l,h;for(e.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,u;for(u=[],n=c=0;0<=r?c<r:c>r;n=0<=r?++c:--c)u.push(e.readInt16());return u}(),this.widths=(function(){var c,u,f,d;for(d=[],c=0,u=(f=this.metrics).length;c<u;c++)o=f[c],d.push(o.advance);return d}).call(this),s=this.widths[this.widths.length-1],h=[],n=a=0;0<=r?a<r:a>r;n=0<=r?++a:--a)h.push(this.widths.push(s));return h},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),IC=[].slice,BO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var n,s,r,o,a,l,h,c,u,f;return e in this.cache?this.cache[e]:(o=this.file.loca,n=this.file.contents,s=o.indexOf(e),(r=o.lengthOf(e))===0?this.cache[e]=null:(n.pos=this.offset+s,a=(l=new $a(n.read(r))).readShort(),c=l.readShort(),f=l.readShort(),h=l.readShort(),u=l.readShort(),this.cache[e]=a===-1?new zO(l,c,f,h,u):new jO(l,a,c,f,h,u),this.cache[e]))},t.prototype.encode=function(e,n,s){var r,o,a,l,h;for(a=[],o=[],l=0,h=n.length;l<h;l++)r=e[n[l]],o.push(a.length),r&&(a=a.concat(r.encode(s)));return o.push(a.length),{table:a,offsets:o}},t}(),jO=function(){function i(t,e,n,s,r,o){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=s,this.xMax=r,this.yMax=o,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i}(),zO=function(){function i(t,e,n,s,r){var o,a;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=s,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;a=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&a;)o.pos+=1&a?4:2,128&a?o.pos+=8:64&a?o.pos+=4:8&a&&(o.pos+=2)}return i.prototype.encode=function(){var t,e,n;for(e=new $a(IC.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},i}(),GO=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return fo(t,kr),t.prototype.tag="loca",t.prototype.parse=function(e){var n,s;return e.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var r,o;for(o=[],s=0,r=this.length;s<r;s+=2)o.push(2*e.readUInt16());return o}).call(this):(function(){var r,o;for(o=[],s=0,r=this.length;s<r;s+=4)o.push(e.readUInt32());return o}).call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,n){for(var s=new Uint32Array(this.offsets.length),r=0,o=0,a=0;a<s.length;++a)if(s[a]=r,o<n.length&&n[o]==a){++o,s[a]=r;var l=this.offsets[a],h=this.offsets[a+1]-l;h>0&&(r+=h)}for(var c=new Array(4*s.length),u=0;u<s.length;++u)c[4*u+3]=255&s[u],c[4*u+2]=(65280&s[u])>>8,c[4*u+1]=(16711680&s[u])>>16,c[4*u]=(4278190080&s[u])>>24;return c},t}(),UO=function(){function i(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var t,e,n,s,r;for(e in s=this.font.cmap.tables[0].codeMap,t={},r=this.subset)n=r[e],t[e]=s[n];return t},i.prototype.glyphsFor=function(t){var e,n,s,r,o,a,l;for(s={},o=0,a=t.length;o<a;o++)s[r=t[o]]=this.font.glyf.glyphFor(r);for(r in e=[],s)(n=s[r])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(r in l=this.glyphsFor(e))n=l[r],s[r]=n;return s},i.prototype.encode=function(t,e){var n,s,r,o,a,l,h,c,u,f,d,g,p,y,_;for(s in n=PC.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),d={0:0},_=n.charMap)d[(l=_[s]).old]=l.new;for(g in f=n.maxGlyphID,o)g in d||(d[g]=f++);return c=function(x){var b,L;for(b in L={},x)L[x[b]]=b;return L}(d),u=Object.keys(c).sort(function(x,b){return x-b}),p=function(){var x,b,L;for(L=[],x=0,b=u.length;x<b;x++)a=u[x],L.push(c[a]);return L}(),r=this.font.glyf.encode(o,p,d),h=this.font.loca.encode(r.offsets,p),y={cmap:this.font.cmap.raw(),glyf:r.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},i}();pe.API.PDFObject=function(){var i;function t(){}return i=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,s,r,o;if(Array.isArray(e))return"["+function(){var a,l,h;for(h=[],a=0,l=e.length;a<l;a++)n=e[a],h.push(t.convert(n));return h}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+i(e.getUTCFullYear(),4)+i(e.getUTCMonth(),2)+i(e.getUTCDate(),2)+i(e.getUTCHours(),2)+i(e.getUTCMinutes(),2)+i(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(s in r=["<<"],e)o=e[s],r.push("/"+s+" "+t.convert(o));return r.push(">>"),r.join(`
`)}return""+e},t}();class H2{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=gi,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?xe(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()==="tile-pixels"&&(n=xe(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return de()}readFeature(t,e){return de()}readFeatures(t,e){return de()}readGeometry(t,e){return de()}readProjection(t){return de()}writeFeature(t,e){return de()}writeFeatures(t,e){return de()}writeGeometry(t,e){return de()}}function qs(i,t,e){const n=e?xe(e.featureProjection):null,s=e?xe(e.dataProjection):null;let r=i;if(n&&s&&!Kr(n,s)){t&&(r=i.clone());const o=t?n:s,a=t?s:n;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(Dc(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,c=l.length;h<c;++h)l[h]=Math.round(l[h]*o)/o;return l};r===i&&(r=i.clone()),r.applyTransform(a)}return r}const WO={Point:Qi,LineString:cn,Polygon:sr,MultiPoint:nh,MultiLineString:ho,MultiPolygon:qa};function qO(i,t,e){return Array.isArray(t[0])?(wS(i,0,t,e)||(i=i.slice(),S_(i,0,t,e)),i):(Ky(i,0,t,e)||(i=i.slice(),Vp(i,0,t,e)),i)}function RC(i,t){var r;const e=i.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>RC({...i,geometry:o})).flat();const n=e.type==="MultiPolygon"?"Polygon":e.type;if(n==="GeometryCollection"||n==="Circle")throw new Error("Unsupported geometry type: "+n);const s=e.layout.length;return qs(new Bs(n,n==="Polygon"?qO(e.flatCoordinates,e.ends,s):e.flatCoordinates,(r=e.ends)==null?void 0:r.flat(),s,i.properties||{},i.id).enableSimplifyTransformed(),!1,t)}function Y2(i,t){if(!i)return null;if(Array.isArray(i)){const n=i.map(s=>Y2(s,t));return new rr(n)}const e=WO[i.type];return qs(new e(i.flatCoordinates,i.layout,i.ends),!1,t)}class NC extends H2{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Qg(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Qg(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return de()}readFeaturesFromObject(t,e){return de()}readGeometry(t,e){return this.readGeometryFromObject(Qg(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return de()}readProjection(t){return this.readProjectionFromObject(Qg(t))}readProjectionFromObject(t){return de()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return de()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return de()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return de()}}function Qg(i){if(typeof i=="string"){const t=JSON.parse(i);return t||null}return i!==null?i:null}class nm extends NC{constructor(t){t=t||{},super(),this.dataProjection=xe(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=xe(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};const s=X2(n.geometry);if(this.featureClass===Bs)return RC({geometry:s,id:n.id,properties:n.properties},e);const r=new gi;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&r.setGeometryName(n.geometry_name),r.setGeometry(Y2(s,e)),"id"in n&&r.setId(n.id),n.properties&&r.setProperties(n.properties,!0),r}readFeaturesFromObject(t,e){const n=t;let s=null;if(n.type==="FeatureCollection"){const r=t;s=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],e);h&&s.push(h)}}else s=[this.readFeatureFromObject(t,e)];return s.flat()}readGeometryFromObject(t,e){return VO(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if(e.type=="name")n=xe(e.properties.name);else if(e.type==="EPSG")n=xe("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},s=t.getId();if(s!==void 0&&(n.id=s),!t.hasProperties())return n;const r=t.getProperties(),o=t.getGeometry();return o&&(n.geometry=ty(o,e),delete r[t.getGeometryName()]),Ul(r)||(n.properties=r),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let s=0,r=t.length;s<r;++s)n.push(this.writeFeatureObject(t[s],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return ty(t,this.adaptOptions(e))}}function X2(i,t){if(!i)return null;let e;switch(i.type){case"Point":{e=YO(i);break}case"LineString":{e=XO(i);break}case"Polygon":{e=JO(i);break}case"MultiPoint":{e=KO(i);break}case"MultiLineString":{e=$O(i);break}case"MultiPolygon":{e=ZO(i);break}case"GeometryCollection":{e=HO(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return e}function VO(i,t){const e=X2(i);return Y2(e,t)}function HO(i,t){return i.geometries.map(function(n){return X2(n)})}function YO(i){const t=i.coordinates;return{type:"Point",flatCoordinates:t,layout:eh(t.length)}}function XO(i){var n;const t=i.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:eh(((n=t[0])==null?void 0:n.length)||2)}}function $O(i){var r,o;const t=i.coordinates,e=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length)||2,n=[],s=Sf(n,0,t,e);return{type:"MultiLineString",flatCoordinates:n,ends:s,layout:eh(e)}}function KO(i){var e;const t=i.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:eh(((e=t[0])==null?void 0:e.length)||2)}}function ZO(i){var r,o;const t=i.coordinates,e=[],n=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,s=fS(e,0,t,n);return{type:"MultiPolygon",flatCoordinates:e,ends:s,layout:eh(n)}}function JO(i){var r,o;const t=i.coordinates,e=[],n=(o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length,s=Sf(e,0,t,n);return{type:"Polygon",flatCoordinates:e,ends:s,layout:eh(n)}}function ty(i,t){i=qs(i,!0,t);const e=i.getType();let n;switch(e){case"Point":{n=s8(i);break}case"LineString":{n=t8(i);break}case"Polygon":{n=r8(i,t);break}case"MultiPoint":{n=i8(i);break}case"MultiLineString":{n=e8(i);break}case"MultiPolygon":{n=n8(i,t);break}case"GeometryCollection":{n=QO(i,t);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return n}function QO(i,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return ty(n,t)})}}function t8(i,t){return{type:"LineString",coordinates:i.getCoordinates()}}function e8(i,t){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function i8(i,t){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function n8(i,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(e)}}function s8(i,t){return{type:"Point",coordinates:i.getCoordinates()}}function r8(i,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(e)}}const _0="http://www.w3.org/2001/XMLSchema-instance";function lh(i,t){return eu().createElementNS(i,t)}function Fr(i,t){return kC(i,t,[]).join("")}function kC(i,t,e){if(i.nodeType==Node.CDATA_SECTION_NODE||i.nodeType==Node.TEXT_NODE)e.push(i.nodeValue);else{let n;for(n=i.firstChild;n;n=n.nextSibling)kC(n,t,e)}return e}function eo(i){return"documentElement"in i}function io(i){return new DOMParser().parseFromString(i,"application/xml")}function sb(i,t){return function(e,n){const s=i.call(t??this,e,n);if(s!==void 0){const r=n[n.length-1];Ye(r,s)}}}function bs(i,t){return function(e,n){const s=i.call(t??this,e,n);s!==void 0&&n[n.length-1].push(s)}}function $2(i,t){return function(e,n){const s=i.call(this,e,n);s!==void 0&&(n[n.length-1]=s)}}function ys(i,t,e){return function(n,s){const r=i.call(this,n,s);if(r!==void 0){const o=s[s.length-1],a=n.localName;let l;a in o?l=o[a]:(l=[],o[a]=l),l.push(r)}}}function bt(i,t,e){return function(n,s){const r=i.call(this,n,s);if(r!==void 0){const o=s[s.length-1],a=t!==void 0?t:n.localName;o[a]=r}}}function Ut(i,t){return function(e,n,s){i.call(this,e,n,s),s[s.length-1].node.appendChild(e)}}function FC(i,t){let e,n;return function(s,r,o){if(e===void 0){e={};const a={};a[s.localName]=i,e[s.namespaceURI]=a,n=Or(s.localName)}OC(e,n,r,o)}}function Or(i,t){return function(e,n,s){const o=n[n.length-1].node;let a=i;a===void 0&&(a=s);const l=o.namespaceURI;return lh(l,a)}}const Vn=Or();function Cs(i,t){const e=t.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=i[t[s]];return n}function Ft(i,t,e){e=e!==void 0?e:{};let n,s;for(n=0,s=i.length;n<s;++n)e[i[n]]=t;return e}function il(i,t,e,n){let s;for(s=t.firstElementChild;s;s=s.nextElementSibling){const r=i[s.namespaceURI];if(r!==void 0){const o=r[s.localName];o!==void 0&&o.call(n,s,e)}}}function oe(i,t,e,n,s){return n.push(i),il(t,e,n,s),n.pop()}function OC(i,t,e,n,s,r){const o=(s!==void 0?s:e).length;let a,l;for(let h=0;h<o;++h)a=e[h],a!==void 0&&(l=t.call(r,a,n,s!==void 0?s[h]:void 0),l!==void 0&&i[l.namespaceURI][l.localName].call(r,l,a,n))}function pi(i,t,e,n,s,r,o){return s.push(i),OC(t,e,n,s,r,o),s.pop()}let Z1;function o8(){return Z1===void 0&&typeof XMLSerializer<"u"&&(Z1=new XMLSerializer),Z1}let J1;function eu(){return J1===void 0&&typeof document<"u"&&(J1=document.implementation.createDocument("","",null)),J1}class DC extends H2{constructor(){super(),this.xmlSerializer_=o8()}getType(){return"xml"}readFeature(t,e){if(!t)return null;if(typeof t=="string"){const n=io(t);return this.readFeatureFromDocument(n,e)}return eo(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}readFeatureFromDocument(t,e){const n=this.readFeaturesFromDocument(t,e);return n.length>0?n[0]:null}readFeatureFromNode(t,e){return null}readFeatures(t,e){if(!t)return[];if(typeof t=="string"){const n=io(t);return this.readFeaturesFromDocument(n,e)}return eo(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}readFeaturesFromDocument(t,e){const n=[];for(let s=t.firstChild;s;s=s.nextSibling)s.nodeType==Node.ELEMENT_NODE&&Ye(n,this.readFeaturesFromNode(s,e));return n}readFeaturesFromNode(t,e){return de()}readGeometry(t,e){if(!t)return null;if(typeof t=="string"){const n=io(t);return this.readGeometryFromDocument(n,e)}return eo(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}readGeometryFromDocument(t,e){return null}readGeometryFromNode(t,e){return null}readProjection(t){if(!t)return null;if(typeof t=="string"){const e=io(t);return this.readProjectionFromDocument(e)}return eo(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}readProjectionFromDocument(t){return this.dataProjection}readProjectionFromNode(t){return this.dataProjection}writeFeature(t,e){const n=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeFeatureNode(t,e){return null}writeFeatures(t,e){const n=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeFeaturesNode(t,e){return null}writeGeometry(t,e){const n=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeGeometryNode(t,e){return null}}function Ka(i){const t=Fr(i,!1);return a8(t)}function a8(i){const t=/^\s*(true|1)|(false|0)\s*$/.exec(i);if(t)return t[1]!==void 0||!1}function sm(i){const t=Fr(i,!1),e=Date.parse(t);return isNaN(e)?void 0:e/1e3}function Xe(i){const t=Fr(i,!1);return l8(t)}function l8(i){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(i);if(t)return parseFloat(t[1])}function Gs(i){const t=Fr(i,!1);return h8(t)}function h8(i){const t=/^\s*(\d+)\s*$/.exec(i);if(t)return parseInt(t[1],10)}function $t(i){return Fr(i,!1).trim()}function Vc(i,t){ni(i,t?"1":"0")}function c8(i,t){i.appendChild(eu().createCDATASection(t))}function u8(i,t){const e=new Date(t*1e3),n=e.getUTCFullYear()+"-"+Ou(e.getUTCMonth()+1,2)+"-"+Ou(e.getUTCDate(),2)+"T"+Ou(e.getUTCHours(),2)+":"+Ou(e.getUTCMinutes(),2)+":"+Ou(e.getUTCSeconds(),2)+"Z";i.appendChild(eu().createTextNode(n))}function ps(i,t){const e=t.toPrecision();i.appendChild(eu().createTextNode(e))}function y0(i,t){const e=t.toString();i.appendChild(eu().createTextNode(e))}function ni(i,t){i.appendChild(eu().createTextNode(t))}const Ei=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],d8="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",f8={rte:BC,trk:jC,wpt:zC},g8=Ft(Ei,{rte:bs(BC),trk:bs(jC),wpt:bs(zC)}),p8=Ft(Ei,{text:bt($t,"linkText"),type:bt($t,"linkType")}),m8=Ft(Ei,{name:bt($t),email:W8,link:Nf}),_8=Ft(Ei,{name:bt($t),desc:bt($t),author:bt(z8),copyright:bt(G8),link:Nf,time:bt(sm),keywords:bt($t),bounds:U8,extensions:rm}),y8=Ft(Ei,{year:bt(Gs),license:bt($t)}),v8=Ft(Ei,{rte:Ut(Y8),trk:Ut(X8),wpt:Ut(K8)});class x8 extends DC{constructor(t){super(),t=t||{},this.dataProjection=xe("EPSG:4326"),this.readExtensions_=t.readExtensions}handleReadExtensions_(t){t||(t=[]);for(let e=0,n=t.length;e<n;++e){const s=t[e];if(this.readExtensions_){const r=s.get("extensionsNode_")||null;this.readExtensions_(s,r)}s.set("extensionsNode_",void 0)}}readMetadata(t){return t?typeof t=="string"?this.readMetadataFromDocument(io(t)):eo(t)?this.readMetadataFromDocument(t):this.readMetadataFromNode(t):null}readMetadataFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType===Node.ELEMENT_NODE){const n=this.readMetadataFromNode(e);if(n)return n}return null}readMetadataFromNode(t){if(!Ei.includes(t.namespaceURI))return null;for(let e=t.firstElementChild;e;e=e.nextElementSibling)if(Ei.includes(e.namespaceURI)&&e.localName==="metadata")return oe({},_8,e,[]);return null}readFeatureFromNode(t,e){if(!Ei.includes(t.namespaceURI))return null;const n=f8[t.localName];if(!n)return null;const s=n(t,[this.getReadOptions(t,e)]);return s?(this.handleReadExtensions_([s]),s):null}readFeaturesFromNode(t,e){if(!Ei.includes(t.namespaceURI))return[];if(t.localName=="gpx"){const n=oe([],g8,t,[this.getReadOptions(t,e)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}writeFeaturesNode(t,e){e=this.adaptOptions(e);const n=lh("http://www.topografix.com/GPX/1/1","gpx");return n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",_0),n.setAttributeNS(_0,"xsi:schemaLocation",d8),n.setAttribute("version","1.1"),n.setAttribute("creator","OpenLayers"),pi({node:n},v8,j8,t,[e]),n}}const b8=Ft(Ei,{name:bt($t),cmt:bt($t),desc:bt($t),src:bt($t),link:Nf,number:bt(Gs),extensions:rm,type:bt($t),rtept:q8}),w8=Ft(Ei,{ele:bt(Xe),time:bt(sm)}),S8=Ft(Ei,{name:bt($t),cmt:bt($t),desc:bt($t),src:bt($t),link:Nf,number:bt(Gs),type:bt($t),extensions:rm,trkseg:H8}),E8=Ft(Ei,{trkpt:V8}),C8=Ft(Ei,{ele:bt(Xe),time:bt(sm)}),L8=Ft(Ei,{ele:bt(Xe),time:bt(sm),magvar:bt(Xe),geoidheight:bt(Xe),name:bt($t),cmt:bt($t),desc:bt($t),src:bt($t),link:Nf,sym:bt($t),type:bt($t),fix:bt($t),sat:bt(Gs),hdop:bt(Xe),vdop:bt(Xe),pdop:bt(Xe),ageofdgpsdata:bt(Xe),dgpsid:bt(Gs),extensions:rm}),M8=["text","type"],T8=Ft(Ei,{text:Ut(ni),type:Ut(ni)}),A8=Ft(Ei,["name","cmt","desc","src","link","number","type","rtept"]),P8=Ft(Ei,{name:Ut(ni),cmt:Ut(ni),desc:Ut(ni),src:Ut(ni),link:Ut(J2),number:Ut(y0),type:Ut(ni),rtept:FC(Ut(Q2))}),I8=Ft(Ei,["ele","time"]),R8=Ft(Ei,["name","cmt","desc","src","link","number","type","trkseg"]),N8=Ft(Ei,{name:Ut(ni),cmt:Ut(ni),desc:Ut(ni),src:Ut(ni),link:Ut(J2),number:Ut(y0),type:Ut(ni),trkseg:FC(Ut($8))}),k8=Or("trkpt"),F8=Ft(Ei,{trkpt:Ut(Q2)}),O8=Ft(Ei,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),D8=Ft(Ei,{ele:Ut(ps),time:Ut(u8),magvar:Ut(ps),geoidheight:Ut(ps),name:Ut(ni),cmt:Ut(ni),desc:Ut(ni),src:Ut(ni),link:Ut(J2),sym:Ut(ni),type:Ut(ni),fix:Ut(ni),sat:Ut(y0),hdop:Ut(ps),vdop:Ut(ps),pdop:Ut(ps),ageofdgpsdata:Ut(ps),dgpsid:Ut(y0)}),B8={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function j8(i,t,e){const n=i.getGeometry();if(n){const s=B8[n.getType()];if(s){const r=t[t.length-1].node;return lh(r.namespaceURI,s)}}}function K2(i,t,e,n){return i.push(parseFloat(e.getAttribute("lon")),parseFloat(e.getAttribute("lat"))),"ele"in n?(i.push(n.ele),delete n.ele,t.hasZ=!0):i.push(0),"time"in n?(i.push(n.time),delete n.time,t.hasM=!0):i.push(0),i}function Z2(i,t,e){let n="XY",s=2;if(i.hasZ&&i.hasM?(n="XYZM",s=4):i.hasZ?(n="XYZ",s=3):i.hasM&&(n="XYM",s=3),s!==4){for(let r=0,o=t.length/4;r<o;r++)t[r*s]=t[r*4],t[r*s+1]=t[r*4+1],i.hasZ&&(t[r*s+2]=t[r*4+2]),i.hasM&&(t[r*s+2]=t[r*4+3]);if(t.length=t.length/4*s,e)for(let r=0,o=e.length;r<o;r++)e[r]=e[r]/4*s}return n}function z8(i,t){const e=oe({},m8,i,t);if(e)return e}function G8(i,t){const e=oe({},y8,i,t);if(e){const n=i.getAttribute("author");return n!==null&&(e.author=n),e}}function U8(i,t){const e=t[t.length-1],n=i.getAttribute("minlat"),s=i.getAttribute("minlon"),r=i.getAttribute("maxlat"),o=i.getAttribute("maxlon");s!==null&&n!==null&&o!==null&&r!==null&&(e.bounds=[[parseFloat(s),parseFloat(n)],[parseFloat(o),parseFloat(r)]])}function W8(i,t){const e=t[t.length-1],n=i.getAttribute("id"),s=i.getAttribute("domain");n!==null&&s!==null&&(e.email=`${n}@${s}`)}function Nf(i,t){const e=t[t.length-1],n=i.getAttribute("href");n!==null&&(e.link=n),il(p8,i,t)}function rm(i,t){const e=t[t.length-1];e.extensionsNode_=i}function q8(i,t){const e=oe({},w8,i,t);if(e){const n=t[t.length-1],s=n.flatCoordinates,r=n.layoutOptions;K2(s,r,i,e)}}function V8(i,t){const e=oe({},C8,i,t);if(e){const n=t[t.length-1],s=n.flatCoordinates,r=n.layoutOptions;K2(s,r,i,e)}}function H8(i,t){const e=t[t.length-1];il(E8,i,t);const n=e.flatCoordinates;e.ends.push(n.length)}function BC(i,t){const e=t[0],n=oe({flatCoordinates:[],layoutOptions:{}},b8,i,t);if(!n)return;const s=n.flatCoordinates;delete n.flatCoordinates;const r=n.layoutOptions;delete n.layoutOptions;const o=Z2(r,s),a=new cn(s,o);qs(a,!1,e);const l=new gi(a);return l.setProperties(n,!0),l}function jC(i,t){const e=t[0],n=oe({flatCoordinates:[],ends:[],layoutOptions:{}},S8,i,t);if(!n)return;const s=n.flatCoordinates;delete n.flatCoordinates;const r=n.ends;delete n.ends;const o=n.layoutOptions;delete n.layoutOptions;const a=Z2(o,s,r),l=new ho(s,a,r);qs(l,!1,e);const h=new gi(l);return h.setProperties(n,!0),h}function zC(i,t){const e=t[0],n=oe({},L8,i,t);if(!n)return;const s={},r=K2([],s,i,n),o=Z2(s,r),a=new Qi(r,o);qs(a,!1,e);const l=new gi(a);return l.setProperties(n,!0),l}function J2(i,t,e){i.setAttribute("href",t);const s=e[e.length-1].properties,r=[s.linkText,s.linkType];pi({node:i},T8,Vn,r,e,M8)}function Q2(i,t,e){const n=e[e.length-1],r=n.node.namespaceURI,o=n.properties;switch(i.setAttributeNS(null,"lat",String(t[1])),i.setAttributeNS(null,"lon",String(t[0])),n.geometryLayout){case"XYZM":t[3]!==0&&(o.time=t[3]);case"XYZ":t[2]!==0&&(o.ele=t[2]);break;case"XYM":t[2]!==0&&(o.time=t[2]);break}const l=i.nodeName=="rtept"?I8[r]:O8[r],h=Cs(o,l);pi({node:i,properties:o},D8,Vn,h,e,l)}function Y8(i,t,e){const n=e[0],s=t.getProperties(),r={node:i};r.properties=s;const o=t.getGeometry();if(o.getType()=="LineString"){const c=qs(o,!0,n);r.geometryLayout=c.getLayout(),s.rtept=c.getCoordinates()}const a=e[e.length-1].node,l=A8[a.namespaceURI],h=Cs(s,l);pi(r,P8,Vn,h,e,l)}function X8(i,t,e){const n=e[0],s=t.getProperties(),r={node:i};r.properties=s;const o=t.getGeometry();if(o.getType()=="MultiLineString"){const c=qs(o,!0,n);s.trkseg=c.getLineStrings()}const a=e[e.length-1].node,l=R8[a.namespaceURI],h=Cs(s,l);pi(r,N8,Vn,h,e,l)}function $8(i,t,e){const n={node:i};n.geometryLayout=t.getLayout(),n.properties={},pi(n,F8,k8,t.getCoordinates(),e)}function K8(i,t,e){const n=e[0],s=e[e.length-1];s.properties=t.getProperties();const r=t.getGeometry();if(r.getType()=="Point"){const o=qs(r,!0,n);s.geometryLayout=o.getLayout(),Q2(i,o.getCoordinates(),e)}}class Z8 extends H2{constructor(){super()}getType(){return"text"}readFeature(t,e){return this.readFeatureFromText(tp(t),this.adaptOptions(e))}readFeatureFromText(t,e){return de()}readFeatures(t,e){return this.readFeaturesFromText(tp(t),this.adaptOptions(e))}readFeaturesFromText(t,e){return de()}readGeometry(t,e){return this.readGeometryFromText(tp(t),this.adaptOptions(e))}readGeometryFromText(t,e){return de()}readProjection(t){return this.readProjectionFromText(tp(t))}readProjectionFromText(t){return this.dataProjection}writeFeature(t,e){return this.writeFeatureText(t,this.adaptOptions(e))}writeFeatureText(t,e){return de()}writeFeatures(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))}writeFeaturesText(t,e){return de()}writeGeometry(t,e){return this.writeGeometryText(t,this.adaptOptions(e))}writeGeometryText(t,e){return de()}}function tp(i){return typeof i=="string"?i:""}const J8=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,Q8=/^H.([A-Z]{3}).*?:(.*)/,tD=/^HFDTE(\d{2})(\d{2})(\d{2})/,eD=/^HFDTEDATE:(\d{2})(\d{2})(\d{2}),(\d{2})/,iD=/\r\n|\r|\n/;class nD extends Z8{constructor(t){super(),t=t||{},this.dataProjection=xe("EPSG:4326"),this.altitudeMode_=t.altitudeMode?t.altitudeMode:"none",this.lad_=!1,this.lod_=!1,this.ladStart_=0,this.ladStop_=0,this.lodStart_=0,this.lodStop_=0}readFeatureFromText(t,e){const n=this.altitudeMode_,s=t.split(iD),r={},o=[];let a=2e3,l=0,h=1,c=-1,u,f;for(u=0,f=s.length;u<f;++u){const y=s[u];let _;if(y.charAt(0)=="B"){if(_=J8.exec(y),_){const x=parseInt(_[1],10),b=parseInt(_[2],10),L=parseInt(_[3],10);let M=parseInt(_[4],10)+parseInt(_[5],10)/6e4;this.lad_&&(M+=parseInt(y.slice(this.ladStart_,this.ladStop_),10)/6e4/10**(this.ladStop_-this.ladStart_)),_[6]=="S"&&(M=-M);let k=parseInt(_[7],10)+parseInt(_[8],10)/6e4;if(this.lod_&&(k+=parseInt(y.slice(this.lodStart_,this.lodStop_),10)/6e4/10**(this.lodStop_-this.lodStart_)),_[9]=="W"&&(k=-k),o.push(k,M),n!="none"){let T;n=="gps"?T=parseInt(_[11],10):n=="barometric"?T=parseInt(_[12],10):T=0,o.push(T)}let A=Date.UTC(a,l,h,x,b,L);A<c&&(A=Date.UTC(a,l,h+1,x,b,L)),o.push(A/1e3),c=A}}else if(y.charAt(0)=="H")_=eD.exec(y),_?(h=parseInt(_[1],10),l=parseInt(_[2],10)-1,a=2e3+parseInt(_[3],10)):(_=tD.exec(y),_?(h=parseInt(_[1],10),l=parseInt(_[2],10)-1,a=2e3+parseInt(_[3],10)):(_=Q8.exec(y),_&&(r[_[1]]=_[2].trim())));else if(y.charAt(0)=="I"){const x=parseInt(y.slice(1,3),10);for(let b=0;b<x;b++){const L=y.slice(7+b*7,10+b*7);if(L==="LAD"||L==="LOD"){const M=parseInt(y.slice(3+b*7,5+b*7),10)-1,k=parseInt(y.slice(5+b*7,7+b*7),10);L==="LAD"?(this.lad_=!0,this.ladStart_=M,this.ladStop_=k):L==="LOD"&&(this.lod_=!0,this.lodStart_=M,this.lodStop_=k)}}}}if(o.length===0)return null;const d=n=="none"?"XYM":"XYZM",g=new cn(o,d),p=new gi(qs(g,!1,e));return p.setProperties(r,!0),p}readFeaturesFromText(t,e){const n=this.readFeatureFromText(t,e);return n?[n]:[]}}const Qo=["http://www.google.com/kml/ext/2.2"],ae=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],sD="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",rb={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},rD=Ft(ae,{ExtendedData:iL,Region:nL,MultiGeometry:bt(QC,"geometry"),LineString:bt(ZC,"geometry"),LinearRing:bt(JC,"geometry"),Point:bt(tL,"geometry"),Polygon:bt(eL,"geometry"),Style:bt(iv),StyleMap:GD,address:bt($t),description:bt($t),name:bt($t),open:bt(Ka),phoneNumber:bt($t),styleUrl:bt(HC),visibility:bt(Ka)},Ft(Qo,{MultiTrack:bt(TD,"geometry"),Track:bt(KC,"geometry")})),oD=Ft(ae,{ExtendedData:iL,Region:nL,Link:QD,address:bt($t),description:bt($t),name:bt($t),open:bt(Ka),phoneNumber:bt($t),visibility:bt(Ka)}),aD=Ft(ae,{href:bt(VC)}),lD=Ft(ae,{Altitude:bt(Xe),Longitude:bt(Xe),Latitude:bt(Xe),Tilt:bt(Xe),AltitudeMode:bt($t),Heading:bt(Xe),Roll:bt(Xe)}),GC=Ft(ae,{LatLonAltBox:HD,Lod:XD}),hD=Ft(ae,["Document","Placemark"]),cD=Ft(ae,{Document:Ut(a7),Placemark:Ut(oL)});let Lc,Tp=null,ey,Td,Ad,Pd,v0,iy=null,tv,ny=null,sy,Il=null,ob=null,ry=null;function x0(i){return 32/Math.min(i[0],i[1])}function uD(){Lc=[255,255,255,1],Tp=new ke({color:Lc}),ey=[20,2],Td="pixels",Ad="pixels",Pd=[64,64],v0="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",iy=new Wa({anchor:ey,anchorOrigin:"bottom-left",anchorXUnits:Td,anchorYUnits:Ad,crossOrigin:"anonymous",rotation:0,scale:x0(Pd),size:Pd,src:v0}),tv="NO_IMAGE",ny=new si({color:Lc,width:1}),sy=new si({color:[51,51,51,1],width:2}),Il=new qn({font:"bold 16px Helvetica",fill:Tp,stroke:sy,scale:.8}),ob=new Pe({fill:Tp,image:iy,text:Il,stroke:ny,zIndex:0}),ry=[ob]}let ep;function dD(i){return i}class UC extends DC{constructor(t){super(),t=t||{},ry||uD(),this.dataProjection=xe("EPSG:4326"),this.defaultStyle_=t.defaultStyle?t.defaultStyle:ry,this.extractStyles_=t.extractStyles!==void 0?t.extractStyles:!0,this.writeStyles_=t.writeStyles!==void 0?t.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=t.showPointNames!==void 0?t.showPointNames:!0,this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",this.iconUrlFunction_=t.iconUrlFunction?t.iconUrlFunction:dD,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(t,e){const n=Ft(ae,{Document:sb(this.readDocumentOrFolder_,this),Folder:sb(this.readDocumentOrFolder_,this),Placemark:bs(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),s=oe([],n,t,e,this);if(s)return s}readPlacemark_(t,e){const n=oe({geometry:null},rD,t,e,this);if(!n)return;const s=new gi,r=t.getAttribute("id");r!==null&&s.setId(r);const o=e[0],a=n.geometry;if(a&&qs(a,!1,o),s.setGeometry(a),delete n.geometry,this.extractStyles_){const l=n.Style,h=n.styleUrl,c=gD(l,h,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);s.setStyle(c)}return delete n.Style,s.setProperties(n,!0),s}readSharedStyle_(t,e){const n=t.getAttribute("id");if(n!==null){const s=iv.call(this,t,e);if(s){let r,o=t.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?r=new URL("#"+n,o).href:r="#"+n,this.sharedStyles_[r]=s}}}readSharedStyleMap_(t,e){const n=t.getAttribute("id");if(n===null)return;const s=XC.call(this,t,e);if(!s)return;let r,o=t.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?r=new URL("#"+n,o).href:r="#"+n,this.sharedStyles_[r]=s}readFeatureFromNode(t,e){if(!ae.includes(t.namespaceURI))return null;const n=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return n||null}readFeaturesFromNode(t,e){if(!ae.includes(t.namespaceURI))return[];let n;const s=t.localName;if(s=="Document"||s=="Folder")return n=this.readDocumentOrFolder_(t,[this.getReadOptions(t,e)]),n||[];if(s=="Placemark"){const r=this.readPlacemark_(t,[this.getReadOptions(t,e)]);return r?[r]:[]}if(s=="kml"){n=[];for(let r=t.firstElementChild;r;r=r.nextElementSibling){const o=this.readFeaturesFromNode(r,e);o&&Ye(n,o)}return n}return[]}readName(t){if(t){if(typeof t=="string"){const e=io(t);return this.readNameFromDocument(e)}return eo(t)?this.readNameFromDocument(t):this.readNameFromNode(t)}}readNameFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE){const n=this.readNameFromNode(e);if(n)return n}}readNameFromNode(t){for(let e=t.firstElementChild;e;e=e.nextElementSibling)if(ae.includes(e.namespaceURI)&&e.localName=="name")return $t(e);for(let e=t.firstElementChild;e;e=e.nextElementSibling){const n=e.localName;if(ae.includes(e.namespaceURI)&&(n=="Document"||n=="Folder"||n=="Placemark"||n=="kml")){const s=this.readNameFromNode(e);if(s)return s}}}readNetworkLinks(t){const e=[];if(typeof t=="string"){const n=io(t);Ye(e,this.readNetworkLinksFromDocument(n))}else eo(t)?Ye(e,this.readNetworkLinksFromDocument(t)):Ye(e,this.readNetworkLinksFromNode(t));return e}readNetworkLinksFromDocument(t){const e=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&Ye(e,this.readNetworkLinksFromNode(n));return e}readNetworkLinksFromNode(t){const e=[];for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(ae.includes(n.namespaceURI)&&n.localName=="NetworkLink"){const s=oe({},oD,n,[]);e.push(s)}for(let n=t.firstElementChild;n;n=n.nextElementSibling){const s=n.localName;ae.includes(n.namespaceURI)&&(s=="Document"||s=="Folder"||s=="kml")&&Ye(e,this.readNetworkLinksFromNode(n))}return e}readRegion(t){const e=[];if(typeof t=="string"){const n=io(t);Ye(e,this.readRegionFromDocument(n))}else eo(t)?Ye(e,this.readRegionFromDocument(t)):Ye(e,this.readRegionFromNode(t));return e}readRegionFromDocument(t){const e=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&Ye(e,this.readRegionFromNode(n));return e}readRegionFromNode(t){const e=[];for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(ae.includes(n.namespaceURI)&&n.localName=="Region"){const s=oe({},GC,n,[]);e.push(s)}for(let n=t.firstElementChild;n;n=n.nextElementSibling){const s=n.localName;ae.includes(n.namespaceURI)&&(s=="Document"||s=="Folder"||s=="kml")&&Ye(e,this.readRegionFromNode(n))}return e}readCamera(t){const e=[];if(typeof t=="string"){const n=io(t);Ye(e,this.readCameraFromDocument(n))}else eo(t)?Ye(e,this.readCameraFromDocument(t)):Ye(e,this.readCameraFromNode(t));return e}readCameraFromDocument(t){const e=[];for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType===Node.ELEMENT_NODE&&Ye(e,this.readCameraFromNode(n));return e}readCameraFromNode(t){const e=[];for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(ae.includes(n.namespaceURI)&&n.localName==="Camera"){const s=oe({},lD,n,[]);e.push(s)}for(let n=t.firstElementChild;n;n=n.nextElementSibling){const s=n.localName;ae.includes(n.namespaceURI)&&(s==="Document"||s==="Folder"||s==="Placemark"||s==="kml")&&Ye(e,this.readCameraFromNode(n))}return e}writeFeaturesNode(t,e){e=this.adaptOptions(e);const n=lh(ae[4],"kml"),s="http://www.w3.org/2000/xmlns/";n.setAttributeNS(s,"xmlns:gx",Qo[0]),n.setAttributeNS(s,"xmlns:xsi",_0),n.setAttributeNS(_0,"xsi:schemaLocation",sD);const r={node:n},o={};t.length>1?o.Document=t:t.length==1&&(o.Placemark=t[0]);const a=hD[n.namespaceURI],l=Cs(o,a);return pi(r,cD,Vn,l,[e],a,this),n}}function fD(i,t){const e=[0,0];let n="start";const s=i.getImage();if(s){const a=s.getSize();if(a&&a.length==2){const l=s.getScaleArray(),h=s.getAnchor();e[0]=l[0]*(a[0]-h[0]),e[1]=l[1]*(a[1]/2-h[1]),n="left"}}let r=i.getText();return r?(r=r.clone(),r.setFont(r.getFont()||Il.getFont()),r.setScale(r.getScale()||Il.getScale()),r.setFill(r.getFill()||Il.getFill()),r.setStroke(r.getStroke()||sy)):r=Il.clone(),r.setText(t),r.setOffsetX(e[0]),r.setOffsetY(e[1]),r.setTextAlign(n),new Pe({image:s,text:r})}function gD(i,t,e,n,s){return function(r,o){let a=s,l="",h=[];if(a){const u=r.getGeometry();if(u)if(u instanceof rr)h=u.getGeometriesArrayRecursive().filter(function(f){const d=f.getType();return d==="Point"||d==="MultiPoint"}),a=h.length>0;else{const f=u.getType();a=f==="Point"||f==="MultiPoint"}}a&&(l=r.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(ep||(ep=document.createElement("textarea")),ep.innerHTML=l,l=ep.value));let c=e;if(i?c=i:t&&(c=WC(t,e,n)),a){const u=fD(c[0],l);if(h.length>0){u.setGeometry(new rr(h));const f=new Pe({geometry:c[0].getGeometry(),image:null,fill:c[0].getFill(),stroke:c[0].getStroke(),text:null});return[u,f].concat(c.slice(1))}return u}return c}}function WC(i,t,e){return Array.isArray(i)?i:typeof i=="string"?WC(e[i],t,e):t}function om(i){const t=Fr(i,!1),e=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(e){const n=e[1];return[parseInt(n.substr(6,2),16),parseInt(n.substr(4,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(0,2),16)/255]}}function qC(i){let t=Fr(i,!1);const e=[];t=t.replace(/\s*,\s*/g,",");const n=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let s;for(;s=n.exec(t);){const r=parseFloat(s[1]),o=parseFloat(s[2]),a=s[3]?parseFloat(s[3]):0;e.push(r,o,a),t=t.substr(s[0].length)}if(t==="")return e}function VC(i){const t=Fr(i,!1).trim();let e=i.baseURI;return(!e||e=="about:blank")&&(e=window.location.href),e?new URL(t,e).href:t}function HC(i){const t=Fr(i,!1).trim().replace(/^(?!.*#)/,"#");let e=i.baseURI;return(!e||e=="about:blank")&&(e=window.location.href),e?new URL(t,e).href:t}function pD(i){const t=i.getAttribute("xunits"),e=i.getAttribute("yunits");let n;return t!=="insetPixels"?e!=="insetPixels"?n="bottom-left":n="top-left":e!=="insetPixels"?n="bottom-right":n="top-right",{x:parseFloat(i.getAttribute("x")),xunits:rb[t],y:parseFloat(i.getAttribute("y")),yunits:rb[e],origin:n}}function YC(i){return Xe(i)}const mD=Ft(ae,{Pair:zD});function XC(i,t){return oe(void 0,mD,i,t,this)}const _D=Ft(ae,{Icon:bt(ID),color:bt(om),heading:bt(Xe),hotSpot:bt(pD),scale:bt(YC)});function yD(i,t){const e=oe({},_D,i,t);if(!e)return;const n=t[t.length-1],s="Icon"in e?e.Icon:{},r=!("Icon"in e)||Object.keys(s).length>0;let o;const a=s.href;a?o=a:r&&(o=v0);let l,h,c,u="bottom-left";const f=e.hotSpot;f?(l=[f.x,f.y],h=f.xunits,c=f.yunits,u=f.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=ey,h=Td,c=Ad):o.includes("arrow-reverse")?(l=[54,42],h=Td,c=Ad):o.includes("paddle")&&(l=[32,1],h=Td,c=Ad));let d;const g=s.x,p=s.y;g!==void 0&&p!==void 0&&(d=[g,p]);let y;const _=s.w,x=s.h;_!==void 0&&x!==void 0&&(y=[_,x]);let b;const L=e.heading;L!==void 0&&(b=Lr(L));const M=e.scale,k=e.color;if(r){o==v0&&(y=Pd);const A=new Wa({anchor:l,anchorOrigin:u,anchorXUnits:h,anchorYUnits:c,crossOrigin:this.crossOrigin_,offset:d,offsetOrigin:"bottom-left",rotation:b,scale:M,size:y,src:this.iconUrlFunction_(o),color:k}),T=A.getScaleArray()[0],F=A.getSize();if(F===null){const q=A.getImageState();if(q===re.IDLE||q===re.LOADING){const R=function(){const S=A.getImageState();if(!(S===re.IDLE||S===re.LOADING)){const O=A.getSize();if(O&&O.length==2){const E=x0(O);A.setScale(T*E)}A.unlistenImageChange(R)}};A.listenImageChange(R),q===re.IDLE&&A.load()}}else if(F.length==2){const q=x0(F);A.setScale(T*q)}n.imageStyle=A}else n.imageStyle=tv}const vD=Ft(ae,{color:bt(om),scale:bt(YC)});function xD(i,t){const e=oe({},vD,i,t);if(!e)return;const n=t[t.length-1],s=new qn({fill:new ke({color:"color"in e?e.color:Lc}),scale:e.scale});n.textStyle=s}const bD=Ft(ae,{color:bt(om),width:bt(Xe)});function wD(i,t){const e=oe({},bD,i,t);if(!e)return;const n=t[t.length-1],s=new si({color:"color"in e?e.color:Lc,width:"width"in e?e.width:1});n.strokeStyle=s}const SD=Ft(ae,{color:bt(om),fill:bt(Ka),outline:bt(Ka)});function ED(i,t){const e=oe({},SD,i,t);if(!e)return;const n=t[t.length-1],s=new ke({color:"color"in e?e.color:Lc});n.fillStyle=s;const r=e.fill;r!==void 0&&(n.fill=r);const o=e.outline;o!==void 0&&(n.outline=o)}const CD=Ft(ae,{coordinates:$2(qC)});function $C(i,t){return oe(null,CD,i,t)}function LD(i,t){const n=t[t.length-1].coordinates,s=Fr(i,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(s);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),h=parseFloat(o[3]);n.push([a,l,h])}else n.push([])}const MD=Ft(Qo,{Track:bs(KC)});function TD(i,t){const e=oe([],MD,i,t);if(e)return new ho(e)}const AD=Ft(ae,{when:t7},Ft(Qo,{coord:LD}));function KC(i,t){const e=oe({coordinates:[],whens:[]},AD,i,t);if(!e)return;const n=[],s=e.coordinates,r=e.whens;for(let o=0,a=Math.min(s.length,r.length);o<a;++o)s[o].length==3&&n.push(s[o][0],s[o][1],s[o][2],r[o]);return new cn(n,"XYZM")}const PD=Ft(ae,{href:bt(VC)},Ft(Qo,{x:bt(Xe),y:bt(Xe),w:bt(Xe),h:bt(Xe)}));function ID(i,t){const e=oe({},PD,i,t);return e||null}const RD=Ft(ae,{coordinates:$2(qC)});function ev(i,t){return oe(null,RD,i,t)}const am=Ft(ae,{extrude:bt(Ka),tessellate:bt(Ka),altitudeMode:bt($t)});function ZC(i,t){const e=oe({},am,i,t),n=ev(i,t);if(n){const s=new cn(n,"XYZ");return s.setProperties(e,!0),s}}function JC(i,t){const e=oe({},am,i,t),n=ev(i,t);if(n){const s=new sr(n,"XYZ",[n.length]);return s.setProperties(e,!0),s}}const ND=Ft(ae,{LineString:bs(ZC),LinearRing:bs(JC),MultiGeometry:bs(QC),Point:bs(tL),Polygon:bs(eL)});function QC(i,t){const e=oe([],ND,i,t);if(!e)return null;if(e.length===0)return new rr(e);let n,s=!0;const r=e[0].getType();let o;for(let a=1,l=e.length;a<l;++a)if(o=e[a],o.getType()!=r){s=!1;break}if(s){let a,l;if(r=="Point"){const h=e[0];a=h.getLayout(),l=h.getFlatCoordinates();for(let c=1,u=e.length;c<u;++c)o=e[c],Ye(l,o.getFlatCoordinates());n=new nh(l,a),Q1(n,e)}else if(r=="LineString")n=new ho(e),Q1(n,e);else if(r=="Polygon")n=new qa(e),Q1(n,e);else if(r=="GeometryCollection"||r.startsWith("Multi"))n=new rr(e);else throw new Error("Unknown geometry type found")}else n=new rr(e);return n}function tL(i,t){const e=oe({},am,i,t),n=ev(i,t);if(n){const s=new Qi(n,"XYZ");return s.setProperties(e,!0),s}}const kD=Ft(ae,{innerBoundaryIs:KD,outerBoundaryIs:JD});function eL(i,t){const e=oe({},am,i,t),n=oe([null],kD,i,t);if(n&&n[0]){const s=n[0],r=[s.length];for(let a=1,l=n.length;a<l;++a)Ye(s,n[a]),r.push(s.length);const o=new sr(s,"XYZ",r);return o.setProperties(e,!0),o}}const FD=Ft(ae,{IconStyle:yD,LabelStyle:xD,LineStyle:wD,PolyStyle:ED});function iv(i,t){const e=oe({},FD,i,t,this);if(!e)return null;let n="fillStyle"in e?e.fillStyle:Tp;const s=e.fill;s!==void 0&&!s&&(n=null);let r;"imageStyle"in e?e.imageStyle!=tv&&(r=e.imageStyle):r=iy;const o="textStyle"in e?e.textStyle:Il,a="strokeStyle"in e?e.strokeStyle:ny,l=e.outline;return l!==void 0&&!l?[new Pe({geometry:function(h){const c=h.getGeometry(),u=c.getType();if(u==="GeometryCollection"){const f=c;return new rr(f.getGeometriesArrayRecursive().filter(function(d){const g=d.getType();return g!=="Polygon"&&g!=="MultiPolygon"}))}if(u!=="Polygon"&&u!=="MultiPolygon")return c},fill:n,image:r,stroke:a,text:o,zIndex:void 0}),new Pe({geometry:function(h){const c=h.getGeometry(),u=c.getType();if(u==="GeometryCollection"){const f=c;return new rr(f.getGeometriesArrayRecursive().filter(function(d){const g=d.getType();return g==="Polygon"||g==="MultiPolygon"}))}if(u==="Polygon"||u==="MultiPolygon")return c},fill:n,stroke:null,zIndex:void 0})]:[new Pe({fill:n,image:r,stroke:a,text:o,zIndex:void 0})]}function Q1(i,t){const e=t.length,n=new Array(t.length),s=new Array(t.length),r=new Array(t.length);let o,a,l;o=!1,a=!1,l=!1;for(let h=0;h<e;++h){const c=t[h];n[h]=c.get("extrude"),s[h]=c.get("tessellate"),r[h]=c.get("altitudeMode"),o=o||n[h]!==void 0,a=a||s[h]!==void 0,l=l||r[h]}o&&i.set("extrude",n),a&&i.set("tessellate",s),l&&i.set("altitudeMode",r)}const OD=Ft(ae,{displayName:bt($t),value:bt($t)});function DD(i,t){const e=i.getAttribute("name");il(OD,i,t);const n=t[t.length-1];e&&n.displayName?n[e]={value:n.value,displayName:n.displayName,toString:function(){return n.value}}:e!==null?n[e]=n.value:n.displayName!==null&&(n[n.displayName]=n.value),delete n.value}const BD=Ft(ae,{Data:DD,SchemaData:WD});function iL(i,t){il(BD,i,t)}function nL(i,t){il(GC,i,t)}const jD=Ft(ae,{Style:bt(iv),key:bt($t),styleUrl:bt(HC)});function zD(i,t){const e=oe({},jD,i,t,this);if(!e)return;const n=e.key;if(n&&n=="normal"){const s=e.styleUrl;s&&(t[t.length-1]=s);const r=e.Style;r&&(t[t.length-1]=r)}}function GD(i,t){const e=XC.call(this,i,t);if(!e)return;const n=t[t.length-1];if(Array.isArray(e))n.Style=e;else if(typeof e=="string")n.styleUrl=e;else throw new Error("`styleMapValue` has an unknown type")}const UD=Ft(ae,{SimpleData:qD});function WD(i,t){il(UD,i,t)}function qD(i,t){const e=i.getAttribute("name");if(e!==null){const n=$t(i),s=t[t.length-1];s[e]=n}}const VD=Ft(ae,{altitudeMode:bt($t),minAltitude:bt(Xe),maxAltitude:bt(Xe),north:bt(Xe),south:bt(Xe),east:bt(Xe),west:bt(Xe)});function HD(i,t){const e=oe({},VD,i,t);if(!e)return;const n=t[t.length-1],s=[parseFloat(e.west),parseFloat(e.south),parseFloat(e.east),parseFloat(e.north)];n.extent=s,n.altitudeMode=e.altitudeMode,n.minAltitude=parseFloat(e.minAltitude),n.maxAltitude=parseFloat(e.maxAltitude)}const YD=Ft(ae,{minLodPixels:bt(Xe),maxLodPixels:bt(Xe),minFadeExtent:bt(Xe),maxFadeExtent:bt(Xe)});function XD(i,t){const e=oe({},YD,i,t);if(!e)return;const n=t[t.length-1];n.minLodPixels=parseFloat(e.minLodPixels),n.maxLodPixels=parseFloat(e.maxLodPixels),n.minFadeExtent=parseFloat(e.minFadeExtent),n.maxFadeExtent=parseFloat(e.maxFadeExtent)}const $D=Ft(ae,{LinearRing:bs($C)});function KD(i,t){const e=oe([],$D,i,t);e.length>0&&t[t.length-1].push(...e)}const ZD=Ft(ae,{LinearRing:$2($C)});function JD(i,t){const e=oe(void 0,ZD,i,t);if(e){const n=t[t.length-1];n[0]=e}}function QD(i,t){il(aD,i,t)}function t7(i,t){const n=t[t.length-1].whens,s=Fr(i,!1),r=Date.parse(s);n.push(isNaN(r)?0:r)}function lm(i,t){const e=ql(t),s=[(e.length==4?e[3]:1)*255,e[2],e[1],e[0]];for(let r=0;r<4;++r){const o=Math.floor(s[r]).toString(16);s[r]=o.length==1?"0"+o:o}ni(i,s.join(""))}function e7(i,t,e){const n=e[e.length-1],s=n.layout,r=n.stride;let o;if(s=="XY"||s=="XYM")o=2;else if(s=="XYZ"||s=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=t.length;let l="";if(a>0){l+=t[0];for(let h=1;h<o;++h)l+=","+t[h];for(let h=r;h<a;h+=r){l+=" "+t[h];for(let c=1;c<o;++c)l+=","+t[h+c]}}ni(i,l)}const Ap=Ft(ae,{Data:Ut(i7),value:Ut(s7),displayName:Ut(n7)});function i7(i,t,e){i.setAttribute("name",t.name);const n={node:i},s=t.value;typeof s=="object"?(s!==null&&s.displayName&&pi(n,Ap,Vn,[s.displayName],e,["displayName"]),s!==null&&s.value&&pi(n,Ap,Vn,[s.value],e,["value"])):pi(n,Ap,Vn,[s],e,["value"])}function n7(i,t){c8(i,t)}function s7(i,t){ni(i,t)}const r7=Ft(ae,{Placemark:Ut(oL)}),o7=function(i,t,e){const n=t[t.length-1].node;return lh(n.namespaceURI,"Placemark")};function a7(i,t,e){pi({node:i},r7,o7,t,e,void 0,this)}const l7=Or("Data");function h7(i,t,e){const n={node:i},s=t.names,r=t.values,o=s.length;for(let a=0;a<o;a++)pi(n,Ap,l7,[{name:s[a],value:r[a]}],e)}const ab=Ft(ae,["href"],Ft(Qo,["x","y","w","h"])),lb=Ft(ae,{href:Ut(ni)},Ft(Qo,{x:Ut(ps),y:Ut(ps),w:Ut(ps),h:Ut(ps)})),c7=function(i,t,e){return lh(Qo[0],"gx:"+e)};function u7(i,t,e){const n={node:i},s=e[e.length-1].node;let r=ab[s.namespaceURI],o=Cs(t,r);pi(n,lb,Vn,o,e,r),r=ab[Qo[0]],o=Cs(t,r),pi(n,lb,c7,o,e,r)}const d7=Ft(ae,["scale","heading","Icon","color","hotSpot"]),f7=Ft(ae,{Icon:Ut(u7),color:Ut(lm),heading:Ut(ps),hotSpot:Ut(z7),scale:Ut(lL)});function g7(i,t,e){const n={node:i},s={},r=t.getSrc(),o=t.getSize(),a=t.getImageSize(),l={href:r};if(o){l.w=o[0],l.h=o[1];const y=t.getAnchor(),_=t.getOrigin();if(_&&a&&_[0]!==0&&_[1]!==o[1]&&(l.x=_[0],l.y=a[1]-(_[1]+o[1])),y&&(y[0]!==o[0]/2||y[1]!==o[1]/2)){const x={x:y[0],xunits:"pixels",y:o[1]-y[1],yunits:"pixels"};s.hotSpot=x}}s.Icon=l;let h=t.getScaleArray()[0],c=o;if(c===null&&(c=Pd),c.length==2){const y=x0(c);h=h/y}h!==1&&(s.scale=h);const u=t.getRotation();u!==0&&(s.heading=u);const f=t.getColor();f&&(s.color=f);const d=e[e.length-1].node,g=d7[d.namespaceURI],p=Cs(s,g);pi(n,f7,Vn,p,e,g)}const p7=Ft(ae,["color","scale"]),m7=Ft(ae,{color:Ut(lm),scale:Ut(lL)});function _7(i,t,e){const n={node:i},s={},r=t.getFill();r&&(s.color=r.getColor());const o=t.getScale();o&&o!==1&&(s.scale=o);const a=e[e.length-1].node,l=p7[a.namespaceURI],h=Cs(s,l);pi(n,m7,Vn,h,e,l)}const y7=Ft(ae,["color","width"]),v7=Ft(ae,{color:Ut(lm),width:Ut(ps)});function x7(i,t,e){const n={node:i},s={color:t.getColor(),width:Number(t.getWidth())||1},r=e[e.length-1].node,o=y7[r.namespaceURI],a=Cs(s,o);pi(n,v7,Vn,a,e,o)}const b7={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},sL=function(i,t,e){if(i){const n=t[t.length-1].node;return lh(n.namespaceURI,b7[i.getType()])}},w7=Or("Point"),S7=Or("LineString"),E7=Or("LinearRing"),C7=Or("Polygon"),L7=Ft(ae,{LineString:Ut(Mc),Point:Ut(Mc),Polygon:Ut(aL),GeometryCollection:Ut(rL)});function rL(i,t,e){const n={node:i},s=t.getType();let r=[],o;if(s==="GeometryCollection")t.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")r=r.concat(a.getPoints());else if(l==="MultiLineString")r=r.concat(a.getLineStrings());else if(l==="MultiPolygon")r=r.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")r.push(a);else throw new Error("Unknown geometry type")}),o=sL;else if(s==="MultiPoint")r=t.getPoints(),o=w7;else if(s==="MultiLineString")r=t.getLineStrings(),o=S7;else if(s==="MultiPolygon")r=t.getPolygons(),o=C7;else throw new Error("Unknown geometry type");pi(n,L7,o,r,e)}const M7=Ft(ae,{LinearRing:Ut(Mc)});function hb(i,t,e){pi({node:i},M7,E7,[t],e)}const t_=Ft(ae,{ExtendedData:Ut(h7),MultiGeometry:Ut(rL),LineString:Ut(Mc),LinearRing:Ut(Mc),Point:Ut(Mc),Polygon:Ut(aL),Style:Ut(j7),address:Ut(ni),description:Ut(ni),name:Ut(ni),open:Ut(Vc),phoneNumber:Ut(ni),styleUrl:Ut(ni),visibility:Ut(Vc)}),T7=Ft(ae,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),A7=Or("ExtendedData");function oL(i,t,e){const n={node:i};t.getId()&&i.setAttribute("id",t.getId());const s=t.getProperties(),r={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};r[t.getGeometryName()]=1;const o=Object.keys(s||{}).sort().filter(function(d){return!r[d]}),a=t.getStyleFunction();if(a){const d=a(t,0);if(d){const g=Array.isArray(d)?d:[d];let p=g;if(t.getGeometry()&&(p=g.filter(function(y){const _=y.getGeometryFunction()(t);if(_){const x=_.getType();return x==="GeometryCollection"?_.getGeometriesArrayRecursive().filter(function(b){const L=b.getType();return L==="Point"||L==="MultiPoint"}).length:x==="Point"||x==="MultiPoint"}})),this.writeStyles_){let y=g,_=g;t.getGeometry()&&(y=g.filter(function(x){const b=x.getGeometryFunction()(t);if(b){const L=b.getType();return L==="GeometryCollection"?b.getGeometriesArrayRecursive().filter(function(M){const k=M.getType();return k==="LineString"||k==="MultiLineString"}).length:L==="LineString"||L==="MultiLineString"}}),_=g.filter(function(x){const b=x.getGeometryFunction()(t);if(b){const L=b.getType();return L==="GeometryCollection"?b.getGeometriesArrayRecursive().filter(function(M){const k=M.getType();return k==="Polygon"||k==="MultiPolygon"}).length:L==="Polygon"||L==="MultiPolygon"}})),s.Style={pointStyles:p,lineStyles:y,polyStyles:_}}if(p.length&&s.name===void 0){const y=p[0].getText();y&&(s.name=y.getText())}}}const l=e[e.length-1].node,h=T7[l.namespaceURI],c=Cs(s,h);if(pi(n,t_,Vn,c,e,h),o.length>0){const d=Cs(s,o);pi(n,t_,A7,[{names:o,values:d}],e)}const u=e[0];let f=t.getGeometry();f&&(f=qs(f,!0,u)),pi(n,t_,sL,[f],e)}const P7=Ft(ae,["extrude","tessellate","altitudeMode","coordinates"]),I7=Ft(ae,{extrude:Ut(Vc),tessellate:Ut(Vc),altitudeMode:Ut(ni),coordinates:Ut(e7)});function Mc(i,t,e){const n=t.getFlatCoordinates(),s={node:i};s.layout=t.getLayout(),s.stride=t.getStride();const r=t.getProperties();r.coordinates=n;const o=e[e.length-1].node,a=P7[o.namespaceURI],l=Cs(r,a);pi(s,I7,Vn,l,e,a)}const R7=Ft(ae,["color","fill","outline"]),cb=Ft(ae,{outerBoundaryIs:Ut(hb),innerBoundaryIs:Ut(hb)}),N7=Or("innerBoundaryIs"),k7=Or("outerBoundaryIs");function aL(i,t,e){const n=t.getLinearRings(),s=n.shift(),r={node:i};pi(r,cb,N7,n,e),pi(r,cb,k7,[s],e)}const F7=Ft(ae,{color:Ut(lm),fill:Ut(Vc),outline:Ut(Vc)});function O7(i,t,e){const n={node:i},s=t.getFill(),r=t.getStroke(),o={color:s?s.getColor():void 0,fill:s?void 0:!1,outline:r?void 0:!1},a=e[e.length-1].node,l=R7[a.namespaceURI],h=Cs(o,l);pi(n,F7,Vn,h,e,l)}function lL(i,t){ps(i,Math.round(t*1e6)/1e6)}const D7=Ft(ae,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),B7=Ft(ae,{IconStyle:Ut(g7),LabelStyle:Ut(_7),LineStyle:Ut(x7),PolyStyle:Ut(O7)});function j7(i,t,e){const n={node:i},s={};if(t.pointStyles.length){const l=t.pointStyles[0].getText();l&&(s.LabelStyle=l);const h=t.pointStyles[0].getImage();h&&typeof h.getSrc=="function"&&(s.IconStyle=h)}if(t.lineStyles.length){const l=t.lineStyles[0].getStroke();l&&(s.LineStyle=l)}if(t.polyStyles.length){const l=t.polyStyles[0].getStroke();l&&!s.LineStyle&&(s.LineStyle=l),s.PolyStyle=t.polyStyles[0]}const r=e[e.length-1].node,o=D7[r.namespaceURI],a=Cs(s,o);pi(n,B7,Vn,a,e,o)}function z7(i,t){i.setAttribute("x",String(t.x)),i.setAttribute("y",String(t.y)),i.setAttribute("xunits",t.xunits),i.setAttribute("yunits",t.yunits)}class hL{read(t){if(!t)return null;if(typeof t=="string"){const e=io(t);return this.readFromDocument(e)}return eo(t)?this.readFromDocument(t):this.readFromNode(t)}readFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null}readFromNode(t){de()}}const G7="http://www.w3.org/1999/xlink";function nv(i){return i.getAttributeNS(G7,"href")}const Ps=[null,"http://www.opengis.net/ows/1.1"],U7=Ft(Ps,{ServiceIdentification:bt(fB),ServiceProvider:bt(pB),OperationsMetadata:bt(uB)});class W7 extends hL{constructor(){super()}readFromNode(t){const e=oe({},U7,t,[]);return e||null}}const q7=Ft(Ps,{DeliveryPoint:bt($t),City:bt($t),AdministrativeArea:bt($t),PostalCode:bt($t),Country:bt($t),ElectronicMailAddress:bt($t)}),V7=Ft(Ps,{Value:ys(mB)}),H7=Ft(Ps,{AllowedValues:bt(sB)}),Y7=Ft(Ps,{Phone:bt(dB),Address:bt(nB)}),X7=Ft(Ps,{HTTP:bt(hB)}),$7=Ft(Ps,{Get:ys(lB),Post:void 0}),K7=Ft(Ps,{DCP:bt(aB)}),Z7=Ft(Ps,{Operation:cB}),J7=Ft(Ps,{Voice:bt($t),Facsimile:bt($t)}),Q7=Ft(Ps,{Constraint:ys(rB)}),tB=Ft(Ps,{IndividualName:bt($t),PositionName:bt($t),ContactInfo:bt(oB)}),eB=Ft(Ps,{Abstract:bt($t),AccessConstraints:bt($t),Fees:bt($t),Title:bt($t),ServiceTypeVersion:bt($t),ServiceType:bt($t)}),iB=Ft(Ps,{ProviderName:bt($t),ProviderSite:bt(nv),ServiceContact:bt(gB)});function nB(i,t){return oe({},q7,i,t)}function sB(i,t){return oe({},V7,i,t)}function rB(i,t){const e=i.getAttribute("name");if(e)return oe({name:e},H7,i,t)}function oB(i,t){return oe({},Y7,i,t)}function aB(i,t){return oe({},X7,i,t)}function lB(i,t){const e=nv(i);if(e)return oe({href:e},Q7,i,t)}function hB(i,t){return oe({},$7,i,t)}function cB(i,t){const e=i.getAttribute("name"),n=oe({},K7,i,t);if(!n)return;const s=t[t.length-1];s[e]=n}function uB(i,t){return oe({},Z7,i,t)}function dB(i,t){return oe({},J7,i,t)}function fB(i,t){return oe({},eB,i,t)}function gB(i,t){return oe({},tB,i,t)}function pB(i,t){return oe({},iB,i,t)}function mB(i,t){return $t(i)}class _B extends NC{constructor(t){super(),t=t||{},this.layerName_=t.layerName,this.layers_=t.layers?t.layers:null,this.dataProjection=xe(t.dataProjection?t.dataProjection:"EPSG:4326")}readFeaturesFromObject(t,e){if(t.type=="Topology"){const n=t;let s,r=null,o=null;n.transform&&(s=n.transform,r=s.scale,o=s.translate);const a=n.arcs;s&&LB(a,r,o);const l=[],h=n.objects,c=this.layerName_;let u;for(const f in h)this.layers_&&!this.layers_.includes(f)||(h[f].type==="GeometryCollection"?(u=h[f],l.push.apply(l,CB(u,a,r,o,c,f,e))):(u=h[f],l.push(cL(u,a,r,o,c,f,e))));return l}return[]}readProjectionFromObject(t){return this.dataProjection}}const yB={Point:vB,LineString:bB,Polygon:SB,MultiPoint:xB,MultiLineString:wB,MultiPolygon:EB};function hm(i,t){const e=[];let n;for(let s=0,r=i.length;s<r;++s)if(n=i[s],s>0&&e.pop(),n>=0){const o=t[n];for(let a=0,l=o.length;a<l;++a)e.push(o[a].slice(0))}else{const o=t[~n];for(let a=o.length-1;a>=0;--a)e.push(o[a].slice(0))}return e}function vB(i,t,e){const n=i.coordinates;return t&&e&&sv(n,t,e),new Qi(n)}function xB(i,t,e){const n=i.coordinates;if(t&&e)for(let s=0,r=n.length;s<r;++s)sv(n[s],t,e);return new nh(n)}function bB(i,t){const e=hm(i.arcs,t);return new cn(e)}function wB(i,t){const e=[];for(let n=0,s=i.arcs.length;n<s;++n)e[n]=hm(i.arcs[n],t);return new ho(e)}function SB(i,t){const e=[];for(let n=0,s=i.arcs.length;n<s;++n)e[n]=hm(i.arcs[n],t);return new sr(e)}function EB(i,t){const e=[];for(let n=0,s=i.arcs.length;n<s;++n){const r=i.arcs[n],o=[];for(let a=0,l=r.length;a<l;++a)o[a]=hm(r[a],t);e[n]=o}return new qa(e)}function CB(i,t,e,n,s,r,o){const a=i.geometries,l=[];for(let h=0,c=a.length;h<c;++h)l[h]=cL(a[h],t,e,n,s,r,o);return l}function cL(i,t,e,n,s,r,o){let a=null;const l=i.type;if(l){const u=yB[l];l==="Point"||l==="MultiPoint"?a=u(i,e,n):a=u(i,t),a=qs(a,!1,o)}const h=new gi({geometry:a});i.id!==void 0&&h.setId(i.id);let c=i.properties;return s&&(c||(c={}),c[s]=r),c&&h.setProperties(c,!0),h}function LB(i,t,e){for(let n=0,s=i.length;n<s;++n)MB(i[n],t,e)}function MB(i,t,e){let n=0,s=0;for(let r=0,o=i.length;r<o;++r){const a=i[r];n+=a[0],s+=a[1],a[0]=n,a[1]=s,sv(a,t,e)}}function sv(i,t,e){i[0]=i[0]*t[0]+e[0],i[1]=i[1]*t[1]+e[1]}const go=[null,"http://www.opengis.net/wmts/1.0"],iu=[null,"http://www.opengis.net/ows/1.1"],TB=Ft(go,{Contents:bt(jB)});class AB extends hL{constructor(){super(),this.owsParser_=new W7}readFromNode(t){let e=t.getAttribute("version");e&&(e=e.trim());let n=this.owsParser_.readFromNode(t);return n?(n.version=e,n=oe(n,TB,t,[]),n||null):null}}const PB=Ft(go,{Layer:ys(zB),TileMatrixSet:ys(GB)}),IB=Ft(go,{Style:ys(UB),Format:ys($t),TileMatrixSetLink:ys(WB),Dimension:ys(qB),ResourceURL:ys(VB)},Ft(iu,{Title:bt($t),Abstract:bt($t),WGS84BoundingBox:bt(dL),BoundingBox:ys(HB),Identifier:bt($t)})),RB=Ft(go,{LegendURL:ys(YB)},Ft(iu,{Title:bt($t),Identifier:bt($t)})),NB=Ft(go,{TileMatrixSet:bt($t),TileMatrixSetLimits:bt($B)}),kB=Ft(go,{TileMatrixLimits:bs(KB)}),FB=Ft(go,{TileMatrix:bt($t),MinTileRow:bt(Gs),MaxTileRow:bt(Gs),MinTileCol:bt(Gs),MaxTileCol:bt(Gs)}),OB=Ft(go,{Default:bt($t),Value:ys($t)},Ft(iu,{Identifier:bt($t)})),uL=Ft(iu,{LowerCorner:bs(oy),UpperCorner:bs(oy)}),DB=Ft(go,{WellKnownScaleSet:bt($t),TileMatrix:ys(XB)},Ft(iu,{SupportedCRS:bt($t),Identifier:bt($t),BoundingBox:bt(dL)})),BB=Ft(go,{TopLeftCorner:bt(oy),ScaleDenominator:bt(Xe),TileWidth:bt(Gs),TileHeight:bt(Gs),MatrixWidth:bt(Gs),MatrixHeight:bt(Gs)},Ft(iu,{Identifier:bt($t)}));function jB(i,t){return oe({},PB,i,t)}function zB(i,t){return oe({},IB,i,t)}function GB(i,t){return oe({},DB,i,t)}function UB(i,t){const e=oe({},RB,i,t);if(!e)return;const n=i.getAttribute("isDefault")==="true";return e.isDefault=n,e}function WB(i,t){return oe({},NB,i,t)}function qB(i,t){return oe({},OB,i,t)}function VB(i,t){const e=i.getAttribute("format"),n=i.getAttribute("template"),s=i.getAttribute("resourceType"),r={};return e&&(r.format=e),n&&(r.template=n),s&&(r.resourceType=s),r}function dL(i,t){const e=oe([],uL,i,t);if(e.length==2)return es(e)}function HB(i,t){const e=i.getAttribute("crs"),n=oe([],uL,i,t);if(n.length==2)return{extent:es(n),crs:e}}function YB(i,t){const e={};return e.format=i.getAttribute("format"),e.href=nv(i),e}function oy(i,t){const e=$t(i).split(/\s+/);if(!e||e.length!=2)return;const n=+e[0],s=+e[1];if(!(isNaN(n)||isNaN(s)))return[n,s]}function XB(i,t){return oe({},BB,i,t)}function $B(i,t){return oe([],kB,i,t)}function KB(i,t){return oe({},FB,i,t)}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function kf(i){return i+.5|0}const Ra=(i,t,e)=>Math.max(Math.min(i,e),t);function ld(i){return Ra(kf(i*2.55),0,255)}function ja(i){return Ra(kf(i*255),0,255)}function Do(i){return Ra(kf(i/2.55)/100,0,1)}function ub(i){return Ra(kf(i*100),0,100)}const tr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ay=[..."0123456789ABCDEF"],ZB=i=>ay[i&15],JB=i=>ay[(i&240)>>4]+ay[i&15],ip=i=>(i&240)>>4===(i&15),QB=i=>ip(i.r)&&ip(i.g)&&ip(i.b)&&ip(i.a);function t9(i){var t=i.length,e;return i[0]==="#"&&(t===4||t===5?e={r:255&tr[i[1]]*17,g:255&tr[i[2]]*17,b:255&tr[i[3]]*17,a:t===5?tr[i[4]]*17:255}:(t===7||t===9)&&(e={r:tr[i[1]]<<4|tr[i[2]],g:tr[i[3]]<<4|tr[i[4]],b:tr[i[5]]<<4|tr[i[6]],a:t===9?tr[i[7]]<<4|tr[i[8]]:255})),e}const e9=(i,t)=>i<255?t(i):"";function i9(i){var t=QB(i)?ZB:JB;return i?"#"+t(i.r)+t(i.g)+t(i.b)+e9(i.a,t):void 0}const n9=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function fL(i,t,e){const n=t*Math.min(e,1-e),s=(r,o=(r+i/30)%12)=>e-n*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function s9(i,t,e){const n=(s,r=(s+i/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[n(5),n(3),n(1)]}function r9(i,t,e){const n=fL(i,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)n[s]*=1-t-e,n[s]+=t;return n}function o9(i,t,e,n,s){return i===s?(t-e)/n+(t<e?6:0):t===s?(e-i)/n+2:(i-t)/n+4}function rv(i){const e=i.r/255,n=i.g/255,s=i.b/255,r=Math.max(e,n,s),o=Math.min(e,n,s),a=(r+o)/2;let l,h,c;return r!==o&&(c=r-o,h=a>.5?c/(2-r-o):c/(r+o),l=o9(e,n,s,c,r),l=l*60+.5),[l|0,h||0,a]}function ov(i,t,e,n){return(Array.isArray(t)?i(t[0],t[1],t[2]):i(t,e,n)).map(ja)}function av(i,t,e){return ov(fL,i,t,e)}function a9(i,t,e){return ov(r9,i,t,e)}function l9(i,t,e){return ov(s9,i,t,e)}function gL(i){return(i%360+360)%360}function h9(i){const t=n9.exec(i);let e=255,n;if(!t)return;t[5]!==n&&(e=t[6]?ld(+t[5]):ja(+t[5]));const s=gL(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=a9(s,r,o):t[1]==="hsv"?n=l9(s,r,o):n=av(s,r,o),{r:n[0],g:n[1],b:n[2],a:e}}function c9(i,t){var e=rv(i);e[0]=gL(e[0]+t),e=av(e),i.r=e[0],i.g=e[1],i.b=e[2]}function u9(i){if(!i)return;const t=rv(i),e=t[0],n=ub(t[1]),s=ub(t[2]);return i.a<255?`hsla(${e}, ${n}%, ${s}%, ${Do(i.a)})`:`hsl(${e}, ${n}%, ${s}%)`}const db={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},fb={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function d9(){const i={},t=Object.keys(fb),e=Object.keys(db);let n,s,r,o,a;for(n=0;n<t.length;n++){for(o=a=t[n],s=0;s<e.length;s++)r=e[s],a=a.replace(r,db[r]);r=parseInt(fb[o],16),i[a]=[r>>16&255,r>>8&255,r&255]}return i}let np;function f9(i){np||(np=d9(),np.transparent=[0,0,0,0]);const t=np[i.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const g9=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function p9(i){const t=g9.exec(i);let e=255,n,s,r;if(t){if(t[7]!==n){const o=+t[7];e=t[8]?ld(o):Ra(o*255,0,255)}return n=+t[1],s=+t[3],r=+t[5],n=255&(t[2]?ld(n):Ra(n,0,255)),s=255&(t[4]?ld(s):Ra(s,0,255)),r=255&(t[6]?ld(r):Ra(r,0,255)),{r:n,g:s,b:r,a:e}}}function m9(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${Do(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const e_=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,Jh=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function _9(i,t,e){const n=Jh(Do(i.r)),s=Jh(Do(i.g)),r=Jh(Do(i.b));return{r:ja(e_(n+e*(Jh(Do(t.r))-n))),g:ja(e_(s+e*(Jh(Do(t.g))-s))),b:ja(e_(r+e*(Jh(Do(t.b))-r))),a:i.a+e*(t.a-i.a)}}function sp(i,t,e){if(i){let n=rv(i);n[t]=Math.max(0,Math.min(n[t]+n[t]*e,t===0?360:1)),n=av(n),i.r=n[0],i.g=n[1],i.b=n[2]}}function pL(i,t){return i&&Object.assign(t||{},i)}function gb(i){var t={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(t={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(t.a=ja(i[3]))):(t=pL(i,{r:0,g:0,b:0,a:1}),t.a=ja(t.a)),t}function y9(i){return i.charAt(0)==="r"?p9(i):h9(i)}class of{constructor(t){if(t instanceof of)return t;const e=typeof t;let n;e==="object"?n=gb(t):e==="string"&&(n=t9(t)||f9(t)||y9(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=pL(this._rgb);return t&&(t.a=Do(t.a)),t}set rgb(t){this._rgb=gb(t)}rgbString(){return this._valid?m9(this._rgb):void 0}hexString(){return this._valid?i9(this._rgb):void 0}hslString(){return this._valid?u9(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,s=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,l=n.a-s.a,h=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;r=1-h,n.r=255&h*n.r+r*s.r+.5,n.g=255&h*n.g+r*s.g+.5,n.b=255&h*n.b+r*s.b+.5,n.a=o*n.a+(1-o)*s.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=_9(this._rgb,t._rgb,e)),this}clone(){return new of(this.rgb)}alpha(t){return this._rgb.a=ja(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=kf(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return sp(this._rgb,2,t),this}darken(t){return sp(this._rgb,2,-t),this}saturate(t){return sp(this._rgb,1,t),this}desaturate(t){return sp(this._rgb,1,-t),this}rotate(t){return c9(this._rgb,t),this}}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function To(){}const v9=(()=>{let i=0;return()=>i++})();function $e(i){return i===null||typeof i>"u"}function Mi(i){if(Array.isArray&&Array.isArray(i))return!0;const t=Object.prototype.toString.call(i);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Be(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function Oi(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function Fs(i,t){return Oi(i)?i:t}function Te(i,t){return typeof i>"u"?t:i}const x9=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100:+i/t,mL=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*t:+i;function yi(i,t,e){if(i&&typeof i.call=="function")return i.apply(e,t)}function li(i,t,e,n){let s,r,o;if(Mi(i))for(r=i.length,s=0;s<r;s++)t.call(e,i[s],s);else if(Be(i))for(o=Object.keys(i),r=o.length,s=0;s<r;s++)t.call(e,i[o[s]],o[s])}function b0(i,t){let e,n,s,r;if(!i||!t||i.length!==t.length)return!1;for(e=0,n=i.length;e<n;++e)if(s=i[e],r=t[e],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function w0(i){if(Mi(i))return i.map(w0);if(Be(i)){const t=Object.create(null),e=Object.keys(i),n=e.length;let s=0;for(;s<n;++s)t[e[s]]=w0(i[e[s]]);return t}return i}function _L(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function b9(i,t,e,n){if(!_L(i))return;const s=t[i],r=e[i];Be(s)&&Be(r)?af(s,r,n):t[i]=w0(r)}function af(i,t,e){const n=Mi(t)?t:[t],s=n.length;if(!Be(i))return i;e=e||{};const r=e.merger||b9;let o;for(let a=0;a<s;++a){if(o=n[a],!Be(o))continue;const l=Object.keys(o);for(let h=0,c=l.length;h<c;++h)r(l[h],i,o,e)}return i}function Id(i,t){return af(i,t,{merger:w9})}function w9(i,t,e){if(!_L(i))return;const n=t[i],s=e[i];Be(n)&&Be(s)?Id(n,s):Object.prototype.hasOwnProperty.call(t,i)||(t[i]=w0(s))}const pb={"":i=>i,x:i=>i.x,y:i=>i.y};function S9(i){const t=i.split("."),e=[];let n="";for(const s of t)n+=s,n.endsWith("\\")?n=n.slice(0,-1)+".":(e.push(n),n="");return e}function E9(i){const t=S9(i);return e=>{for(const n of t){if(n==="")break;e=e&&e[n]}return e}}function Za(i,t){return(pb[t]||(pb[t]=E9(t)))(i)}function lv(i){return i.charAt(0).toUpperCase()+i.slice(1)}const lf=i=>typeof i<"u",Ja=i=>typeof i=="function",mb=(i,t)=>{if(i.size!==t.size)return!1;for(const e of i)if(!t.has(e))return!1;return!0};function C9(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const Li=Math.PI,Ci=2*Li,L9=Ci+Li,S0=Number.POSITIVE_INFINITY,M9=Li/180,Ji=Li/2,_l=Li/4,_b=Li*2/3,Na=Math.log10,oo=Math.sign;function Rd(i,t,e){return Math.abs(i-t)<e}function yb(i){const t=Math.round(i);i=Rd(i,t,i/1e3)?t:i;const e=Math.pow(10,Math.floor(Na(i))),n=i/e;return(n<=1?1:n<=2?2:n<=5?5:10)*e}function T9(i){const t=[],e=Math.sqrt(i);let n;for(n=1;n<e;n++)i%n===0&&(t.push(n),t.push(i/n));return e===(e|0)&&t.push(e),t.sort((s,r)=>s-r).pop(),t}function Hc(i){return!isNaN(parseFloat(i))&&isFinite(i)}function A9(i,t){const e=Math.round(i);return e-t<=i&&e+t>=i}function yL(i,t,e){let n,s,r;for(n=0,s=i.length;n<s;n++)r=i[n][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function Cr(i){return i*(Li/180)}function hv(i){return i*(180/Li)}function vb(i){if(!Oi(i))return;let t=1,e=0;for(;Math.round(i*t)/t!==i;)t*=10,e++;return e}function vL(i,t){const e=t.x-i.x,n=t.y-i.y,s=Math.sqrt(e*e+n*n);let r=Math.atan2(n,e);return r<-.5*Li&&(r+=Ci),{angle:r,distance:s}}function ly(i,t){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}function P9(i,t){return(i-t+L9)%Ci-Li}function Os(i){return(i%Ci+Ci)%Ci}function hf(i,t,e,n){const s=Os(i),r=Os(t),o=Os(e),a=Os(r-s),l=Os(o-s),h=Os(s-r),c=Os(s-o);return s===r||s===o||n&&r===o||a>l&&h<c}function En(i,t,e){return Math.max(t,Math.min(e,i))}function I9(i){return En(i,-32768,32767)}function zo(i,t,e,n=1e-6){return i>=Math.min(t,e)-n&&i<=Math.max(t,e)+n}function cv(i,t,e){e=e||(o=>i[o]<t);let n=i.length-1,s=0,r;for(;n-s>1;)r=s+n>>1,e(r)?s=r:n=r;return{lo:s,hi:n}}const Go=(i,t,e,n)=>cv(i,e,n?s=>{const r=i[s][t];return r<e||r===e&&i[s+1][t]===e}:s=>i[s][t]<e),R9=(i,t,e)=>cv(i,e,n=>i[n][t]>=e);function N9(i,t,e){let n=0,s=i.length;for(;n<s&&i[n]<t;)n++;for(;s>n&&i[s-1]>e;)s--;return n>0||s<i.length?i.slice(n,s):i}const xL=["push","pop","shift","splice","unshift"];function k9(i,t){if(i._chartjs){i._chartjs.listeners.push(t);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),xL.forEach(e=>{const n="_onData"+lv(e),s=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return i._chartjs.listeners.forEach(a=>{typeof a[n]=="function"&&a[n](...r)}),o}})})}function xb(i,t){const e=i._chartjs;if(!e)return;const n=e.listeners,s=n.indexOf(t);s!==-1&&n.splice(s,1),!(n.length>0)&&(xL.forEach(r=>{delete i[r]}),delete i._chartjs)}function bL(i){const t=new Set(i);return t.size===i.length?i:Array.from(t)}const wL=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function SL(i,t){let e=[],n=!1;return function(...s){e=s,n||(n=!0,wL.call(window,()=>{n=!1,i.apply(t,e)}))}}function F9(i,t){let e;return function(...n){return t?(clearTimeout(e),e=setTimeout(i,t,n)):i.apply(this,n),t}}const uv=i=>i==="start"?"left":i==="end"?"right":"center",zn=(i,t,e)=>i==="start"?t:i==="end"?e:(t+e)/2,O9=(i,t,e,n)=>i===(n?"left":"right")?e:i==="center"?(t+e)/2:t;function EL(i,t,e){const n=t.length;let s=0,r=n;if(i._sorted){const{iScale:o,_parsed:a}=i,l=o.axis,{min:h,max:c,minDefined:u,maxDefined:f}=o.getUserBounds();u&&(s=En(Math.min(Go(a,l,h).lo,e?n:Go(t,l,o.getPixelForValue(h)).lo),0,n-1)),f?r=En(Math.max(Go(a,o.axis,c,!0).hi+1,e?0:Go(t,l,o.getPixelForValue(c),!0).hi+1),s,n)-s:r=n-s}return{start:s,count:r}}function CL(i){const{xScale:t,yScale:e,_scaleRanges:n}=i,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!n)return i._scaleRanges=s,!0;const r=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==e.min||n.ymax!==e.max;return Object.assign(n,s),r}const rp=i=>i===0||i===1,bb=(i,t,e)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-t)*Ci/e)),wb=(i,t,e)=>Math.pow(2,-10*i)*Math.sin((i-t)*Ci/e)+1,Nd={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*Ji)+1,easeOutSine:i=>Math.sin(i*Ji),easeInOutSine:i=>-.5*(Math.cos(Li*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>rp(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>rp(i)?i:bb(i,.075,.3),easeOutElastic:i=>rp(i)?i:wb(i,.075,.3),easeInOutElastic(i){return rp(i)?i:i<.5?.5*bb(i*2,.1125,.45):.5+.5*wb(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let t=1.70158;return(i/=.5)<1?.5*(i*i*(((t*=1.525)+1)*i-t)):.5*((i-=2)*i*(((t*=1.525)+1)*i+t)+2)},easeInBounce:i=>1-Nd.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?Nd.easeInBounce(i*2)*.5:Nd.easeOutBounce(i*2-1)*.5+.5};function dv(i){if(i&&typeof i=="object"){const t=i.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Sb(i){return dv(i)?i:new of(i)}function i_(i){return dv(i)?i:new of(i).saturate(.5).darken(.1).hexString()}const D9=["x","y","borderWidth","radius","tension"],B9=["color","borderColor","backgroundColor"];function j9(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),i.set("animations",{colors:{type:"color",properties:B9},numbers:{type:"number",properties:D9}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function z9(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Eb=new Map;function G9(i,t){t=t||{};const e=i+JSON.stringify(t);let n=Eb.get(e);return n||(n=new Intl.NumberFormat(i,t),Eb.set(e,n)),n}function Ff(i,t,e){return G9(t,e).format(i)}const LL={values(i){return Mi(i)?i:""+i},numeric(i,t,e){if(i===0)return"0";const n=this.chart.options.locale;let s,r=i;if(e.length>1){const h=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(h<1e-4||h>1e15)&&(s="scientific"),r=U9(i,e)}const o=Na(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Ff(i,n,l)},logarithmic(i,t,e){if(i===0)return"0";const n=e[t].significand||i/Math.pow(10,Math.floor(Na(i)));return[1,2,3,5,10,15].includes(n)||t>.8*e.length?LL.numeric.call(this,i,t,e):""}};function U9(i,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&i!==Math.floor(i)&&(e=i-Math.floor(i)),e}var cm={formatters:LL};function W9(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:cm.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Xl=Object.create(null),hy=Object.create(null);function kd(i,t){if(!t)return i;const e=t.split(".");for(let n=0,s=e.length;n<s;++n){const r=e[n];i=i[r]||(i[r]=Object.create(null))}return i}function n_(i,t,e){return typeof t=="string"?af(kd(i,t),e):af(kd(i,""),t)}class q9{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,s)=>i_(s.backgroundColor),this.hoverBorderColor=(n,s)=>i_(s.borderColor),this.hoverColor=(n,s)=>i_(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return n_(this,t,e)}get(t){return kd(this,t)}describe(t,e){return n_(hy,t,e)}override(t,e){return n_(Xl,t,e)}route(t,e,n,s){const r=kd(this,t),o=kd(this,n),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],h=o[s];return Be(l)?Object.assign({},h,l):Te(l,h)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var Di=new q9({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[j9,z9,W9]);function V9(i){return!i||$e(i.size)||$e(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function E0(i,t,e,n,s){let r=t[s];return r||(r=t[s]=i.measureText(s).width,e.push(s)),r>n&&(n=r),n}function H9(i,t,e,n){n=n||{};let s=n.data=n.data||{},r=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(s=n.data={},r=n.garbageCollect=[],n.font=t),i.save(),i.font=t;let o=0;const a=e.length;let l,h,c,u,f;for(l=0;l<a;l++)if(u=e[l],u!=null&&!Mi(u))o=E0(i,s,r,o,u);else if(Mi(u))for(h=0,c=u.length;h<c;h++)f=u[h],f!=null&&!Mi(f)&&(o=E0(i,s,r,o,f));i.restore();const d=r.length/2;if(d>e.length){for(l=0;l<d;l++)delete s[r[l]];r.splice(0,d)}return o}function yl(i,t,e){const n=i.currentDevicePixelRatio,s=e!==0?Math.max(e/2,.5):0;return Math.round((t-s)*n)/n+s}function Cb(i,t){!t&&!i||(t=t||i.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,i.width,i.height),t.restore())}function cy(i,t,e,n){ML(i,t,e,n,null)}function ML(i,t,e,n,s){let r,o,a,l,h,c,u,f;const d=t.pointStyle,g=t.rotation,p=t.radius;let y=(g||0)*M9;if(d&&typeof d=="object"&&(r=d.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){i.save(),i.translate(e,n),i.rotate(y),i.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),i.restore();return}if(!(isNaN(p)||p<=0)){switch(i.beginPath(),d){default:s?i.ellipse(e,n,s/2,p,0,0,Ci):i.arc(e,n,p,0,Ci),i.closePath();break;case"triangle":c=s?s/2:p,i.moveTo(e+Math.sin(y)*c,n-Math.cos(y)*p),y+=_b,i.lineTo(e+Math.sin(y)*c,n-Math.cos(y)*p),y+=_b,i.lineTo(e+Math.sin(y)*c,n-Math.cos(y)*p),i.closePath();break;case"rectRounded":h=p*.516,l=p-h,o=Math.cos(y+_l)*l,u=Math.cos(y+_l)*(s?s/2-h:l),a=Math.sin(y+_l)*l,f=Math.sin(y+_l)*(s?s/2-h:l),i.arc(e-u,n-a,h,y-Li,y-Ji),i.arc(e+f,n-o,h,y-Ji,y),i.arc(e+u,n+a,h,y,y+Ji),i.arc(e-f,n+o,h,y+Ji,y+Li),i.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*p,c=s?s/2:l,i.rect(e-c,n-l,2*c,2*l);break}y+=_l;case"rectRot":u=Math.cos(y)*(s?s/2:p),o=Math.cos(y)*p,a=Math.sin(y)*p,f=Math.sin(y)*(s?s/2:p),i.moveTo(e-u,n-a),i.lineTo(e+f,n-o),i.lineTo(e+u,n+a),i.lineTo(e-f,n+o),i.closePath();break;case"crossRot":y+=_l;case"cross":u=Math.cos(y)*(s?s/2:p),o=Math.cos(y)*p,a=Math.sin(y)*p,f=Math.sin(y)*(s?s/2:p),i.moveTo(e-u,n-a),i.lineTo(e+u,n+a),i.moveTo(e+f,n-o),i.lineTo(e-f,n+o);break;case"star":u=Math.cos(y)*(s?s/2:p),o=Math.cos(y)*p,a=Math.sin(y)*p,f=Math.sin(y)*(s?s/2:p),i.moveTo(e-u,n-a),i.lineTo(e+u,n+a),i.moveTo(e+f,n-o),i.lineTo(e-f,n+o),y+=_l,u=Math.cos(y)*(s?s/2:p),o=Math.cos(y)*p,a=Math.sin(y)*p,f=Math.sin(y)*(s?s/2:p),i.moveTo(e-u,n-a),i.lineTo(e+u,n+a),i.moveTo(e+f,n-o),i.lineTo(e-f,n+o);break;case"line":o=s?s/2:Math.cos(y)*p,a=Math.sin(y)*p,i.moveTo(e-o,n-a),i.lineTo(e+o,n+a);break;case"dash":i.moveTo(e,n),i.lineTo(e+Math.cos(y)*(s?s/2:p),n+Math.sin(y)*p);break;case!1:i.closePath();break}i.fill(),t.borderWidth>0&&i.stroke()}}function Uo(i,t,e){return e=e||.5,!t||i&&i.x>t.left-e&&i.x<t.right+e&&i.y>t.top-e&&i.y<t.bottom+e}function um(i,t){i.save(),i.beginPath(),i.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),i.clip()}function dm(i){i.restore()}function Y9(i,t,e,n,s){if(!t)return i.lineTo(e.x,e.y);if(s==="middle"){const r=(t.x+e.x)/2;i.lineTo(r,t.y),i.lineTo(r,e.y)}else s==="after"!=!!n?i.lineTo(t.x,e.y):i.lineTo(e.x,t.y);i.lineTo(e.x,e.y)}function X9(i,t,e,n){if(!t)return i.lineTo(e.x,e.y);i.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?e.cp2x:e.cp1x,n?e.cp2y:e.cp1y,e.x,e.y)}function $9(i,t){t.translation&&i.translate(t.translation[0],t.translation[1]),$e(t.rotation)||i.rotate(t.rotation),t.color&&(i.fillStyle=t.color),t.textAlign&&(i.textAlign=t.textAlign),t.textBaseline&&(i.textBaseline=t.textBaseline)}function K9(i,t,e,n,s){if(s.strikethrough||s.underline){const r=i.measureText(n),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,l=e-r.actualBoundingBoxAscent,h=e+r.actualBoundingBoxDescent,c=s.strikethrough?(l+h)/2:h;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=s.decorationWidth||2,i.moveTo(o,c),i.lineTo(a,c),i.stroke()}}function Z9(i,t){const e=i.fillStyle;i.fillStyle=t.color,i.fillRect(t.left,t.top,t.width,t.height),i.fillStyle=e}function $l(i,t,e,n,s,r={}){const o=Mi(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let l,h;for(i.save(),i.font=s.string,$9(i,r),l=0;l<o.length;++l)h=o[l],r.backdrop&&Z9(i,r.backdrop),a&&(r.strokeColor&&(i.strokeStyle=r.strokeColor),$e(r.strokeWidth)||(i.lineWidth=r.strokeWidth),i.strokeText(h,e,n,r.maxWidth)),i.fillText(h,e,n,r.maxWidth),K9(i,e,n,h,r),n+=Number(s.lineHeight);i.restore()}function cf(i,t){const{x:e,y:n,w:s,h:r,radius:o}=t;i.arc(e+o.topLeft,n+o.topLeft,o.topLeft,1.5*Li,Li,!0),i.lineTo(e,n+r-o.bottomLeft),i.arc(e+o.bottomLeft,n+r-o.bottomLeft,o.bottomLeft,Li,Ji,!0),i.lineTo(e+s-o.bottomRight,n+r),i.arc(e+s-o.bottomRight,n+r-o.bottomRight,o.bottomRight,Ji,0,!0),i.lineTo(e+s,n+o.topRight),i.arc(e+s-o.topRight,n+o.topRight,o.topRight,0,-Ji,!0),i.lineTo(e+o.topLeft,n)}const J9=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Q9=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function tj(i,t){const e=(""+i).match(J9);if(!e||e[1]==="normal")return t*1.2;switch(i=+e[2],e[3]){case"px":return i;case"%":i/=100;break}return t*i}const ej=i=>+i||0;function fv(i,t){const e={},n=Be(t),s=n?Object.keys(t):t,r=Be(i)?n?o=>Te(i[o],i[t[o]]):o=>i[o]:()=>i;for(const o of s)e[o]=ej(r(o));return e}function TL(i){return fv(i,{top:"y",right:"x",bottom:"y",left:"x"})}function Bl(i){return fv(i,["topLeft","topRight","bottomLeft","bottomRight"])}function Xn(i){const t=TL(i);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function fn(i,t){i=i||{},t=t||Di.font;let e=Te(i.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let n=Te(i.style,t.style);n&&!(""+n).match(Q9)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const s={family:Te(i.family,t.family),lineHeight:tj(Te(i.lineHeight,t.lineHeight),e),size:e,style:n,weight:Te(i.weight,t.weight),string:""};return s.string=V9(s),s}function hd(i,t,e,n){let s,r,o;for(s=0,r=i.length;s<r;++s)if(o=i[s],o!==void 0&&o!==void 0)return o}function ij(i,t,e){const{min:n,max:s}=i,r=mL(t,(s-n)/2),o=(a,l)=>e&&a===0?0:a+l;return{min:o(n,-Math.abs(r)),max:o(s,r)}}function nl(i,t){return Object.assign(Object.create(i),t)}function gv(i,t=[""],e,n,s=()=>i[0]){const r=e||i;typeof n>"u"&&(n=RL("_fallback",i));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:r,_fallback:n,_getTarget:s,override:a=>gv([a,...i],t,r,n)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete i[0][l],!0},get(a,l){return PL(a,l,()=>cj(l,t,i,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(a,l){return Mb(a).includes(l)},ownKeys(a){return Mb(a)},set(a,l,h){const c=a._storage||(a._storage=s());return a[l]=c[l]=h,delete a._keys,!0}})}function Yc(i,t,e,n){const s={_cacheable:!1,_proxy:i,_context:t,_subProxy:e,_stack:new Set,_descriptors:AL(i,n),setContext:r=>Yc(i,r,e,n),override:r=>Yc(i.override(r),t,e,n)};return new Proxy(s,{deleteProperty(r,o){return delete r[o],delete i[o],!0},get(r,o,a){return PL(r,o,()=>sj(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(i,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,o)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(r,o){return Reflect.has(i,o)},ownKeys(){return Reflect.ownKeys(i)},set(r,o,a){return i[o]=a,delete r[o],!0}})}function AL(i,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:n=t.indexable,_allKeys:s=t.allKeys}=i;return{allKeys:s,scriptable:e,indexable:n,isScriptable:Ja(e)?e:()=>e,isIndexable:Ja(n)?n:()=>n}}const nj=(i,t)=>i?i+lv(t):t,pv=(i,t)=>Be(t)&&i!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function PL(i,t,e){if(Object.prototype.hasOwnProperty.call(i,t)||t==="constructor")return i[t];const n=e();return i[t]=n,n}function sj(i,t,e){const{_proxy:n,_context:s,_subProxy:r,_descriptors:o}=i;let a=n[t];return Ja(a)&&o.isScriptable(t)&&(a=rj(t,a,i,e)),Mi(a)&&a.length&&(a=oj(t,a,i,o.isIndexable)),pv(t,a)&&(a=Yc(a,s,r&&r[t],o)),a}function rj(i,t,e,n){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=e;if(a.has(i))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+i);a.add(i);let l=t(r,o||n);return a.delete(i),pv(i,l)&&(l=mv(s._scopes,s,i,l)),l}function oj(i,t,e,n){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&n(i))return t[r.index%t.length];if(Be(t[0])){const l=t,h=s._scopes.filter(c=>c!==l);t=[];for(const c of l){const u=mv(h,s,i,c);t.push(Yc(u,r,o&&o[i],a))}}return t}function IL(i,t,e){return Ja(i)?i(t,e):i}const aj=(i,t)=>i===!0?t:typeof i=="string"?Za(t,i):void 0;function lj(i,t,e,n,s){for(const r of t){const o=aj(e,r);if(o){i.add(o);const a=IL(o._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==n)return a}else if(o===!1&&typeof n<"u"&&e!==n)return null}return!1}function mv(i,t,e,n){const s=t._rootScopes,r=IL(t._fallback,e,n),o=[...i,...s],a=new Set;a.add(n);let l=Lb(a,o,e,r||e,n);return l===null||typeof r<"u"&&r!==e&&(l=Lb(a,o,r,l,n),l===null)?!1:gv(Array.from(a),[""],s,r,()=>hj(t,e,n))}function Lb(i,t,e,n,s){for(;e;)e=lj(i,t,e,n,s);return e}function hj(i,t,e){const n=i._getTarget();t in n||(n[t]={});const s=n[t];return Mi(s)&&Be(e)?e:s||{}}function cj(i,t,e,n){let s;for(const r of t)if(s=RL(nj(r,i),e),typeof s<"u")return pv(i,s)?mv(e,n,i,s):s}function RL(i,t){for(const e of t){if(!e)continue;const n=e[i];if(typeof n<"u")return n}}function Mb(i){let t=i._keys;return t||(t=i._keys=uj(i._scopes)),t}function uj(i){const t=new Set;for(const e of i)for(const n of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(n);return Array.from(t)}function NL(i,t,e,n){const{iScale:s}=i,{key:r="r"}=this._parsing,o=new Array(n);let a,l,h,c;for(a=0,l=n;a<l;++a)h=a+e,c=t[h],o[a]={r:s.parse(Za(c,r),h)};return o}const dj=Number.EPSILON||1e-14,Xc=(i,t)=>t<i.length&&!i[t].skip&&i[t],kL=i=>i==="x"?"y":"x";function fj(i,t,e,n){const s=i.skip?t:i,r=t,o=e.skip?t:e,a=ly(r,s),l=ly(o,r);let h=a/(a+l),c=l/(a+l);h=isNaN(h)?0:h,c=isNaN(c)?0:c;const u=n*h,f=n*c;return{previous:{x:r.x-u*(o.x-s.x),y:r.y-u*(o.y-s.y)},next:{x:r.x+f*(o.x-s.x),y:r.y+f*(o.y-s.y)}}}function gj(i,t,e){const n=i.length;let s,r,o,a,l,h=Xc(i,0);for(let c=0;c<n-1;++c)if(l=h,h=Xc(i,c+1),!(!l||!h)){if(Rd(t[c],0,dj)){e[c]=e[c+1]=0;continue}s=e[c]/t[c],r=e[c+1]/t[c],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[c]=s*o*t[c],e[c+1]=r*o*t[c])}}function pj(i,t,e="x"){const n=kL(e),s=i.length;let r,o,a,l=Xc(i,0);for(let h=0;h<s;++h){if(o=a,a=l,l=Xc(i,h+1),!a)continue;const c=a[e],u=a[n];o&&(r=(c-o[e])/3,a[`cp1${e}`]=c-r,a[`cp1${n}`]=u-r*t[h]),l&&(r=(l[e]-c)/3,a[`cp2${e}`]=c+r,a[`cp2${n}`]=u+r*t[h])}}function mj(i,t="x"){const e=kL(t),n=i.length,s=Array(n).fill(0),r=Array(n);let o,a,l,h=Xc(i,0);for(o=0;o<n;++o)if(a=l,l=h,h=Xc(i,o+1),!!l){if(h){const c=h[t]-l[t];s[o]=c!==0?(h[e]-l[e])/c:0}r[o]=a?h?oo(s[o-1])!==oo(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}gj(i,s,r),pj(i,r,t)}function op(i,t,e){return Math.max(Math.min(i,e),t)}function _j(i,t){let e,n,s,r,o,a=Uo(i[0],t);for(e=0,n=i.length;e<n;++e)o=r,r=a,a=e<n-1&&Uo(i[e+1],t),r&&(s=i[e],o&&(s.cp1x=op(s.cp1x,t.left,t.right),s.cp1y=op(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=op(s.cp2x,t.left,t.right),s.cp2y=op(s.cp2y,t.top,t.bottom)))}function yj(i,t,e,n,s){let r,o,a,l;if(t.spanGaps&&(i=i.filter(h=>!h.skip)),t.cubicInterpolationMode==="monotone")mj(i,s);else{let h=n?i[i.length-1]:i[0];for(r=0,o=i.length;r<o;++r)a=i[r],l=fj(h,a,i[Math.min(r+1,o-(n?0:1))%o],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,h=a}t.capBezierPoints&&_j(i,e)}function _v(){return typeof window<"u"&&typeof document<"u"}function yv(i){let t=i.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function C0(i,t,e){let n;return typeof i=="string"?(n=parseInt(i,10),i.indexOf("%")!==-1&&(n=n/100*t.parentNode[e])):n=i,n}const fm=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function vj(i,t){return fm(i).getPropertyValue(t)}const xj=["top","right","bottom","left"];function jl(i,t,e){const n={};e=e?"-"+e:"";for(let s=0;s<4;s++){const r=xj[s];n[r]=parseFloat(i[t+"-"+r+e])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const bj=(i,t,e)=>(i>0||t>0)&&(!e||!e.shadowRoot);function wj(i,t){const e=i.touches,n=e&&e.length?e[0]:i,{offsetX:s,offsetY:r}=n;let o=!1,a,l;if(bj(s,r,i.target))a=s,l=r;else{const h=t.getBoundingClientRect();a=n.clientX-h.left,l=n.clientY-h.top,o=!0}return{x:a,y:l,box:o}}function El(i,t){if("native"in i)return i;const{canvas:e,currentDevicePixelRatio:n}=t,s=fm(e),r=s.boxSizing==="border-box",o=jl(s,"padding"),a=jl(s,"border","width"),{x:l,y:h,box:c}=wj(i,e),u=o.left+(c&&a.left),f=o.top+(c&&a.top);let{width:d,height:g}=t;return r&&(d-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-u)/d*e.width/n),y:Math.round((h-f)/g*e.height/n)}}function Sj(i,t,e){let n,s;if(t===void 0||e===void 0){const r=i&&yv(i);if(!r)t=i.clientWidth,e=i.clientHeight;else{const o=r.getBoundingClientRect(),a=fm(r),l=jl(a,"border","width"),h=jl(a,"padding");t=o.width-h.width-l.width,e=o.height-h.height-l.height,n=C0(a.maxWidth,r,"clientWidth"),s=C0(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:n||S0,maxHeight:s||S0}}const ap=i=>Math.round(i*10)/10;function Ej(i,t,e,n){const s=fm(i),r=jl(s,"margin"),o=C0(s.maxWidth,i,"clientWidth")||S0,a=C0(s.maxHeight,i,"clientHeight")||S0,l=Sj(i,t,e);let{width:h,height:c}=l;if(s.boxSizing==="content-box"){const f=jl(s,"border","width"),d=jl(s,"padding");h-=d.width+f.width,c-=d.height+f.height}return h=Math.max(0,h-r.width),c=Math.max(0,n?h/n:c-r.height),h=ap(Math.min(h,o,l.maxWidth)),c=ap(Math.min(c,a,l.maxHeight)),h&&!c&&(c=ap(h/2)),(t!==void 0||e!==void 0)&&n&&l.height&&c>l.height&&(c=l.height,h=ap(Math.floor(c*n))),{width:h,height:c}}function Tb(i,t,e){const n=t||1,s=Math.floor(i.height*n),r=Math.floor(i.width*n);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const o=i.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${i.height}px`,o.style.width=`${i.width}px`),i.currentDevicePixelRatio!==n||o.height!==s||o.width!==r?(i.currentDevicePixelRatio=n,o.height=s,o.width=r,i.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Cj=function(){let i=!1;try{const t={get passive(){return i=!0,!1}};_v()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return i}();function Ab(i,t){const e=vj(i,t),n=e&&e.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Cl(i,t,e,n){return{x:i.x+e*(t.x-i.x),y:i.y+e*(t.y-i.y)}}function Lj(i,t,e,n){return{x:i.x+e*(t.x-i.x),y:n==="middle"?e<.5?i.y:t.y:n==="after"?e<1?i.y:t.y:e>0?t.y:i.y}}function Mj(i,t,e,n){const s={x:i.cp2x,y:i.cp2y},r={x:t.cp1x,y:t.cp1y},o=Cl(i,s,e),a=Cl(s,r,e),l=Cl(r,t,e),h=Cl(o,a,e),c=Cl(a,l,e);return Cl(h,c,e)}const Tj=function(i,t){return{x(e){return i+i+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,n){return e-n},leftForLtr(e,n){return e-n}}},Aj=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,t){return i+t},leftForLtr(i,t){return i}}};function Tc(i,t,e){return i?Tj(t,e):Aj()}function FL(i,t){let e,n;(t==="ltr"||t==="rtl")&&(e=i.canvas.style,n=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),i.prevTextDirection=n)}function OL(i,t){t!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",t[0],t[1]))}function DL(i){return i==="angle"?{between:hf,compare:P9,normalize:Os}:{between:zo,compare:(t,e)=>t-e,normalize:t=>t}}function Pb({start:i,end:t,count:e,loop:n,style:s}){return{start:i%e,end:t%e,loop:n&&(t-i+1)%e===0,style:s}}function Pj(i,t,e){const{property:n,start:s,end:r}=e,{between:o,normalize:a}=DL(n),l=t.length;let{start:h,end:c,loop:u}=i,f,d;if(u){for(h+=l,c+=l,f=0,d=l;f<d&&o(a(t[h%l][n]),s,r);++f)h--,c--;h%=l,c%=l}return c<h&&(c+=l),{start:h,end:c,loop:u,style:i.style}}function BL(i,t,e){if(!e)return[i];const{property:n,start:s,end:r}=e,o=t.length,{compare:a,between:l,normalize:h}=DL(n),{start:c,end:u,loop:f,style:d}=Pj(i,t,e),g=[];let p=!1,y=null,_,x,b;const L=()=>l(s,b,_)&&a(s,b)!==0,M=()=>a(r,_)===0||l(r,b,_),k=()=>p||L(),A=()=>!p||M();for(let T=c,F=c;T<=u;++T)x=t[T%o],!x.skip&&(_=h(x[n]),_!==b&&(p=l(_,s,r),y===null&&k()&&(y=a(_,s)===0?T:F),y!==null&&A()&&(g.push(Pb({start:y,end:T,loop:f,count:o,style:d})),y=null),F=T,b=_));return y!==null&&g.push(Pb({start:y,end:u,loop:f,count:o,style:d})),g}function jL(i,t){const e=[],n=i.segments;for(let s=0;s<n.length;s++){const r=BL(n[s],i.points,t);r.length&&e.push(...r)}return e}function Ij(i,t,e,n){let s=0,r=t-1;if(e&&!n)for(;s<t&&!i[s].skip;)s++;for(;s<t&&i[s].skip;)s++;for(s%=t,e&&(r+=s);r>s&&i[r%t].skip;)r--;return r%=t,{start:s,end:r}}function Rj(i,t,e,n){const s=i.length,r=[];let o=t,a=i[t],l;for(l=t+1;l<=e;++l){const h=i[l%s];h.skip||h.stop?a.skip||(n=!1,r.push({start:t%s,end:(l-1)%s,loop:n}),t=o=h.stop?l:null):(o=l,a.skip&&(t=l)),a=h}return o!==null&&r.push({start:t%s,end:o%s,loop:n}),r}function Nj(i,t){const e=i.points,n=i.options.spanGaps,s=e.length;if(!s)return[];const r=!!i._loop,{start:o,end:a}=Ij(e,s,r,n);if(n===!0)return Ib(i,[{start:o,end:a,loop:r}],e,t);const l=a<o?a+s:a,h=!!i._fullLoop&&o===0&&a===s-1;return Ib(i,Rj(e,o,l,h),e,t)}function Ib(i,t,e,n){return!n||!n.setContext||!e?t:kj(i,t,e,n)}function kj(i,t,e,n){const s=i._chart.getContext(),r=Rb(i.options),{_datasetIndex:o,options:{spanGaps:a}}=i,l=e.length,h=[];let c=r,u=t[0].start,f=u;function d(g,p,y,_){const x=a?-1:1;if(g!==p){for(g+=l;e[g%l].skip;)g-=x;for(;e[p%l].skip;)p+=x;g%l!==p%l&&(h.push({start:g%l,end:p%l,loop:y,style:_}),c=_,u=p%l)}}for(const g of t){u=a?u:g.start;let p=e[u%l],y;for(f=u+1;f<=g.end;f++){const _=e[f%l];y=Rb(n.setContext(nl(s,{type:"segment",p0:p,p1:_,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),Fj(y,c)&&d(u,f-1,g.loop,c),p=_,c=y}u<f-1&&d(u,f-1,g.loop,c)}return h}function Rb(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function Fj(i,t){if(!t)return!1;const e=[],n=function(s,r){return dv(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(i,n)!==JSON.stringify(t,n)}/*!
 * Chart.js v4.4.4
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class Oj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,s){const r=e.listeners[s],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(n-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=wL.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((n,s)=>{if(!n.running||!n.items.length)return;const r=n.items;let o=r.length-1,a=!1,l;for(;o>=0;--o)l=r[o],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,n,t,"progress")),r.length||(n.running=!1,this._notify(s,n,t,"complete"),n.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((n,s)=>Math.max(n,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let s=n.length-1;for(;s>=0;--s)n[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Io=new Oj;const Nb="transparent",Dj={boolean(i,t,e){return e>.5?t:i},color(i,t,e){const n=Sb(i||Nb),s=n.valid&&Sb(t||Nb);return s&&s.valid?s.mix(n,e).hexString():t},number(i,t,e){return i+(t-i)*e}};class Bj{constructor(t,e,n,s){const r=e[n];s=hd([t.to,s,r,t.from]);const o=hd([t.from,r,s]);this._active=!0,this._fn=t.fn||Dj[t.type||typeof o],this._easing=Nd[t.easing]||Nd.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const s=this._target[this._prop],r=n-this._start,o=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=hd([t.to,e,s,t.from]),this._from=hd([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||e<n),!this._active){this._target[s]=a,this._notify(!0);return}if(e<0){this._target[s]=r;return}l=e/n%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(r,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,n)=>{t.push({res:e,rej:n})})}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let s=0;s<n.length;s++)n[s][e]()}}class zL{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Be(t))return;const e=Object.keys(Di.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const r=t[s];if(!Be(r))return;const o={};for(const a of e)o[a]=r[a];(Mi(r.properties)&&r.properties||[s]).forEach(a=>{(a===s||!n.has(a))&&n.set(a,o)})})}_animateOptions(t,e){const n=e.options,s=zj(t,n);if(!s)return[];const r=this._createAnimations(s,n);return n.$shared&&jj(t.options.$animations,n).then(()=>{t.options=n},()=>{}),r}_createAnimations(t,e){const n=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const h=o[l];if(h.charAt(0)==="$")continue;if(h==="options"){s.push(...this._animateOptions(t,e));continue}const c=e[h];let u=r[h];const f=n.get(h);if(u)if(f&&u.active()){u.update(f,c,a);continue}else u.cancel();if(!f||!f.duration){t[h]=c;continue}r[h]=u=new Bj(f,t,h,c),s.push(u)}return s}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const n=this._createAnimations(t,e);if(n.length)return Io.add(this._chart,n),!0}}function jj(i,t){const e=[],n=Object.keys(t);for(let s=0;s<n.length;s++){const r=i[n[s]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function zj(i,t){if(!t)return;let e=i.options;if(!e){i.options=t;return}return e.$shared&&(i.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function kb(i,t){const e=i&&i.options||{},n=e.reverse,s=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:n?r:s,end:n?s:r}}function Gj(i,t,e){if(e===!1)return!1;const n=kb(i,e),s=kb(t,e);return{top:s.end,right:n.end,bottom:s.start,left:n.start}}function Uj(i){let t,e,n,s;return Be(i)?(t=i.top,e=i.right,n=i.bottom,s=i.left):t=e=n=s=i,{top:t,right:e,bottom:n,left:s,disabled:i===!1}}function GL(i,t){const e=[],n=i._getSortedDatasetMetas(t);let s,r;for(s=0,r=n.length;s<r;++s)e.push(n[s].index);return e}function Fb(i,t,e,n={}){const s=i.keys,r=n.mode==="single";let o,a,l,h;if(t!==null){for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===e){if(n.all)continue;break}h=i.values[l],Oi(h)&&(r||t===0||oo(t)===oo(h))&&(t+=h)}return t}}function Wj(i,t){const{iScale:e,vScale:n}=t,s=e.axis==="x"?"x":"y",r=n.axis==="x"?"x":"y",o=Object.keys(i),a=new Array(o.length);let l,h,c;for(l=0,h=o.length;l<h;++l)c=o[l],a[l]={[s]:c,[r]:i[c]};return a}function Ob(i,t){const e=i&&i.options.stacked;return e||e===void 0&&t.stack!==void 0}function qj(i,t,e){return`${i.id}.${t.id}.${e.stack||e.type}`}function Vj(i){const{min:t,max:e,minDefined:n,maxDefined:s}=i.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}function Hj(i,t,e){const n=i[t]||(i[t]={});return n[e]||(n[e]={})}function Db(i,t,e,n){for(const s of t.getMatchingVisibleMetas(n).reverse()){const r=i[s.index];if(e&&r>0||!e&&r<0)return s.index}return null}function Bb(i,t){const{chart:e,_cachedMeta:n}=i,s=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=n,l=r.axis,h=o.axis,c=qj(r,o,n),u=t.length;let f;for(let d=0;d<u;++d){const g=t[d],{[l]:p,[h]:y}=g,_=g._stacks||(g._stacks={});f=_[h]=Hj(s,c,p),f[a]=y,f._top=Db(f,o,!0,n.type),f._bottom=Db(f,o,!1,n.type);const x=f._visualValues||(f._visualValues={});x[a]=y}}function s_(i,t){const e=i.scales;return Object.keys(e).filter(n=>e[n].axis===t).shift()}function Yj(i,t){return nl(i,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Xj(i,t,e){return nl(i,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Vu(i,t){const e=i.controller.index,n=i.vScale&&i.vScale.axis;if(n){t=t||i._parsed;for(const s of t){const r=s._stacks;if(!r||r[n]===void 0||r[n][e]===void 0)return;delete r[n][e],r[n]._visualValues!==void 0&&r[n]._visualValues[e]!==void 0&&delete r[n]._visualValues[e]}}}const r_=i=>i==="reset"||i==="none",jb=(i,t)=>t?i:Object.assign({},i),$j=(i,t,e)=>i&&!t.hidden&&t._stacked&&{keys:GL(e,!0),values:null};class Tr{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ob(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Vu(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),s=(u,f,d,g)=>u==="x"?f:u==="r"?g:d,r=e.xAxisID=Te(n.xAxisID,s_(t,"x")),o=e.yAxisID=Te(n.yAxisID,s_(t,"y")),a=e.rAxisID=Te(n.rAxisID,s_(t,"r")),l=e.indexAxis,h=e.iAxisID=s(l,r,o,a),c=e.vAxisID=s(l,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(h),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&xb(this._data,this),t._stacked&&Vu(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(Be(e)){const s=this._cachedMeta;this._data=Wj(e,s)}else if(n!==e){if(n){xb(n,this);const s=this._cachedMeta;Vu(s),s._parsed=[]}e&&Object.isExtensible(e)&&k9(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let s=!1;this._dataCheck();const r=e._stacked;e._stacked=Ob(e.vScale,e),e.stack!==n.stack&&(s=!0,Vu(e),e.stack=n.stack),this._resyncElements(t),(s||r!==e._stacked)&&Bb(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:s}=this,{iScale:r,_stacked:o}=n,a=r.axis;let l=t===0&&e===s.length?!0:n._sorted,h=t>0&&n._parsed[t-1],c,u,f;if(this._parsing===!1)n._parsed=s,n._sorted=!0,f=s;else{Mi(s[t])?f=this.parseArrayData(n,s,t,e):Be(s[t])?f=this.parseObjectData(n,s,t,e):f=this.parsePrimitiveData(n,s,t,e);const d=()=>u[a]===null||h&&u[a]<h[a];for(c=0;c<e;++c)n._parsed[c+t]=u=f[c],l&&(d()&&(l=!1),h=u);n._sorted=l}o&&Bb(this,f)}parsePrimitiveData(t,e,n,s){const{iScale:r,vScale:o}=t,a=r.axis,l=o.axis,h=r.getLabels(),c=r===o,u=new Array(s);let f,d,g;for(f=0,d=s;f<d;++f)g=f+n,u[f]={[a]:c||r.parse(h[g],g),[l]:o.parse(e[g],g)};return u}parseArrayData(t,e,n,s){const{xScale:r,yScale:o}=t,a=new Array(s);let l,h,c,u;for(l=0,h=s;l<h;++l)c=l+n,u=e[c],a[l]={x:r.parse(u[0],c),y:o.parse(u[1],c)};return a}parseObjectData(t,e,n,s){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,h=new Array(s);let c,u,f,d;for(c=0,u=s;c<u;++c)f=c+n,d=e[f],h[c]={x:r.parse(Za(d,a),f),y:o.parse(Za(d,l),f)};return h}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const s=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:GL(s,!0),values:e._stacks[t.axis]._visualValues};return Fb(a,o,r.index,{mode:n})}updateRangeFromParsed(t,e,n,s){const r=n[e.axis];let o=r===null?NaN:r;const a=s&&n._stacks[e.axis];s&&a&&(s.values=a,o=Fb(s,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const n=this._cachedMeta,s=n._parsed,r=n._sorted&&t===n.iScale,o=s.length,a=this._getOtherScale(t),l=$j(e,n,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=Vj(a);let f,d;function g(){d=s[f];const p=d[a.axis];return!Oi(d[t.axis])||c>p||u<p}for(f=0;f<o&&!(!g()&&(this.updateRangeFromParsed(h,t,d,l),r));++f);if(r){for(f=o-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(h,t,d,l);break}}return h}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let s,r,o;for(s=0,r=e.length;s<r;++s)o=e[s][t.axis],Oi(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,s=e.vScale,r=this.getParsed(t);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=Uj(Te(this.options.clip,Gj(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,s=n.data||[],r=e.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||s.length-a,h=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,r,a,l),c=a;c<a+l;++c){const u=s[c];u.hidden||(u.active&&h?o.push(u):u.draw(t,r))}for(c=0;c<o.length;++c)o[c].draw(t,r)}getStyle(t,e){const n=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const s=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=Xj(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=s.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=Yj(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=n,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const s=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],l=this.enableOptionSharing&&lf(n);if(a)return jb(a,l);const h=this.chart.config,c=h.datasetElementScopeKeys(this._type,t),u=s?[`${t}Hover`,"hover",t,""]:[t,""],f=h.getOptionScopes(this.getDataset(),c),d=Object.keys(Di.elements[t]),g=()=>this.getContext(n,s,e),p=h.resolveNamedOptions(f,d,g,u);return p.$shared&&(p.$shared=l,r[o]=Object.freeze(jb(p,l))),p}_resolveAnimations(t,e,n){const s=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let l;if(s.options.animation!==!1){const c=this.chart.config,u=c.datasetAnimationScopeKeys(this._type,e),f=c.getOptionScopes(this.getDataset(),u);l=c.createResolver(f,this.getContext(t,n,e))}const h=new zL(s,l&&l.animations);return l&&l._cacheable&&(r[o]=Object.freeze(h)),h}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||r_(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),s=this._sharedOptions,r=this.getSharedOptions(n),o=this.includeOptions(e,r)||r!==s;return this.updateSharedOptions(r,e,n),{sharedOptions:r,includeOptions:o}}updateElement(t,e,n,s){r_(s)?Object.assign(t,n):this._resolveAnimations(e,s).update(t,n)}updateSharedOptions(t,e,n){t&&!r_(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,s){t.active=s;const r=this.getStyle(e,s);this._resolveAnimations(e,n,s).update(t,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[a,l,h]of this._syncList)this[a](l,h);this._syncList=[];const s=n.length,r=e.length,o=Math.min(r,s);o&&this.parse(0,o),r>s?this._insertElements(s,r-s,t):r<s&&this._removeElements(r,s-r)}_insertElements(t,e,n=!0){const s=this._cachedMeta,r=s.data,o=t+e;let a;const l=h=>{for(h.length+=e,a=h.length-1;a>=o;a--)h[a]=h[a-e]};for(l(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(t,e),n&&this.updateElements(r,t,e,"reset")}updateElements(t,e,n,s){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const s=n._parsed.splice(t,e);n._stacked&&Vu(n,s)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,s]=t;this[e](n,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Vt(Tr,"defaults",{}),Vt(Tr,"datasetElementType",null),Vt(Tr,"dataElementType",null);function Kj(i,t){if(!i._cache.$bar){const e=i.getMatchingVisibleMetas(t);let n=[];for(let s=0,r=e.length;s<r;s++)n=n.concat(e[s].controller.getAllParsedValues(i));i._cache.$bar=bL(n.sort((s,r)=>s-r))}return i._cache.$bar}function Zj(i){const t=i.iScale,e=Kj(t,i.type);let n=t._length,s,r,o,a;const l=()=>{o===32767||o===-32768||(lf(a)&&(n=Math.min(n,Math.abs(o-a)||n)),a=o)};for(s=0,r=e.length;s<r;++s)o=t.getPixelForValue(e[s]),l();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),l();return n}function Jj(i,t,e,n){const s=e.barThickness;let r,o;return $e(s)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=s*n,o=1),{chunk:r/n,ratio:o,start:t.pixels[i]-r/2}}function Qj(i,t,e,n){const s=t.pixels,r=s[i];let o=i>0?s[i-1]:null,a=i<s.length-1?s[i+1]:null;const l=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const h=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/n,ratio:e.barPercentage,start:h}}function tz(i,t,e,n){const s=e.parse(i[0],n),r=e.parse(i[1],n),o=Math.min(s,r),a=Math.max(s,r);let l=o,h=a;Math.abs(o)>Math.abs(a)&&(l=a,h=o),t[e.axis]=h,t._custom={barStart:l,barEnd:h,start:s,end:r,min:o,max:a}}function UL(i,t,e,n){return Mi(i)?tz(i,t,e,n):t[e.axis]=e.parse(i,n),t}function zb(i,t,e,n){const s=i.iScale,r=i.vScale,o=s.getLabels(),a=s===r,l=[];let h,c,u,f;for(h=e,c=e+n;h<c;++h)f=t[h],u={},u[s.axis]=a||s.parse(o[h],h),l.push(UL(f,u,r,h));return l}function o_(i){return i&&i.barStart!==void 0&&i.barEnd!==void 0}function ez(i,t,e){return i!==0?oo(i):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function iz(i){let t,e,n,s,r;return i.horizontal?(t=i.base>i.x,e="left",n="right"):(t=i.base<i.y,e="bottom",n="top"),t?(s="end",r="start"):(s="start",r="end"),{start:e,end:n,reverse:t,top:s,bottom:r}}function nz(i,t,e,n){let s=t.borderSkipped;const r={};if(!s){i.borderSkipped=r;return}if(s===!0){i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:h,bottom:c}=iz(i);s==="middle"&&e&&(i.enableBorderRadius=!0,(e._top||0)===n?s=h:(e._bottom||0)===n?s=c:(r[Gb(c,o,a,l)]=!0,s=h)),r[Gb(s,o,a,l)]=!0,i.borderSkipped=r}function Gb(i,t,e,n){return n?(i=sz(i,t,e),i=Ub(i,e,t)):i=Ub(i,t,e),i}function sz(i,t,e){return i===t?e:i===e?t:i}function Ub(i,t,e){return i==="start"?t:i==="end"?e:i}function rz(i,{inflateAmount:t},e){i.inflateAmount=t==="auto"?e===1?.33:0:t}class Pp extends Tr{parsePrimitiveData(t,e,n,s){return zb(t,e,n,s)}parseArrayData(t,e,n,s){return zb(t,e,n,s)}parseObjectData(t,e,n,s){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,h=r.axis==="x"?a:l,c=o.axis==="x"?a:l,u=[];let f,d,g,p;for(f=n,d=n+s;f<d;++f)p=e[f],g={},g[r.axis]=r.parse(Za(p,h),f),u.push(UL(Za(p,c),g,o,f));return u}updateRangeFromParsed(t,e,n,s){super.updateRangeFromParsed(t,e,n,s);const r=n._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:s}=e,r=this.getParsed(t),o=r._custom,a=o_(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(r[s.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,s){const r=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),h=a.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:f}=this._getSharedOptions(e,s);for(let d=e;d<e+n;d++){const g=this.getParsed(d),p=r||$e(g[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(d),y=this._calculateBarIndexPixels(d,c),_=(g._stacks||{})[a.axis],x={horizontal:h,base:p.base,enableBorderRadius:!_||o_(g._custom)||o===_._top||o===_._bottom,x:h?p.head:y.center,y:h?y.center:p.head,height:h?y.size:Math.abs(p.size),width:h?Math.abs(p.size):y.size};f&&(x.options=u||this.resolveDataElementOptions(d,t[d].active?"active":s));const b=x.options||t[d].options;nz(x,b,_,o),rz(x,b,c.ratio),this.updateElement(t[d],d,x,s)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,s=n.getMatchingVisibleMetas(this._type).filter(c=>c.controller.options.grouped),r=n.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),l=a&&a[n.axis],h=c=>{const u=c._parsed.find(d=>d[n.axis]===l),f=u&&u[c.vScale.axis];if($e(f)||isNaN(f))return!0};for(const c of s)if(!(e!==void 0&&h(c))&&((r===!1||o.indexOf(c.stack)===-1||r===void 0&&c.stack===void 0)&&o.push(c.stack),c.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const s=this._getStacks(t,n),r=e!==void 0?s.indexOf(e):-1;return r===-1?s.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,s=[];let r,o;for(r=0,o=e.data.length;r<o;++r)s.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const a=t.barThickness;return{min:a||Zj(e),pixels:s,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:s},options:{base:r,minBarLength:o}}=this,a=r||0,l=this.getParsed(t),h=l._custom,c=o_(h);let u=l[e.axis],f=0,d=n?this.applyStack(e,l,n):u,g,p;d!==u&&(f=d-u,d=u),c&&(u=h.barStart,d=h.barEnd-h.barStart,u!==0&&oo(u)!==oo(h.barEnd)&&(f=0),f+=u);const y=!$e(r)&&!c?r:f;let _=e.getPixelForValue(y);if(this.chart.getDataVisibility(t)?g=e.getPixelForValue(f+d):g=_,p=g-_,Math.abs(p)<o){p=ez(p,e,a)*o,u===a&&(_-=p/2);const x=e.getPixelForDecimal(0),b=e.getPixelForDecimal(1),L=Math.min(x,b),M=Math.max(x,b);_=Math.max(Math.min(_,M),L),g=_+p,n&&!c&&(l._stacks[e.axis]._visualValues[s]=e.getValueForPixel(g)-e.getValueForPixel(_))}if(_===e.getPixelForValue(a)){const x=oo(p)*e.getLineWidthForValue(a)/2;_+=x,p-=x}return{size:p,base:_,head:g,center:g+p/2}}_calculateBarIndexPixels(t,e){const n=e.scale,s=this.options,r=s.skipNull,o=Te(s.maxBarThickness,1/0);let a,l;if(e.grouped){const h=r?this._getStackCount(t):e.stackCount,c=s.barThickness==="flex"?Qj(t,e,s,h):Jj(t,e,s,h),u=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);a=c.start+c.chunk*u+c.chunk/2,l=Math.min(o,c.chunk*c.ratio)}else a=n.getPixelForValue(this.getParsed(t)[n.axis],t),l=Math.min(o,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,s=n.length;let r=0;for(;r<s;++r)this.getParsed(r)[e.axis]!==null&&!n[r].hidden&&n[r].draw(this._ctx)}}Vt(Pp,"id","bar"),Vt(Pp,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Vt(Pp,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Ip extends Tr{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,s){const r=super.parsePrimitiveData(t,e,n,s);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+n).radius;return r}parseArrayData(t,e,n,s){const r=super.parseArrayData(t,e,n,s);for(let o=0;o<r.length;o++){const a=e[n+o];r[o]._custom=Te(a[2],this.resolveDataElementOptions(o+n).radius)}return r}parseObjectData(t,e,n,s){const r=super.parseObjectData(t,e,n,s);for(let o=0;o<r.length;o++){const a=e[n+o];r[o]._custom=Te(a&&a.r&&+a.r,this.resolveDataElementOptions(o+n).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),l=r.getLabelForValue(o.y),h=o._custom;return{label:n[t]||"",value:"("+a+", "+l+(h?", "+h:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,s){const r=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:h}=this._getSharedOptions(e,s),c=o.axis,u=a.axis;for(let f=e;f<e+n;f++){const d=t[f],g=!r&&this.getParsed(f),p={},y=p[c]=r?o.getPixelForDecimal(.5):o.getPixelForValue(g[c]),_=p[u]=r?a.getBasePixel():a.getPixelForValue(g[u]);p.skip=isNaN(y)||isNaN(_),h&&(p.options=l||this.resolveDataElementOptions(f,d.active?"active":s),r&&(p.options.radius=0)),this.updateElement(d,f,p,s)}}resolveDataElementOptions(t,e){const n=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const r=s.radius;return e!=="active"&&(s.radius=0),s.radius+=Te(n&&n._custom,r),s}}Vt(Ip,"id","bubble"),Vt(Ip,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Vt(Ip,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function oz(i,t,e){let n=1,s=1,r=0,o=0;if(t<Ci){const a=i,l=a+t,h=Math.cos(a),c=Math.sin(a),u=Math.cos(l),f=Math.sin(l),d=(b,L,M)=>hf(b,a,l,!0)?1:Math.max(L,L*e,M,M*e),g=(b,L,M)=>hf(b,a,l,!0)?-1:Math.min(L,L*e,M,M*e),p=d(0,h,u),y=d(Ji,c,f),_=g(Li,h,u),x=g(Li+Ji,c,f);n=(p-_)/2,s=(y-x)/2,r=-(p+_)/2,o=-(y+x)/2}return{ratioX:n,ratioY:s,offsetX:r,offsetY:o}}class Rl extends Tr{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=n;else{let r=l=>+n[l];if(Be(n[t])){const{key:l="value"}=this._parsing;r=h=>+Za(n[h],l)}let o,a;for(o=t,a=t+e;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return Cr(this.options.rotation-90)}_getCircumference(){return Cr(this.options.circumference)}_getRotationExtents(){let t=Ci,e=-Ci;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const s=this.chart.getDatasetMeta(n).controller,r=s._getRotation(),o=s._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,s=this._cachedMeta,r=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-o)/2,0),l=Math.min(x9(this.options.cutout,a),1),h=this._getRingWeight(this.index),{circumference:c,rotation:u}=this._getRotationExtents(),{ratioX:f,ratioY:d,offsetX:g,offsetY:p}=oz(u,c,l),y=(n.width-o)/f,_=(n.height-o)/d,x=Math.max(Math.min(y,_)/2,0),b=mL(this.options.radius,x),L=Math.max(b*l,0),M=(b-L)/this._getVisibleDatasetWeightTotal();this.offsetX=g*b,this.offsetY=p*b,s.total=this.calculateTotal(),this.outerRadius=b-M*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-M*h,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const n=this.options,s=this._cachedMeta,r=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*r/Ci)}updateElements(t,e,n,s){const r=s==="reset",o=this.chart,a=o.chartArea,h=o.options.animation,c=(a.left+a.right)/2,u=(a.top+a.bottom)/2,f=r&&h.animateScale,d=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:p,includeOptions:y}=this._getSharedOptions(e,s);let _=this._getRotation(),x;for(x=0;x<e;++x)_+=this._circumference(x,r);for(x=e;x<e+n;++x){const b=this._circumference(x,r),L=t[x],M={x:c+this.offsetX,y:u+this.offsetY,startAngle:_,endAngle:_+b,circumference:b,outerRadius:g,innerRadius:d};y&&(M.options=p||this.resolveDataElementOptions(x,L.active?"active":s)),_+=b,this.updateElement(L,x,M,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n=0,s;for(s=0;s<e.length;s++){const r=t._parsed[s];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(s)&&!e[s].hidden&&(n+=Math.abs(r))}return n}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Ci*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,s=n.data.labels||[],r=Ff(e._parsed[t],n.options.locale);return{label:s[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const n=this.chart;let s,r,o,a,l;if(!t){for(s=0,r=n.data.datasets.length;s<r;++s)if(n.isDatasetVisible(s)){o=n.getDatasetMeta(s),t=o.data,a=o.controller;break}}if(!t)return 0;for(s=0,r=t.length;s<r;++s)l=a.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,s=t.length;n<s;++n){const r=this.resolveDataElementOptions(n);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(Te(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Vt(Rl,"id","doughnut"),Vt(Rl,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Vt(Rl,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Vt(Rl,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}});class Rp extends Tr{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:s=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:l}=EL(e,s,o);this._drawStart=a,this._drawCount=l,CL(e)&&(a=0,l=s.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=s;const h=this.resolveDatasetElementOptions(t);this.options.showLine||(h.borderWidth=0),h.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:h},t),this.updateElements(s,a,l,t)}updateElements(t,e,n,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:h}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(e,s),f=o.axis,d=a.axis,{spanGaps:g,segment:p}=this.options,y=Hc(g)?g:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||r||s==="none",x=e+n,b=t.length;let L=e>0&&this.getParsed(e-1);for(let M=0;M<b;++M){const k=t[M],A=_?k:{};if(M<e||M>=x){A.skip=!0;continue}const T=this.getParsed(M),F=$e(T[d]),q=A[f]=o.getPixelForValue(T[f],M),R=A[d]=r||F?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,T,l):T[d],M);A.skip=isNaN(q)||isNaN(R)||F,A.stop=M>0&&Math.abs(T[f]-L[f])>y,p&&(A.parsed=T,A.raw=h.data[M]),u&&(A.options=c||this.resolveDataElementOptions(M,k.active?"active":s)),_||this.updateElement(k,M,A,s),L=T}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return n;const r=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(n,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Vt(Rp,"id","line"),Vt(Rp,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Vt(Rp,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Fd extends Tr{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,s=n.data.labels||[],r=Ff(e._parsed[t].r,n.options.locale);return{label:s[t]||"",value:r}}parseObjectData(t,e,n,s){return NL.bind(this)(t,e,n,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((n,s)=>{const r=this.getParsed(s).r;!isNaN(r)&&this.chart.getDataVisibility(s)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(s/2,0),o=Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,n,s){const r=s==="reset",o=this.chart,l=o.options.animation,h=this._cachedMeta.rScale,c=h.xCenter,u=h.yCenter,f=h.getIndexAngle(0)-.5*Li;let d=f,g;const p=360/this.countVisibleElements();for(g=0;g<e;++g)d+=this._computeAngle(g,s,p);for(g=e;g<e+n;g++){const y=t[g];let _=d,x=d+this._computeAngle(g,s,p),b=o.getDataVisibility(g)?h.getDistanceFromCenterForValue(this.getParsed(g).r):0;d=x,r&&(l.animateScale&&(b=0),l.animateRotate&&(_=x=f));const L={x:c,y:u,innerRadius:0,outerRadius:b,startAngle:_,endAngle:x,options:this.resolveDataElementOptions(g,y.active?"active":s)};this.updateElement(y,g,L,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((n,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&e++}),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?Cr(this.resolveDataElementOptions(t,e).angle||n):0}}Vt(Fd,"id","polarArea"),Vt(Fd,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Vt(Fd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const l=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class uy extends Rl{}Vt(uy,"id","pie"),Vt(uy,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Np extends Tr{getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}parseObjectData(t,e,n,s){return NL.bind(this)(t,e,n,s)}update(t){const e=this._cachedMeta,n=e.dataset,s=e.data||[],r=e.iScale.getLabels();if(n.points=s,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===s.length,options:o};this.updateElement(n,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,n,s){const r=this._cachedMeta.rScale,o=s==="reset";for(let a=e;a<e+n;a++){const l=t[a],h=this.resolveDataElementOptions(a,l.active?"active":s),c=r.getPointPositionForValue(a,this.getParsed(a).r),u=o?r.xCenter:c.x,f=o?r.yCenter:c.y,d={x:u,y:f,angle:c.angle,skip:isNaN(u)||isNaN(f),options:h};this.updateElement(l,a,d,s)}}}Vt(Np,"id","radar"),Vt(Np,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Vt(Np,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class kp extends Tr{getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),l=r.getLabelForValue(o.y);return{label:n[t]||"",value:"("+a+", "+l+")"}}update(t){const e=this._cachedMeta,{data:n=[]}=e,s=this.chart._animationsDisabled;let{start:r,count:o}=EL(e,n,s);if(this._drawStart=r,this._drawCount=o,CL(e)&&(r=0,o=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=n;const h=this.resolveDatasetElementOptions(t);h.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:h},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(n,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,n,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:h}=this._cachedMeta,c=this.resolveDataElementOptions(e,s),u=this.getSharedOptions(c),f=this.includeOptions(s,u),d=o.axis,g=a.axis,{spanGaps:p,segment:y}=this.options,_=Hc(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||r||s==="none";let b=e>0&&this.getParsed(e-1);for(let L=e;L<e+n;++L){const M=t[L],k=this.getParsed(L),A=x?M:{},T=$e(k[g]),F=A[d]=o.getPixelForValue(k[d],L),q=A[g]=r||T?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,k,l):k[g],L);A.skip=isNaN(F)||isNaN(q)||T,A.stop=L>0&&Math.abs(k[d]-b[d])>_,y&&(A.parsed=k,A.raw=h.data[L]),f&&(A.options=u||this.resolveDataElementOptions(L,M.active?"active":s)),x||this.updateElement(M,L,A,s),b=k}this.updateSharedOptions(u,s,c)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let l=e.length-1;l>=0;--l)a=Math.max(a,e[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const n=t.dataset,s=n.options&&n.options.borderWidth||0;if(!e.length)return s;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,r,o)/2}}Vt(kp,"id","scatter"),Vt(kp,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Vt(kp,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var az=Object.freeze({__proto__:null,BarController:Pp,BubbleController:Ip,DoughnutController:Rl,LineController:Rp,PieController:uy,PolarAreaController:Fd,RadarController:Np,ScatterController:kp});function vl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class vv{constructor(t){Vt(this,"options");this.options=t||{}}static override(t){Object.assign(vv.prototype,t)}init(){}formats(){return vl()}parse(){return vl()}format(){return vl()}add(){return vl()}diff(){return vl()}startOf(){return vl()}endOf(){return vl()}}var lz={_date:vv};function hz(i,t,e,n){const{controller:s,data:r,_sorted:o}=i,a=s._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const l=a._reversePixels?R9:Go;if(n){if(s._sharedOptions){const h=r[0],c=typeof h.getRange=="function"&&h.getRange(t);if(c){const u=l(r,t,e-c),f=l(r,t,e+c);return{lo:u.lo,hi:f.hi}}}}else return l(r,t,e)}return{lo:0,hi:r.length-1}}function Of(i,t,e,n,s){const r=i.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,l=r.length;a<l;++a){const{index:h,data:c}=r[a],{lo:u,hi:f}=hz(r[a],t,o,s);for(let d=u;d<=f;++d){const g=c[d];g.skip||n(g,h,d)}}}function cz(i){const t=i.indexOf("x")!==-1,e=i.indexOf("y")!==-1;return function(n,s){const r=t?Math.abs(n.x-s.x):0,o=e?Math.abs(n.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function a_(i,t,e,n,s){const r=[];return!s&&!i.isPointInArea(t)||Of(i,e,t,function(a,l,h){!s&&!Uo(a,i.chartArea,0)||a.inRange(t.x,t.y,n)&&r.push({element:a,datasetIndex:l,index:h})},!0),r}function uz(i,t,e,n){let s=[];function r(o,a,l){const{startAngle:h,endAngle:c}=o.getProps(["startAngle","endAngle"],n),{angle:u}=vL(o,{x:t.x,y:t.y});hf(u,h,c)&&s.push({element:o,datasetIndex:a,index:l})}return Of(i,e,t,r),s}function dz(i,t,e,n,s,r){let o=[];const a=cz(e);let l=Number.POSITIVE_INFINITY;function h(c,u,f){const d=c.inRange(t.x,t.y,s);if(n&&!d)return;const g=c.getCenterPoint(s);if(!(!!r||i.isPointInArea(g))&&!d)return;const y=a(t,g);y<l?(o=[{element:c,datasetIndex:u,index:f}],l=y):y===l&&o.push({element:c,datasetIndex:u,index:f})}return Of(i,e,t,h),o}function l_(i,t,e,n,s,r){return!r&&!i.isPointInArea(t)?[]:e==="r"&&!n?uz(i,t,e,s):dz(i,t,e,n,s,r)}function Wb(i,t,e,n,s){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return Of(i,e,t,(l,h,c)=>{l[o]&&l[o](t[e],s)&&(r.push({element:l,datasetIndex:h,index:c}),a=a||l.inRange(t.x,t.y,s))}),n&&!a?[]:r}var fz={evaluateInteractionItems:Of,modes:{index(i,t,e,n){const s=El(t,i),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?a_(i,s,r,n,o):l_(i,s,r,!1,n,o),l=[];return a.length?(i.getSortedVisibleDatasetMetas().forEach(h=>{const c=a[0].index,u=h.data[c];u&&!u.skip&&l.push({element:u,datasetIndex:h.index,index:c})}),l):[]},dataset(i,t,e,n){const s=El(t,i),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?a_(i,s,r,n,o):l_(i,s,r,!1,n,o);if(a.length>0){const l=a[0].datasetIndex,h=i.getDatasetMeta(l).data;a=[];for(let c=0;c<h.length;++c)a.push({element:h[c],datasetIndex:l,index:c})}return a},point(i,t,e,n){const s=El(t,i),r=e.axis||"xy",o=e.includeInvisible||!1;return a_(i,s,r,n,o)},nearest(i,t,e,n){const s=El(t,i),r=e.axis||"xy",o=e.includeInvisible||!1;return l_(i,s,r,e.intersect,n,o)},x(i,t,e,n){const s=El(t,i);return Wb(i,s,"x",e.intersect,n)},y(i,t,e,n){const s=El(t,i);return Wb(i,s,"y",e.intersect,n)}}};const WL=["left","top","right","bottom"];function Hu(i,t){return i.filter(e=>e.pos===t)}function qb(i,t){return i.filter(e=>WL.indexOf(e.pos)===-1&&e.box.axis===t)}function Yu(i,t){return i.sort((e,n)=>{const s=t?n:e,r=t?e:n;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function gz(i){const t=[];let e,n,s,r,o,a;for(e=0,n=(i||[]).length;e<n;++e)s=i[e],{position:r,options:{stack:o,stackWeight:a=1}}=s,t.push({index:e,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}function pz(i){const t={};for(const e of i){const{stack:n,pos:s,stackWeight:r}=e;if(!n||!WL.includes(s))continue;const o=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function mz(i,t){const e=pz(i),{vBoxMaxWidth:n,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=i.length;r<o;++r){a=i[r];const{fullSize:l}=a.box,h=e[a.stack],c=h&&a.stackWeight/h.weight;a.horizontal?(a.width=c?c*n:l&&t.availableWidth,a.height=s):(a.width=n,a.height=c?c*s:l&&t.availableHeight)}return e}function _z(i){const t=gz(i),e=Yu(t.filter(h=>h.box.fullSize),!0),n=Yu(Hu(t,"left"),!0),s=Yu(Hu(t,"right")),r=Yu(Hu(t,"top"),!0),o=Yu(Hu(t,"bottom")),a=qb(t,"x"),l=qb(t,"y");return{fullSize:e,leftAndTop:n.concat(r),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:Hu(t,"chartArea"),vertical:n.concat(s).concat(l),horizontal:r.concat(o).concat(a)}}function Vb(i,t,e,n){return Math.max(i[e],t[e])+Math.max(i[n],t[n])}function qL(i,t){i.top=Math.max(i.top,t.top),i.left=Math.max(i.left,t.left),i.bottom=Math.max(i.bottom,t.bottom),i.right=Math.max(i.right,t.right)}function yz(i,t,e,n){const{pos:s,box:r}=e,o=i.maxPadding;if(!Be(s)){e.size&&(i[s]-=e.size);const u=n[e.stack]||{size:0,count:1};u.size=Math.max(u.size,e.horizontal?r.height:r.width),e.size=u.size/u.count,i[s]+=e.size}r.getPadding&&qL(o,r.getPadding());const a=Math.max(0,t.outerWidth-Vb(o,i,"left","right")),l=Math.max(0,t.outerHeight-Vb(o,i,"top","bottom")),h=a!==i.w,c=l!==i.h;return i.w=a,i.h=l,e.horizontal?{same:h,other:c}:{same:c,other:h}}function vz(i){const t=i.maxPadding;function e(n){const s=Math.max(t[n]-i[n],0);return i[n]+=s,s}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}function xz(i,t){const e=t.maxPadding;function n(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return n(i?["left","right"]:["top","bottom"])}function cd(i,t,e,n){const s=[];let r,o,a,l,h,c;for(r=0,o=i.length,h=0;r<o;++r){a=i[r],l=a.box,l.update(a.width||t.w,a.height||t.h,xz(a.horizontal,t));const{same:u,other:f}=yz(t,e,a,n);h|=u&&s.length,c=c||f,l.fullSize||s.push(a)}return h&&cd(s,t,e,n)||c}function lp(i,t,e,n,s){i.top=e,i.left=t,i.right=t+n,i.bottom=e+s,i.width=n,i.height=s}function Hb(i,t,e,n){const s=e.padding;let{x:r,y:o}=t;for(const a of i){const l=a.box,h=n[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/h.weight||1;if(a.horizontal){const u=t.w*c,f=h.size||l.height;lf(h.start)&&(o=h.start),l.fullSize?lp(l,s.left,o,e.outerWidth-s.right-s.left,f):lp(l,t.left+h.placed,o,u,f),h.start=o,h.placed+=u,o=l.bottom}else{const u=t.h*c,f=h.size||l.width;lf(h.start)&&(r=h.start),l.fullSize?lp(l,r,s.top,f,e.outerHeight-s.bottom-s.top):lp(l,r,t.top+h.placed,f,u),h.start=r,h.placed+=u,r=l.right}}t.x=r,t.y=o}var Wn={addBox(i,t){i.boxes||(i.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},i.boxes.push(t)},removeBox(i,t){const e=i.boxes?i.boxes.indexOf(t):-1;e!==-1&&i.boxes.splice(e,1)},configure(i,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(i,t,e,n){if(!i)return;const s=Xn(i.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(e-s.height,0),a=_z(i.boxes),l=a.vertical,h=a.horizontal;li(i.boxes,p=>{typeof p.beforeLayout=="function"&&p.beforeLayout()});const c=l.reduce((p,y)=>y.box.options&&y.box.options.display===!1?p:p+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/c,hBoxMaxHeight:o/2}),f=Object.assign({},s);qL(f,Xn(n));const d=Object.assign({maxPadding:f,w:r,h:o,x:s.left,y:s.top},s),g=mz(l.concat(h),u);cd(a.fullSize,d,u,g),cd(l,d,u,g),cd(h,d,u,g)&&cd(l,d,u,g),vz(d),Hb(a.leftAndTop,d,u,g),d.x+=d.w,d.y+=d.h,Hb(a.rightAndBottom,d,u,g),i.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},li(a.chartArea,p=>{const y=p.box;Object.assign(y,i.chartArea),y.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})})}};class VL{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,s){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):n)}}isAttached(t){return!0}updateConfig(t){}}class bz extends VL{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Fp="$chartjs",wz={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Yb=i=>i===null||i==="";function Sz(i,t){const e=i.style,n=i.getAttribute("height"),s=i.getAttribute("width");if(i[Fp]={initial:{height:n,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Yb(s)){const r=Ab(i,"width");r!==void 0&&(i.width=r)}if(Yb(n))if(i.style.height==="")i.height=i.width/(t||2);else{const r=Ab(i,"height");r!==void 0&&(i.height=r)}return i}const HL=Cj?{passive:!0}:!1;function Ez(i,t,e){i&&i.addEventListener(t,e,HL)}function Cz(i,t,e){i&&i.canvas&&i.canvas.removeEventListener(t,e,HL)}function Lz(i,t){const e=wz[i.type]||i.type,{x:n,y:s}=El(i,t);return{type:e,chart:t,native:i,x:n!==void 0?n:null,y:s!==void 0?s:null}}function L0(i,t){for(const e of i)if(e===t||e.contains(t))return!0}function Mz(i,t,e){const n=i.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||L0(a.addedNodes,n),o=o&&!L0(a.removedNodes,n);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function Tz(i,t,e){const n=i.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||L0(a.removedNodes,n),o=o&&!L0(a.addedNodes,n);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const uf=new Map;let Xb=0;function YL(){const i=window.devicePixelRatio;i!==Xb&&(Xb=i,uf.forEach((t,e)=>{e.currentDevicePixelRatio!==i&&t()}))}function Az(i,t){uf.size||window.addEventListener("resize",YL),uf.set(i,t)}function Pz(i){uf.delete(i),uf.size||window.removeEventListener("resize",YL)}function Iz(i,t,e){const n=i.canvas,s=n&&yv(n);if(!s)return;const r=SL((a,l)=>{const h=s.clientWidth;e(a,l),h<s.clientWidth&&e()},window),o=new ResizeObserver(a=>{const l=a[0],h=l.contentRect.width,c=l.contentRect.height;h===0&&c===0||r(h,c)});return o.observe(s),Az(i,r),o}function h_(i,t,e){e&&e.disconnect(),t==="resize"&&Pz(i)}function Rz(i,t,e){const n=i.canvas,s=SL(r=>{i.ctx!==null&&e(Lz(r,i))},i);return Ez(n,t,s),s}class Nz extends VL{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(Sz(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[Fp])return!1;const n=e[Fp].initial;["height","width"].forEach(r=>{const o=n[r];$e(o)?e.removeAttribute(r):e.setAttribute(r,o)});const s=n.style||{};return Object.keys(s).forEach(r=>{e.style[r]=s[r]}),e.width=e.width,delete e[Fp],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),o={attach:Mz,detach:Tz,resize:Iz}[e]||Rz;s[e]=o(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),s=n[e];if(!s)return;({attach:h_,detach:h_,resize:h_}[e]||Cz)(t,e,s),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,s){return Ej(t,e,n,s)}isAttached(t){const e=t&&yv(t);return!!(e&&e.isConnected)}}function kz(i){return!_v()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?bz:Nz}var vp;let ta=(vp=class{constructor(){Vt(this,"x");Vt(this,"y");Vt(this,"active",!1);Vt(this,"options");Vt(this,"$animations")}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return Hc(this.x)&&Hc(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const s={};return t.forEach(r=>{s[r]=n[r]&&n[r].active()?n[r]._to:this[r]}),s}},Vt(vp,"defaults",{}),Vt(vp,"defaultRoutes"),vp);function Fz(i,t){const e=i.options.ticks,n=Oz(i),s=Math.min(e.maxTicksLimit||n,n),r=e.major.enabled?Bz(t):[],o=r.length,a=r[0],l=r[o-1],h=[];if(o>s)return jz(t,h,r,o/s),h;const c=Dz(r,t,s);if(o>0){let u,f;const d=o>1?Math.round((l-a)/(o-1)):null;for(hp(t,h,c,$e(d)?0:a-d,a),u=0,f=o-1;u<f;u++)hp(t,h,c,r[u],r[u+1]);return hp(t,h,c,l,$e(d)?t.length:l+d),h}return hp(t,h,c),h}function Oz(i){const t=i.options.offset,e=i._tickSize(),n=i._length/e+(t?0:1),s=i._maxLength/e;return Math.floor(Math.min(n,s))}function Dz(i,t,e){const n=zz(i),s=t.length/e;if(!n)return Math.max(s,1);const r=T9(n);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>s)return l}return Math.max(s,1)}function Bz(i){const t=[];let e,n;for(e=0,n=i.length;e<n;e++)i[e].major&&t.push(e);return t}function jz(i,t,e,n){let s=0,r=e[0],o;for(n=Math.ceil(n),o=0;o<i.length;o++)o===r&&(t.push(i[o]),s++,r=e[s*n])}function hp(i,t,e,n,s){const r=Te(n,0),o=Math.min(Te(s,i.length),i.length);let a=0,l,h,c;for(e=Math.ceil(e),s&&(l=s-n,e=l/Math.floor(l/e)),c=r;c<0;)a++,c=Math.round(r+a*e);for(h=Math.max(r,0);h<o;h++)h===c&&(t.push(i[h]),a++,c=Math.round(r+a*e))}function zz(i){const t=i.length;let e,n;if(t<2)return!1;for(n=i[0],e=1;e<t;++e)if(i[e]-i[e-1]!==n)return!1;return n}const Gz=i=>i==="left"?"right":i==="right"?"left":i,$b=(i,t,e)=>t==="top"||t==="left"?i[t]+e:i[t]-e,Kb=(i,t)=>Math.min(t||i,i);function Zb(i,t){const e=[],n=i.length/t,s=i.length;let r=0;for(;r<s;r+=n)e.push(i[Math.floor(r)]);return e}function Uz(i,t,e){const n=i.ticks.length,s=Math.min(t,n-1),r=i._startPixel,o=i._endPixel,a=1e-6;let l=i.getPixelForTick(s),h;if(!(e&&(n===1?h=Math.max(l-r,o-l):t===0?h=(i.getPixelForTick(1)-l)/2:h=(l-i.getPixelForTick(s-1))/2,l+=s<t?h:-h,l<r-a||l>o+a)))return l}function Wz(i,t){li(i,e=>{const n=e.gc,s=n.length/2;let r;if(s>t){for(r=0;r<s;++r)delete e.data[n[r]];n.splice(0,s)}})}function Xu(i){return i.drawTicks?i.tickLength:0}function Jb(i,t){if(!i.display)return 0;const e=fn(i.font,t),n=Xn(i.padding);return(Mi(i.text)?i.text.length:1)*e.lineHeight+n.height}function qz(i,t){return nl(i,{scale:t,type:"scale"})}function Vz(i,t,e){return nl(i,{tick:e,index:t,type:"tick"})}function Hz(i,t,e){let n=uv(i);return(e&&t!=="right"||!e&&t==="right")&&(n=Gz(n)),n}function Yz(i,t,e,n){const{top:s,left:r,bottom:o,right:a,chart:l}=i,{chartArea:h,scales:c}=l;let u=0,f,d,g;const p=o-s,y=a-r;if(i.isHorizontal()){if(d=zn(n,r,a),Be(e)){const _=Object.keys(e)[0],x=e[_];g=c[_].getPixelForValue(x)+p-t}else e==="center"?g=(h.bottom+h.top)/2+p-t:g=$b(i,e,t);f=a-r}else{if(Be(e)){const _=Object.keys(e)[0],x=e[_];d=c[_].getPixelForValue(x)-y+t}else e==="center"?d=(h.left+h.right)/2-y+t:d=$b(i,e,t);g=zn(n,o,s),u=e==="left"?-Ji:Ji}return{titleX:d,titleY:g,maxWidth:f,rotation:u}}class hh extends ta{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:s}=this;return t=Fs(t,Number.POSITIVE_INFINITY),e=Fs(e,Number.NEGATIVE_INFINITY),n=Fs(n,Number.POSITIVE_INFINITY),s=Fs(s,Number.NEGATIVE_INFINITY),{min:Fs(t,n),max:Fs(e,s),minDefined:Oi(t),maxDefined:Oi(e)}}getMinMax(t){let{min:e,max:n,minDefined:s,maxDefined:r}=this.getUserBounds(),o;if(s&&r)return{min:e,max:n};const a=this.getMatchingVisibleMetas();for(let l=0,h=a.length;l<h;++l)o=a[l].controller.getMinMax(this,t),s||(e=Math.min(e,o.min)),r||(n=Math.max(n,o.max));return e=r&&e>n?n:e,n=s&&e>n?e:n,{min:Fs(e,Fs(n,e)),max:Fs(n,Fs(e,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){yi(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=ij(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?Zb(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Fz(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,n;this.isHorizontal()?(e=this.left,n=this.right):(e=this.top,n=this.bottom,t=!t),this._startPixel=e,this._endPixel=n,this._reversePixels=t,this._length=n-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){yi(this.options.afterUpdate,[this])}beforeSetDimensions(){yi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){yi(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),yi(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){yi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,s,r;for(n=0,s=t.length;n<s;n++)r=t[n],r.label=yi(e.callback,[r.value,n,t],this)}afterTickToLabelConversion(){yi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){yi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=Kb(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,r=e.maxRotation;let o=s,a,l,h;if(!this._isVisible()||!e.display||s>=r||n<=1||!this.isHorizontal()){this.labelRotation=s;return}const c=this._getLabelSizes(),u=c.widest.width,f=c.highest.height,d=En(this.chart.width-u,0,this.maxWidth);a=t.offset?this.maxWidth/n:d/(n-1),u+6>a&&(a=d/(n-(t.offset?.5:1)),l=this.maxHeight-Xu(t.grid)-e.padding-Jb(t.title,this.chart.options.font),h=Math.sqrt(u*u+f*f),o=hv(Math.min(Math.asin(En((c.highest.height+6)/a,-1,1)),Math.asin(En(l/h,-1,1))-Math.asin(En(f/h,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){yi(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){yi(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=Jb(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=Xu(r)+l):(t.height=this.maxHeight,t.width=Xu(r)+l),n.display&&this.ticks.length){const{first:h,last:c,widest:u,highest:f}=this._getLabelSizes(),d=n.padding*2,g=Cr(this.labelRotation),p=Math.cos(g),y=Math.sin(g);if(a){const _=n.mirror?0:y*u.width+p*f.height;t.height=Math.min(this.maxHeight,t.height+_+d)}else{const _=n.mirror?0:p*u.width+y*f.height;t.width=Math.min(this.maxWidth,t.width+_+d)}this._calculatePadding(h,c,y,p)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,s){const{ticks:{align:r,padding:o},position:a}=this.options,l=this.labelRotation!==0,h=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const c=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,d=0;l?h?(f=s*t.width,d=n*e.height):(f=n*t.height,d=s*e.width):r==="start"?d=e.width:r==="end"?f=t.width:r!=="inner"&&(f=t.width/2,d=e.width/2),this.paddingLeft=Math.max((f-c+o)*this.width/(this.width-c),0),this.paddingRight=Math.max((d-u+o)*this.width/(this.width-u),0)}else{let c=e.height/2,u=t.height/2;r==="start"?(c=0,u=t.height):r==="end"&&(c=e.height,u=0),this.paddingTop=c+o,this.paddingBottom=u+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){yi(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,n;for(e=0,n=t.length;e<n;e++)$e(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=Zb(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:s,_longestTextCache:r}=this,o=[],a=[],l=Math.floor(e/Kb(e,n));let h=0,c=0,u,f,d,g,p,y,_,x,b,L,M;for(u=0;u<e;u+=l){if(g=t[u].label,p=this._resolveTickFontOptions(u),s.font=y=p.string,_=r[y]=r[y]||{data:{},gc:[]},x=p.lineHeight,b=L=0,!$e(g)&&!Mi(g))b=E0(s,_.data,_.gc,b,g),L=x;else if(Mi(g))for(f=0,d=g.length;f<d;++f)M=g[f],!$e(M)&&!Mi(M)&&(b=E0(s,_.data,_.gc,b,M),L+=x);o.push(b),a.push(L),h=Math.max(b,h),c=Math.max(L,c)}Wz(r,e);const k=o.indexOf(h),A=a.indexOf(c),T=F=>({width:o[F]||0,height:a[F]||0});return{first:T(0),last:T(e-1),widest:T(k),highest:T(A),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return I9(this._alignToPixels?yl(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=Vz(this.getContext(),t,n))}return this.$context||(this.$context=qz(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=Cr(this.labelRotation),n=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*n>a*s?a/n:l/s:l*s<a*n?l/n:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,s=this.options,{grid:r,position:o,border:a}=s,l=r.offset,h=this.isHorizontal(),u=this.ticks.length+(l?1:0),f=Xu(r),d=[],g=a.setContext(this.getContext()),p=g.display?g.width:0,y=p/2,_=function(X){return yl(n,X,p)};let x,b,L,M,k,A,T,F,q,R,S,O;if(o==="top")x=_(this.bottom),A=this.bottom-f,F=x-y,R=_(t.top)+y,O=t.bottom;else if(o==="bottom")x=_(this.top),R=t.top,O=_(t.bottom)-y,A=x+y,F=this.top+f;else if(o==="left")x=_(this.right),k=this.right-f,T=x-y,q=_(t.left)+y,S=t.right;else if(o==="right")x=_(this.left),q=t.left,S=_(t.right)-y,k=x+y,T=this.left+f;else if(e==="x"){if(o==="center")x=_((t.top+t.bottom)/2+.5);else if(Be(o)){const X=Object.keys(o)[0],Z=o[X];x=_(this.chart.scales[X].getPixelForValue(Z))}R=t.top,O=t.bottom,A=x+y,F=A+f}else if(e==="y"){if(o==="center")x=_((t.left+t.right)/2);else if(Be(o)){const X=Object.keys(o)[0],Z=o[X];x=_(this.chart.scales[X].getPixelForValue(Z))}k=x-y,T=k-f,q=t.left,S=t.right}const E=Te(s.ticks.maxTicksLimit,u),U=Math.max(1,Math.ceil(u/E));for(b=0;b<u;b+=U){const X=this.getContext(b),Z=r.setContext(X),st=a.setContext(X),tt=Z.lineWidth,ot=Z.color,et=st.dash||[],P=st.dashOffset,H=Z.tickWidth,j=Z.tickColor,K=Z.tickBorderDash||[],ht=Z.tickBorderDashOffset;L=Uz(this,b,l),L!==void 0&&(M=yl(n,L,tt),h?k=T=q=S=M:A=F=R=O=M,d.push({tx1:k,ty1:A,tx2:T,ty2:F,x1:q,y1:R,x2:S,y2:O,width:tt,color:ot,borderDash:et,borderDashOffset:P,tickWidth:H,tickColor:j,tickBorderDash:K,tickBorderDashOffset:ht}))}return this._ticksLength=u,this._borderValue=x,d}_computeLabelItems(t){const e=this.axis,n=this.options,{position:s,ticks:r}=n,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:h,padding:c,mirror:u}=r,f=Xu(n.grid),d=f+c,g=u?-c:d,p=-Cr(this.labelRotation),y=[];let _,x,b,L,M,k,A,T,F,q,R,S,O="middle";if(s==="top")k=this.bottom-g,A=this._getXAxisLabelAlignment();else if(s==="bottom")k=this.top+g,A=this._getXAxisLabelAlignment();else if(s==="left"){const U=this._getYAxisLabelAlignment(f);A=U.textAlign,M=U.x}else if(s==="right"){const U=this._getYAxisLabelAlignment(f);A=U.textAlign,M=U.x}else if(e==="x"){if(s==="center")k=(t.top+t.bottom)/2+d;else if(Be(s)){const U=Object.keys(s)[0],X=s[U];k=this.chart.scales[U].getPixelForValue(X)+d}A=this._getXAxisLabelAlignment()}else if(e==="y"){if(s==="center")M=(t.left+t.right)/2-d;else if(Be(s)){const U=Object.keys(s)[0],X=s[U];M=this.chart.scales[U].getPixelForValue(X)}A=this._getYAxisLabelAlignment(f).textAlign}e==="y"&&(l==="start"?O="top":l==="end"&&(O="bottom"));const E=this._getLabelSizes();for(_=0,x=a.length;_<x;++_){b=a[_],L=b.label;const U=r.setContext(this.getContext(_));T=this.getPixelForTick(_)+r.labelOffset,F=this._resolveTickFontOptions(_),q=F.lineHeight,R=Mi(L)?L.length:1;const X=R/2,Z=U.color,st=U.textStrokeColor,tt=U.textStrokeWidth;let ot=A;o?(M=T,A==="inner"&&(_===x-1?ot=this.options.reverse?"left":"right":_===0?ot=this.options.reverse?"right":"left":ot="center"),s==="top"?h==="near"||p!==0?S=-R*q+q/2:h==="center"?S=-E.highest.height/2-X*q+q:S=-E.highest.height+q/2:h==="near"||p!==0?S=q/2:h==="center"?S=E.highest.height/2-X*q:S=E.highest.height-R*q,u&&(S*=-1),p!==0&&!U.showLabelBackdrop&&(M+=q/2*Math.sin(p))):(k=T,S=(1-R)*q/2);let et;if(U.showLabelBackdrop){const P=Xn(U.backdropPadding),H=E.heights[_],j=E.widths[_];let K=S-P.top,ht=0-P.left;switch(O){case"middle":K-=H/2;break;case"bottom":K-=H;break}switch(A){case"center":ht-=j/2;break;case"right":ht-=j;break;case"inner":_===x-1?ht-=j:_>0&&(ht-=j/2);break}et={left:ht,top:K,width:j+P.width,height:H+P.height,color:U.backdropColor}}y.push({label:L,font:F,textOffset:S,options:{rotation:p,color:Z,strokeColor:st,strokeWidth:tt,textAlign:ot,textBaseline:O,translation:[M,k],backdrop:et}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Cr(this.labelRotation))return t==="top"?"left":"right";let s="center";return e.align==="start"?s="left":e.align==="end"?s="right":e.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:s,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,l=o.widest.width;let h,c;return e==="left"?s?(c=this.right+r,n==="near"?h="left":n==="center"?(h="center",c+=l/2):(h="right",c+=l)):(c=this.right-a,n==="near"?h="right":n==="center"?(h="center",c-=l/2):(h="left",c=this.left)):e==="right"?s?(c=this.left+r,n==="near"?h="right":n==="center"?(h="center",c-=l/2):(h="left",c-=l)):(c=this.left+a,n==="near"?h="left":n==="center"?(h="center",c+=l/2):(h="right",c=this.right)):h="right",{textAlign:h,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:s,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,s,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,n=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(l,h,c)=>{!c.width||!c.color||(n.save(),n.lineWidth=c.width,n.strokeStyle=c.color,n.setLineDash(c.borderDash||[]),n.lineDashOffset=c.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(h.x,h.y),n.stroke(),n.restore())};if(e.display)for(r=0,o=s.length;r<o;++r){const l=s[r];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:s}}=this,r=n.setContext(this.getContext()),o=n.display?r.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let h,c,u,f;this.isHorizontal()?(h=yl(t,this.left,o)-o/2,c=yl(t,this.right,a)+a/2,u=f=l):(u=yl(t,this.top,o)-o/2,f=yl(t,this.bottom,a)+a/2,h=c=l),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(h,u),e.lineTo(c,f),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,s=this._computeLabelArea();s&&um(n,s);const r=this.getLabelItems(t);for(const o of r){const a=o.options,l=o.font,h=o.label,c=o.textOffset;$l(n,h,0,c,l,a)}s&&dm(n)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:s}}=this;if(!n.display)return;const r=fn(n.font),o=Xn(n.padding),a=n.align;let l=r.lineHeight/2;e==="bottom"||e==="center"||Be(e)?(l+=o.bottom,Mi(n.text)&&(l+=r.lineHeight*(n.text.length-1))):l+=o.top;const{titleX:h,titleY:c,maxWidth:u,rotation:f}=Yz(this,l,e,a);$l(t,n.text,0,0,r,{color:n.color,maxWidth:u,rotation:f,textAlign:Hz(a,e,s),textBaseline:"middle",translation:[h,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=Te(t.grid&&t.grid.z,-1),s=Te(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==hh.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:n,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",s=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[n]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return fn(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class cp{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;Kz(e)&&(n=this.register(e));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,Xz(t,o,n),this.override&&Di.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,s=this.scope;n in e&&delete e[n],s&&n in Di[s]&&(delete Di[s][n],this.override&&delete Xl[n])}}function Xz(i,t,e){const n=af(Object.create(null),[e?Di.get(e):{},Di.get(t),i.defaults]);Di.set(t,n),i.defaultRoutes&&$z(t,i.defaultRoutes),i.descriptors&&Di.describe(t,i.descriptors)}function $z(i,t){Object.keys(t).forEach(e=>{const n=e.split("."),s=n.pop(),r=[i].concat(n).join("."),o=t[e].split("."),a=o.pop(),l=o.join(".");Di.route(r,s,l,a)})}function Kz(i){return"id"in i&&"defaults"in i}class Zz{constructor(){this.controllers=new cp(Tr,"datasets",!0),this.elements=new cp(ta,"elements"),this.plugins=new cp(Object,"plugins"),this.scales=new cp(hh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach(s=>{const r=n||this._getRegistryForType(s);n||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):li(s,o=>{const a=n||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,n){const s=lv(t);yi(n["before"+s],[],n),e[t](n),yi(n["after"+s],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const s=e.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return s}}var Yr=new Zz;class Jz{constructor(){this._init=[]}notify(t,e,n,s){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,e,n);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,n,s){s=s||{};for(const r of t){const o=r.plugin,a=o[n],l=[e,s,r.options];if(yi(a,l,o)===!1&&s.cancelable)return!1}return!0}invalidate(){$e(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,s=Te(n.options&&n.options.plugins,{}),r=Qz(n);return s===!1&&!e?[]:eG(t,r,s,e)}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,s=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(e,n),t,"stop"),this._notify(s(n,e),t,"start")}}function Qz(i){const t={},e=[],n=Object.keys(Yr.plugins.items);for(let r=0;r<n.length;r++)e.push(Yr.getPlugin(n[r]));const s=i.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function tG(i,t){return!t&&i===!1?null:i===!0?{}:i}function eG(i,{plugins:t,localIds:e},n,s){const r=[],o=i.getContext();for(const a of t){const l=a.id,h=tG(n[l],s);h!==null&&r.push({plugin:a,options:iG(i.config,{plugin:a,local:e[l]},h,o)})}return r}function iG(i,{plugin:t,local:e},n,s){const r=i.pluginScopeKeys(t),o=i.getOptionScopes(n,r);return e&&t.defaults&&o.push(t.defaults),i.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function dy(i,t){const e=Di.datasets[i]||{};return((t.datasets||{})[i]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function nG(i,t){let e=i;return i==="_index_"?e=t:i==="_value_"&&(e=t==="x"?"y":"x"),e}function sG(i,t){return i===t?"_index_":"_value_"}function Qb(i){if(i==="x"||i==="y"||i==="r")return i}function rG(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function fy(i,...t){if(Qb(i))return i;for(const e of t){const n=e.axis||rG(e.position)||i.length>1&&Qb(i[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function tw(i,t,e){if(e[t+"AxisID"]===i)return{axis:t}}function oG(i,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(n=>n.xAxisID===i||n.yAxisID===i);if(e.length)return tw(i,"x",e[0])||tw(i,"y",e[0])}return{}}function aG(i,t){const e=Xl[i.type]||{scales:{}},n=t.scales||{},s=dy(i.type,t),r=Object.create(null);return Object.keys(n).forEach(o=>{const a=n[o];if(!Be(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=fy(o,a,oG(o,i),Di.scales[a.type]),h=sG(l,s),c=e.scales||{};r[o]=Id(Object.create(null),[{axis:l},a,c[l],c[h]])}),i.data.datasets.forEach(o=>{const a=o.type||i.type,l=o.indexAxis||dy(a,t),c=(Xl[a]||{}).scales||{};Object.keys(c).forEach(u=>{const f=nG(u,l),d=o[f+"AxisID"]||f;r[d]=r[d]||Object.create(null),Id(r[d],[{axis:f},n[d],c[u]])})}),Object.keys(r).forEach(o=>{const a=r[o];Id(a,[Di.scales[a.type],Di.scale])}),r}function XL(i){const t=i.options||(i.options={});t.plugins=Te(t.plugins,{}),t.scales=aG(i,t)}function $L(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function lG(i){return i=i||{},i.data=$L(i.data),XL(i),i}const ew=new Map,KL=new Set;function up(i,t){let e=ew.get(i);return e||(e=t(),ew.set(i,e),KL.add(e)),e}const $u=(i,t,e)=>{const n=Za(t,e);n!==void 0&&i.add(n)};class hG{constructor(t){this._config=lG(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=$L(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),XL(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return up(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return up(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return up(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,n=this.type;return up(`${n}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const n=this._scopeCache;let s=n.get(t);return(!s||e)&&(s=new Map,n.set(t,s)),s}getOptionScopes(t,e,n){const{options:s,type:r}=this,o=this._cachedScopes(t,n),a=o.get(e);if(a)return a;const l=new Set;e.forEach(c=>{t&&(l.add(t),c.forEach(u=>$u(l,t,u))),c.forEach(u=>$u(l,s,u)),c.forEach(u=>$u(l,Xl[r]||{},u)),c.forEach(u=>$u(l,Di,u)),c.forEach(u=>$u(l,hy,u))});const h=Array.from(l);return h.length===0&&h.push(Object.create(null)),KL.has(e)&&o.set(e,h),h}chartOptionScopes(){const{options:t,type:e}=this;return[t,Xl[e]||{},Di.datasets[e]||{},{type:e},Di,hy]}resolveNamedOptions(t,e,n,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=iw(this._resolverCache,t,s);let l=o;if(uG(o,e)){r.$shared=!1,n=Ja(n)?n():n;const h=this.createResolver(t,n,a);l=Yc(o,n,h)}for(const h of e)r[h]=l[h];return r}createResolver(t,e,n=[""],s){const{resolver:r}=iw(this._resolverCache,t,n);return Be(e)?Yc(r,e,void 0,s):r}}function iw(i,t,e){let n=i.get(t);n||(n=new Map,i.set(t,n));const s=e.join();let r=n.get(s);return r||(r={resolver:gv(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},n.set(s,r)),r}const cG=i=>Be(i)&&Object.getOwnPropertyNames(i).some(t=>Ja(i[t]));function uG(i,t){const{isScriptable:e,isIndexable:n}=AL(i);for(const s of t){const r=e(s),o=n(s),a=(o||r)&&i[s];if(r&&(Ja(a)||cG(a))||o&&Mi(a))return!0}return!1}var dG="4.4.4";const fG=["top","bottom","left","right","chartArea"];function nw(i,t){return i==="top"||i==="bottom"||fG.indexOf(i)===-1&&t==="x"}function sw(i,t){return function(e,n){return e[i]===n[i]?e[t]-n[t]:e[i]-n[i]}}function rw(i){const t=i.chart,e=t.options.animation;t.notifyPlugins("afterRender"),yi(e&&e.onComplete,[i],t)}function gG(i){const t=i.chart,e=t.options.animation;yi(e&&e.onProgress,[i],t)}function ZL(i){return _v()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const Op={},ow=i=>{const t=ZL(i);return Object.values(Op).filter(e=>e.canvas===t).pop()};function pG(i,t,e){const n=Object.keys(i);for(const s of n){const r=+s;if(r>=t){const o=i[s];delete i[s],(e>0||r>t)&&(i[r+e]=o)}}}function mG(i,t,e,n){return!e||i.type==="mouseout"?null:n?t:i}function dp(i,t,e){return i.options.clip?i[e]:t[e]}function _G(i,t){const{xScale:e,yScale:n}=i;return e&&n?{left:dp(e,t,"left"),right:dp(e,t,"right"),top:dp(n,t,"top"),bottom:dp(n,t,"bottom")}:t}class Ca{static register(...t){Yr.add(...t),aw()}static unregister(...t){Yr.remove(...t),aw()}constructor(t,e){const n=this.config=new hG(e),s=ZL(t),r=ow(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||kz(s)),this.platform.updateConfig(n);const a=this.platform.acquireContext(s,o.aspectRatio),l=a&&a.canvas,h=l&&l.height,c=l&&l.width;if(this.id=v9(),this.ctx=a,this.canvas=l,this.width=c,this.height=h,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Jz,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=F9(u=>this.update(u),o.resizeDelay||0),this._dataChanges=[],Op[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Io.listen(this,"complete",rw),Io.listen(this,"progress",gG),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:s,_aspectRatio:r}=this;return $e(t)?e&&r?r:s?n/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Yr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Tb(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Cb(this.canvas,this.ctx),this}stop(){return Io.stop(this),this}resize(t,e){Io.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,s=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,e,r),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Tb(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),yi(n.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};li(e,(n,s)=>{n.id=s})}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,s=Object.keys(n).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],l=fy(o,a),h=l==="r",c=l==="x";return{options:a,dposition:h?"chartArea":c?"bottom":"left",dtype:h?"radialLinear":c?"category":"linear"}}))),li(r,o=>{const a=o.options,l=a.id,h=fy(l,a),c=Te(a.type,o.dtype);(a.position===void 0||nw(a.position,h)!==nw(o.dposition))&&(a.position=o.dposition),s[l]=!0;let u=null;if(l in n&&n[l].type===c)u=n[l];else{const f=Yr.getScale(c);u=new f({id:l,type:c,ctx:this.ctx,chart:this}),n[u.id]=u}u.init(a,t)}),li(s,(o,a)=>{o||delete n[a]}),li(n,o=>{Wn.configure(this,o,o.options),Wn.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort((s,r)=>s.index-r.index),n>e){for(let s=e;s<n;++s)this._destroyDatasetMeta(s);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(sw("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((n,s)=>{e.filter(r=>r===n._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,s;for(this._removeUnreferencedMetasets(),n=0,s=e.length;n<s;n++){const r=e[n];let o=this.getDatasetMeta(n);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=a,o.indexAxis=r.indexAxis||dy(a,this.options),o.order=r.order||0,o.index=n,o.label=""+r.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const l=Yr.getController(a),{datasetElementType:h,dataElementType:c}=Di.datasets[a];Object.assign(l,{dataElementType:Yr.getElement(c),datasetElementType:h&&Yr.getElement(h)}),o.controller=new l(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){li(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let h=0,c=this.data.datasets.length;h<c;h++){const{controller:u}=this.getDatasetMeta(h),f=!s&&r.indexOf(u)===-1;u.buildOrUpdateElements(f),o=Math.max(+u.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),s||li(r,h=>{h.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(sw("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){li(this.scales,t=>{Wn.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!mb(e,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:s,count:r}of e){const o=n==="_removeElements"?-r:r;pG(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),s=n(0);for(let r=1;r<e;r++)if(!mb(s,n(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Wn.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],li(this.boxes,s=>{n&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,n=this.data.datasets.length;e<n;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,Ja(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),s={meta:n,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(n.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Io.has(this)?this.attached&&!Io.running(this)&&Io.start(this):(this.draw(),rw({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let s,r;for(s=0,r=e.length;s<r;++s){const o=e[s];(!t||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,s=!n.disabled,r=_G(t,this.chartArea),o={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(s&&um(e,{left:n.left===!1?0:r.left-n.left,right:n.right===!1?this.width:r.right+n.right,top:n.top===!1?0:r.top-n.top,bottom:n.bottom===!1?this.height:r.bottom+n.bottom}),t.controller.draw(),s&&dm(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return Uo(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,s){const r=fz.modes[e];return typeof r=="function"?r(this,t,n,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let s=n.filter(r=>r&&r._dataset===e).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(s)),s}getContext(){return this.$context||(this.$context=nl(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!e.hidden}setDatasetVisibility(t,e){const n=this.getDatasetMeta(t);n.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const s=n?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,s);lf(e)?(r.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(r,{visible:n}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),Io.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Cb(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Op[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},s=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};li(this.options.events,r=>n(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(l,h)=>{e.addEventListener(this,l,h),t[l]=h},s=(l,h)=>{t[l]&&(e.removeEventListener(this,l,h),delete t[l])},r=(l,h)=>{this.canvas&&this.resize(l,h)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),n("resize",r),n("detach",o)};o=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),n("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){li(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},li(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const s=n?"set":"remove";let r,o,a,l;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){o=t[a];const h=o&&this.getDatasetMeta(o.datasetIndex).controller;h&&h[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!b0(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,n){const s=this.options.hover,r=(l,h)=>l.filter(c=>!h.some(u=>c.datasetIndex===u.datasetIndex&&c.index===u.index)),o=r(e,t),a=n?t:r(t,e);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,s)===!1)return;const r=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,s),(r||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:s=[],options:r}=this,o=e,a=this._getActiveElements(t,s,n,o),l=C9(t),h=mG(t,this._lastEvent,n,l);n&&(this._lastEvent=null,yi(r.onHover,[t,a,this],this),l&&yi(r.onClick,[t,a,this],this));const c=!b0(a,s);return(c||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=h,c}_getActiveElements(t,e,n,s){if(t.type==="mouseout")return[];if(!n)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,s)}}Vt(Ca,"defaults",Di),Vt(Ca,"instances",Op),Vt(Ca,"overrides",Xl),Vt(Ca,"registry",Yr),Vt(Ca,"version",dG),Vt(Ca,"getChart",ow);function aw(){return li(Ca.instances,i=>i._plugins.invalidate())}function yG(i,t,e){const{startAngle:n,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:l}=t;let h=s/a;i.beginPath(),i.arc(r,o,a,n-h,e+h),l>s?(h=s/l,i.arc(r,o,l,e+h,n-h,!0)):i.arc(r,o,s,e+Ji,n-Ji),i.closePath(),i.clip()}function vG(i){return fv(i,["outerStart","outerEnd","innerStart","innerEnd"])}function xG(i,t,e,n){const s=vG(i.options.borderRadius),r=(e-t)/2,o=Math.min(r,n*t/2),a=l=>{const h=(e-Math.min(r,l))*n/2;return En(l,0,Math.min(r,h))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:En(s.innerStart,0,o),innerEnd:En(s.innerEnd,0,o)}}function Qh(i,t,e,n){return{x:e+i*Math.cos(t),y:n+i*Math.sin(t)}}function M0(i,t,e,n,s,r){const{x:o,y:a,startAngle:l,pixelMargin:h,innerRadius:c}=t,u=Math.max(t.outerRadius+n+e-h,0),f=c>0?c+n+e+h:0;let d=0;const g=s-l;if(n){const U=c>0?c-n:0,X=u>0?u-n:0,Z=(U+X)/2,st=Z!==0?g*Z/(Z+n):g;d=(g-st)/2}const p=Math.max(.001,g*u-e/Li)/u,y=(g-p)/2,_=l+y+d,x=s-y-d,{outerStart:b,outerEnd:L,innerStart:M,innerEnd:k}=xG(t,f,u,x-_),A=u-b,T=u-L,F=_+b/A,q=x-L/T,R=f+M,S=f+k,O=_+M/R,E=x-k/S;if(i.beginPath(),r){const U=(F+q)/2;if(i.arc(o,a,u,F,U),i.arc(o,a,u,U,q),L>0){const tt=Qh(T,q,o,a);i.arc(tt.x,tt.y,L,q,x+Ji)}const X=Qh(S,x,o,a);if(i.lineTo(X.x,X.y),k>0){const tt=Qh(S,E,o,a);i.arc(tt.x,tt.y,k,x+Ji,E+Math.PI)}const Z=(x-k/f+(_+M/f))/2;if(i.arc(o,a,f,x-k/f,Z,!0),i.arc(o,a,f,Z,_+M/f,!0),M>0){const tt=Qh(R,O,o,a);i.arc(tt.x,tt.y,M,O+Math.PI,_-Ji)}const st=Qh(A,_,o,a);if(i.lineTo(st.x,st.y),b>0){const tt=Qh(A,F,o,a);i.arc(tt.x,tt.y,b,_-Ji,F)}}else{i.moveTo(o,a);const U=Math.cos(F)*u+o,X=Math.sin(F)*u+a;i.lineTo(U,X);const Z=Math.cos(q)*u+o,st=Math.sin(q)*u+a;i.lineTo(Z,st)}i.closePath()}function bG(i,t,e,n,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let l=t.endAngle;if(r){M0(i,t,e,n,l,s);for(let h=0;h<r;++h)i.fill();isNaN(a)||(l=o+(a%Ci||Ci))}return M0(i,t,e,n,l,s),i.fill(),l}function wG(i,t,e,n,s){const{fullCircles:r,startAngle:o,circumference:a,options:l}=t,{borderWidth:h,borderJoinStyle:c,borderDash:u,borderDashOffset:f}=l,d=l.borderAlign==="inner";if(!h)return;i.setLineDash(u||[]),i.lineDashOffset=f,d?(i.lineWidth=h*2,i.lineJoin=c||"round"):(i.lineWidth=h,i.lineJoin=c||"bevel");let g=t.endAngle;if(r){M0(i,t,e,n,g,s);for(let p=0;p<r;++p)i.stroke();isNaN(a)||(g=o+(a%Ci||Ci))}d&&yG(i,t,g),r||(M0(i,t,e,n,g,s),i.stroke())}class ud extends ta{constructor(e){super();Vt(this,"circumference");Vt(this,"endAngle");Vt(this,"fullCircles");Vt(this,"innerRadius");Vt(this,"outerRadius");Vt(this,"pixelMargin");Vt(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.getProps(["x","y"],s),{angle:o,distance:a}=vL(r,{x:e,y:n}),{startAngle:l,endAngle:h,innerRadius:c,outerRadius:u,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),d=(this.options.spacing+this.options.borderWidth)/2,g=Te(f,h-l),p=hf(o,l,h)&&l!==h,y=g>=Ci||p,_=zo(a,c+d,u+d);return y&&_}getCenterPoint(e){const{x:n,y:s,startAngle:r,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:h,spacing:c}=this.options,u=(r+o)/2,f=(a+l+c+h)/2;return{x:n+Math.cos(u)*f,y:s+Math.sin(u)*f}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,r=(n.offset||0)/4,o=(n.spacing||0)/2,a=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Ci?Math.floor(s/Ci):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*r,Math.sin(l)*r);const h=1-Math.sin(Math.min(Li,s||0)),c=r*h;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,bG(e,this,c,o,a),wG(e,this,c,o,a),e.restore()}}Vt(ud,"id","arc"),Vt(ud,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Vt(ud,"defaultRoutes",{backgroundColor:"backgroundColor"}),Vt(ud,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function JL(i,t,e=t){i.lineCap=Te(e.borderCapStyle,t.borderCapStyle),i.setLineDash(Te(e.borderDash,t.borderDash)),i.lineDashOffset=Te(e.borderDashOffset,t.borderDashOffset),i.lineJoin=Te(e.borderJoinStyle,t.borderJoinStyle),i.lineWidth=Te(e.borderWidth,t.borderWidth),i.strokeStyle=Te(e.borderColor,t.borderColor)}function SG(i,t,e){i.lineTo(e.x,e.y)}function EG(i){return i.stepped?Y9:i.tension||i.cubicInterpolationMode==="monotone"?X9:SG}function QL(i,t,e={}){const n=i.length,{start:s=0,end:r=n-1}=e,{start:o,end:a}=t,l=Math.max(s,o),h=Math.min(r,a),c=s<o&&r<o||s>a&&r>a;return{count:n,start:l,loop:t.loop,ilen:h<l&&!c?n+h-l:h-l}}function CG(i,t,e,n){const{points:s,options:r}=t,{count:o,start:a,loop:l,ilen:h}=QL(s,e,n),c=EG(r);let{move:u=!0,reverse:f}=n||{},d,g,p;for(d=0;d<=h;++d)g=s[(a+(f?h-d:d))%o],!g.skip&&(u?(i.moveTo(g.x,g.y),u=!1):c(i,p,g,f,r.stepped),p=g);return l&&(g=s[(a+(f?h:0))%o],c(i,p,g,f,r.stepped)),!!l}function LG(i,t,e,n){const s=t.points,{count:r,start:o,ilen:a}=QL(s,e,n),{move:l=!0,reverse:h}=n||{};let c=0,u=0,f,d,g,p,y,_;const x=L=>(o+(h?a-L:L))%r,b=()=>{p!==y&&(i.lineTo(c,y),i.lineTo(c,p),i.lineTo(c,_))};for(l&&(d=s[x(0)],i.moveTo(d.x,d.y)),f=0;f<=a;++f){if(d=s[x(f)],d.skip)continue;const L=d.x,M=d.y,k=L|0;k===g?(M<p?p=M:M>y&&(y=M),c=(u*c+L)/++u):(b(),i.lineTo(L,M),g=k,u=0,p=y=M),_=M}b()}function gy(i){const t=i.options,e=t.borderDash&&t.borderDash.length;return!i._decimated&&!i._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?LG:CG}function MG(i){return i.stepped?Lj:i.tension||i.cubicInterpolationMode==="monotone"?Mj:Cl}function TG(i,t,e,n){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,n)&&s.closePath()),JL(i,t.options),i.stroke(s)}function AG(i,t,e,n){const{segments:s,options:r}=t,o=gy(t);for(const a of s)JL(i,r,a.style),i.beginPath(),o(i,t,a,{start:e,end:e+n-1})&&i.closePath(),i.stroke()}const PG=typeof Path2D=="function";function IG(i,t,e,n){PG&&!t.options.segment?TG(i,t,e,n):AG(i,t,e,n)}class ka extends ta{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const s=n.spanGaps?this._loop:this._fullLoop;yj(this._points,n,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Nj(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,s=t[e],r=this.points,o=jL(this,{property:e,start:s,end:s});if(!o.length)return;const a=[],l=MG(n);let h,c;for(h=0,c=o.length;h<c;++h){const{start:u,end:f}=o[h],d=r[u],g=r[f];if(d===g){a.push(d);continue}const p=Math.abs((s-d[e])/(g[e]-d[e])),y=l(d,g,p,n.stepped);y[e]=t[e],a.push(y)}return a.length===1?a[0]:a}pathSegment(t,e,n){return gy(this)(t,this,e,n)}path(t,e,n){const s=this.segments,r=gy(this);let o=this._loop;e=e||0,n=n||this.points.length-e;for(const a of s)o&=r(t,this,a,{start:e,end:e+n-1});return!!o}draw(t,e,n,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),IG(t,this,n,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Vt(ka,"id","line"),Vt(ka,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Vt(ka,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Vt(ka,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function lw(i,t,e,n){const s=i.options,{[e]:r}=i.getProps([e],n);return Math.abs(t-r)<s.radius+s.hitRadius}class Dp extends ta{constructor(e){super();Vt(this,"parsed");Vt(this,"skip");Vt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.options,{x:o,y:a}=this.getProps(["x","y"],s);return Math.pow(e-o,2)+Math.pow(n-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return lw(this,e,"x",n)}inYRange(e,n){return lw(this,e,"y",n)}getCenterPoint(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const s=n&&e.borderWidth||0;return(n+s)*2}draw(e,n){const s=this.options;this.skip||s.radius<.1||!Uo(this,n,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,cy(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}Vt(Dp,"id","point"),Vt(Dp,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Vt(Dp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function t3(i,t){const{x:e,y:n,base:s,width:r,height:o}=i.getProps(["x","y","base","width","height"],t);let a,l,h,c,u;return i.horizontal?(u=o/2,a=Math.min(e,s),l=Math.max(e,s),h=n-u,c=n+u):(u=r/2,a=e-u,l=e+u,h=Math.min(n,s),c=Math.max(n,s)),{left:a,top:h,right:l,bottom:c}}function Fa(i,t,e,n){return i?0:En(t,e,n)}function RG(i,t,e){const n=i.options.borderWidth,s=i.borderSkipped,r=TL(n);return{t:Fa(s.top,r.top,0,e),r:Fa(s.right,r.right,0,t),b:Fa(s.bottom,r.bottom,0,e),l:Fa(s.left,r.left,0,t)}}function NG(i,t,e){const{enableBorderRadius:n}=i.getProps(["enableBorderRadius"]),s=i.options.borderRadius,r=Bl(s),o=Math.min(t,e),a=i.borderSkipped,l=n||Be(s);return{topLeft:Fa(!l||a.top||a.left,r.topLeft,0,o),topRight:Fa(!l||a.top||a.right,r.topRight,0,o),bottomLeft:Fa(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:Fa(!l||a.bottom||a.right,r.bottomRight,0,o)}}function kG(i){const t=t3(i),e=t.right-t.left,n=t.bottom-t.top,s=RG(i,e/2,n/2),r=NG(i,e/2,n/2);return{outer:{x:t.left,y:t.top,w:e,h:n,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:n-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function c_(i,t,e,n){const s=t===null,r=e===null,a=i&&!(s&&r)&&t3(i,n);return a&&(s||zo(t,a.left,a.right))&&(r||zo(e,a.top,a.bottom))}function FG(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}function OG(i,t){i.rect(t.x,t.y,t.w,t.h)}function u_(i,t,e={}){const n=i.x!==e.x?-t:0,s=i.y!==e.y?-t:0,r=(i.x+i.w!==e.x+e.w?t:0)-n,o=(i.y+i.h!==e.y+e.h?t:0)-s;return{x:i.x+n,y:i.y+s,w:i.w+r,h:i.h+o,radius:i.radius}}class Bp extends ta{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:s}}=this,{inner:r,outer:o}=kG(this),a=FG(o.radius)?cf:OG;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,u_(o,e,r)),t.clip(),a(t,u_(r,-e,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),a(t,u_(r,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,n){return c_(this,t,e,n)}inXRange(t,e){return c_(this,t,null,e)}inYRange(t,e){return c_(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+s)/2:e,y:r?n:(n+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Vt(Bp,"id","bar"),Vt(Bp,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Vt(Bp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var DG=Object.freeze({__proto__:null,ArcElement:ud,BarElement:Bp,LineElement:ka,PointElement:Dp});const py=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],hw=py.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function e3(i){return py[i%py.length]}function i3(i){return hw[i%hw.length]}function BG(i,t){return i.borderColor=e3(t),i.backgroundColor=i3(t),++t}function jG(i,t){return i.backgroundColor=i.data.map(()=>e3(t++)),t}function zG(i,t){return i.backgroundColor=i.data.map(()=>i3(t++)),t}function GG(i){let t=0;return(e,n)=>{const s=i.getDatasetMeta(n).controller;s instanceof Rl?t=jG(e,t):s instanceof Fd?t=zG(e,t):s&&(t=BG(e,t))}}function cw(i){let t;for(t in i)if(i[t].borderColor||i[t].backgroundColor)return!0;return!1}function UG(i){return i&&(i.borderColor||i.backgroundColor)}var WG={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,t,e){if(!e.enabled)return;const{data:{datasets:n},options:s}=i.config,{elements:r}=s;if(!e.forceOverride&&(cw(n)||UG(s)||r&&cw(r)))return;const o=GG(i);n.forEach(o)}};function qG(i,t,e,n,s){const r=s.samples||n;if(r>=e)return i.slice(t,t+e);const o=[],a=(e-2)/(r-2);let l=0;const h=t+e-1;let c=t,u,f,d,g,p;for(o[l++]=i[c],u=0;u<r-2;u++){let y=0,_=0,x;const b=Math.floor((u+1)*a)+1+t,L=Math.min(Math.floor((u+2)*a)+1,e)+t,M=L-b;for(x=b;x<L;x++)y+=i[x].x,_+=i[x].y;y/=M,_/=M;const k=Math.floor(u*a)+1+t,A=Math.min(Math.floor((u+1)*a)+1,e)+t,{x:T,y:F}=i[c];for(d=g=-1,x=k;x<A;x++)g=.5*Math.abs((T-y)*(i[x].y-F)-(T-i[x].x)*(_-F)),g>d&&(d=g,f=i[x],p=x);o[l++]=f,c=p}return o[l++]=i[h],o}function VG(i,t,e,n){let s=0,r=0,o,a,l,h,c,u,f,d,g,p;const y=[],_=t+e-1,x=i[t].x,L=i[_].x-x;for(o=t;o<t+e;++o){a=i[o],l=(a.x-x)/L*n,h=a.y;const M=l|0;if(M===c)h<g?(g=h,u=o):h>p&&(p=h,f=o),s=(r*s+a.x)/++r;else{const k=o-1;if(!$e(u)&&!$e(f)){const A=Math.min(u,f),T=Math.max(u,f);A!==d&&A!==k&&y.push({...i[A],x:s}),T!==d&&T!==k&&y.push({...i[T],x:s})}o>0&&k!==d&&y.push(i[k]),y.push(a),c=M,r=0,g=p=h,u=f=d=o}}return y}function n3(i){if(i._decimated){const t=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function uw(i){i.data.datasets.forEach(t=>{n3(t)})}function HG(i,t){const e=t.length;let n=0,s;const{iScale:r}=i,{min:o,max:a,minDefined:l,maxDefined:h}=r.getUserBounds();return l&&(n=En(Go(t,r.axis,o).lo,0,e-1)),h?s=En(Go(t,r.axis,a).hi+1,n,e)-n:s=e-n,{start:n,count:s}}var YG={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,t,e)=>{if(!e.enabled){uw(i);return}const n=i.width;i.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,l=i.getDatasetMeta(r),h=o||s.data;if(hd([a,i.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const c=i.scales[l.xAxisID];if(c.type!=="linear"&&c.type!=="time"||i.options.parsing)return;let{start:u,count:f}=HG(l,h);const d=e.threshold||4*n;if(f<=d){n3(s);return}$e(o)&&(s._data=h,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(p){this._data=p}}));let g;switch(e.algorithm){case"lttb":g=qG(h,u,f,n,e);break;case"min-max":g=VG(h,u,f,n);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=g})},destroy(i){uw(i)}};function XG(i,t,e){const n=i.segments,s=i.points,r=t.points,o=[];for(const a of n){let{start:l,end:h}=a;h=xv(l,h,s);const c=my(e,s[l],s[h],a.loop);if(!t.segments){o.push({source:a,target:c,start:s[l],end:s[h]});continue}const u=jL(t,c);for(const f of u){const d=my(e,r[f.start],r[f.end],f.loop),g=BL(a,s,d);for(const p of g)o.push({source:p,target:f,start:{[e]:dw(c,d,"start",Math.max)},end:{[e]:dw(c,d,"end",Math.min)}})}}return o}function my(i,t,e,n){if(n)return;let s=t[i],r=e[i];return i==="angle"&&(s=Os(s),r=Os(r)),{property:i,start:s,end:r}}function $G(i,t){const{x:e=null,y:n=null}=i||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=xv(o,a,s);const l=s[o],h=s[a];n!==null?(r.push({x:l.x,y:n}),r.push({x:h.x,y:n})):e!==null&&(r.push({x:e,y:l.y}),r.push({x:e,y:h.y}))}),r}function xv(i,t,e){for(;t>i;t--){const n=e[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function dw(i,t,e,n){return i&&t?n(i[e],t[e]):i?i[e]:t?t[e]:0}function s3(i,t){let e=[],n=!1;return Mi(i)?(n=!0,e=i):e=$G(i,t),e.length?new ka({points:e,options:{tension:0},_loop:n,_fullLoop:n}):null}function fw(i){return i&&i.fill!==!1}function KG(i,t,e){let s=i[t].fill;const r=[t];let o;if(!e)return s;for(;s!==!1&&r.indexOf(s)===-1;){if(!Oi(s))return s;if(o=i[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function ZG(i,t,e){const n=eU(i);if(Be(n))return isNaN(n.value)?!1:n;let s=parseFloat(n);return Oi(s)&&Math.floor(s)===s?JG(n[0],t,s,e):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function JG(i,t,e,n){return(i==="-"||i==="+")&&(e=t+e),e===t||e<0||e>=n?!1:e}function QG(i,t){let e=null;return i==="start"?e=t.bottom:i==="end"?e=t.top:Be(i)?e=t.getPixelForValue(i.value):t.getBasePixel&&(e=t.getBasePixel()),e}function tU(i,t,e){let n;return i==="start"?n=e:i==="end"?n=t.options.reverse?t.min:t.max:Be(i)?n=i.value:n=t.getBaseValue(),n}function eU(i){const t=i.options,e=t.fill;let n=Te(e&&e.target,e);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function iU(i){const{scale:t,index:e,line:n}=i,s=[],r=n.segments,o=n.points,a=nU(t,e);a.push(s3({x:null,y:t.bottom},n));for(let l=0;l<r.length;l++){const h=r[l];for(let c=h.start;c<=h.end;c++)sU(s,o[c],a)}return new ka({points:s,options:{}})}function nU(i,t){const e=[],n=i.getMatchingVisibleMetas("line");for(let s=0;s<n.length;s++){const r=n[s];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function sU(i,t,e){const n=[];for(let s=0;s<e.length;s++){const r=e[s],{first:o,last:a,point:l}=rU(r,t,"x");if(!(!l||o&&a)){if(o)n.unshift(l);else if(i.push(l),!a)break}}i.push(...n)}function rU(i,t,e){const n=i.interpolate(t,e);if(!n)return{};const s=n[e],r=i.segments,o=i.points;let a=!1,l=!1;for(let h=0;h<r.length;h++){const c=r[h],u=o[c.start][e],f=o[c.end][e];if(zo(s,u,f)){a=s===u,l=s===f;break}}return{first:a,last:l,point:n}}class r3{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:s,y:r,radius:o}=this;return e=e||{start:0,end:Ci},t.arc(s,r,o,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:s}=this,r=t.angle;return{x:e+Math.cos(r)*s,y:n+Math.sin(r)*s,angle:r}}}function oU(i){const{chart:t,fill:e,line:n}=i;if(Oi(e))return aU(t,e);if(e==="stack")return iU(i);if(e==="shape")return!0;const s=lU(i);return s instanceof r3?s:s3(s,n)}function aU(i,t){const e=i.getDatasetMeta(t);return e&&i.isDatasetVisible(t)?e.dataset:null}function lU(i){return(i.scale||{}).getPointPositionForValue?cU(i):hU(i)}function hU(i){const{scale:t={},fill:e}=i,n=QG(e,t);if(Oi(n)){const s=t.isHorizontal();return{x:s?n:null,y:s?null:n}}return null}function cU(i){const{scale:t,fill:e}=i,n=t.options,s=t.getLabels().length,r=n.reverse?t.max:t.min,o=tU(e,t,r),a=[];if(n.grid.circular){const l=t.getPointPositionForValue(0,r);return new r3({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(o)})}for(let l=0;l<s;++l)a.push(t.getPointPositionForValue(l,o));return a}function d_(i,t,e){const n=oU(t),{line:s,scale:r,axis:o}=t,a=s.options,l=a.fill,h=a.backgroundColor,{above:c=h,below:u=h}=l||{};n&&s.points.length&&(um(i,e),uU(i,{line:s,target:n,above:c,below:u,area:e,scale:r,axis:o}),dm(i))}function uU(i,t){const{line:e,target:n,above:s,below:r,area:o,scale:a}=t,l=e._loop?"angle":t.axis;i.save(),l==="x"&&r!==s&&(gw(i,n,o.top),pw(i,{line:e,target:n,color:s,scale:a,property:l}),i.restore(),i.save(),gw(i,n,o.bottom)),pw(i,{line:e,target:n,color:r,scale:a,property:l}),i.restore()}function gw(i,t,e){const{segments:n,points:s}=t;let r=!0,o=!1;i.beginPath();for(const a of n){const{start:l,end:h}=a,c=s[l],u=s[xv(l,h,s)];r?(i.moveTo(c.x,c.y),r=!1):(i.lineTo(c.x,e),i.lineTo(c.x,c.y)),o=!!t.pathSegment(i,a,{move:o}),o?i.closePath():i.lineTo(u.x,e)}i.lineTo(t.first().x,e),i.closePath(),i.clip()}function pw(i,t){const{line:e,target:n,property:s,color:r,scale:o}=t,a=XG(e,n,s);for(const{source:l,target:h,start:c,end:u}of a){const{style:{backgroundColor:f=r}={}}=l,d=n!==!0;i.save(),i.fillStyle=f,dU(i,o,d&&my(s,c,u)),i.beginPath();const g=!!e.pathSegment(i,l);let p;if(d){g?i.closePath():mw(i,n,u,s);const y=!!n.pathSegment(i,h,{move:g,reverse:!0});p=g&&y,p||mw(i,n,c,s)}i.closePath(),i.fill(p?"evenodd":"nonzero"),i.restore()}}function dU(i,t,e){const{top:n,bottom:s}=t.chart.chartArea,{property:r,start:o,end:a}=e||{};r==="x"&&(i.beginPath(),i.rect(o,n,a-o,s-n),i.clip())}function mw(i,t,e,n){const s=t.interpolate(e,n);s&&i.lineTo(s.x,s.y)}var fU={id:"filler",afterDatasetsUpdate(i,t,e){const n=(i.data.datasets||[]).length,s=[];let r,o,a,l;for(o=0;o<n;++o)r=i.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof ka&&(l={visible:i.isDatasetVisible(o),index:o,fill:ZG(a,o,n),chart:i,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,s.push(l);for(o=0;o<n;++o)l=s[o],!(!l||l.fill===!1)&&(l.fill=KG(s,o,e.propagate))},beforeDraw(i,t,e){const n=e.drawTime==="beforeDraw",s=i.getSortedVisibleDatasetMetas(),r=i.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),n&&a.fill&&d_(i.ctx,a,r))}},beforeDatasetsDraw(i,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const n=i.getSortedVisibleDatasetMetas();for(let s=n.length-1;s>=0;--s){const r=n[s].$filler;fw(r)&&d_(i.ctx,r,i.chartArea)}},beforeDatasetDraw(i,t,e){const n=t.meta.$filler;!fw(n)||e.drawTime!=="beforeDatasetDraw"||d_(i.ctx,n,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const _w=(i,t)=>{let{boxHeight:e=t,boxWidth:n=t}=i;return i.usePointStyle&&(e=Math.min(e,t),n=i.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:e,itemHeight:Math.max(t,e)}},gU=(i,t)=>i!==null&&t!==null&&i.datasetIndex===t.datasetIndex&&i.index===t.index;class yw extends ta{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=yi(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(n=>t.filter(n,this.chart.data))),t.sort&&(e=e.sort((n,s)=>t.sort(n,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,s=fn(n.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=_w(n,r);let h,c;e.font=s.string,this.isHorizontal()?(h=this.maxWidth,c=this._fitRows(o,r,a,l)+10):(c=this.maxHeight,h=this._fitCols(o,s,a,l)+10),this.width=Math.min(h,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],h=this.lineWidths=[0],c=s+a;let u=t;r.textAlign="left",r.textBaseline="middle";let f=-1,d=-c;return this.legendItems.forEach((g,p)=>{const y=n+e/2+r.measureText(g.text).width;(p===0||h[h.length-1]+y+2*a>o)&&(u+=c,h[h.length-(p>0?0:1)]=0,d+=c,f++),l[p]={left:0,top:d,row:f,width:y,height:s},h[h.length-1]+=y+a}),u}_fitCols(t,e,n,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],h=this.columnSizes=[],c=o-t;let u=a,f=0,d=0,g=0,p=0;return this.legendItems.forEach((y,_)=>{const{itemWidth:x,itemHeight:b}=pU(n,e,r,y,s);_>0&&d+b+2*a>c&&(u+=f+a,h.push({width:f,height:d}),g+=f+a,p++,f=d=0),l[_]={left:g,top:d,col:p,width:x,height:b},f=Math.max(f,x),d+=b+a}),u+=f,h.push({width:f,height:d}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:s},rtl:r}}=this,o=Tc(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=zn(n,this.left+s,this.right-this.lineWidths[a]);for(const h of e)a!==h.row&&(a=h.row,l=zn(n,this.left+s,this.right-this.lineWidths[a])),h.top+=this.top+t+s,h.left=o.leftForLtr(o.x(l),h.width),l+=h.width+s}else{let a=0,l=zn(n,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const h of e)h.col!==a&&(a=h.col,l=zn(n,this.top+t+s,this.bottom-this.columnSizes[a].height)),h.top=l,h.left+=this.left+s,h.left=o.leftForLtr(o.x(h.left),h.width),l+=h.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;um(t,this),this._draw(),dm(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:s}=this,{align:r,labels:o}=t,a=Di.color,l=Tc(t.rtl,this.left,this.width),h=fn(o.font),{padding:c}=o,u=h.size,f=u/2;let d;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;const{boxWidth:g,boxHeight:p,itemHeight:y}=_w(o,u),_=function(k,A,T){if(isNaN(g)||g<=0||isNaN(p)||p<0)return;s.save();const F=Te(T.lineWidth,1);if(s.fillStyle=Te(T.fillStyle,a),s.lineCap=Te(T.lineCap,"butt"),s.lineDashOffset=Te(T.lineDashOffset,0),s.lineJoin=Te(T.lineJoin,"miter"),s.lineWidth=F,s.strokeStyle=Te(T.strokeStyle,a),s.setLineDash(Te(T.lineDash,[])),o.usePointStyle){const q={radius:p*Math.SQRT2/2,pointStyle:T.pointStyle,rotation:T.rotation,borderWidth:F},R=l.xPlus(k,g/2),S=A+f;ML(s,q,R,S,o.pointStyleWidth&&g)}else{const q=A+Math.max((u-p)/2,0),R=l.leftForLtr(k,g),S=Bl(T.borderRadius);s.beginPath(),Object.values(S).some(O=>O!==0)?cf(s,{x:R,y:q,w:g,h:p,radius:S}):s.rect(R,q,g,p),s.fill(),F!==0&&s.stroke()}s.restore()},x=function(k,A,T){$l(s,T.text,k,A+y/2,h,{strikethrough:T.hidden,textAlign:l.textAlign(T.textAlign)})},b=this.isHorizontal(),L=this._computeTitleHeight();b?d={x:zn(r,this.left+c,this.right-n[0]),y:this.top+c+L,line:0}:d={x:this.left+c,y:zn(r,this.top+L+c,this.bottom-e[0].height),line:0},FL(this.ctx,t.textDirection);const M=y+c;this.legendItems.forEach((k,A)=>{s.strokeStyle=k.fontColor,s.fillStyle=k.fontColor;const T=s.measureText(k.text).width,F=l.textAlign(k.textAlign||(k.textAlign=o.textAlign)),q=g+f+T;let R=d.x,S=d.y;l.setWidth(this.width),b?A>0&&R+q+c>this.right&&(S=d.y+=M,d.line++,R=d.x=zn(r,this.left+c,this.right-n[d.line])):A>0&&S+M>this.bottom&&(R=d.x=R+e[d.line].width+c,d.line++,S=d.y=zn(r,this.top+L+c,this.bottom-e[d.line].height));const O=l.x(R);if(_(O,S,k),R=O9(F,R+g+f,b?R+q:this.right,t.rtl),x(l.x(R),S,k),b)d.x+=q+c;else if(typeof k.text!="string"){const E=h.lineHeight;d.y+=o3(k,E)+c}else d.y+=M}),OL(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=fn(e.font),s=Xn(e.padding);if(!e.display)return;const r=Tc(t.rtl,this.left,this.width),o=this.ctx,a=e.position,l=n.size/2,h=s.top+l;let c,u=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),c=this.top+h,u=zn(t.align,u,this.right-f);else{const g=this.columnSizes.reduce((p,y)=>Math.max(p,y.height),0);c=h+zn(t.align,this.top,this.bottom-g-t.labels.padding-this._computeTitleHeight())}const d=zn(a,u,u+f);o.textAlign=r.textAlign(uv(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=n.string,$l(o,e.text,d,c,n)}_computeTitleHeight(){const t=this.options.title,e=fn(t.font),n=Xn(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,s,r;if(zo(t,this.left,this.right)&&zo(e,this.top,this.bottom)){for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(s=r[n],zo(t,s.left,s.left+s.width)&&zo(e,s.top,s.top+s.height))return this.legendItems[n]}return null}handleEvent(t){const e=this.options;if(!yU(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,r=gU(s,n);s&&!r&&yi(e.onLeave,[t,s,this],this),this._hoveredItem=n,n&&!r&&yi(e.onHover,[t,n,this],this)}else n&&yi(e.onClick,[t,n,this],this)}}function pU(i,t,e,n,s){const r=mU(n,i,t,e),o=_U(s,n,t.lineHeight);return{itemWidth:r,itemHeight:o}}function mU(i,t,e,n){let s=i.text;return s&&typeof s!="string"&&(s=s.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+n.measureText(s).width}function _U(i,t,e){let n=i;return typeof t.text!="string"&&(n=o3(t,e)),n}function o3(i,t){const e=i.text?i.text.length:0;return t*e}function yU(i,t){return!!((i==="mousemove"||i==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(i==="click"||i==="mouseup"))}var vU={id:"legend",_element:yw,start(i,t,e){const n=i.legend=new yw({ctx:i.ctx,options:e,chart:i});Wn.configure(i,n,e),Wn.addBox(i,n)},stop(i){Wn.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,t,e){const n=i.legend;Wn.configure(i,n,e),n.options=e},afterUpdate(i){const t=i.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(i,t){t.replay||i.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,t,e){const n=t.datasetIndex,s=e.chart;s.isDatasetVisible(n)?(s.hide(n),t.hidden=!0):(s.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const t=i.data.datasets,{labels:{usePointStyle:e,pointStyle:n,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=i.legend.options;return i._getSortedDatasetMetas().map(l=>{const h=l.controller.getStyle(e?0:void 0),c=Xn(h.borderWidth);return{text:t[l.index].label,fillStyle:h.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:h.borderCapStyle,lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:h.borderColor,pointStyle:n||h.pointStyle,rotation:h.rotation,textAlign:s||h.textAlign,borderRadius:o&&(a||h.borderRadius),datasetIndex:l.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class bv extends ta{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const s=Mi(n.text)?n.text.length:1;this._padding=Xn(n.padding);const r=s*fn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:n,bottom:s,right:r,options:o}=this,a=o.align;let l=0,h,c,u;return this.isHorizontal()?(c=zn(a,n,r),u=e+t,h=r-n):(o.position==="left"?(c=n+t,u=zn(a,s,e),l=Li*-.5):(c=r-t,u=zn(a,e,s),l=Li*.5),h=s-e),{titleX:c,titleY:u,maxWidth:h,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=fn(e.font),r=n.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:h}=this._drawArgs(r);$l(t,e.text,0,0,n,{color:e.color,maxWidth:l,rotation:h,textAlign:uv(e.align),textBaseline:"middle",translation:[o,a]})}}function xU(i,t){const e=new bv({ctx:i.ctx,options:t,chart:i});Wn.configure(i,e,t),Wn.addBox(i,e),i.titleBlock=e}var bU={id:"title",_element:bv,start(i,t,e){xU(i,e)},stop(i){const t=i.titleBlock;Wn.removeBox(i,t),delete i.titleBlock},beforeUpdate(i,t,e){const n=i.titleBlock;Wn.configure(i,n,e),n.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const fp=new WeakMap;var wU={id:"subtitle",start(i,t,e){const n=new bv({ctx:i.ctx,options:e,chart:i});Wn.configure(i,n,e),Wn.addBox(i,n),fp.set(i,n)},stop(i){Wn.removeBox(i,fp.get(i)),fp.delete(i)},beforeUpdate(i,t,e){const n=fp.get(i);Wn.configure(i,n,e),n.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const dd={average(i){if(!i.length)return!1;let t,e,n=new Set,s=0,r=0;for(t=0,e=i.length;t<e;++t){const a=i[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();n.add(l.x),s+=l.y,++r}}return r===0||n.size===0?!1:{x:[...n].reduce((a,l)=>a+l)/n.size,y:s/r}},nearest(i,t){if(!i.length)return!1;let e=t.x,n=t.y,s=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=i.length;r<o;++r){const l=i[r].element;if(l&&l.hasValue()){const h=l.getCenterPoint(),c=ly(t,h);c<s&&(s=c,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,n=l.y}return{x:e,y:n}}};function Hr(i,t){return t&&(Mi(t)?Array.prototype.push.apply(i,t):i.push(t)),i}function Ro(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function SU(i,t){const{element:e,datasetIndex:n,index:s}=t,r=i.getDatasetMeta(n).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:i,label:o,parsed:r.getParsed(s),raw:i.data.datasets[n].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:n,element:e}}function vw(i,t){const e=i.chart.ctx,{body:n,footer:s,title:r}=i,{boxWidth:o,boxHeight:a}=t,l=fn(t.bodyFont),h=fn(t.titleFont),c=fn(t.footerFont),u=r.length,f=s.length,d=n.length,g=Xn(t.padding);let p=g.height,y=0,_=n.reduce((L,M)=>L+M.before.length+M.lines.length+M.after.length,0);if(_+=i.beforeBody.length+i.afterBody.length,u&&(p+=u*h.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),_){const L=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;p+=d*L+(_-d)*l.lineHeight+(_-1)*t.bodySpacing}f&&(p+=t.footerMarginTop+f*c.lineHeight+(f-1)*t.footerSpacing);let x=0;const b=function(L){y=Math.max(y,e.measureText(L).width+x)};return e.save(),e.font=h.string,li(i.title,b),e.font=l.string,li(i.beforeBody.concat(i.afterBody),b),x=t.displayColors?o+2+t.boxPadding:0,li(n,L=>{li(L.before,b),li(L.lines,b),li(L.after,b)}),x=0,e.font=c.string,li(i.footer,b),e.restore(),y+=g.width,{width:y,height:p}}function EU(i,t){const{y:e,height:n}=t;return e<n/2?"top":e>i.height-n/2?"bottom":"center"}function CU(i,t,e,n){const{x:s,width:r}=n,o=e.caretSize+e.caretPadding;if(i==="left"&&s+r+o>t.width||i==="right"&&s-r-o<0)return!0}function LU(i,t,e,n){const{x:s,width:r}=e,{width:o,chartArea:{left:a,right:l}}=i;let h="center";return n==="center"?h=s<=(a+l)/2?"left":"right":s<=r/2?h="left":s>=o-r/2&&(h="right"),CU(h,i,t,e)&&(h="center"),h}function xw(i,t,e){const n=e.yAlign||t.yAlign||EU(i,e);return{xAlign:e.xAlign||t.xAlign||LU(i,t,e,n),yAlign:n}}function MU(i,t){let{x:e,width:n}=i;return t==="right"?e-=n:t==="center"&&(e-=n/2),e}function TU(i,t,e){let{y:n,height:s}=i;return t==="top"?n+=e:t==="bottom"?n-=s+e:n-=s/2,n}function bw(i,t,e,n){const{caretSize:s,caretPadding:r,cornerRadius:o}=i,{xAlign:a,yAlign:l}=e,h=s+r,{topLeft:c,topRight:u,bottomLeft:f,bottomRight:d}=Bl(o);let g=MU(t,a);const p=TU(t,l,h);return l==="center"?a==="left"?g+=h:a==="right"&&(g-=h):a==="left"?g-=Math.max(c,f)+s:a==="right"&&(g+=Math.max(u,d)+s),{x:En(g,0,n.width-t.width),y:En(p,0,n.height-t.height)}}function gp(i,t,e){const n=Xn(e.padding);return t==="center"?i.x+i.width/2:t==="right"?i.x+i.width-n.right:i.x+n.left}function ww(i){return Hr([],Ro(i))}function AU(i,t,e){return nl(i,{tooltip:t,tooltipItems:e,type:"tooltip"})}function Sw(i,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?i.override(e):i}const a3={beforeTitle:To,title(i){if(i.length>0){const t=i[0],e=t.chart.data.labels,n=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return e[t.dataIndex]}return""},afterTitle:To,beforeBody:To,beforeLabel:To,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let t=i.dataset.label||"";t&&(t+=": ");const e=i.formattedValue;return $e(e)||(t+=e),t},labelColor(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:To,afterBody:To,beforeFooter:To,footer:To,afterFooter:To};function ds(i,t,e,n){const s=i[t].call(e,n);return typeof s>"u"?a3[t].call(e,n):s}class _y extends ta{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),s=n.enabled&&e.options.animation&&n.animations,r=new zL(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=AU(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:n}=e,s=ds(n,"beforeTitle",this,t),r=ds(n,"title",this,t),o=ds(n,"afterTitle",this,t);let a=[];return a=Hr(a,Ro(s)),a=Hr(a,Ro(r)),a=Hr(a,Ro(o)),a}getBeforeBody(t,e){return ww(ds(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,s=[];return li(t,r=>{const o={before:[],lines:[],after:[]},a=Sw(n,r);Hr(o.before,Ro(ds(a,"beforeLabel",this,r))),Hr(o.lines,ds(a,"label",this,r)),Hr(o.after,Ro(ds(a,"afterLabel",this,r))),s.push(o)}),s}getAfterBody(t,e){return ww(ds(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,s=ds(n,"beforeFooter",this,t),r=ds(n,"footer",this,t),o=ds(n,"afterFooter",this,t);let a=[];return a=Hr(a,Ro(s)),a=Hr(a,Ro(r)),a=Hr(a,Ro(o)),a}_createItems(t){const e=this._active,n=this.chart.data,s=[],r=[],o=[];let a=[],l,h;for(l=0,h=e.length;l<h;++l)a.push(SU(this.chart,e[l]));return t.filter&&(a=a.filter((c,u,f)=>t.filter(c,u,f,n))),t.itemSort&&(a=a.sort((c,u)=>t.itemSort(c,u,n))),li(a,c=>{const u=Sw(t.callbacks,c);s.push(ds(u,"labelColor",this,c)),r.push(ds(u,"labelPointStyle",this,c)),o.push(ds(u,"labelTextColor",this,c))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const n=this.options.setContext(this.getContext()),s=this._active;let r,o=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const a=dd[n.position].call(this,s,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const l=this._size=vw(this,n),h=Object.assign({},a,l),c=xw(this.chart,n,h),u=bw(n,h,c,this.chart);this.xAlign=c.xAlign,this.yAlign=c.yAlign,r={opacity:1,x:u.x,y:u.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,s){const r=this.getCaretPosition(t,n,s);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,n){const{xAlign:s,yAlign:r}=this,{caretSize:o,cornerRadius:a}=n,{topLeft:l,topRight:h,bottomLeft:c,bottomRight:u}=Bl(a),{x:f,y:d}=t,{width:g,height:p}=e;let y,_,x,b,L,M;return r==="center"?(L=d+p/2,s==="left"?(y=f,_=y-o,b=L+o,M=L-o):(y=f+g,_=y+o,b=L-o,M=L+o),x=y):(s==="left"?_=f+Math.max(l,c)+o:s==="right"?_=f+g-Math.max(h,u)-o:_=this.caretX,r==="top"?(b=d,L=b-o,y=_-o,x=_+o):(b=d+p,L=b+o,y=_+o,x=_-o),M=b),{x1:y,x2:_,x3:x,y1:b,y2:L,y3:M}}drawTitle(t,e,n){const s=this.title,r=s.length;let o,a,l;if(r){const h=Tc(n.rtl,this.x,this.width);for(t.x=gp(this,n.titleAlign,n),e.textAlign=h.textAlign(n.titleAlign),e.textBaseline="middle",o=fn(n.titleFont),a=n.titleSpacing,e.fillStyle=n.titleColor,e.font=o.string,l=0;l<r;++l)e.fillText(s[l],h.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,l+1===r&&(t.y+=n.titleMarginBottom-a)}}_drawColorBox(t,e,n,s,r){const o=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:l,boxWidth:h}=r,c=fn(r.bodyFont),u=gp(this,"left",r),f=s.x(u),d=l<c.lineHeight?(c.lineHeight-l)/2:0,g=e.y+d;if(r.usePointStyle){const p={radius:Math.min(h,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=s.leftForLtr(f,h)+h/2,_=g+l/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,cy(t,p,y,_),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,cy(t,p,y,_)}else{t.lineWidth=Be(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const p=s.leftForLtr(f,h),y=s.leftForLtr(s.xPlus(f,1),h-2),_=Bl(o.borderRadius);Object.values(_).some(x=>x!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,cf(t,{x:p,y:g,w:h,h:l,radius:_}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),cf(t,{x:y,y:g+1,w:h-2,h:l-2,radius:_}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(p,g,h,l),t.strokeRect(p,g,h,l),t.fillStyle=o.backgroundColor,t.fillRect(y,g+1,h-2,l-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:s}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:h,boxPadding:c}=n,u=fn(n.bodyFont);let f=u.lineHeight,d=0;const g=Tc(n.rtl,this.x,this.width),p=function(T){e.fillText(T,g.x(t.x+d),t.y+f/2),t.y+=f+r},y=g.textAlign(o);let _,x,b,L,M,k,A;for(e.textAlign=o,e.textBaseline="middle",e.font=u.string,t.x=gp(this,y,n),e.fillStyle=n.bodyColor,li(this.beforeBody,p),d=a&&y!=="right"?o==="center"?h/2+c:h+2+c:0,L=0,k=s.length;L<k;++L){for(_=s[L],x=this.labelTextColors[L],e.fillStyle=x,li(_.before,p),b=_.lines,a&&b.length&&(this._drawColorBox(e,t,L,g,n),f=Math.max(u.lineHeight,l)),M=0,A=b.length;M<A;++M)p(b[M]),f=u.lineHeight;li(_.after,p)}d=0,f=u.lineHeight,li(this.afterBody,p),t.y-=r}drawFooter(t,e,n){const s=this.footer,r=s.length;let o,a;if(r){const l=Tc(n.rtl,this.x,this.width);for(t.x=gp(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=l.textAlign(n.footerAlign),e.textBaseline="middle",o=fn(n.footerFont),e.fillStyle=n.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(s[a],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,e,n,s){const{xAlign:r,yAlign:o}=this,{x:a,y:l}=t,{width:h,height:c}=n,{topLeft:u,topRight:f,bottomLeft:d,bottomRight:g}=Bl(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+u,l),o==="top"&&this.drawCaret(t,e,n,s),e.lineTo(a+h-f,l),e.quadraticCurveTo(a+h,l,a+h,l+f),o==="center"&&r==="right"&&this.drawCaret(t,e,n,s),e.lineTo(a+h,l+c-g),e.quadraticCurveTo(a+h,l+c,a+h-g,l+c),o==="bottom"&&this.drawCaret(t,e,n,s),e.lineTo(a+d,l+c),e.quadraticCurveTo(a,l+c,a,l+c-d),o==="center"&&r==="left"&&this.drawCaret(t,e,n,s),e.lineTo(a,l+u),e.quadraticCurveTo(a,l,a+u,l),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,s=n&&n.x,r=n&&n.y;if(s||r){const o=dd[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=vw(this,t),l=Object.assign({},o,this._size),h=xw(e,t,l),c=bw(t,l,h,e);(s._to!==c.x||r._to!==c.y)&&(this.xAlign=h.xAlign,this.yAlign=h.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Xn(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=n,this.drawBackground(r,t,s,e),FL(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),OL(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,s=t.map(({datasetIndex:a,index:l})=>{const h=this.chart.getDatasetMeta(a);if(!h)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:h.data[l],index:l}}),r=!b0(n,s),o=this._positionChanged(s,e);(r||o)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,n),a=this._positionChanged(o,t),l=e||!b0(o,r)||a;return l&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,n,s){const r=this.options;if(t.type==="mouseout")return[];if(!s)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,n);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:n,caretY:s,options:r}=this,o=dd[r.position].call(this,t,e);return o!==!1&&(n!==o.x||s!==o.y)}}Vt(_y,"positioners",dd);var PU={id:"tooltip",_element:_y,positioners:dd,afterInit(i,t,e){e&&(i.tooltip=new _y({chart:i,options:e}))},beforeUpdate(i,t,e){i.tooltip&&i.tooltip.initialize(e)},reset(i,t,e){i.tooltip&&i.tooltip.initialize(e)},afterDraw(i){const t=i.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(i.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",e)}},afterEvent(i,t){if(i.tooltip){const e=t.replay;i.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,t)=>t.bodyFont.size,boxWidth:(i,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:a3},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},IU=Object.freeze({__proto__:null,Colors:WG,Decimation:YG,Filler:fU,Legend:vU,SubTitle:wU,Title:bU,Tooltip:PU});const RU=(i,t,e,n)=>(typeof t=="string"?(e=i.push(t)-1,n.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function NU(i,t,e,n){const s=i.indexOf(t);if(s===-1)return RU(i,t,e,n);const r=i.lastIndexOf(t);return s!==r?e:s}const kU=(i,t)=>i===null?null:En(Math.round(i),0,t);function Ew(i){const t=this.getLabels();return i>=0&&i<t.length?t[i]:i}class yy extends hh{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const n=this.getLabels();for(const{index:s,label:r}of e)n[s]===r&&n.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,e){if($e(t))return null;const n=this.getLabels();return e=isFinite(e)&&n[e]===t?e:NU(n,t,Te(e,t),this._addedLabels),kU(e,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),e||(s=this.getLabels().length-1)),this.min=n,this.max=s}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,s=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=e;o++)s.push({value:o});return s}getLabelForValue(t){return Ew.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Vt(yy,"id","category"),Vt(yy,"defaults",{ticks:{callback:Ew}});function FU(i,t){const e=[],{bounds:s,step:r,min:o,max:a,precision:l,count:h,maxTicks:c,maxDigits:u,includeBounds:f}=i,d=r||1,g=c-1,{min:p,max:y}=t,_=!$e(o),x=!$e(a),b=!$e(h),L=(y-p)/(u+1);let M=yb((y-p)/g/d)*d,k,A,T,F;if(M<1e-14&&!_&&!x)return[{value:p},{value:y}];F=Math.ceil(y/M)-Math.floor(p/M),F>g&&(M=yb(F*M/g/d)*d),$e(l)||(k=Math.pow(10,l),M=Math.ceil(M*k)/k),s==="ticks"?(A=Math.floor(p/M)*M,T=Math.ceil(y/M)*M):(A=p,T=y),_&&x&&r&&A9((a-o)/r,M/1e3)?(F=Math.round(Math.min((a-o)/M,c)),M=(a-o)/F,A=o,T=a):b?(A=_?o:A,T=x?a:T,F=h-1,M=(T-A)/F):(F=(T-A)/M,Rd(F,Math.round(F),M/1e3)?F=Math.round(F):F=Math.ceil(F));const q=Math.max(vb(M),vb(A));k=Math.pow(10,$e(l)?q:l),A=Math.round(A*k)/k,T=Math.round(T*k)/k;let R=0;for(_&&(f&&A!==o?(e.push({value:o}),A<o&&R++,Rd(Math.round((A+R*M)*k)/k,o,Cw(o,L,i))&&R++):A<o&&R++);R<F;++R){const S=Math.round((A+R*M)*k)/k;if(x&&S>a)break;e.push({value:S})}return x&&f&&T!==a?e.length&&Rd(e[e.length-1].value,a,Cw(a,L,i))?e[e.length-1].value=a:e.push({value:a}):(!x||T===a)&&e.push({value:T}),e}function Cw(i,t,{horizontal:e,minRotation:n}){const s=Cr(n),r=(e?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+i).length;return Math.min(t/r,o)}class T0 extends hh{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return $e(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this;const o=l=>s=e?s:l,a=l=>r=n?r:l;if(t){const l=oo(s),h=oo(r);l<0&&h<0?a(0):l>0&&h>0&&o(0)}if(s===r){let l=r===0?1:Math.abs(r*.05);a(r+l),t||o(s-l)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:n}=t,s;return n?(s=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const s={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=FU(s,r);return t.bounds==="ticks"&&yL(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const s=(n-e)/Math.max(t.length-1,1)/2;e-=s,n+=s}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return Ff(t,this.chart.options.locale,this.options.ticks.format)}}class vy extends T0{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Oi(t)?t:0,this.max=Oi(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=Cr(this.options.ticks.minRotation),s=(t?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Vt(vy,"id","linear"),Vt(vy,"defaults",{ticks:{callback:cm.formatters.numeric}});const df=i=>Math.floor(Na(i)),xl=(i,t)=>Math.pow(10,df(i)+t);function Lw(i){return i/Math.pow(10,df(i))===1}function Mw(i,t,e){const n=Math.pow(10,e),s=Math.floor(i/n);return Math.ceil(t/n)-s}function OU(i,t){const e=t-i;let n=df(e);for(;Mw(i,t,n)>10;)n++;for(;Mw(i,t,n)<10;)n--;return Math.min(n,df(i))}function DU(i,{min:t,max:e}){t=Fs(i.min,t);const n=[],s=df(t);let r=OU(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),l=s>r?Math.pow(10,s):0,h=Math.round((t-l)*o)/o,c=Math.floor((t-l)/a/10)*a*10;let u=Math.floor((h-c)/Math.pow(10,r)),f=Fs(i.min,Math.round((l+c+u*Math.pow(10,r))*o)/o);for(;f<e;)n.push({value:f,major:Lw(f),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(r++,u=2,o=r>=0?1:o),f=Math.round((l+c+u*Math.pow(10,r))*o)/o;const d=Fs(i.max,f);return n.push({value:d,major:Lw(d),significand:u}),n}class xy extends hh{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=T0.prototype.parse.apply(this,[t,e]);if(n===0){this._zero=!0;return}return Oi(n)&&n>0?n:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Oi(t)?Math.max(0,t):null,this.max=Oi(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Oi(this._userMin)&&(this.min=t===xl(this.min,0)?xl(this.min,-1):xl(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,s=this.max;const r=a=>n=t?n:a,o=a=>s=e?s:a;n===s&&(n<=0?(r(1),o(10)):(r(xl(n,-1)),o(xl(s,1)))),n<=0&&r(xl(s,-1)),s<=0&&o(xl(n,1)),this.min=n,this.max=s}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},n=DU(e,this);return t.bounds==="ticks"&&yL(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(t){return t===void 0?"0":Ff(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Na(t),this._valueRange=Na(this.max)-Na(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Na(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}Vt(xy,"id","logarithmic"),Vt(xy,"defaults",{ticks:{callback:cm.formatters.logarithmic,major:{enabled:!0}}});function by(i){const t=i.ticks;if(t.display&&i.display){const e=Xn(t.backdropPadding);return Te(t.font&&t.font.size,Di.font.size)+e.height}return 0}function BU(i,t,e){return e=Mi(e)?e:[e],{w:H9(i,t.string,e),h:e.length*t.lineHeight}}function Tw(i,t,e,n,s){return i===n||i===s?{start:t-e/2,end:t+e/2}:i<n||i>s?{start:t-e,end:t}:{start:t,end:t+e}}function jU(i){const t={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},e=Object.assign({},t),n=[],s=[],r=i._pointLabels.length,o=i.options.pointLabels,a=o.centerPointLabels?Li/r:0;for(let l=0;l<r;l++){const h=o.setContext(i.getPointLabelContext(l));s[l]=h.padding;const c=i.getPointPosition(l,i.drawingArea+s[l],a),u=fn(h.font),f=BU(i.ctx,u,i._pointLabels[l]);n[l]=f;const d=Os(i.getIndexAngle(l)+a),g=Math.round(hv(d)),p=Tw(g,c.x,f.w,0,180),y=Tw(g,c.y,f.h,90,270);zU(e,t,d,p,y)}i.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),i._pointLabelItems=WU(i,n,s)}function zU(i,t,e,n,s){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,l=0;n.start<t.l?(a=(t.l-n.start)/r,i.l=Math.min(i.l,t.l-a)):n.end>t.r&&(a=(n.end-t.r)/r,i.r=Math.max(i.r,t.r+a)),s.start<t.t?(l=(t.t-s.start)/o,i.t=Math.min(i.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/o,i.b=Math.max(i.b,t.b+l))}function GU(i,t,e){const n=i.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=e,l=i.getPointPosition(t,n+s+o,r),h=Math.round(hv(Os(l.angle+Ji))),c=HU(l.y,a.h,h),u=qU(h),f=VU(l.x,a.w,u);return{visible:!0,x:l.x,y:c,textAlign:u,left:f,top:c,right:f+a.w,bottom:c+a.h}}function UU(i,t){if(!t)return!0;const{left:e,top:n,right:s,bottom:r}=i;return!(Uo({x:e,y:n},t)||Uo({x:e,y:r},t)||Uo({x:s,y:n},t)||Uo({x:s,y:r},t))}function WU(i,t,e){const n=[],s=i._pointLabels.length,r=i.options,{centerPointLabels:o,display:a}=r.pointLabels,l={extra:by(r)/2,additionalAngle:o?Li/s:0};let h;for(let c=0;c<s;c++){l.padding=e[c],l.size=t[c];const u=GU(i,c,l);n.push(u),a==="auto"&&(u.visible=UU(u,h),u.visible&&(h=u))}return n}function qU(i){return i===0||i===180?"center":i<180?"left":"right"}function VU(i,t,e){return e==="right"?i-=t:e==="center"&&(i-=t/2),i}function HU(i,t,e){return e===90||e===270?i-=t/2:(e>270||e<90)&&(i-=t),i}function YU(i,t,e){const{left:n,top:s,right:r,bottom:o}=e,{backdropColor:a}=t;if(!$e(a)){const l=Bl(t.borderRadius),h=Xn(t.backdropPadding);i.fillStyle=a;const c=n-h.left,u=s-h.top,f=r-n+h.width,d=o-s+h.height;Object.values(l).some(g=>g!==0)?(i.beginPath(),cf(i,{x:c,y:u,w:f,h:d,radius:l}),i.fill()):i.fillRect(c,u,f,d)}}function XU(i,t){const{ctx:e,options:{pointLabels:n}}=i;for(let s=t-1;s>=0;s--){const r=i._pointLabelItems[s];if(!r.visible)continue;const o=n.setContext(i.getPointLabelContext(s));YU(e,o,r);const a=fn(o.font),{x:l,y:h,textAlign:c}=r;$l(e,i._pointLabels[s],l,h+a.lineHeight/2,a,{color:o.color,textAlign:c,textBaseline:"middle"})}}function l3(i,t,e,n){const{ctx:s}=i;if(e)s.arc(i.xCenter,i.yCenter,t,0,Ci);else{let r=i.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<n;o++)r=i.getPointPosition(o,t),s.lineTo(r.x,r.y)}}function $U(i,t,e,n,s){const r=i.ctx,o=t.circular,{color:a,lineWidth:l}=t;!o&&!n||!a||!l||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=l,r.setLineDash(s.dash),r.lineDashOffset=s.dashOffset,r.beginPath(),l3(i,e,o,n),r.closePath(),r.stroke(),r.restore())}function KU(i,t,e){return nl(i,{label:e,index:t,type:"pointLabel"})}class fd extends T0{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Xn(by(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=Oi(t)&&!isNaN(t)?t:0,this.max=Oi(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/by(this.options))}generateTickLabels(t){T0.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,n)=>{const s=yi(this.options.pointLabels.callback,[e,n],this);return s||s===0?s:""}).filter((e,n)=>this.chart.getDataVisibility(n))}fit(){const t=this.options;t.display&&t.pointLabels.display?jU(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,s))}getIndexAngle(t){const e=Ci/(this._pointLabels.length||1),n=this.options.startAngle||0;return Os(t*e+Cr(n))}getDistanceFromCenterForValue(t){if($e(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if($e(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return KU(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const s=this.getIndexAngle(t)-Ji+n;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:s,bottom:r}=this._pointLabelItems[t];return{left:e,top:n,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),l3(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:s,border:r}=e,o=this._pointLabels.length;let a,l,h;if(e.pointLabels.display&&XU(this,o),s.display&&this.ticks.forEach((c,u)=>{if(u!==0||u===0&&this.min<0){l=this.getDistanceFromCenterForValue(c.value);const f=this.getContext(u),d=s.setContext(f),g=r.setContext(f);$U(this,d,l,o,g)}}),n.display){for(t.save(),a=o-1;a>=0;a--){const c=n.setContext(this.getPointLabelContext(a)),{color:u,lineWidth:f}=c;!f||!u||(t.lineWidth=f,t.strokeStyle=u,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),h=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(h.x,h.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;const h=n.setContext(this.getContext(l)),c=fn(h.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),h.showLabelBackdrop){t.font=c.string,o=t.measureText(a.label).width,t.fillStyle=h.backdropColor;const u=Xn(h.backdropPadding);t.fillRect(-o/2-u.left,-r-c.size/2-u.top,o+u.width,c.size+u.height)}$l(t,a.label,0,-r,c,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),t.restore()}drawTitle(){}}Vt(fd,"id","radialLinear"),Vt(fd,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:cm.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),Vt(fd,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Vt(fd,"descriptors",{angleLines:{_fallback:"grid"}});const gm={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ws=Object.keys(gm);function Aw(i,t){return i-t}function Pw(i,t){if($e(t))return null;const e=i._adapter,{parser:n,round:s,isoWeekday:r}=i._parseOpts;let o=t;return typeof n=="function"&&(o=n(o)),Oi(o)||(o=typeof n=="string"?e.parse(o,n):e.parse(o)),o===null?null:(s&&(o=s==="week"&&(Hc(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,s)),+o)}function Iw(i,t,e,n){const s=ws.length;for(let r=ws.indexOf(i);r<s-1;++r){const o=gm[ws[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=n)return ws[r]}return ws[s-1]}function ZU(i,t,e,n,s){for(let r=ws.length-1;r>=ws.indexOf(e);r--){const o=ws[r];if(gm[o].common&&i._adapter.diff(s,n,o)>=t-1)return o}return ws[e?ws.indexOf(e):0]}function JU(i){for(let t=ws.indexOf(i)+1,e=ws.length;t<e;++t)if(gm[ws[t]].common)return ws[t]}function Rw(i,t,e){if(!e)i[t]=!0;else if(e.length){const{lo:n,hi:s}=cv(e,t),r=e[n]>=t?e[n]:e[s];i[r]=!0}}function QU(i,t,e,n){const s=i._adapter,r=+s.startOf(t[0].value,n),o=t[t.length-1].value;let a,l;for(a=r;a<=o;a=+s.add(a,1,n))l=e[a],l>=0&&(t[l].major=!0);return t}function Nw(i,t,e){const n=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,n.push({value:a,major:!1});return r===0||!e?n:QU(i,n,s,e)}class ff extends hh{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),s=this._adapter=new lz._date(t.adapters.date);s.init(e),Id(n.displayFormats,s.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Pw(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:s,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function l(h){!o&&!isNaN(h.min)&&(s=Math.min(s,h.min)),!a&&!isNaN(h.max)&&(r=Math.max(r,h.max))}(!o||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=Oi(s)&&!isNaN(s)?s:+e.startOf(Date.now(),n),r=Oi(r)&&!isNaN(r)?r:+e.endOf(Date.now(),n)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,s=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,o=this.max,a=N9(s,r,o);return this._unit=e.unit||(n.autoSkip?Iw(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):ZU(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:JU(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),Nw(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,n=0,s,r;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?e=1-s:e=(this.getDecimalForValue(t[1])-s)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?n=r:n=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=En(e,0,o),n=En(n,0,o),this._offsets={start:e,end:n,factor:1/(e+1+n)}}_generate(){const t=this._adapter,e=this.min,n=this.max,s=this.options,r=s.time,o=r.unit||Iw(r.minUnit,e,n,this._getLabelCapacity(e)),a=Te(s.ticks.stepSize,1),l=o==="week"?r.isoWeekday:!1,h=Hc(l)||l===!0,c={};let u=e,f,d;if(h&&(u=+t.startOf(u,"isoWeek",l)),u=+t.startOf(u,h?"day":o),t.diff(n,e,o)>1e5*a)throw new Error(e+" and "+n+" are too far apart with stepSize of "+a+" "+o);const g=s.ticks.source==="data"&&this.getDataTimestamps();for(f=u,d=0;f<n;f=+t.add(f,a,o),d++)Rw(c,f,g);return(f===n||s.bounds==="ticks"||d===1)&&Rw(c,f,g),Object.keys(c).sort(Aw).map(p=>+p)}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const s=this.options.time.displayFormats,r=this._unit,o=e||s[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,n,s){const r=this.options,o=r.ticks.callback;if(o)return yi(o,[t,e,n],this);const a=r.time.displayFormats,l=this._unit,h=this._majorUnit,c=l&&a[l],u=h&&a[h],f=n[e],d=h&&u&&f&&f.major;return this._adapter.format(t,s||(d?u:c))}generateTickLabels(t){let e,n,s;for(e=0,n=t.length;e<n;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,s=Cr(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:n*r+a*o,h:n*o+a*r}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,s=n[e.unit]||n.millisecond,r=this._tickFormatFunction(t,0,Nw(this,[t],this._majorUnit),s),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,n;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(e=0,n=s.length;e<n;++e)t=t.concat(s[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const s=this.getLabels();for(e=0,n=s.length;e<n;++e)t.push(Pw(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return bL(t.sort(Aw))}}Vt(ff,"id","time"),Vt(ff,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function pp(i,t,e){let n=0,s=i.length-1,r,o,a,l;e?(t>=i[n].pos&&t<=i[s].pos&&({lo:n,hi:s}=Go(i,"pos",t)),{pos:r,time:a}=i[n],{pos:o,time:l}=i[s]):(t>=i[n].time&&t<=i[s].time&&({lo:n,hi:s}=Go(i,"time",t)),{time:r,pos:a}=i[n],{time:o,pos:l}=i[s]);const h=o-r;return h?a+(l-a)*(t-r)/h:a}class wy extends ff{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=pp(e,this.min),this._tableRange=pp(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,s=[],r=[];let o,a,l,h,c;for(o=0,a=t.length;o<a;++o)h=t[o],h>=e&&h<=n&&s.push(h);if(s.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(o=0,a=s.length;o<a;++o)c=s[o+1],l=s[o-1],h=s[o],Math.round((c+l)/2)!==h&&r.push({time:h,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(e)||n.length===1)&&n.push(e),n.sort((s,r)=>s-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return e.length&&n.length?t=this.normalize(e.concat(n)):t=e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(pp(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return pp(this._table,n*this._tableRange+this._minPos,!0)}}Vt(wy,"id","timeseries"),Vt(wy,"defaults",ff.defaults);var tW=Object.freeze({__proto__:null,CategoryScale:yy,LinearScale:vy,LogarithmicScale:xy,RadialLinearScale:fd,TimeScale:ff,TimeSeriesScale:wy});const eW=[az,DG,IU,tW];Ca.register(...eW);var h3={exports:{}};(function(i,t){(function(e,n){n()})(Bo,function(){function e(h,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,c,u){var f=new XMLHttpRequest;f.open("GET",h),f.responseType="blob",f.onload=function(){l(f.response,c,u)},f.onerror=function(){console.error("could not download file")},f.send()}function s(h){var c=new XMLHttpRequest;c.open("HEAD",h,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function r(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(c)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Bo=="object"&&Bo.global===Bo?Bo:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(h,c,u){var f=o.URL||o.webkitURL,d=document.createElement("a");c=c||h.name||"download",d.download=c,d.rel="noopener",typeof h=="string"?(d.href=h,d.origin===location.origin?r(d):s(d.href)?n(h,c,u):r(d,d.target="_blank")):(d.href=f.createObjectURL(h),setTimeout(function(){f.revokeObjectURL(d.href)},4e4),setTimeout(function(){r(d)},0))}:"msSaveOrOpenBlob"in navigator?function(h,c,u){if(c=c||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(e(h,u),c);else if(s(h))n(h,c,u);else{var f=document.createElement("a");f.href=h,f.target="_blank",setTimeout(function(){r(f)})}}:function(h,c,u,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof h=="string")return n(h,c,u);var d=h.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||d&&g||a)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var b=y.result;b=p?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=b:location=b,f=null},y.readAsDataURL(h)}else{var _=o.URL||o.webkitURL,x=_.createObjectURL(h);f?f.location=x:location.href=x,f=null,setTimeout(function(){_.revokeObjectURL(x)},4e4)}});o.saveAs=l.saveAs=l,i.exports=l})})(h3);var iW=h3.exports;function mp(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var c3={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,t){(function(e){i.exports=e()})(function(){return function e(n,s,r){function o(h,c){if(!s[h]){if(!n[h]){var u=typeof mp=="function"&&mp;if(!c&&u)return u(h,!0);if(a)return a(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var d=s[h]={exports:{}};n[h][0].call(d.exports,function(g){var p=n[h][1][g];return o(p||g)},d,d.exports,e,n,s,r)}return s[h].exports}for(var a=typeof mp=="function"&&mp,l=0;l<r.length;l++)o(r[l]);return o}({1:[function(e,n,s){var r=e("./utils"),o=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var h,c,u,f,d,g,p,y=[],_=0,x=l.length,b=x,L=r.getTypeOf(l)!=="string";_<l.length;)b=x-_,u=L?(h=l[_++],c=_<x?l[_++]:0,_<x?l[_++]:0):(h=l.charCodeAt(_++),c=_<x?l.charCodeAt(_++):0,_<x?l.charCodeAt(_++):0),f=h>>2,d=(3&h)<<4|c>>4,g=1<b?(15&c)<<2|u>>6:64,p=2<b?63&u:64,y.push(a.charAt(f)+a.charAt(d)+a.charAt(g)+a.charAt(p));return y.join("")},s.decode=function(l){var h,c,u,f,d,g,p=0,y=0,_="data:";if(l.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var x,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&b--,l.charAt(l.length-2)===a.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=o.uint8array?new Uint8Array(0|b):new Array(0|b);p<l.length;)h=a.indexOf(l.charAt(p++))<<2|(f=a.indexOf(l.charAt(p++)))>>4,c=(15&f)<<4|(d=a.indexOf(l.charAt(p++)))>>2,u=(3&d)<<6|(g=a.indexOf(l.charAt(p++))),x[y++]=h,d!==64&&(x[y++]=c),g!==64&&(x[y++]=u);return x}},{"./support":30,"./utils":32}],2:[function(e,n,s){var r=e("./external"),o=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function h(c,u,f,d,g){this.compressedSize=c,this.uncompressedSize=u,this.crc32=f,this.compression=d,this.compressedContent=g}h.prototype={getContentWorker:function(){var c=new o(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),u=this;return c.on("end",function(){if(this.streamInfo.data_length!==u.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new o(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(c,u,f){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(u.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",u)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,s){var r=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,s){var r=e("./utils"),o=function(){for(var a,l=[],h=0;h<256;h++){a=h;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;l[h]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?r.getTypeOf(a)!=="string"?function(h,c,u,f){var d=o,g=f+u;h^=-1;for(var p=f;p<g;p++)h=h>>>8^d[255&(h^c[p])];return-1^h}(0|l,a,a.length,0):function(h,c,u,f){var d=o,g=f+u;h^=-1;for(var p=f;p<g;p++)h=h>>>8^d[255&(h^c.charCodeAt(p))];return-1^h}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(e,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,n,s){var r=null;r=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:r}},{lie:37}],7:[function(e,n,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),a=e("./utils"),l=e("./stream/GenericWorker"),h=r?"uint8array":"array";function c(u,f){l.call(this,"FlateWorker/"+u),this._pako=null,this._pakoAction=u,this._pakoOptions=f,this.meta={}}s.magic="\b\0",a.inherits(c,l),c.prototype.processChunk=function(u){this.meta=u.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(h,u.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var u=this;this._pako.onData=function(f){u.push({data:f,meta:u.meta})}},s.compressWorker=function(u){return new c("Deflate",u)},s.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,s){function r(d,g){var p,y="";for(p=0;p<g;p++)y+=String.fromCharCode(255&d),d>>>=8;return y}function o(d,g,p,y,_,x){var b,L,M=d.file,k=d.compression,A=x!==h.utf8encode,T=a.transformTo("string",x(M.name)),F=a.transformTo("string",h.utf8encode(M.name)),q=M.comment,R=a.transformTo("string",x(q)),S=a.transformTo("string",h.utf8encode(q)),O=F.length!==M.name.length,E=S.length!==q.length,U="",X="",Z="",st=M.dir,tt=M.date,ot={crc32:0,compressedSize:0,uncompressedSize:0};g&&!p||(ot.crc32=d.crc32,ot.compressedSize=d.compressedSize,ot.uncompressedSize=d.uncompressedSize);var et=0;g&&(et|=8),A||!O&&!E||(et|=2048);var P=0,H=0;st&&(P|=16),_==="UNIX"?(H=798,P|=function(K,ht){var ft=K;return K||(ft=ht?16893:33204),(65535&ft)<<16}(M.unixPermissions,st)):(H=20,P|=function(K){return 63&(K||0)}(M.dosPermissions)),b=tt.getUTCHours(),b<<=6,b|=tt.getUTCMinutes(),b<<=5,b|=tt.getUTCSeconds()/2,L=tt.getUTCFullYear()-1980,L<<=4,L|=tt.getUTCMonth()+1,L<<=5,L|=tt.getUTCDate(),O&&(X=r(1,1)+r(c(T),4)+F,U+="up"+r(X.length,2)+X),E&&(Z=r(1,1)+r(c(R),4)+S,U+="uc"+r(Z.length,2)+Z);var j="";return j+=`
\0`,j+=r(et,2),j+=k.magic,j+=r(b,2),j+=r(L,2),j+=r(ot.crc32,4),j+=r(ot.compressedSize,4),j+=r(ot.uncompressedSize,4),j+=r(T.length,2),j+=r(U.length,2),{fileRecord:u.LOCAL_FILE_HEADER+j+T+U,dirRecord:u.CENTRAL_FILE_HEADER+r(H,2)+j+r(R.length,2)+"\0\0\0\0"+r(P,4)+r(y,4)+T+U+R}}var a=e("../utils"),l=e("../stream/GenericWorker"),h=e("../utf8"),c=e("../crc32"),u=e("../signature");function f(d,g,p,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=p,this.encodeFileName=y,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(f,l),f.prototype.push=function(d){var g=d.meta.percent||0,p=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:p?(g+100*(p-y-1))/p:100}}))},f.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var g=this.streamFiles&&!d.file.dir;if(g){var p=o(d,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(d){this.accumulate=!1;var g=this.streamFiles&&!d.file.dir,p=o(d,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),g)this.push({data:function(y){return u.DATA_DESCRIPTOR+r(y.crc32,4)+r(y.compressedSize,4)+r(y.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var d=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var p=this.bytesWritten-d,y=function(_,x,b,L,M){var k=a.transformTo("string",M(L));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(_,2)+r(_,2)+r(x,4)+r(b,4)+r(k.length,2)+k}(this.dirRecords.length,p,d,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(d){this._sources.push(d);var g=this;return d.on("data",function(p){g.processChunk(p)}),d.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),d.on("error",function(p){g.error(p)}),this},f.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(d){var g=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var p=0;p<g.length;p++)try{g[p].error(d)}catch{}return!0},f.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,g=0;g<d.length;g++)d[g].lock()},n.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,s){var r=e("../compressions"),o=e("./ZipFileWorker");s.generateWorker=function(a,l,h){var c=new o(l.streamFiles,h,l.platform,l.encodeFileName),u=0;try{a.forEach(function(f,d){u++;var g=function(x,b){var L=x||b,M=r[L];if(!M)throw new Error(L+" is not a valid compression method !");return M}(d.options.compression,l.compression),p=d.options.compressionOptions||l.compressionOptions||{},y=d.dir,_=d.date;d._compressWorker(g,p).withStreamInfo("file",{name:f,dir:y,date:_,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(c)}),c.entriesCount=u}catch(f){c.error(f)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,s){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new r;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(o,a){return new r().loadAsync(o,a)},r.external=e("./external"),n.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,s){var r=e("./utils"),o=e("./external"),a=e("./utf8"),l=e("./zipEntries"),h=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function u(f){return new o.Promise(function(d,g){var p=f.decompressed.getContentWorker().pipe(new h);p.on("error",function(y){g(y)}).on("end",function(){p.streamInfo.crc32!==f.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(f,d){var g=this;return d=r.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(f)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",f,!0,d.optimizedBinaryString,d.base64).then(function(p){var y=new l(d);return y.load(p),y}).then(function(p){var y=[o.Promise.resolve(p)],_=p.files;if(d.checkCRC32)for(var x=0;x<_.length;x++)y.push(u(_[x]));return o.Promise.all(y)}).then(function(p){for(var y=p.shift(),_=y.files,x=0;x<_.length;x++){var b=_[x],L=b.fileNameStr,M=r.resolve(b.fileNameStr);g.file(M,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:d.createFolders}),b.dir||(g.file(M).unsafeOriginalName=L)}return y.zipComment.length&&(g.comment=y.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,s){var r=e("../utils"),o=e("../stream/GenericWorker");function a(l,h){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(h)}r.inherits(a,o),a.prototype._bindStream=function(l){var h=this;(this._stream=l).pause(),l.on("data",function(c){h.push({data:c,meta:{percent:0}})}).on("error",function(c){h.isPaused?this.generatedError=c:h.error(c)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,s){var r=e("readable-stream").Readable;function o(a,l,h){r.call(this,l),this._helper=a;var c=this;a.on("data",function(u,f){c.push(u)||c._helper.pause(),h&&h(f)}).on("error",function(u){c.emit("error",u)}).on("end",function(){c.push(null)})}e("../utils").inherits(o,r),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,o);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,o)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var o=new Buffer(r);return o.fill(0),o},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(e,n,s){function r(M,k,A){var T,F=a.getTypeOf(k),q=a.extend(A||{},c);q.date=q.date||new Date,q.compression!==null&&(q.compression=q.compression.toUpperCase()),typeof q.unixPermissions=="string"&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(M=_(M)),q.createFolders&&(T=y(M))&&x.call(this,T,!0);var R=F==="string"&&q.binary===!1&&q.base64===!1;A&&A.binary!==void 0||(q.binary=!R),(k instanceof u&&k.uncompressedSize===0||q.dir||!k||k.length===0)&&(q.base64=!1,q.binary=!0,k="",q.compression="STORE",F="string");var S=null;S=k instanceof u||k instanceof l?k:g.isNode&&g.isStream(k)?new p(M,k):a.prepareContent(M,k,q.binary,q.optimizedBinaryString,q.base64);var O=new f(M,S,q);this.files[M]=O}var o=e("./utf8"),a=e("./utils"),l=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),c=e("./defaults"),u=e("./compressedObject"),f=e("./zipObject"),d=e("./generate"),g=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),y=function(M){M.slice(-1)==="/"&&(M=M.substring(0,M.length-1));var k=M.lastIndexOf("/");return 0<k?M.substring(0,k):""},_=function(M){return M.slice(-1)!=="/"&&(M+="/"),M},x=function(M,k){return k=k!==void 0?k:c.createFolders,M=_(M),this.files[M]||r.call(this,M,null,{dir:!0,createFolders:k}),this.files[M]};function b(M){return Object.prototype.toString.call(M)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(M){var k,A,T;for(k in this.files)T=this.files[k],(A=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&M(A,T)},filter:function(M){var k=[];return this.forEach(function(A,T){M(A,T)&&k.push(T)}),k},file:function(M,k,A){if(arguments.length!==1)return M=this.root+M,r.call(this,M,k,A),this;if(b(M)){var T=M;return this.filter(function(q,R){return!R.dir&&T.test(q)})}var F=this.files[this.root+M];return F&&!F.dir?F:null},folder:function(M){if(!M)return this;if(b(M))return this.filter(function(F,q){return q.dir&&M.test(F)});var k=this.root+M,A=x.call(this,k),T=this.clone();return T.root=A.name,T},remove:function(M){M=this.root+M;var k=this.files[M];if(k||(M.slice(-1)!=="/"&&(M+="/"),k=this.files[M]),k&&!k.dir)delete this.files[M];else for(var A=this.filter(function(F,q){return q.name.slice(0,M.length)===M}),T=0;T<A.length;T++)delete this.files[A[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(M){var k,A={};try{if((A=a.extend(M||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");a.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var T=A.comment||this.comment||"";k=d.generateWorker(this,A,T)}catch(F){(k=new l("error")).error(F)}return new h(k,A.type||"string",A.mimeType)},generateAsync:function(M,k){return this.generateInternalStream(M).accumulate(k)},generateNodeStream:function(M,k){return(M=M||{}).type||(M.type="nodebuffer"),this.generateInternalStream(M).toNodejsStream(k)}};n.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,s){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,s){var r=e("./DataReader");function o(a){r.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}e("../utils").inherits(o,r),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),h=a.charCodeAt(1),c=a.charCodeAt(2),u=a.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===l&&this.data[f+1]===h&&this.data[f+2]===c&&this.data[f+3]===u)return f-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),h=a.charCodeAt(1),c=a.charCodeAt(2),u=a.charCodeAt(3),f=this.readData(4);return l===f[0]&&h===f[1]&&c===f[2]&&u===f[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,n,s){var r=e("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,h=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)h=(h<<8)+this.byteAt(l);return this.index+=a,h},readString:function(a){return r.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=o},{"../utils":32}],19:[function(e,n,s){var r=e("./Uint8ArrayReader");function o(a){r.call(this,a)}e("../utils").inherits(o,r),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,s){var r=e("./DataReader");function o(a){r.call(this,a)}e("../utils").inherits(o,r),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,n,s){var r=e("./ArrayReader");function o(a){r.call(this,a)}e("../utils").inherits(o,r),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,s){var r=e("../utils"),o=e("../support"),a=e("./ArrayReader"),l=e("./StringReader"),h=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");n.exports=function(u){var f=r.getTypeOf(u);return r.checkSupport(f),f!=="string"||o.uint8array?f==="nodebuffer"?new h(u):o.uint8array?new c(r.transformTo("uint8array",u)):new a(r.transformTo("array",u)):new l(u)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,s){var r=e("./GenericWorker"),o=e("../utils");function a(l){r.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,r),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,s){var r=e("./GenericWorker"),o=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,s){var r=e("../utils"),o=e("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}r.inherits(a,o),a.prototype.processChunk=function(l){if(l){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+l.data.length}o.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,s){var r=e("../utils"),o=e("./GenericWorker");function a(l){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){h.dataIsReady=!0,h.data=c,h.max=c&&c.length||0,h.type=r.getTypeOf(c),h.isPaused||h._tickAndRepeat()},function(c){h.error(c)})}r.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,h);break;case"uint8array":l=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":l=this.data.slice(this.index,h)}return this.index=h,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,s){function r(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=r},{}],29:[function(e,n,s){var r=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),l=e("../base64"),h=e("../support"),c=e("../external"),u=null;if(h.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(g,p){return new c.Promise(function(y,_){var x=[],b=g._internalType,L=g._outputType,M=g._mimeType;g.on("data",function(k,A){x.push(k),p&&p(A)}).on("error",function(k){x=[],_(k)}).on("end",function(){try{var k=function(A,T,F){switch(A){case"blob":return r.newBlob(r.transformTo("arraybuffer",T),F);case"base64":return l.encode(T);default:return r.transformTo(A,T)}}(L,function(A,T){var F,q=0,R=null,S=0;for(F=0;F<T.length;F++)S+=T[F].length;switch(A){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(R=new Uint8Array(S),F=0;F<T.length;F++)R.set(T[F],q),q+=T[F].length;return R;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+A+"'")}}(b,x),M);y(k)}catch(A){_(A)}x=[]}).resume()})}function d(g,p,y){var _=p;switch(p){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=p,this._mimeType=y,r.checkSupport(_),this._worker=g.pipe(new o(_)),g.lock()}catch(x){this._worker=new a("error"),this._worker.error(x)}}d.prototype={accumulate:function(g){return f(this,g)},on:function(g,p){var y=this;return g==="data"?this._worker.on(g,function(_){p.call(y,_.data,_.meta)}):this._worker.on(g,function(){r.delay(p,arguments,y)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var r=new ArrayBuffer(0);try{s.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(r),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,s){for(var r=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),l=e("./stream/GenericWorker"),h=new Array(256),c=0;c<256;c++)h[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;h[254]=h[254]=1;function u(){l.call(this,"utf-8 decode"),this.leftOver=null}function f(){l.call(this,"utf-8 encode")}s.utf8encode=function(d){return o.nodebuffer?a.newBufferFrom(d,"utf-8"):function(g){var p,y,_,x,b,L=g.length,M=0;for(x=0;x<L;x++)(64512&(y=g.charCodeAt(x)))==55296&&x+1<L&&(64512&(_=g.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(_-56320),x++),M+=y<128?1:y<2048?2:y<65536?3:4;for(p=o.uint8array?new Uint8Array(M):new Array(M),x=b=0;b<M;x++)(64512&(y=g.charCodeAt(x)))==55296&&x+1<L&&(64512&(_=g.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(_-56320),x++),y<128?p[b++]=y:(y<2048?p[b++]=192|y>>>6:(y<65536?p[b++]=224|y>>>12:(p[b++]=240|y>>>18,p[b++]=128|y>>>12&63),p[b++]=128|y>>>6&63),p[b++]=128|63&y);return p}(d)},s.utf8decode=function(d){return o.nodebuffer?r.transformTo("nodebuffer",d).toString("utf-8"):function(g){var p,y,_,x,b=g.length,L=new Array(2*b);for(p=y=0;p<b;)if((_=g[p++])<128)L[y++]=_;else if(4<(x=h[_]))L[y++]=65533,p+=x-1;else{for(_&=x===2?31:x===3?15:7;1<x&&p<b;)_=_<<6|63&g[p++],x--;1<x?L[y++]=65533:_<65536?L[y++]=_:(_-=65536,L[y++]=55296|_>>10&1023,L[y++]=56320|1023&_)}return L.length!==y&&(L.subarray?L=L.subarray(0,y):L.length=y),r.applyFromCharCode(L)}(d=r.transformTo(o.uint8array?"uint8array":"array",d))},r.inherits(u,l),u.prototype.processChunk=function(d){var g=r.transformTo(o.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var p=g;(g=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),g.set(p,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var y=function(x,b){var L;for((b=b||x.length)>x.length&&(b=x.length),L=b-1;0<=L&&(192&x[L])==128;)L--;return L<0||L===0?b:L+h[x[L]]>b?L:b}(g),_=g;y!==g.length&&(o.uint8array?(_=g.subarray(0,y),this.leftOver=g.subarray(y,g.length)):(_=g.slice(0,y),this.leftOver=g.slice(y,g.length))),this.push({data:s.utf8decode(_),meta:d.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=u,r.inherits(f,l),f.prototype.processChunk=function(d){this.push({data:s.utf8encode(d.data),meta:d.meta})},s.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,s){var r=e("./support"),o=e("./base64"),a=e("./nodejsUtils"),l=e("./external");function h(p){return p}function c(p,y){for(var _=0;_<p.length;++_)y[_]=255&p.charCodeAt(_);return y}e("setimmediate"),s.newBlob=function(p,y){s.checkSupport("blob");try{return new Blob([p],{type:y})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(p),_.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(p,y,_){var x=[],b=0,L=p.length;if(L<=_)return String.fromCharCode.apply(null,p);for(;b<L;)y==="array"||y==="nodebuffer"?x.push(String.fromCharCode.apply(null,p.slice(b,Math.min(b+_,L)))):x.push(String.fromCharCode.apply(null,p.subarray(b,Math.min(b+_,L)))),b+=_;return x.join("")},stringifyByChar:function(p){for(var y="",_=0;_<p.length;_++)y+=String.fromCharCode(p[_]);return y},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function f(p){var y=65536,_=s.getTypeOf(p),x=!0;if(_==="uint8array"?x=u.applyCanBeUsed.uint8array:_==="nodebuffer"&&(x=u.applyCanBeUsed.nodebuffer),x)for(;1<y;)try{return u.stringifyByChunk(p,_,y)}catch{y=Math.floor(y/2)}return u.stringifyByChar(p)}function d(p,y){for(var _=0;_<p.length;_++)y[_]=p[_];return y}s.applyFromCharCode=f;var g={};g.string={string:h,array:function(p){return c(p,new Array(p.length))},arraybuffer:function(p){return g.string.uint8array(p).buffer},uint8array:function(p){return c(p,new Uint8Array(p.length))},nodebuffer:function(p){return c(p,a.allocBuffer(p.length))}},g.array={string:f,array:h,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(p)}},g.arraybuffer={string:function(p){return f(new Uint8Array(p))},array:function(p){return d(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:h,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return a.newBufferFrom(new Uint8Array(p))}},g.uint8array={string:f,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:h,nodebuffer:function(p){return a.newBufferFrom(p)}},g.nodebuffer={string:f,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return g.nodebuffer.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:h},s.transformTo=function(p,y){if(y=y||"",!p)return y;s.checkSupport(p);var _=s.getTypeOf(y);return g[_][p](y)},s.resolve=function(p){for(var y=p.split("/"),_=[],x=0;x<y.length;x++){var b=y[x];b==="."||b===""&&x!==0&&x!==y.length-1||(b===".."?_.pop():_.push(b))}return _.join("/")},s.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":r.nodebuffer&&a.isBuffer(p)?"nodebuffer":r.uint8array&&p instanceof Uint8Array?"uint8array":r.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(p){if(!r[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(p){var y,_,x="";for(_=0;_<(p||"").length;_++)x+="\\x"+((y=p.charCodeAt(_))<16?"0":"")+y.toString(16).toUpperCase();return x},s.delay=function(p,y,_){setImmediate(function(){p.apply(_||null,y||[])})},s.inherits=function(p,y){function _(){}_.prototype=y.prototype,p.prototype=new _},s.extend=function(){var p,y,_={};for(p=0;p<arguments.length;p++)for(y in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],y)&&_[y]===void 0&&(_[y]=arguments[p][y]);return _},s.prepareContent=function(p,y,_,x,b){return l.Promise.resolve(y).then(function(L){return r.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1)&&typeof FileReader<"u"?new l.Promise(function(M,k){var A=new FileReader;A.onload=function(T){M(T.target.result)},A.onerror=function(T){k(T.target.error)},A.readAsArrayBuffer(L)}):L}).then(function(L){var M=s.getTypeOf(L);return M?(M==="arraybuffer"?L=s.transformTo("uint8array",L):M==="string"&&(b?L=o.decode(L):_&&x!==!0&&(L=function(k){return c(k,r.uint8array?new Uint8Array(k.length):new Array(k.length))}(L))),L):l.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,s){var r=e("./reader/readerFor"),o=e("./utils"),a=e("./signature"),l=e("./zipEntry"),h=e("./support");function c(u){this.files=[],this.loadOptions=u}c.prototype={checkSignature:function(u){if(!this.reader.readAndCheckSignature(u)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(f)+", expected "+o.pretty(u)+")")}},isSignature:function(u,f){var d=this.reader.index;this.reader.setIndex(u);var g=this.reader.readString(4)===f;return this.reader.setIndex(d),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var u=this.reader.readData(this.zipCommentLength),f=h.uint8array?"uint8array":"array",d=o.transformTo(f,u);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var u,f,d,g=this.zip64EndOfCentralSize-44;0<g;)u=this.reader.readInt(2),f=this.reader.readInt(4),d=this.reader.readData(f),this.zip64ExtensibleData[u]={id:u,length:f,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var u,f;for(u=0;u<this.files.length;u++)f=this.files[u],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var u;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(u=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(u);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var u=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(u<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(u);var f=u;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(u=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(u),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var g=f-d;if(0<g)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(u){this.reader=r(u)},load:function(u){this.prepareReader(u),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,s){var r=e("./reader/readerFor"),o=e("./utils"),a=e("./compressedObject"),l=e("./crc32"),h=e("./utf8"),c=e("./compressions"),u=e("./support");function f(d,g){this.options=d,this.loadOptions=g}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var g,p;if(d.skip(22),this.fileNameLength=d.readInt(2),p=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(y){for(var _ in c)if(Object.prototype.hasOwnProperty.call(c,_)&&c[_].magic===y)return c[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var g=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(g),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=r(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var g,p,y,_=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<_;)g=d.readInt(2),p=d.readInt(2),y=d.readData(p),this.extraFields[g]={id:g,length:p,value:y};d.setIndex(_)},handleUTF8:function(){var d=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var p=o.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var _=o.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var g=r(d.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:h.utf8decode(g.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var g=r(d.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:h.utf8decode(g.readData(d.length-5))}return null}},n.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,s){function r(g,p,y){this.name=g,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=p,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),l=e("./utf8"),h=e("./compressedObject"),c=e("./stream/GenericWorker");r.prototype={internalStream:function(g){var p=null,y="string";try{if(!g)throw new Error("No output type specified.");var _=(y=g.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),p=this._decompressWorker();var x=!this._dataBinary;x&&!_&&(p=p.pipe(new l.Utf8EncodeWorker)),!x&&_&&(p=p.pipe(new l.Utf8DecodeWorker))}catch(b){(p=new c("error")).error(b)}return new o(p,y,"")},async:function(g,p){return this.internalStream(g).accumulate(p)},nodeStream:function(g,p){return this.internalStream(g||"nodebuffer").toNodejsStream(p)},_compressWorker:function(g,p){if(this._data instanceof h&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),h.createWorkerFrom(y,g,p)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)r.prototype[u[d]]=f;n.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,s){(function(r){var o,a,l=r.MutationObserver||r.WebKitMutationObserver;if(l){var h=0,c=new l(g),u=r.document.createTextNode("");c.observe(u,{characterData:!0}),o=function(){u.data=h=++h%2}}else if(r.setImmediate||r.MessageChannel===void 0)o="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var p=r.document.createElement("script");p.onreadystatechange=function(){g(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},r.document.documentElement.appendChild(p)}:function(){setTimeout(g,0)};else{var f=new r.MessageChannel;f.port1.onmessage=g,o=function(){f.port2.postMessage(0)}}var d=[];function g(){var p,y;a=!0;for(var _=d.length;_;){for(y=d,d=[],p=-1;++p<_;)y[p]();_=d.length}a=!1}n.exports=function(p){d.push(p)!==1||a||o()}}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,s){var r=e("immediate");function o(){}var a={},l=["REJECTED"],h=["FULFILLED"],c=["PENDING"];function u(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,_!==o&&p(this,_)}function f(_,x,b){this.promise=_,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function d(_,x,b){r(function(){var L;try{L=x(b)}catch(M){return a.reject(_,M)}L===_?a.reject(_,new TypeError("Cannot resolve promise with itself")):a.resolve(_,L)})}function g(_){var x=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof x=="function")return function(){x.apply(_,arguments)}}function p(_,x){var b=!1;function L(A){b||(b=!0,a.reject(_,A))}function M(A){b||(b=!0,a.resolve(_,A))}var k=y(function(){x(M,L)});k.status==="error"&&L(k.value)}function y(_,x){var b={};try{b.value=_(x),b.status="success"}catch(L){b.status="error",b.value=L}return b}(n.exports=u).prototype.finally=function(_){if(typeof _!="function")return this;var x=this.constructor;return this.then(function(b){return x.resolve(_()).then(function(){return b})},function(b){return x.resolve(_()).then(function(){throw b})})},u.prototype.catch=function(_){return this.then(null,_)},u.prototype.then=function(_,x){if(typeof _!="function"&&this.state===h||typeof x!="function"&&this.state===l)return this;var b=new this.constructor(o);return this.state!==c?d(b,this.state===h?_:x,this.outcome):this.queue.push(new f(b,_,x)),b},f.prototype.callFulfilled=function(_){a.resolve(this.promise,_)},f.prototype.otherCallFulfilled=function(_){d(this.promise,this.onFulfilled,_)},f.prototype.callRejected=function(_){a.reject(this.promise,_)},f.prototype.otherCallRejected=function(_){d(this.promise,this.onRejected,_)},a.resolve=function(_,x){var b=y(g,x);if(b.status==="error")return a.reject(_,b.value);var L=b.value;if(L)p(_,L);else{_.state=h,_.outcome=x;for(var M=-1,k=_.queue.length;++M<k;)_.queue[M].callFulfilled(x)}return _},a.reject=function(_,x){_.state=l,_.outcome=x;for(var b=-1,L=_.queue.length;++b<L;)_.queue[b].callRejected(x);return _},u.resolve=function(_){return _ instanceof this?_:a.resolve(new this(o),_)},u.reject=function(_){var x=new this(o);return a.reject(x,_)},u.all=function(_){var x=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=_.length,L=!1;if(!b)return this.resolve([]);for(var M=new Array(b),k=0,A=-1,T=new this(o);++A<b;)F(_[A],A);return T;function F(q,R){x.resolve(q).then(function(S){M[R]=S,++k!==b||L||(L=!0,a.resolve(T,M))},function(S){L||(L=!0,a.reject(T,S))})}},u.race=function(_){var x=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=_.length,L=!1;if(!b)return this.resolve([]);for(var M=-1,k=new this(o);++M<b;)A=_[M],x.resolve(A).then(function(T){L||(L=!0,a.resolve(k,T))},function(T){L||(L=!0,a.reject(k,T))});var A;return k}},{immediate:36}],38:[function(e,n,s){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,s){var r=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/messages"),h=e("./zlib/zstream"),c=Object.prototype.toString,u=0,f=-1,d=0,g=8;function p(_){if(!(this instanceof p))return new p(_);this.options=o.assign({level:f,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},_||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var b=r.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(b!==u)throw new Error(l[b]);if(x.header&&r.deflateSetHeader(this.strm,x.header),x.dictionary){var L;if(L=typeof x.dictionary=="string"?a.string2buf(x.dictionary):c.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(b=r.deflateSetDictionary(this.strm,L))!==u)throw new Error(l[b]);this._dict_set=!0}}function y(_,x){var b=new p(x);if(b.push(_,!0),b.err)throw b.msg||l[b.err];return b.result}p.prototype.push=function(_,x){var b,L,M=this.strm,k=this.options.chunkSize;if(this.ended)return!1;L=x===~~x?x:x===!0?4:0,typeof _=="string"?M.input=a.string2buf(_):c.call(_)==="[object ArrayBuffer]"?M.input=new Uint8Array(_):M.input=_,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new o.Buf8(k),M.next_out=0,M.avail_out=k),(b=r.deflate(M,L))!==1&&b!==u)return this.onEnd(b),!(this.ended=!0);M.avail_out!==0&&(M.avail_in!==0||L!==4&&L!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(M.output,M.next_out))):this.onData(o.shrinkBuf(M.output,M.next_out)))}while((0<M.avail_in||M.avail_out===0)&&b!==1);return L===4?(b=r.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u):L!==2||(this.onEnd(u),!(M.avail_out=0))},p.prototype.onData=function(_){this.chunks.push(_)},p.prototype.onEnd=function(_){_===u&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Deflate=p,s.deflate=y,s.deflateRaw=function(_,x){return(x=x||{}).raw=!0,y(_,x)},s.gzip=function(_,x){return(x=x||{}).gzip=!0,y(_,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,s){var r=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/constants"),h=e("./zlib/messages"),c=e("./zlib/zstream"),u=e("./zlib/gzheader"),f=Object.prototype.toString;function d(p){if(!(this instanceof d))return new d(p);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},p||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||p&&p.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=r.inflateInit2(this.strm,y.windowBits);if(_!==l.Z_OK)throw new Error(h[_]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function g(p,y){var _=new d(y);if(_.push(p,!0),_.err)throw _.msg||h[_.err];return _.result}d.prototype.push=function(p,y){var _,x,b,L,M,k,A=this.strm,T=this.options.chunkSize,F=this.options.dictionary,q=!1;if(this.ended)return!1;x=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof p=="string"?A.input=a.binstring2buf(p):f.call(p)==="[object ArrayBuffer]"?A.input=new Uint8Array(p):A.input=p,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new o.Buf8(T),A.next_out=0,A.avail_out=T),(_=r.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&F&&(k=typeof F=="string"?a.string2buf(F):f.call(F)==="[object ArrayBuffer]"?new Uint8Array(F):F,_=r.inflateSetDictionary(this.strm,k)),_===l.Z_BUF_ERROR&&q===!0&&(_=l.Z_OK,q=!1),_!==l.Z_STREAM_END&&_!==l.Z_OK)return this.onEnd(_),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&_!==l.Z_STREAM_END&&(A.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=a.utf8border(A.output,A.next_out),L=A.next_out-b,M=a.buf2string(A.output,b),A.next_out=L,A.avail_out=T-L,L&&o.arraySet(A.output,A.output,b,L,0),this.onData(M)):this.onData(o.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(q=!0)}while((0<A.avail_in||A.avail_out===0)&&_!==l.Z_STREAM_END);return _===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(_=r.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},s.Inflate=d,s.inflate=g,s.inflateRaw=function(p,y){return(y=y||{}).raw=!0,g(p,y)},s.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var c=h.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var u in c)c.hasOwnProperty(u)&&(l[u]=c[u])}}return l},s.shrinkBuf=function(l,h){return l.length===h?l:l.subarray?l.subarray(0,h):(l.length=h,l)};var o={arraySet:function(l,h,c,u,f){if(h.subarray&&l.subarray)l.set(h.subarray(c,c+u),f);else for(var d=0;d<u;d++)l[f+d]=h[c+d]},flattenChunks:function(l){var h,c,u,f,d,g;for(h=u=0,c=l.length;h<c;h++)u+=l[h].length;for(g=new Uint8Array(u),h=f=0,c=l.length;h<c;h++)d=l[h],g.set(d,f),f+=d.length;return g}},a={arraySet:function(l,h,c,u,f){for(var d=0;d<u;d++)l[f+d]=h[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(r)},{}],42:[function(e,n,s){var r=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new r.Buf8(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function c(u,f){if(f<65537&&(u.subarray&&a||!u.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(u,f));for(var d="",g=0;g<f;g++)d+=String.fromCharCode(u[g]);return d}l[254]=l[254]=1,s.string2buf=function(u){var f,d,g,p,y,_=u.length,x=0;for(p=0;p<_;p++)(64512&(d=u.charCodeAt(p)))==55296&&p+1<_&&(64512&(g=u.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(g-56320),p++),x+=d<128?1:d<2048?2:d<65536?3:4;for(f=new r.Buf8(x),p=y=0;y<x;p++)(64512&(d=u.charCodeAt(p)))==55296&&p+1<_&&(64512&(g=u.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(g-56320),p++),d<128?f[y++]=d:(d<2048?f[y++]=192|d>>>6:(d<65536?f[y++]=224|d>>>12:(f[y++]=240|d>>>18,f[y++]=128|d>>>12&63),f[y++]=128|d>>>6&63),f[y++]=128|63&d);return f},s.buf2binstring=function(u){return c(u,u.length)},s.binstring2buf=function(u){for(var f=new r.Buf8(u.length),d=0,g=f.length;d<g;d++)f[d]=u.charCodeAt(d);return f},s.buf2string=function(u,f){var d,g,p,y,_=f||u.length,x=new Array(2*_);for(d=g=0;d<_;)if((p=u[d++])<128)x[g++]=p;else if(4<(y=l[p]))x[g++]=65533,d+=y-1;else{for(p&=y===2?31:y===3?15:7;1<y&&d<_;)p=p<<6|63&u[d++],y--;1<y?x[g++]=65533:p<65536?x[g++]=p:(p-=65536,x[g++]=55296|p>>10&1023,x[g++]=56320|1023&p)}return c(x,g)},s.utf8border=function(u,f){var d;for((f=f||u.length)>u.length&&(f=u.length),d=f-1;0<=d&&(192&u[d])==128;)d--;return d<0||d===0?f:d+l[u[d]]>f?d:f}},{"./common":41}],43:[function(e,n,s){n.exports=function(r,o,a,l){for(var h=65535&r|0,c=r>>>16&65535|0,u=0;a!==0;){for(a-=u=2e3<a?2e3:a;c=c+(h=h+o[l++]|0)|0,--u;);h%=65521,c%=65521}return h|c<<16|0}},{}],44:[function(e,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,s){var r=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();n.exports=function(o,a,l,h){var c=r,u=h+l;o^=-1;for(var f=h;f<u;f++)o=o>>>8^c[255&(o^a[f])];return-1^o}},{}],46:[function(e,n,s){var r,o=e("../utils/common"),a=e("./trees"),l=e("./adler32"),h=e("./crc32"),c=e("./messages"),u=0,f=4,d=0,g=-2,p=-1,y=4,_=2,x=8,b=9,L=286,M=30,k=19,A=2*L+1,T=15,F=3,q=258,R=q+F+1,S=42,O=113,E=1,U=2,X=3,Z=4;function st(N,rt){return N.msg=c[rt],rt}function tt(N){return(N<<1)-(4<N?9:0)}function ot(N){for(var rt=N.length;0<=--rt;)N[rt]=0}function et(N){var rt=N.state,z=rt.pending;z>N.avail_out&&(z=N.avail_out),z!==0&&(o.arraySet(N.output,rt.pending_buf,rt.pending_out,z,N.next_out),N.next_out+=z,rt.pending_out+=z,N.total_out+=z,N.avail_out-=z,rt.pending-=z,rt.pending===0&&(rt.pending_out=0))}function P(N,rt){a._tr_flush_block(N,0<=N.block_start?N.block_start:-1,N.strstart-N.block_start,rt),N.block_start=N.strstart,et(N.strm)}function H(N,rt){N.pending_buf[N.pending++]=rt}function j(N,rt){N.pending_buf[N.pending++]=rt>>>8&255,N.pending_buf[N.pending++]=255&rt}function K(N,rt){var z,J,Y=N.max_chain_length,it=N.strstart,pt=N.prev_length,vt=N.nice_match,at=N.strstart>N.w_size-R?N.strstart-(N.w_size-R):0,Et=N.window,It=N.w_mask,Ct=N.prev,jt=N.strstart+q,ie=Et[it+pt-1],te=Et[it+pt];N.prev_length>=N.good_match&&(Y>>=2),vt>N.lookahead&&(vt=N.lookahead);do if(Et[(z=rt)+pt]===te&&Et[z+pt-1]===ie&&Et[z]===Et[it]&&Et[++z]===Et[it+1]){it+=2,z++;do;while(Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&Et[++it]===Et[++z]&&it<jt);if(J=q-(jt-it),it=jt-q,pt<J){if(N.match_start=rt,vt<=(pt=J))break;ie=Et[it+pt-1],te=Et[it+pt]}}while((rt=Ct[rt&It])>at&&--Y!=0);return pt<=N.lookahead?pt:N.lookahead}function ht(N){var rt,z,J,Y,it,pt,vt,at,Et,It,Ct=N.w_size;do{if(Y=N.window_size-N.lookahead-N.strstart,N.strstart>=Ct+(Ct-R)){for(o.arraySet(N.window,N.window,Ct,Ct,0),N.match_start-=Ct,N.strstart-=Ct,N.block_start-=Ct,rt=z=N.hash_size;J=N.head[--rt],N.head[rt]=Ct<=J?J-Ct:0,--z;);for(rt=z=Ct;J=N.prev[--rt],N.prev[rt]=Ct<=J?J-Ct:0,--z;);Y+=Ct}if(N.strm.avail_in===0)break;if(pt=N.strm,vt=N.window,at=N.strstart+N.lookahead,Et=Y,It=void 0,It=pt.avail_in,Et<It&&(It=Et),z=It===0?0:(pt.avail_in-=It,o.arraySet(vt,pt.input,pt.next_in,It,at),pt.state.wrap===1?pt.adler=l(pt.adler,vt,It,at):pt.state.wrap===2&&(pt.adler=h(pt.adler,vt,It,at)),pt.next_in+=It,pt.total_in+=It,It),N.lookahead+=z,N.lookahead+N.insert>=F)for(it=N.strstart-N.insert,N.ins_h=N.window[it],N.ins_h=(N.ins_h<<N.hash_shift^N.window[it+1])&N.hash_mask;N.insert&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[it+F-1])&N.hash_mask,N.prev[it&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=it,it++,N.insert--,!(N.lookahead+N.insert<F)););}while(N.lookahead<R&&N.strm.avail_in!==0)}function ft(N,rt){for(var z,J;;){if(N.lookahead<R){if(ht(N),N.lookahead<R&&rt===u)return E;if(N.lookahead===0)break}if(z=0,N.lookahead>=F&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+F-1])&N.hash_mask,z=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),z!==0&&N.strstart-z<=N.w_size-R&&(N.match_length=K(N,z)),N.match_length>=F)if(J=a._tr_tally(N,N.strstart-N.match_start,N.match_length-F),N.lookahead-=N.match_length,N.match_length<=N.max_lazy_match&&N.lookahead>=F){for(N.match_length--;N.strstart++,N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+F-1])&N.hash_mask,z=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart,--N.match_length!=0;);N.strstart++}else N.strstart+=N.match_length,N.match_length=0,N.ins_h=N.window[N.strstart],N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+1])&N.hash_mask;else J=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++;if(J&&(P(N,!1),N.strm.avail_out===0))return E}return N.insert=N.strstart<F-1?N.strstart:F-1,rt===f?(P(N,!0),N.strm.avail_out===0?X:Z):N.last_lit&&(P(N,!1),N.strm.avail_out===0)?E:U}function gt(N,rt){for(var z,J,Y;;){if(N.lookahead<R){if(ht(N),N.lookahead<R&&rt===u)return E;if(N.lookahead===0)break}if(z=0,N.lookahead>=F&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+F-1])&N.hash_mask,z=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),N.prev_length=N.match_length,N.prev_match=N.match_start,N.match_length=F-1,z!==0&&N.prev_length<N.max_lazy_match&&N.strstart-z<=N.w_size-R&&(N.match_length=K(N,z),N.match_length<=5&&(N.strategy===1||N.match_length===F&&4096<N.strstart-N.match_start)&&(N.match_length=F-1)),N.prev_length>=F&&N.match_length<=N.prev_length){for(Y=N.strstart+N.lookahead-F,J=a._tr_tally(N,N.strstart-1-N.prev_match,N.prev_length-F),N.lookahead-=N.prev_length-1,N.prev_length-=2;++N.strstart<=Y&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+F-1])&N.hash_mask,z=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),--N.prev_length!=0;);if(N.match_available=0,N.match_length=F-1,N.strstart++,J&&(P(N,!1),N.strm.avail_out===0))return E}else if(N.match_available){if((J=a._tr_tally(N,0,N.window[N.strstart-1]))&&P(N,!1),N.strstart++,N.lookahead--,N.strm.avail_out===0)return E}else N.match_available=1,N.strstart++,N.lookahead--}return N.match_available&&(J=a._tr_tally(N,0,N.window[N.strstart-1]),N.match_available=0),N.insert=N.strstart<F-1?N.strstart:F-1,rt===f?(P(N,!0),N.strm.avail_out===0?X:Z):N.last_lit&&(P(N,!1),N.strm.avail_out===0)?E:U}function _t(N,rt,z,J,Y){this.good_length=N,this.max_lazy=rt,this.nice_length=z,this.max_chain=J,this.func=Y}function Pt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*A),this.dyn_dtree=new o.Buf16(2*(2*M+1)),this.bl_tree=new o.Buf16(2*(2*k+1)),ot(this.dyn_ltree),ot(this.dyn_dtree),ot(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(T+1),this.heap=new o.Buf16(2*L+1),ot(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*L+1),ot(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Tt(N){var rt;return N&&N.state?(N.total_in=N.total_out=0,N.data_type=_,(rt=N.state).pending=0,rt.pending_out=0,rt.wrap<0&&(rt.wrap=-rt.wrap),rt.status=rt.wrap?S:O,N.adler=rt.wrap===2?0:1,rt.last_flush=u,a._tr_init(rt),d):st(N,g)}function Wt(N){var rt=Tt(N);return rt===d&&function(z){z.window_size=2*z.w_size,ot(z.head),z.max_lazy_match=r[z.level].max_lazy,z.good_match=r[z.level].good_length,z.nice_match=r[z.level].nice_length,z.max_chain_length=r[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=F-1,z.match_available=0,z.ins_h=0}(N.state),rt}function Gt(N,rt,z,J,Y,it){if(!N)return g;var pt=1;if(rt===p&&(rt=6),J<0?(pt=0,J=-J):15<J&&(pt=2,J-=16),Y<1||b<Y||z!==x||J<8||15<J||rt<0||9<rt||it<0||y<it)return st(N,g);J===8&&(J=9);var vt=new Pt;return(N.state=vt).strm=N,vt.wrap=pt,vt.gzhead=null,vt.w_bits=J,vt.w_size=1<<vt.w_bits,vt.w_mask=vt.w_size-1,vt.hash_bits=Y+7,vt.hash_size=1<<vt.hash_bits,vt.hash_mask=vt.hash_size-1,vt.hash_shift=~~((vt.hash_bits+F-1)/F),vt.window=new o.Buf8(2*vt.w_size),vt.head=new o.Buf16(vt.hash_size),vt.prev=new o.Buf16(vt.w_size),vt.lit_bufsize=1<<Y+6,vt.pending_buf_size=4*vt.lit_bufsize,vt.pending_buf=new o.Buf8(vt.pending_buf_size),vt.d_buf=1*vt.lit_bufsize,vt.l_buf=3*vt.lit_bufsize,vt.level=rt,vt.strategy=it,vt.method=z,Wt(N)}r=[new _t(0,0,0,0,function(N,rt){var z=65535;for(z>N.pending_buf_size-5&&(z=N.pending_buf_size-5);;){if(N.lookahead<=1){if(ht(N),N.lookahead===0&&rt===u)return E;if(N.lookahead===0)break}N.strstart+=N.lookahead,N.lookahead=0;var J=N.block_start+z;if((N.strstart===0||N.strstart>=J)&&(N.lookahead=N.strstart-J,N.strstart=J,P(N,!1),N.strm.avail_out===0)||N.strstart-N.block_start>=N.w_size-R&&(P(N,!1),N.strm.avail_out===0))return E}return N.insert=0,rt===f?(P(N,!0),N.strm.avail_out===0?X:Z):(N.strstart>N.block_start&&(P(N,!1),N.strm.avail_out),E)}),new _t(4,4,8,4,ft),new _t(4,5,16,8,ft),new _t(4,6,32,32,ft),new _t(4,4,16,16,gt),new _t(8,16,32,32,gt),new _t(8,16,128,128,gt),new _t(8,32,128,256,gt),new _t(32,128,258,1024,gt),new _t(32,258,258,4096,gt)],s.deflateInit=function(N,rt){return Gt(N,rt,x,15,8,0)},s.deflateInit2=Gt,s.deflateReset=Wt,s.deflateResetKeep=Tt,s.deflateSetHeader=function(N,rt){return N&&N.state?N.state.wrap!==2?g:(N.state.gzhead=rt,d):g},s.deflate=function(N,rt){var z,J,Y,it;if(!N||!N.state||5<rt||rt<0)return N?st(N,g):g;if(J=N.state,!N.output||!N.input&&N.avail_in!==0||J.status===666&&rt!==f)return st(N,N.avail_out===0?-5:g);if(J.strm=N,z=J.last_flush,J.last_flush=rt,J.status===S)if(J.wrap===2)N.adler=0,H(J,31),H(J,139),H(J,8),J.gzhead?(H(J,(J.gzhead.text?1:0)+(J.gzhead.hcrc?2:0)+(J.gzhead.extra?4:0)+(J.gzhead.name?8:0)+(J.gzhead.comment?16:0)),H(J,255&J.gzhead.time),H(J,J.gzhead.time>>8&255),H(J,J.gzhead.time>>16&255),H(J,J.gzhead.time>>24&255),H(J,J.level===9?2:2<=J.strategy||J.level<2?4:0),H(J,255&J.gzhead.os),J.gzhead.extra&&J.gzhead.extra.length&&(H(J,255&J.gzhead.extra.length),H(J,J.gzhead.extra.length>>8&255)),J.gzhead.hcrc&&(N.adler=h(N.adler,J.pending_buf,J.pending,0)),J.gzindex=0,J.status=69):(H(J,0),H(J,0),H(J,0),H(J,0),H(J,0),H(J,J.level===9?2:2<=J.strategy||J.level<2?4:0),H(J,3),J.status=O);else{var pt=x+(J.w_bits-8<<4)<<8;pt|=(2<=J.strategy||J.level<2?0:J.level<6?1:J.level===6?2:3)<<6,J.strstart!==0&&(pt|=32),pt+=31-pt%31,J.status=O,j(J,pt),J.strstart!==0&&(j(J,N.adler>>>16),j(J,65535&N.adler)),N.adler=1}if(J.status===69)if(J.gzhead.extra){for(Y=J.pending;J.gzindex<(65535&J.gzhead.extra.length)&&(J.pending!==J.pending_buf_size||(J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),et(N),Y=J.pending,J.pending!==J.pending_buf_size));)H(J,255&J.gzhead.extra[J.gzindex]),J.gzindex++;J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),J.gzindex===J.gzhead.extra.length&&(J.gzindex=0,J.status=73)}else J.status=73;if(J.status===73)if(J.gzhead.name){Y=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),et(N),Y=J.pending,J.pending===J.pending_buf_size)){it=1;break}it=J.gzindex<J.gzhead.name.length?255&J.gzhead.name.charCodeAt(J.gzindex++):0,H(J,it)}while(it!==0);J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),it===0&&(J.gzindex=0,J.status=91)}else J.status=91;if(J.status===91)if(J.gzhead.comment){Y=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),et(N),Y=J.pending,J.pending===J.pending_buf_size)){it=1;break}it=J.gzindex<J.gzhead.comment.length?255&J.gzhead.comment.charCodeAt(J.gzindex++):0,H(J,it)}while(it!==0);J.gzhead.hcrc&&J.pending>Y&&(N.adler=h(N.adler,J.pending_buf,J.pending-Y,Y)),it===0&&(J.status=103)}else J.status=103;if(J.status===103&&(J.gzhead.hcrc?(J.pending+2>J.pending_buf_size&&et(N),J.pending+2<=J.pending_buf_size&&(H(J,255&N.adler),H(J,N.adler>>8&255),N.adler=0,J.status=O)):J.status=O),J.pending!==0){if(et(N),N.avail_out===0)return J.last_flush=-1,d}else if(N.avail_in===0&&tt(rt)<=tt(z)&&rt!==f)return st(N,-5);if(J.status===666&&N.avail_in!==0)return st(N,-5);if(N.avail_in!==0||J.lookahead!==0||rt!==u&&J.status!==666){var vt=J.strategy===2?function(at,Et){for(var It;;){if(at.lookahead===0&&(ht(at),at.lookahead===0)){if(Et===u)return E;break}if(at.match_length=0,It=a._tr_tally(at,0,at.window[at.strstart]),at.lookahead--,at.strstart++,It&&(P(at,!1),at.strm.avail_out===0))return E}return at.insert=0,Et===f?(P(at,!0),at.strm.avail_out===0?X:Z):at.last_lit&&(P(at,!1),at.strm.avail_out===0)?E:U}(J,rt):J.strategy===3?function(at,Et){for(var It,Ct,jt,ie,te=at.window;;){if(at.lookahead<=q){if(ht(at),at.lookahead<=q&&Et===u)return E;if(at.lookahead===0)break}if(at.match_length=0,at.lookahead>=F&&0<at.strstart&&(Ct=te[jt=at.strstart-1])===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]){ie=at.strstart+q;do;while(Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&Ct===te[++jt]&&jt<ie);at.match_length=q-(ie-jt),at.match_length>at.lookahead&&(at.match_length=at.lookahead)}if(at.match_length>=F?(It=a._tr_tally(at,1,at.match_length-F),at.lookahead-=at.match_length,at.strstart+=at.match_length,at.match_length=0):(It=a._tr_tally(at,0,at.window[at.strstart]),at.lookahead--,at.strstart++),It&&(P(at,!1),at.strm.avail_out===0))return E}return at.insert=0,Et===f?(P(at,!0),at.strm.avail_out===0?X:Z):at.last_lit&&(P(at,!1),at.strm.avail_out===0)?E:U}(J,rt):r[J.level].func(J,rt);if(vt!==X&&vt!==Z||(J.status=666),vt===E||vt===X)return N.avail_out===0&&(J.last_flush=-1),d;if(vt===U&&(rt===1?a._tr_align(J):rt!==5&&(a._tr_stored_block(J,0,0,!1),rt===3&&(ot(J.head),J.lookahead===0&&(J.strstart=0,J.block_start=0,J.insert=0))),et(N),N.avail_out===0))return J.last_flush=-1,d}return rt!==f?d:J.wrap<=0?1:(J.wrap===2?(H(J,255&N.adler),H(J,N.adler>>8&255),H(J,N.adler>>16&255),H(J,N.adler>>24&255),H(J,255&N.total_in),H(J,N.total_in>>8&255),H(J,N.total_in>>16&255),H(J,N.total_in>>24&255)):(j(J,N.adler>>>16),j(J,65535&N.adler)),et(N),0<J.wrap&&(J.wrap=-J.wrap),J.pending!==0?d:1)},s.deflateEnd=function(N){var rt;return N&&N.state?(rt=N.state.status)!==S&&rt!==69&&rt!==73&&rt!==91&&rt!==103&&rt!==O&&rt!==666?st(N,g):(N.state=null,rt===O?st(N,-3):d):g},s.deflateSetDictionary=function(N,rt){var z,J,Y,it,pt,vt,at,Et,It=rt.length;if(!N||!N.state||(it=(z=N.state).wrap)===2||it===1&&z.status!==S||z.lookahead)return g;for(it===1&&(N.adler=l(N.adler,rt,It,0)),z.wrap=0,It>=z.w_size&&(it===0&&(ot(z.head),z.strstart=0,z.block_start=0,z.insert=0),Et=new o.Buf8(z.w_size),o.arraySet(Et,rt,It-z.w_size,z.w_size,0),rt=Et,It=z.w_size),pt=N.avail_in,vt=N.next_in,at=N.input,N.avail_in=It,N.next_in=0,N.input=rt,ht(z);z.lookahead>=F;){for(J=z.strstart,Y=z.lookahead-(F-1);z.ins_h=(z.ins_h<<z.hash_shift^z.window[J+F-1])&z.hash_mask,z.prev[J&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=J,J++,--Y;);z.strstart=J,z.lookahead=F-1,ht(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=F-1,z.match_available=0,N.next_in=vt,N.input=at,N.avail_in=pt,z.wrap=it,d},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,s){n.exports=function(r,o){var a,l,h,c,u,f,d,g,p,y,_,x,b,L,M,k,A,T,F,q,R,S,O,E,U;a=r.state,l=r.next_in,E=r.input,h=l+(r.avail_in-5),c=r.next_out,U=r.output,u=c-(o-r.avail_out),f=c+(r.avail_out-257),d=a.dmax,g=a.wsize,p=a.whave,y=a.wnext,_=a.window,x=a.hold,b=a.bits,L=a.lencode,M=a.distcode,k=(1<<a.lenbits)-1,A=(1<<a.distbits)-1;t:do{b<15&&(x+=E[l++]<<b,b+=8,x+=E[l++]<<b,b+=8),T=L[x&k];e:for(;;){if(x>>>=F=T>>>24,b-=F,(F=T>>>16&255)===0)U[c++]=65535&T;else{if(!(16&F)){if(!(64&F)){T=L[(65535&T)+(x&(1<<F)-1)];continue e}if(32&F){a.mode=12;break t}r.msg="invalid literal/length code",a.mode=30;break t}q=65535&T,(F&=15)&&(b<F&&(x+=E[l++]<<b,b+=8),q+=x&(1<<F)-1,x>>>=F,b-=F),b<15&&(x+=E[l++]<<b,b+=8,x+=E[l++]<<b,b+=8),T=M[x&A];i:for(;;){if(x>>>=F=T>>>24,b-=F,!(16&(F=T>>>16&255))){if(!(64&F)){T=M[(65535&T)+(x&(1<<F)-1)];continue i}r.msg="invalid distance code",a.mode=30;break t}if(R=65535&T,b<(F&=15)&&(x+=E[l++]<<b,(b+=8)<F&&(x+=E[l++]<<b,b+=8)),d<(R+=x&(1<<F)-1)){r.msg="invalid distance too far back",a.mode=30;break t}if(x>>>=F,b-=F,(F=c-u)<R){if(p<(F=R-F)&&a.sane){r.msg="invalid distance too far back",a.mode=30;break t}if(O=_,(S=0)===y){if(S+=g-F,F<q){for(q-=F;U[c++]=_[S++],--F;);S=c-R,O=U}}else if(y<F){if(S+=g+y-F,(F-=y)<q){for(q-=F;U[c++]=_[S++],--F;);if(S=0,y<q){for(q-=F=y;U[c++]=_[S++],--F;);S=c-R,O=U}}}else if(S+=y-F,F<q){for(q-=F;U[c++]=_[S++],--F;);S=c-R,O=U}for(;2<q;)U[c++]=O[S++],U[c++]=O[S++],U[c++]=O[S++],q-=3;q&&(U[c++]=O[S++],1<q&&(U[c++]=O[S++]))}else{for(S=c-R;U[c++]=U[S++],U[c++]=U[S++],U[c++]=U[S++],2<(q-=3););q&&(U[c++]=U[S++],1<q&&(U[c++]=U[S++]))}break}}break}}while(l<h&&c<f);l-=q=b>>3,x&=(1<<(b-=q<<3))-1,r.next_in=l,r.next_out=c,r.avail_in=l<h?h-l+5:5-(l-h),r.avail_out=c<f?f-c+257:257-(c-f),a.hold=x,a.bits=b}},{}],49:[function(e,n,s){var r=e("../utils/common"),o=e("./adler32"),a=e("./crc32"),l=e("./inffast"),h=e("./inftrees"),c=1,u=2,f=0,d=-2,g=1,p=852,y=592;function _(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(S){var O;return S&&S.state?(O=S.state,S.total_in=S.total_out=O.total=0,S.msg="",O.wrap&&(S.adler=1&O.wrap),O.mode=g,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new r.Buf32(p),O.distcode=O.distdyn=new r.Buf32(y),O.sane=1,O.back=-1,f):d}function L(S){var O;return S&&S.state?((O=S.state).wsize=0,O.whave=0,O.wnext=0,b(S)):d}function M(S,O){var E,U;return S&&S.state?(U=S.state,O<0?(E=0,O=-O):(E=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?d:(U.window!==null&&U.wbits!==O&&(U.window=null),U.wrap=E,U.wbits=O,L(S))):d}function k(S,O){var E,U;return S?(U=new x,(S.state=U).window=null,(E=M(S,O))!==f&&(S.state=null),E):d}var A,T,F=!0;function q(S){if(F){var O;for(A=new r.Buf32(512),T=new r.Buf32(32),O=0;O<144;)S.lens[O++]=8;for(;O<256;)S.lens[O++]=9;for(;O<280;)S.lens[O++]=7;for(;O<288;)S.lens[O++]=8;for(h(c,S.lens,0,288,A,0,S.work,{bits:9}),O=0;O<32;)S.lens[O++]=5;h(u,S.lens,0,32,T,0,S.work,{bits:5}),F=!1}S.lencode=A,S.lenbits=9,S.distcode=T,S.distbits=5}function R(S,O,E,U){var X,Z=S.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new r.Buf8(Z.wsize)),U>=Z.wsize?(r.arraySet(Z.window,O,E-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(U<(X=Z.wsize-Z.wnext)&&(X=U),r.arraySet(Z.window,O,E-U,X,Z.wnext),(U-=X)?(r.arraySet(Z.window,O,E-U,U,0),Z.wnext=U,Z.whave=Z.wsize):(Z.wnext+=X,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=X))),0}s.inflateReset=L,s.inflateReset2=M,s.inflateResetKeep=b,s.inflateInit=function(S){return k(S,15)},s.inflateInit2=k,s.inflate=function(S,O){var E,U,X,Z,st,tt,ot,et,P,H,j,K,ht,ft,gt,_t,Pt,Tt,Wt,Gt,N,rt,z,J,Y=0,it=new r.Buf8(4),pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return d;(E=S.state).mode===12&&(E.mode=13),st=S.next_out,X=S.output,ot=S.avail_out,Z=S.next_in,U=S.input,tt=S.avail_in,et=E.hold,P=E.bits,H=tt,j=ot,rt=f;t:for(;;)switch(E.mode){case g:if(E.wrap===0){E.mode=13;break}for(;P<16;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(2&E.wrap&&et===35615){it[E.check=0]=255&et,it[1]=et>>>8&255,E.check=a(E.check,it,2,0),P=et=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&et)<<8)+(et>>8))%31){S.msg="incorrect header check",E.mode=30;break}if((15&et)!=8){S.msg="unknown compression method",E.mode=30;break}if(P-=4,N=8+(15&(et>>>=4)),E.wbits===0)E.wbits=N;else if(N>E.wbits){S.msg="invalid window size",E.mode=30;break}E.dmax=1<<N,S.adler=E.check=1,E.mode=512&et?10:12,P=et=0;break;case 2:for(;P<16;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(E.flags=et,(255&E.flags)!=8){S.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){S.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=et>>8&1),512&E.flags&&(it[0]=255&et,it[1]=et>>>8&255,E.check=a(E.check,it,2,0)),P=et=0,E.mode=3;case 3:for(;P<32;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.head&&(E.head.time=et),512&E.flags&&(it[0]=255&et,it[1]=et>>>8&255,it[2]=et>>>16&255,it[3]=et>>>24&255,E.check=a(E.check,it,4,0)),P=et=0,E.mode=4;case 4:for(;P<16;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.head&&(E.head.xflags=255&et,E.head.os=et>>8),512&E.flags&&(it[0]=255&et,it[1]=et>>>8&255,E.check=a(E.check,it,2,0)),P=et=0,E.mode=5;case 5:if(1024&E.flags){for(;P<16;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.length=et,E.head&&(E.head.extra_len=et),512&E.flags&&(it[0]=255&et,it[1]=et>>>8&255,E.check=a(E.check,it,2,0)),P=et=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(tt<(K=E.length)&&(K=tt),K&&(E.head&&(N=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),r.arraySet(E.head.extra,U,Z,K,N)),512&E.flags&&(E.check=a(E.check,U,K,Z)),tt-=K,Z+=K,E.length-=K),E.length))break t;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(tt===0)break t;for(K=0;N=U[Z+K++],E.head&&N&&E.length<65536&&(E.head.name+=String.fromCharCode(N)),N&&K<tt;);if(512&E.flags&&(E.check=a(E.check,U,K,Z)),tt-=K,Z+=K,N)break t}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(tt===0)break t;for(K=0;N=U[Z+K++],E.head&&N&&E.length<65536&&(E.head.comment+=String.fromCharCode(N)),N&&K<tt;);if(512&E.flags&&(E.check=a(E.check,U,K,Z)),tt-=K,Z+=K,N)break t}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;P<16;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(et!==(65535&E.check)){S.msg="header crc mismatch",E.mode=30;break}P=et=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),S.adler=E.check=0,E.mode=12;break;case 10:for(;P<32;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}S.adler=E.check=_(et),P=et=0,E.mode=11;case 11:if(E.havedict===0)return S.next_out=st,S.avail_out=ot,S.next_in=Z,S.avail_in=tt,E.hold=et,E.bits=P,2;S.adler=E.check=1,E.mode=12;case 12:if(O===5||O===6)break t;case 13:if(E.last){et>>>=7&P,P-=7&P,E.mode=27;break}for(;P<3;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}switch(E.last=1&et,P-=1,3&(et>>>=1)){case 0:E.mode=14;break;case 1:if(q(E),E.mode=20,O!==6)break;et>>>=2,P-=2;break t;case 2:E.mode=17;break;case 3:S.msg="invalid block type",E.mode=30}et>>>=2,P-=2;break;case 14:for(et>>>=7&P,P-=7&P;P<32;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if((65535&et)!=(et>>>16^65535)){S.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&et,P=et=0,E.mode=15,O===6)break t;case 15:E.mode=16;case 16:if(K=E.length){if(tt<K&&(K=tt),ot<K&&(K=ot),K===0)break t;r.arraySet(X,U,Z,K,st),tt-=K,Z+=K,ot-=K,st+=K,E.length-=K;break}E.mode=12;break;case 17:for(;P<14;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(E.nlen=257+(31&et),et>>>=5,P-=5,E.ndist=1+(31&et),et>>>=5,P-=5,E.ncode=4+(15&et),et>>>=4,P-=4,286<E.nlen||30<E.ndist){S.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;P<3;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.lens[pt[E.have++]]=7&et,et>>>=3,P-=3}for(;E.have<19;)E.lens[pt[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,z={bits:E.lenbits},rt=h(0,E.lens,0,19,E.lencode,0,E.work,z),E.lenbits=z.bits,rt){S.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;_t=(Y=E.lencode[et&(1<<E.lenbits)-1])>>>16&255,Pt=65535&Y,!((gt=Y>>>24)<=P);){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(Pt<16)et>>>=gt,P-=gt,E.lens[E.have++]=Pt;else{if(Pt===16){for(J=gt+2;P<J;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(et>>>=gt,P-=gt,E.have===0){S.msg="invalid bit length repeat",E.mode=30;break}N=E.lens[E.have-1],K=3+(3&et),et>>>=2,P-=2}else if(Pt===17){for(J=gt+3;P<J;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}P-=gt,N=0,K=3+(7&(et>>>=gt)),et>>>=3,P-=3}else{for(J=gt+7;P<J;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}P-=gt,N=0,K=11+(127&(et>>>=gt)),et>>>=7,P-=7}if(E.have+K>E.nlen+E.ndist){S.msg="invalid bit length repeat",E.mode=30;break}for(;K--;)E.lens[E.have++]=N}}if(E.mode===30)break;if(E.lens[256]===0){S.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,z={bits:E.lenbits},rt=h(c,E.lens,0,E.nlen,E.lencode,0,E.work,z),E.lenbits=z.bits,rt){S.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,z={bits:E.distbits},rt=h(u,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,z),E.distbits=z.bits,rt){S.msg="invalid distances set",E.mode=30;break}if(E.mode=20,O===6)break t;case 20:E.mode=21;case 21:if(6<=tt&&258<=ot){S.next_out=st,S.avail_out=ot,S.next_in=Z,S.avail_in=tt,E.hold=et,E.bits=P,l(S,j),st=S.next_out,X=S.output,ot=S.avail_out,Z=S.next_in,U=S.input,tt=S.avail_in,et=E.hold,P=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;_t=(Y=E.lencode[et&(1<<E.lenbits)-1])>>>16&255,Pt=65535&Y,!((gt=Y>>>24)<=P);){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(_t&&!(240&_t)){for(Tt=gt,Wt=_t,Gt=Pt;_t=(Y=E.lencode[Gt+((et&(1<<Tt+Wt)-1)>>Tt)])>>>16&255,Pt=65535&Y,!(Tt+(gt=Y>>>24)<=P);){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}et>>>=Tt,P-=Tt,E.back+=Tt}if(et>>>=gt,P-=gt,E.back+=gt,E.length=Pt,_t===0){E.mode=26;break}if(32&_t){E.back=-1,E.mode=12;break}if(64&_t){S.msg="invalid literal/length code",E.mode=30;break}E.extra=15&_t,E.mode=22;case 22:if(E.extra){for(J=E.extra;P<J;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.length+=et&(1<<E.extra)-1,et>>>=E.extra,P-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;_t=(Y=E.distcode[et&(1<<E.distbits)-1])>>>16&255,Pt=65535&Y,!((gt=Y>>>24)<=P);){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(!(240&_t)){for(Tt=gt,Wt=_t,Gt=Pt;_t=(Y=E.distcode[Gt+((et&(1<<Tt+Wt)-1)>>Tt)])>>>16&255,Pt=65535&Y,!(Tt+(gt=Y>>>24)<=P);){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}et>>>=Tt,P-=Tt,E.back+=Tt}if(et>>>=gt,P-=gt,E.back+=gt,64&_t){S.msg="invalid distance code",E.mode=30;break}E.offset=Pt,E.extra=15&_t,E.mode=24;case 24:if(E.extra){for(J=E.extra;P<J;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}E.offset+=et&(1<<E.extra)-1,et>>>=E.extra,P-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){S.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(ot===0)break t;if(K=j-ot,E.offset>K){if((K=E.offset-K)>E.whave&&E.sane){S.msg="invalid distance too far back",E.mode=30;break}ht=K>E.wnext?(K-=E.wnext,E.wsize-K):E.wnext-K,K>E.length&&(K=E.length),ft=E.window}else ft=X,ht=st-E.offset,K=E.length;for(ot<K&&(K=ot),ot-=K,E.length-=K;X[st++]=ft[ht++],--K;);E.length===0&&(E.mode=21);break;case 26:if(ot===0)break t;X[st++]=E.length,ot--,E.mode=21;break;case 27:if(E.wrap){for(;P<32;){if(tt===0)break t;tt--,et|=U[Z++]<<P,P+=8}if(j-=ot,S.total_out+=j,E.total+=j,j&&(S.adler=E.check=E.flags?a(E.check,X,j,st-j):o(E.check,X,j,st-j)),j=ot,(E.flags?et:_(et))!==E.check){S.msg="incorrect data check",E.mode=30;break}P=et=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;P<32;){if(tt===0)break t;tt--,et+=U[Z++]<<P,P+=8}if(et!==(4294967295&E.total)){S.msg="incorrect length check",E.mode=30;break}P=et=0}E.mode=29;case 29:rt=1;break t;case 30:rt=-3;break t;case 31:return-4;case 32:default:return d}return S.next_out=st,S.avail_out=ot,S.next_in=Z,S.avail_in=tt,E.hold=et,E.bits=P,(E.wsize||j!==S.avail_out&&E.mode<30&&(E.mode<27||O!==4))&&R(S,S.output,S.next_out,j-S.avail_out)?(E.mode=31,-4):(H-=S.avail_in,j-=S.avail_out,S.total_in+=H,S.total_out+=j,E.total+=j,E.wrap&&j&&(S.adler=E.check=E.flags?a(E.check,X,j,S.next_out-j):o(E.check,X,j,S.next_out-j)),S.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(H==0&&j===0||O===4)&&rt===f&&(rt=-5),rt)},s.inflateEnd=function(S){if(!S||!S.state)return d;var O=S.state;return O.window&&(O.window=null),S.state=null,f},s.inflateGetHeader=function(S,O){var E;return S&&S.state&&2&(E=S.state).wrap?((E.head=O).done=!1,f):d},s.inflateSetDictionary=function(S,O){var E,U=O.length;return S&&S.state?(E=S.state).wrap!==0&&E.mode!==11?d:E.mode===11&&o(1,O,U,0)!==E.check?-3:R(S,O,U,U)?(E.mode=31,-4):(E.havedict=1,f):d},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,s){var r=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,u,f,d,g,p,y,_){var x,b,L,M,k,A,T,F,q,R=_.bits,S=0,O=0,E=0,U=0,X=0,Z=0,st=0,tt=0,ot=0,et=0,P=null,H=0,j=new r.Buf16(16),K=new r.Buf16(16),ht=null,ft=0;for(S=0;S<=15;S++)j[S]=0;for(O=0;O<d;O++)j[u[f+O]]++;for(X=R,U=15;1<=U&&j[U]===0;U--);if(U<X&&(X=U),U===0)return g[p++]=20971520,g[p++]=20971520,_.bits=1,0;for(E=1;E<U&&j[E]===0;E++);for(X<E&&(X=E),S=tt=1;S<=15;S++)if(tt<<=1,(tt-=j[S])<0)return-1;if(0<tt&&(c===0||U!==1))return-1;for(K[1]=0,S=1;S<15;S++)K[S+1]=K[S]+j[S];for(O=0;O<d;O++)u[f+O]!==0&&(y[K[u[f+O]]++]=O);if(A=c===0?(P=ht=y,19):c===1?(P=o,H-=257,ht=a,ft-=257,256):(P=l,ht=h,-1),S=E,k=p,st=O=et=0,L=-1,M=(ot=1<<(Z=X))-1,c===1&&852<ot||c===2&&592<ot)return 1;for(;;){for(T=S-st,q=y[O]<A?(F=0,y[O]):y[O]>A?(F=ht[ft+y[O]],P[H+y[O]]):(F=96,0),x=1<<S-st,E=b=1<<Z;g[k+(et>>st)+(b-=x)]=T<<24|F<<16|q|0,b!==0;);for(x=1<<S-1;et&x;)x>>=1;if(x!==0?(et&=x-1,et+=x):et=0,O++,--j[S]==0){if(S===U)break;S=u[f+y[O]]}if(X<S&&(et&M)!==L){for(st===0&&(st=X),k+=E,tt=1<<(Z=S-st);Z+st<U&&!((tt-=j[Z+st])<=0);)Z++,tt<<=1;if(ot+=1<<Z,c===1&&852<ot||c===2&&592<ot)return 1;g[L=et&M]=X<<24|Z<<16|k-p|0}}return et!==0&&(g[k+et]=S-st<<24|64<<16|0),_.bits=X,0}},{"../utils/common":41}],51:[function(e,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,s){var r=e("../utils/common"),o=0,a=1;function l(Y){for(var it=Y.length;0<=--it;)Y[it]=0}var h=0,c=29,u=256,f=u+1+c,d=30,g=19,p=2*f+1,y=15,_=16,x=7,b=256,L=16,M=17,k=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(f+2));l(R);var S=new Array(2*d);l(S);var O=new Array(512);l(O);var E=new Array(256);l(E);var U=new Array(c);l(U);var X,Z,st,tt=new Array(d);function ot(Y,it,pt,vt,at){this.static_tree=Y,this.extra_bits=it,this.extra_base=pt,this.elems=vt,this.max_length=at,this.has_stree=Y&&Y.length}function et(Y,it){this.dyn_tree=Y,this.max_code=0,this.stat_desc=it}function P(Y){return Y<256?O[Y]:O[256+(Y>>>7)]}function H(Y,it){Y.pending_buf[Y.pending++]=255&it,Y.pending_buf[Y.pending++]=it>>>8&255}function j(Y,it,pt){Y.bi_valid>_-pt?(Y.bi_buf|=it<<Y.bi_valid&65535,H(Y,Y.bi_buf),Y.bi_buf=it>>_-Y.bi_valid,Y.bi_valid+=pt-_):(Y.bi_buf|=it<<Y.bi_valid&65535,Y.bi_valid+=pt)}function K(Y,it,pt){j(Y,pt[2*it],pt[2*it+1])}function ht(Y,it){for(var pt=0;pt|=1&Y,Y>>>=1,pt<<=1,0<--it;);return pt>>>1}function ft(Y,it,pt){var vt,at,Et=new Array(y+1),It=0;for(vt=1;vt<=y;vt++)Et[vt]=It=It+pt[vt-1]<<1;for(at=0;at<=it;at++){var Ct=Y[2*at+1];Ct!==0&&(Y[2*at]=ht(Et[Ct]++,Ct))}}function gt(Y){var it;for(it=0;it<f;it++)Y.dyn_ltree[2*it]=0;for(it=0;it<d;it++)Y.dyn_dtree[2*it]=0;for(it=0;it<g;it++)Y.bl_tree[2*it]=0;Y.dyn_ltree[2*b]=1,Y.opt_len=Y.static_len=0,Y.last_lit=Y.matches=0}function _t(Y){8<Y.bi_valid?H(Y,Y.bi_buf):0<Y.bi_valid&&(Y.pending_buf[Y.pending++]=Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0}function Pt(Y,it,pt,vt){var at=2*it,Et=2*pt;return Y[at]<Y[Et]||Y[at]===Y[Et]&&vt[it]<=vt[pt]}function Tt(Y,it,pt){for(var vt=Y.heap[pt],at=pt<<1;at<=Y.heap_len&&(at<Y.heap_len&&Pt(it,Y.heap[at+1],Y.heap[at],Y.depth)&&at++,!Pt(it,vt,Y.heap[at],Y.depth));)Y.heap[pt]=Y.heap[at],pt=at,at<<=1;Y.heap[pt]=vt}function Wt(Y,it,pt){var vt,at,Et,It,Ct=0;if(Y.last_lit!==0)for(;vt=Y.pending_buf[Y.d_buf+2*Ct]<<8|Y.pending_buf[Y.d_buf+2*Ct+1],at=Y.pending_buf[Y.l_buf+Ct],Ct++,vt===0?K(Y,at,it):(K(Y,(Et=E[at])+u+1,it),(It=A[Et])!==0&&j(Y,at-=U[Et],It),K(Y,Et=P(--vt),pt),(It=T[Et])!==0&&j(Y,vt-=tt[Et],It)),Ct<Y.last_lit;);K(Y,b,it)}function Gt(Y,it){var pt,vt,at,Et=it.dyn_tree,It=it.stat_desc.static_tree,Ct=it.stat_desc.has_stree,jt=it.stat_desc.elems,ie=-1;for(Y.heap_len=0,Y.heap_max=p,pt=0;pt<jt;pt++)Et[2*pt]!==0?(Y.heap[++Y.heap_len]=ie=pt,Y.depth[pt]=0):Et[2*pt+1]=0;for(;Y.heap_len<2;)Et[2*(at=Y.heap[++Y.heap_len]=ie<2?++ie:0)]=1,Y.depth[at]=0,Y.opt_len--,Ct&&(Y.static_len-=It[2*at+1]);for(it.max_code=ie,pt=Y.heap_len>>1;1<=pt;pt--)Tt(Y,Et,pt);for(at=jt;pt=Y.heap[1],Y.heap[1]=Y.heap[Y.heap_len--],Tt(Y,Et,1),vt=Y.heap[1],Y.heap[--Y.heap_max]=pt,Y.heap[--Y.heap_max]=vt,Et[2*at]=Et[2*pt]+Et[2*vt],Y.depth[at]=(Y.depth[pt]>=Y.depth[vt]?Y.depth[pt]:Y.depth[vt])+1,Et[2*pt+1]=Et[2*vt+1]=at,Y.heap[1]=at++,Tt(Y,Et,1),2<=Y.heap_len;);Y.heap[--Y.heap_max]=Y.heap[1],function(te,ee){var be,qt,bi,he,pn,We,Re=ee.dyn_tree,Rn=ee.max_code,Fe=ee.stat_desc.static_tree,Vs=ee.stat_desc.has_stree,ci=ee.stat_desc.extra_bits,tn=ee.stat_desc.extra_base,ji=ee.stat_desc.max_length,qe=0;for(he=0;he<=y;he++)te.bl_count[he]=0;for(Re[2*te.heap[te.heap_max]+1]=0,be=te.heap_max+1;be<p;be++)ji<(he=Re[2*Re[2*(qt=te.heap[be])+1]+1]+1)&&(he=ji,qe++),Re[2*qt+1]=he,Rn<qt||(te.bl_count[he]++,pn=0,tn<=qt&&(pn=ci[qt-tn]),We=Re[2*qt],te.opt_len+=We*(he+pn),Vs&&(te.static_len+=We*(Fe[2*qt+1]+pn)));if(qe!==0){do{for(he=ji-1;te.bl_count[he]===0;)he--;te.bl_count[he]--,te.bl_count[he+1]+=2,te.bl_count[ji]--,qe-=2}while(0<qe);for(he=ji;he!==0;he--)for(qt=te.bl_count[he];qt!==0;)Rn<(bi=te.heap[--be])||(Re[2*bi+1]!==he&&(te.opt_len+=(he-Re[2*bi+1])*Re[2*bi],Re[2*bi+1]=he),qt--)}}(Y,it),ft(Et,ie,Y.bl_count)}function N(Y,it,pt){var vt,at,Et=-1,It=it[1],Ct=0,jt=7,ie=4;for(It===0&&(jt=138,ie=3),it[2*(pt+1)+1]=65535,vt=0;vt<=pt;vt++)at=It,It=it[2*(vt+1)+1],++Ct<jt&&at===It||(Ct<ie?Y.bl_tree[2*at]+=Ct:at!==0?(at!==Et&&Y.bl_tree[2*at]++,Y.bl_tree[2*L]++):Ct<=10?Y.bl_tree[2*M]++:Y.bl_tree[2*k]++,Et=at,ie=(Ct=0)===It?(jt=138,3):at===It?(jt=6,3):(jt=7,4))}function rt(Y,it,pt){var vt,at,Et=-1,It=it[1],Ct=0,jt=7,ie=4;for(It===0&&(jt=138,ie=3),vt=0;vt<=pt;vt++)if(at=It,It=it[2*(vt+1)+1],!(++Ct<jt&&at===It)){if(Ct<ie)for(;K(Y,at,Y.bl_tree),--Ct!=0;);else at!==0?(at!==Et&&(K(Y,at,Y.bl_tree),Ct--),K(Y,L,Y.bl_tree),j(Y,Ct-3,2)):Ct<=10?(K(Y,M,Y.bl_tree),j(Y,Ct-3,3)):(K(Y,k,Y.bl_tree),j(Y,Ct-11,7));Et=at,ie=(Ct=0)===It?(jt=138,3):at===It?(jt=6,3):(jt=7,4)}}l(tt);var z=!1;function J(Y,it,pt,vt){j(Y,(h<<1)+(vt?1:0),3),function(at,Et,It,Ct){_t(at),H(at,It),H(at,~It),r.arraySet(at.pending_buf,at.window,Et,It,at.pending),at.pending+=It}(Y,it,pt)}s._tr_init=function(Y){z||(function(){var it,pt,vt,at,Et,It=new Array(y+1);for(at=vt=0;at<c-1;at++)for(U[at]=vt,it=0;it<1<<A[at];it++)E[vt++]=at;for(E[vt-1]=at,at=Et=0;at<16;at++)for(tt[at]=Et,it=0;it<1<<T[at];it++)O[Et++]=at;for(Et>>=7;at<d;at++)for(tt[at]=Et<<7,it=0;it<1<<T[at]-7;it++)O[256+Et++]=at;for(pt=0;pt<=y;pt++)It[pt]=0;for(it=0;it<=143;)R[2*it+1]=8,it++,It[8]++;for(;it<=255;)R[2*it+1]=9,it++,It[9]++;for(;it<=279;)R[2*it+1]=7,it++,It[7]++;for(;it<=287;)R[2*it+1]=8,it++,It[8]++;for(ft(R,f+1,It),it=0;it<d;it++)S[2*it+1]=5,S[2*it]=ht(it,5);X=new ot(R,A,u+1,f,y),Z=new ot(S,T,0,d,y),st=new ot(new Array(0),F,0,g,x)}(),z=!0),Y.l_desc=new et(Y.dyn_ltree,X),Y.d_desc=new et(Y.dyn_dtree,Z),Y.bl_desc=new et(Y.bl_tree,st),Y.bi_buf=0,Y.bi_valid=0,gt(Y)},s._tr_stored_block=J,s._tr_flush_block=function(Y,it,pt,vt){var at,Et,It=0;0<Y.level?(Y.strm.data_type===2&&(Y.strm.data_type=function(Ct){var jt,ie=4093624447;for(jt=0;jt<=31;jt++,ie>>>=1)if(1&ie&&Ct.dyn_ltree[2*jt]!==0)return o;if(Ct.dyn_ltree[18]!==0||Ct.dyn_ltree[20]!==0||Ct.dyn_ltree[26]!==0)return a;for(jt=32;jt<u;jt++)if(Ct.dyn_ltree[2*jt]!==0)return a;return o}(Y)),Gt(Y,Y.l_desc),Gt(Y,Y.d_desc),It=function(Ct){var jt;for(N(Ct,Ct.dyn_ltree,Ct.l_desc.max_code),N(Ct,Ct.dyn_dtree,Ct.d_desc.max_code),Gt(Ct,Ct.bl_desc),jt=g-1;3<=jt&&Ct.bl_tree[2*q[jt]+1]===0;jt--);return Ct.opt_len+=3*(jt+1)+5+5+4,jt}(Y),at=Y.opt_len+3+7>>>3,(Et=Y.static_len+3+7>>>3)<=at&&(at=Et)):at=Et=pt+5,pt+4<=at&&it!==-1?J(Y,it,pt,vt):Y.strategy===4||Et===at?(j(Y,2+(vt?1:0),3),Wt(Y,R,S)):(j(Y,4+(vt?1:0),3),function(Ct,jt,ie,te){var ee;for(j(Ct,jt-257,5),j(Ct,ie-1,5),j(Ct,te-4,4),ee=0;ee<te;ee++)j(Ct,Ct.bl_tree[2*q[ee]+1],3);rt(Ct,Ct.dyn_ltree,jt-1),rt(Ct,Ct.dyn_dtree,ie-1)}(Y,Y.l_desc.max_code+1,Y.d_desc.max_code+1,It+1),Wt(Y,Y.dyn_ltree,Y.dyn_dtree)),gt(Y),vt&&_t(Y)},s._tr_tally=function(Y,it,pt){return Y.pending_buf[Y.d_buf+2*Y.last_lit]=it>>>8&255,Y.pending_buf[Y.d_buf+2*Y.last_lit+1]=255&it,Y.pending_buf[Y.l_buf+Y.last_lit]=255&pt,Y.last_lit++,it===0?Y.dyn_ltree[2*pt]++:(Y.matches++,it--,Y.dyn_ltree[2*(E[pt]+u+1)]++,Y.dyn_dtree[2*P(it)]++),Y.last_lit===Y.lit_bufsize-1},s._tr_align=function(Y){j(Y,2,3),K(Y,b,R),function(it){it.bi_valid===16?(H(it,it.bi_buf),it.bi_buf=0,it.bi_valid=0):8<=it.bi_valid&&(it.pending_buf[it.pending++]=255&it.bi_buf,it.bi_buf>>=8,it.bi_valid-=8)}(Y)}},{"../utils/common":41}],53:[function(e,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,s){(function(r){(function(o,a){if(!o.setImmediate){var l,h,c,u,f=1,d={},g=!1,p=o.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(o);y=y&&y.setTimeout?y:o,l={}.toString.call(o.process)==="[object process]"?function(L){process.nextTick(function(){x(L)})}:function(){if(o.postMessage&&!o.importScripts){var L=!0,M=o.onmessage;return o.onmessage=function(){L=!1},o.postMessage("","*"),o.onmessage=M,L}}()?(u="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(L){o.postMessage(u+L,"*")}):o.MessageChannel?((c=new MessageChannel).port1.onmessage=function(L){x(L.data)},function(L){c.port2.postMessage(L)}):p&&"onreadystatechange"in p.createElement("script")?(h=p.documentElement,function(L){var M=p.createElement("script");M.onreadystatechange=function(){x(L),M.onreadystatechange=null,h.removeChild(M),M=null},h.appendChild(M)}):function(L){setTimeout(x,0,L)},y.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var M=new Array(arguments.length-1),k=0;k<M.length;k++)M[k]=arguments[k+1];var A={callback:L,args:M};return d[f]=A,l(f),f++},y.clearImmediate=_}function _(L){delete d[L]}function x(L){if(g)setTimeout(x,0,L);else{var M=d[L];if(M){g=!0;try{(function(k){var A=k.callback,T=k.args;switch(T.length){case 0:A();break;case 1:A(T[0]);break;case 2:A(T[0],T[1]);break;case 3:A(T[0],T[1],T[2]);break;default:A.apply(a,T)}})(M)}finally{_(L),g=!1}}}}function b(L){L.source===o&&typeof L.data=="string"&&L.data.indexOf(u)===0&&x(+L.data.slice(u.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Bo<"u"?Bo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(c3);var nW=c3.exports;const sW=CS(nW);var rW=class extends Ya{constructor(t){t=t||{};var e=document.createElement("div");e.className="ol-graticule ol-unselectable ol-hidden",super({element:e}),this.set("projection",t.projection||"EPSG:4326");var n=new Ql({code:this.get("projection")}),s=n.getMetersPerUnit();for(this.fac=1;s/this.fac>10;)this.fac*=10;this.fac=1e4/this.fac,this.set("maxResolution",t.maxResolution||1/0),this.set("step",t.step||.1),this.set("stepCoord",t.stepCoord||1),this.set("spacing",t.spacing||40),this.set("intervals",t.intervals),this.set("precision",t.precision),this.set("margin",t.margin||0),this.set("borderWidth",t.borderWidth||5),this.set("stroke",t.stroke!==!1),this.formatCoord=t.formatCoord||function(r){return r},t.style instanceof Pe?this.setStyle(t.style):this.setStyle(new Pe({stroke:new si({color:"#000",width:1}),fill:new ke({color:"#fff"}),text:new qn({stroke:new si({color:"#fff",width:2}),fill:new ke({color:"#000"})})}))}setStyle(t){this._style=t}_draw(t){if(!(this.get("maxResolution")<t.frameState.viewState.resolution)){for(var e=this.getContext(t),n=e.canvas,s=t.frameState.pixelRatio,r=n.width/s,o=n.height/s,a=this.get("projection"),l=this.getMap(),h=[l.getCoordinateFromPixel([0,0]),l.getCoordinateFromPixel([r,0]),l.getCoordinateFromPixel([r,o]),l.getCoordinateFromPixel([0,o])],c=-1/0,u=1/0,f=-1/0,d=1/0,g=0,p;p=h[g];g++)h[g]=Zi(p,l.getView().getProjection(),a),c=Math.max(c,h[g][0]),u=Math.min(u,h[g][0]),f=Math.max(f,h[g][1]),d=Math.min(d,h[g][1]);var y=this.get("spacing"),_=this.get("step"),x=this.get("stepCoord"),b=this.get("borderWidth"),L=this.get("margin"),M=(c-u)/_*y;if(M>r){var k=Math.round((c-u)/r*y/_);_*=k,_>this.fac&&(_=Math.round(_/this.fac)*this.fac)}var A=this.get("intervals");if(Array.isArray(A)){var T=A[0];for(let ft=0,gt=A.length;ft<gt&&!(_>=A[ft]);++ft)T=A[ft];_=T}var F=this.get("precision"),q=_;F>0&&_>F&&(q=_/Math.ceil(_/F)),u=Math.floor(u/_)*_-_,d=Math.floor(d/_)*_-_,c=Math.floor(c/_)*_+2*_,f=Math.floor(f/_)*_+2*_;var R=xe(a).getExtent();R&&(u<R[0]&&(u=R[0]),d<R[1]&&(d=R[1]),c>R[2]&&(c=R[2]+_),f>R[3]&&(f=R[3]+_));var S=this.getStyle().getStroke()&&this.get("stroke"),O=this.getStyle().getText(),E=this.getStyle().getFill();e.save(),e.scale(s,s),e.beginPath(),e.rect(L,L,r-2*L,o-2*L),e.clip(),e.beginPath();var U={top:[],left:[],bottom:[],right:[]},X,Z,st,tt,ot;for(X=u;X<c;X+=_)for(tt=Zi([X,d],a,l.getView().getProjection()),tt=l.getPixelFromCoordinate(tt),S&&e.moveTo(tt[0],tt[1]),st=tt,Z=d+q;Z<=f;Z+=q)ot=Zi([X,Z],a,l.getView().getProjection()),ot=l.getPixelFromCoordinate(ot),S&&e.lineTo(ot[0],ot[1]),st[1]>0&&ot[1]<0&&U.top.push([X,st]),st[1]>o&&ot[1]<o&&U.bottom.push([X,st]),st=ot;for(Z=d;Z<f;Z+=_)for(tt=Zi([u,Z],a,l.getView().getProjection()),tt=l.getPixelFromCoordinate(tt),S&&e.moveTo(tt[0],tt[1]),st=tt,X=u+q;X<=c;X+=q)ot=Zi([X,Z],a,l.getView().getProjection()),ot=l.getPixelFromCoordinate(ot),S&&e.lineTo(ot[0],ot[1]),st[0]<0&&ot[0]>0&&U.left.push([Z,st]),st[0]<r&&ot[0]>r&&U.right.push([Z,st]),st=ot;if(S&&(e.strokeStyle=this.getStyle().getStroke().getColor(),e.lineWidth=this.getStyle().getStroke().getWidth(),e.stroke()),O){e.fillStyle=this.getStyle().getText().getFill().getColor(),e.strokeStyle=this.getStyle().getText().getStroke().getColor(),e.lineWidth=this.getStyle().getText().getStroke().getWidth(),e.font=this.getStyle().getText().getFont(),e.textAlign="center",e.textBaseline="hanging";var et,P,H=(E?b:0)+L+2;for(g=0;et=U.top[g];g++)Math.round(et[0]/this.get("step"))%x||(P=this.formatCoord(et[0],"top"),e.strokeText(P,et[1][0],H),e.fillText(P,et[1][0],H));for(e.textBaseline="alphabetic",g=0;et=U.bottom[g];g++)Math.round(et[0]/this.get("step"))%x||(P=this.formatCoord(et[0],"bottom"),e.strokeText(P,et[1][0],o-H),e.fillText(P,et[1][0],o-H));for(e.textBaseline="middle",e.textAlign="left",g=0;et=U.left[g];g++)Math.round(et[0]/this.get("step"))%x||(P=this.formatCoord(et[0],"left"),e.strokeText(P,H,et[1][1]),e.fillText(P,H,et[1][1]));for(e.textAlign="right",g=0;et=U.right[g];g++)Math.round(et[0]/this.get("step"))%x||(P=this.formatCoord(et[0],"right"),e.strokeText(P,r-H,et[1][1]),e.fillText(P,r-H,et[1][1]))}if(E){var j=this.getStyle().getFill().getColor(),K,ht;for((ht=this.getStyle().getStroke())?K=this.getStyle().getStroke().getColor():(K=j,j="#fff"),e.strokeStyle=K,e.lineWidth=ht?ht.getWidth():1,g=1;g<U.top.length;g++)e.beginPath(),e.rect(U.top[g-1][1][0],L,U.top[g][1][0]-U.top[g-1][1][0],b),e.fillStyle=Math.round(U.top[g][0]/_)%2?K:j,e.fill(),e.stroke();for(g=1;g<U.bottom.length;g++)e.beginPath(),e.rect(U.bottom[g-1][1][0],o-b-L,U.bottom[g][1][0]-U.bottom[g-1][1][0],b),e.fillStyle=Math.round(U.bottom[g][0]/_)%2?K:j,e.fill(),e.stroke();for(g=1;g<U.left.length;g++)e.beginPath(),e.rect(L,U.left[g-1][1][1],b,U.left[g][1][1]-U.left[g-1][1][1]),e.fillStyle=Math.round(U.left[g][0]/_)%2?K:j,e.fill(),e.stroke();for(g=1;g<U.right.length;g++)e.beginPath(),e.rect(r-b-L,U.right[g-1][1][1],b,U.right[g][1][1]-U.right[g-1][1][1]),e.fillStyle=Math.round(U.right[g][0]/_)%2?K:j,e.fill(),e.stroke();e.beginPath(),e.fillStyle=K,e.rect(L,L,b,b),e.rect(L,o-b-L,b,b),e.rect(r-b-L,L,b,b),e.rect(r-b-L,o-b-L,b,b),e.fill()}e.restore()}}},ri=class extends Ms{constructor(t){t=t||{};var e=lt.create("DIV",{className:((t.className||"")+" ol-feature-list").trim()});t.target||(e.classList.add("ol-unselectable"),e.classList.add("ol-control"),e.dataset.control=1),super({element:e,target:t.target}),this._listFeatures=[],this._columns=[],this._bottomScroll=e.classList.contains("ol-bottom"),this.set("pageLength",t.pageLength||100),this._canSort=[],this._sort={},t.target||lt.create("BUTTON",{type:"button",click:(function(){this.collapse()}).bind(this),parent:e});var n=lt.create("DIV",{className:"ol-content",parent:e});this._menu=lt.create("DIV",{className:"ol-header",html:'<div class="ol-buttons"></div>',parent:n}),lt.create("P",{text:t.title||"",parent:this._menu}),this.addButton({className:"ol-closebox",type:"button",click:(function(){this.collapse()}).bind(this),parent:this._menu});var s=lt.create("DIV",{className:"ol-sizer",parent:n});s.addEventListener("mousedown",this._dragSizer.bind(this)),s.addEventListener("touchstart",this._dragSizer.bind(this));var r=this._list=lt.create("TABLE",{className:"ol-list",parent:lt.create("DIV",{className:"ol-scroll-container",tabindex:-1,parent:n})});r.parentNode.addEventListener("scroll",this._drawPage.bind(this)),this._head=lt.create("THEAD",{parent:r}),this._listbody=lt.create("TBODY",{parent:r}),this.collapse(t.collapsed!==!1),this.setFeatures(t.features)}setMap(t){super.setMap(t),t.addEventListener("change:size",this.resize.bind(this)),this.resize()}};ri.prototype.setBottomScroll=function(i){this._bottomScroll=!!i,this._bottomScroll?this.element.classList.add("ol-bottom"):this.element.classList.remove("ol-bottom")};ri.prototype.scrollTo=function(i){if(i==="select")return this._curSelection?this.scrollTo(this._curSelection.feature):!1;var t=this._findFeatureIndex(i);if(t>=0){var e=this._list.parentNode;e.scrollTo(e.scrollLeft,(t+1.5)*this.getRowHeight()-e.getBoundingClientRect().height/2);var n=this._findInPage(i);return{feature:i,tr:n?n.tr:lt.create("TR")}}return!1};ri.prototype._findFeatureIndex=function(i){var t=this._listFeatures;if(t){for(var e=0;e<t.length;e++)if(t[e]===i)return e}return-1};ri.prototype._findInPage=function(i){var t=this._page;if(t){for(var e=0;e<t.length;e++)if(t[e].feature===i)return t[e]}return!1};ri.prototype.collapse=function(i){i===void 0&&(i=!this._collapsed),i!==this._collapsed&&(this._collapsed=i,this._collapsed?this.element.classList.add("ol-collapsed"):this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"collapse",collapsed:this._collapsed}),this._collapsed||this.refresh())};ri.prototype.isCollapsed=function(){return this._collapsed};ri.prototype.setFeatures=function(i){this._drawbind||(this._drawbind=this._drawList.bind(this)),this._source&&this._source.un&&this._source.un(["loadend","addfeature","removefeature","add","remove"],this._drawbind),this._source=i||[],this._drawList(),this._source.on&&this._source.on(["loadend","addfeature","removefeature","add","remove"],this._drawbind)};ri.prototype.sortBy=function(i,t){t?this._sort[i]=t!=="down":delete this._sort[i],this.sort(!0),this.dispatchEvent({type:"sort",property:i,sort:t})};ri.prototype.getSort=function(){return this._sort};ri.prototype.resetSort=function(){this._sort={},this.sort()};ri.prototype.enableSort=function(){this._canSort=[...arguments],Object.keys(this._sort).forEach((function(i){this._canSort.indexOf(i)<0&&delete this._sort[i]}).bind(this)),this.sort()};ri.prototype._drawList=function(i){if(i){clearTimeout(this._drawout),this._drawout=setTimeout(this._drawList.bind(this),100);return}var t=this._source.getFeatures?this._source.getFeatures():this._source;this._columns=this.getColumns(t),this._drawHead(),this._listFeatures=[],t.forEach((function(e){this._listFeatures.push(e)}).bind(this)),this.sort()};ri.prototype.updateFeature=function(i){var t=this._findInPage(i);return t?(this._updateFeature(t.feature,t.tr),!0):!1};ri.prototype._updateFeature=function(i,t){t.innerHTML="",this._columns.forEach((function(e){var n=this.formatProperty(i,e);lt.create("TD",{text:n.val,html:n.html,className:n.type,"data-prop":e,parent:t})}).bind(this)),this._curSelection&&this._curSelection.feature===i&&(this._curSelection.tr=t,t.classList.add("ol-selected"))};ri.prototype._getLi=function(i){var t=lt.create("TR",{on:{click:(function(e){var n=e.target.closest("TD");this.dispatchEvent({type:"select",property:n.dataset.prop,feature:i,row:e.target.closest("TR"),col:n,originalEvent:e}),this.select(i,!0)}).bind(this),dblclick:(function(e){var n=e.target.closest("TD");this.dispatchEvent({type:"dblclick",property:n.dataset.prop,feature:i,row:e.target.closest("TR"),col:n,originalEvent:e})}).bind(this)}});return this._updateFeature(i,t),t};ri.prototype._drawHead=function(){var i=this._columns;this._head.innerHTML="";var t=lt.create("TR",{parent:this._head});i.forEach((function(e){var n=lt.create("TD",{html:lt.create("P",{text:e}),parent:t});if(this._canSort.length&&this._canSort.indexOf(e)>=0){n.classList.add("sort");var s=lt.create("BUTTON",{className:"sort"+(this._sort[e]===!0?" sortup":this._sort[e]===!1?" sortdown":""),click:(function(){var r;s.classList.contains("sortup")?r="down":s.classList.contains("sortdown")||(r="up"),this.sortBy(e,r)}).bind(this),parent:n})}}).bind(this))};ri.prototype.sort=function(i){var t=Object.keys(this._sort);t.length&&this._listFeatures.sort((function(e,n){for(let o=0;o<t.length;o++){var s=t[o],r=this.sortFn(e,n,s);if(r)return this._sort[s]?r:-r}return 0}).bind(this)),this.refresh(!0),i||this.dispatchEvent({type:"sort"})};ri.prototype.refresh=function(i){i&&(this._curPage=-1),this._drawHead(),this._drawPage(),this.resize()};ri.prototype.update=function(){this._drawList(),this._curSelection&&this._curSelection.feature&&this.select(this._curSelection.feature,!0)};ri.prototype.getRowHeight=function(){return this._head.getBoundingClientRect().height};ri.prototype._drawPage=function(){var i=Math.round(this.get("pageLength")/2),t=Math.round(i/2),e=this._list.parentNode.scrollTop,n=this.getRowHeight(),s=Math.round((e/n-t)/i);if(s*i>this._listFeatures.length&&(s=0),s!==this._curPage){this._curPage=s,this._listbody.innerHTML="",this._listbody.appendChild(lt.create("TR",{style:{height:Math.max(0,(s*i-t)*n)+"px"}}));var r=Math.min(this._listFeatures.length,(s+1)*i+t);this._page=[];for(var o=Math.max(0,s*i-t);o<r;o++){var a=this._getLi(this._listFeatures[o]);this._page.push({feature:this._listFeatures[o],tr:a}),this._curSelection&&this._listFeatures[o]===this._curSelection.feature&&(this._curSelection.tr=a,a.classList.add("ol-selected")),this._listbody.appendChild(a)}this._listbody.appendChild(lt.create("TR",{style:{height:Math.max(0,(this._listFeatures.length-r)*n)+"px"}})),this.get("focus")!==!1&&this._listbody.focus()}};ri.prototype.sortFn=function(i,t,e){var n=i.get(e)||"",s=t.get(e)||"";return n<s?-1:n>s?1:0};ri.prototype.formatProperty=function(i,t){var e=i.get(t);return{val:e===void 0?"-":e,type:typeof e}};ri.prototype.getColumns=function(i){var t=this.columns||[];if(!t.length&&i){var e={};i.forEach(function(n){Object.keys(n.getProperties()).forEach(function(s){n.get(s)instanceof Gy||(e[s]=!0)})}),t=Object.keys(e)}return t};ri.prototype.setColumns=function(i){this.columns=i||[],this._drawList(),this._curSelection&&this._curSelection.feature&&this.select(this._curSelection.feature,!0)};ri.prototype._dragSizer=function(i){var t=this;switch(this._movefn||(this._movefn=this._dragSizer.bind(this)),i.stopPropagation(),i.preventDefault(),i.type){case"touchcancel":case"touchend":case"mouseup":{t._pageY=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(n){document.removeEventListener(n,t._movefn)});break}case"mousedown":case"touchstart":t._contentHeight=t._list.parentNode.getBoundingClientRect().height,t._pageY=i.pageY||i.touches&&i.touches.length&&i.touches[0].pageY||i.changedTouches&&i.changedTouches.length&&i.changedTouches[0].pageY,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach(function(n){document.addEventListener(n,t._movefn)});case"mousemove":case"touchmove":{if(t.pageY!==!1){var e=i.pageY||i.touches&&i.touches.length&&i.touches[0].pageY||i.changedTouches&&i.changedTouches.length&&i.changedTouches[0].pageY;this._bottomScroll?t.resize(t._contentHeight+e-t._pageY):t.resize(t._contentHeight-e+t._pageY)}break}}};ri.prototype.resize=function(i){if(this.getMap()){var t=this._list.parentNode.getBoundingClientRect().height;if(i!==void 0&&(this._list.parentNode.style.height=i+"px"),this.element.dataset.control){var e=this.getMap().getTargetElement().getBoundingClientRect().height-this._head.getBoundingClientRect().height;this._list.parentNode.style.maxHeight=Math.min(e,this._list.getBoundingClientRect().height)+"px"}t!==this._list.parentNode.getBoundingClientRect().height&&this.dispatchEvent({type:"resize",height:this._list.parentNode.getBoundingClientRect().height})}};ri.prototype.getSelection=function(){return this._curSelection&&this._curSelection.feature||null};ri.prototype.select=function(i,t){if(this._curSelection&&this._curSelection.tr.classList.remove("ol-selected"),this._curSelection=null,i)if(t){var e=this._findInPage(i);this._curSelection={feature:i,tr:e?e.tr:lt.create("TR")}}else this._curSelection=this.scrollTo(i);this._curSelection&&this._curSelection.tr.classList.add("ol-selected")};ri.prototype.addButton=function(i){return lt.create("BUTTON",{className:i.className,title:i.title||"",html:i.html||"",click:i.click,parent:this._menu.querySelector(".ol-buttons")})};var oW=class extends z2{constructor(t){t=t||{},t.className=(t.className||"")+" ol-searchcoord",t.placeholder=t.placeholder||"x,y",super(t),this.projection_=t.projection||"EPSG:3857",this.set("digit",typeof t.digit=="number"?t.digit:3),this.geolocation=new SS({projection:"EPSG:4326",trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),lt.create("BUTTON",{className:"ol-geoloc",title:t.labelGPS||"Locate with GPS",parent:this.element,click:(function(){this.geolocation.setTracking(!0)}).bind(this)}),lt.create("BUTTON",{className:"ol-centerloc",title:t.labelCenter||"Map center",parent:this.element,click:(function(){this.setInput()}).bind(this)}),this._createForm();var e=this.element.querySelector("ul.autocomplete");this.element.appendChild(e)}setInput(t){if(!t){if(!this.getMap())return;t=this.getMap().getView().getCenter(),t=Zi(t,this.getMap().getView().getProjection(),this.getProjection())}var e=Math.pow(10,this.get("digit"));this.inputs_[0].value=Math.round(t[0]*e)/e,this.inputs_[1].value=Math.round(t[1]*e)/e,this._triggerCustomEvent("keyup",this.inputs_[0])}getProjection(){return this.projection_}setProjection(t){this.projection_!==t&&(this.projection_=t,this.clearHistory(),this.element.querySelectorAll('INPUT[type="number"]').forEach(function(e){e.value=""}))}_createForm(){var t=(function(){s.value||r.value?this._input.value=s.value+","+r.value:this._input.value="",this.search()}).bind(this);function e(o){var a=lt.create("INPUT",{className:o,type:"number",step:"any",lang:"en",parent:n,on:{"change keyup":t}});return a}var n=lt.create("DIV",{className:"ol-longitude",parent:this.element});lt.create("LABEL",{html:"X",parent:n});var s=e("ol-decimal");n=lt.create("DIV",{className:"ol-latitude",parent:this.element}),lt.create("LABEL",{html:"Y",parent:n});var r=e("ol-decimal");this.button&&this.button.addEventListener("click",function(){s.focus()}),this.inputs_=[s,r],this.on("select",(function(o){s.value=o.search.gps[0],r.value=o.search.gps[1]}).bind(this)),this.geolocation.on("change",(function(){this.geolocation.setTracking(!1);var o=this.geolocation.getPosition();o=Zi(o,"EPSG:4326",this.projection_);var a=Math.pow(10,this.get("digit"));s.value=Math.round(o[0]*a)/a,r.value=Math.round(o[1]*a)/a,this._triggerCustomEvent("keyup",s)}).bind(this))}autocomplete(t){var e=[],n=t.split(",");n[0]=Number(n[0]),n[1]=Number(n[1]);var s=Zi([n[0],n[1]],this.projection_,this.getMap().getView().getProjection());return e.push({gps:n,coordinate:s,name:t}),e}},u3=class extends Ms{constructor(t){t=t||{};var e=document.createElement("div");super({element:e,target:t.target}),this._features=this.setFeatures(t.features),t.target||(e.className="ol-select ol-unselectable ol-control ol-collapsed",lt.create("BUTTON",{type:"button",on:{"click touchstart":function(s){e.classList.toggle("ol-collapsed"),s.preventDefault()}},parent:e})),t.className&&e.classList.add(t.className);var n=t.content||lt.create("DIV");e.appendChild(n),lt.create("BUTTON",{html:t.btInfo||"OK",className:"ol-ok",on:{click:this.doSelect.bind(this)},parent:n}),this.setSources(t.source)}setSources(t){t?this.set("source",t instanceof Array?t:[t]):this.unset("source")}setFeatures(t){t instanceof ns?this._features=t:this._features=null}getFeatures(){return this._features}_escape(t){return String(t||"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}_checkCondition(t,e,n){if(!e.attr)return!0;var s=t.get(e.attr),r=Number(s)==s&&Number(e.val)==e.val;r&&(s=Number(s));var o;switch(e.op){case"=":return r?s==e.val:(o=new RegExp("^"+this._escape(e.val)+"$",n?"":"i"),o.test(s));case"!=":return r?s!=e.val:(o=new RegExp("^"+this._escape(e.val)+"$",n?"":"i"),!o.test(s));case"<":return s<e.val;case"<=":return s<=e.val;case">":return s>e.val;case">=":return s>=e.val;case"contain":return o=new RegExp(this._escape(e.val),n?"":"i"),o.test(s);case"!contain":return o=new RegExp(this._escape(e.val),n?"":"i"),!o.test(s);case"regexp":return o=new RegExp(e.val,n?"":"i"),o.test(s);case"!regexp":return o=new RegExp(e.val,n?"":"i"),!o.test(s);default:return!1}}_selectFeatures(t,e,n,s,r){n=n||[];for(var o,a=e.length-1;o=e[a];a--){for(var l=s,h=0,c;c=n[h];h++)c.attr&&(s?l=l&&this._checkCondition(o,c,r):l=l||this._checkCondition(o,c,r));l?t.push(o):this._features&&this._features.removeAt(a)}return t}getSources(){if(this.get("source"))return this.get("source");var t=[];function e(n){n.forEach(function(s){s.getLayers?e(s.getLayers()):s.getSource&&s.getSource()instanceof Ws&&t.push(s.getSource())})}return this.getMap()&&e(this.getMap().getLayers()),t}doSelect(t){t=t||{};var e=[];if(t.features)this._selectFeatures(e,t.features,t.conditions,t.matchAll,t.useCase);else if(this._features)this._selectFeatures(e,this._features.getArray(),t.conditions,t.matchAll,t.useCase);else{var n=t.sources||this.getSources();n.forEach((function(s){this._selectFeatures(e,s.getFeatures(),t.conditions,t.matchAll,t.useCase)}).bind(this))}return this.dispatchEvent({type:"select",features:e}),e}};u3.prototype.operationsList={"=":"=","!=":"≠","<":"<","<=":"≤",">=":"≥",">":">",contain:"⊂","!contain":"⊄",regexp:"≃","!regexp":"≄"};var aW=class extends u3{constructor(t){t=t||{};var e=t.content=document.createElement("div");super(t);var n=e.querySelector("button");this._ul=lt.create("UL",{parent:e}),this._all=lt.create("INPUT",{type:"checkbox",checked:!0});var s=lt.create("LABEL",{html:this._all,parent:e});lt.appendText(s,t.allLabel||"match all"),this._useCase=lt.create("INPUT",{type:"checkbox"});var r=lt.create("LABEL",{html:this._useCase,parent:e});lt.appendText(r,t.caseLabel||"case sensitive"),e.appendChild(n),lt.create("BUTTON",{className:"ol-append",html:t.addLabel||"add rule",click:(function(){this.addCondition()}).bind(this),parent:e}),this._conditions=[],this.set("attrPlaceHolder",t.attrPlaceHolder||"attribute"),this.set("valuePlaceHolder",t.valuePlaceHolder||"value"),this.addCondition()}addCondition(t){t=t||{},this._conditions.push({attr:t.attr||"",op:t.op||"=",val:t.val||""}),this._drawlist()}getConditions(){return{usecase:this._useCase.checked,all:this._all.checked,conditions:this._conditions}}setConditions(t){this._useCase.checked=t.usecase,this._all.checked=t.all,this._conditions=t.conditions,this._drawlist()}getConditionsString(t){for(var e="",n=0,s;s=t.conditions[n];n++)s.attr&&(e+=(e?t.all?" AND ":" OR ":"")+s.attr+this.operationsList[s.op]+s.val);return e}_drawlist(){this._ul.innerHTML="";for(var t=0;t<this._conditions.length;t++)this._ul.appendChild(this._getLiCondition(t))}_autocomplete(t,e){e.classList.remove("ol-hidden"),e.innerHTML="";for(var n={},s=this.get("source"),r=0,o;o=s[r];r++)for(var a=o.getFeatures(),l=0,h;(h=a[l])&&(Object.assign(n,h.getProperties()),!(l>100));l++);var c=new RegExp(t,"i");for(var u in n)if(u!=="geometry"&&c.test(u)){var f=document.createElement("li");f.textContent=u,f.addEventListener("click",function(){e.previousElementSibling.value=this.textContent;var d=document.createEvent("HTMLEvents");d.initEvent("change",!0,!1),e.previousElementSibling.dispatchEvent(d),e.classList.add("ol-hidden")}),e.appendChild(f)}}_getLiCondition(t){var e=this,n=document.createElement("li"),s=document.createElement("div");s.classList.add("ol-autocomplete"),s.addEventListener("mouseleave",function(){this.querySelector("ul").classList.add("ol-hidden")}),n.appendChild(s);var r=document.createElement("input");r.classList.add("ol-attr"),r.setAttribute("type","search"),r.setAttribute("placeholder",this.get("attrPlaceHolder")),r.addEventListener("keyup",function(){e._autocomplete(this.value,this.nextElementSibling)}),r.addEventListener("focusout",function(){setTimeout(function(){s.querySelector("ul").classList.add("ol-hidden")},300)}),r.addEventListener("click",function(){setTimeout((function(){e._autocomplete(this.value,this.nextElementSibling),this.nextElementSibling.classList.remove("ol-hidden")}).bind(this))}),r.addEventListener("change",function(){e._conditions[t].attr=this.value}),r.value=e._conditions[t].attr,s.appendChild(r);var o=document.createElement("ul");o.classList.add("ol-hidden"),s.appendChild(o);var a=document.createElement("select");n.appendChild(a);for(var l in this.operationsList){var h=document.createElement("option");h.value=l,h.textContent=this.operationsList[l],a.appendChild(h)}a.value=e._conditions[t].op,a.addEventListener("change",function(){e._conditions[t].op=this.value});var c=document.createElement("input");if(c.setAttribute("type","text"),c.setAttribute("placeholder",this.get("valuePlaceHolder")),c.addEventListener("change",function(){e._conditions[t].val=this.value}),c.value=e._conditions[t].val,n.appendChild(c),this._conditions.length>1){var u=document.createElement("div");u.classList.add("ol-delete"),u.addEventListener("click",function(){e.removeCondition(t)}),n.appendChild(u)}return n}removeCondition(t){this._conditions.splice(t,1),this._drawlist()}doSelect(t){return t=t||{},t.useCase=t.useCase||this._useCase.checked,t.matchAll=t.matchAll||this._all.checked,t.conditions=t.conditions||this._conditions,super.doSelect(t)}};Cn.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs +type=crs");F2(Cn);Cn.defs("EPSG:6870","+proj=tmerc +lat_0=0 +lon_0=20 +k=1 +x_0=500000 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs");F2(Cn);Cn.defs("EPSG:32634","+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs +type=crs");F2(Cn);new Ql({code:"EPSG:4326",units:"degrees",worldExtent:[-180,-90,180,90]});new Ql({code:"EPSG:6870",extent:[-296358556e-2,363947576e-2,240427744e-2,952590877e-2],worldExtent:[-16.1,32.88,40.18,84.73],units:"m"});const wv=new Ql({code:"EPSG:32634",extent:[166021.44,0,833978.56,932900518e-2],worldExtent:[18,0,24,84],units:"m"});ZM([19.818913,41.328608],"EPSG:6870");let Us="localhost",nu="test";const Sv="https://geoportal.asig.gov.al/service/kufinjt_e_njesive_administrative/wms?request=GetCapabilities",su="https://geoportal.asig.gov.al/service",kw=`http://${Us}:8080/geoserver/rest/workspaces/${nu}/layergroups`;function lW(i){const t=i.split(" ");let e=t[0].toLowerCase();for(let n=1;n<t.length;n++){const s=t[n];e+=s.charAt(0).toUpperCase()+s.slice(1).toLowerCase()}return e}function hW(i){const t=i.split(":");if(t.length!==2)throw new Error("Invalid layer name format");const e=t[0],n=t[1],s=n.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ");return{workspace2:e,layerName2:n,layerTitle2:s}}let _p,f_,Ls=[];fetch(kw).then(i=>{if(!i.ok)throw new Error("Network response was not ok");return i.json()}).then(i=>{i.layerGroups.layerGroup.forEach(e=>{_p=e.name,lW(_p);const n=new Hn({layers:[],title:_p,displayInLayerSwitcher:!0});zt.addLayer(n),mf.push(n);const s=kw+"/"+encodeURIComponent(_p);fetch(s).then(r=>{if(!r.ok)throw new Error("Network response was not ok");return r.json()}).then(r=>{const o=r.layerGroup.publishables.published;(Array.isArray(o)?o:[o]).forEach(l=>{f_=l.name;const{workspace2:h,layerName2:c,layerTitle2:u}=hW(f_),f=new M2({source:new zI({url:`http://${Us}:8080/geoserver/${h}/wms`,params:{LAYERS:f_,VERSION:"1.1.1"},ratio:1,serverType:"geoserver"}),visible:!0,title:u,information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0});n.getLayers().push(f),Ls.push(f)})}).catch(r=>{console.error("There was a problem with the fetch operation:",r)})})}).catch(i=>{console.error("There was a problem with the fetch operation:",i)});const cW=new m2({collapsible:!0}),uW=new B6({tipLabel:"Click to fullscreen the map",className:"ol-full-screen"}),dW=new G6({coordinateFormat:function(i){return"KRGJSH : "+HM(i,2)},className:"custom-mouse-position"}),fW=new aE,gW=document.getElementById("pan"),d3=new pE({condition:function(i){return GP(i)}});gW.addEventListener("click",function(){zt.addInteraction(d3)});const pW=[cW,uW,dW,fW,d3],mW=new Yn({source:new PI({key:"AvHGkUYsgRR4sQJ1WmqJ879mN7gP-a59ExxkaD9KXDie-8nyYX4W9oSnG4ozmDXB",imagerySet:"AerialWithLabelsOnDemand"}),visible:!1,title:"BingMaps",baseLayer:!0,displayInLayerSwitcher:!0}),_W=new Yn({source:new UI,title:"OSM",visible:!0,baseLayer:!0,displayInLayerSwitcher:!0}),yW=new Yn({source:new PE({url:"https://{1-4}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:"© CARTO"}),visible:!1,title:"CartoDarkAll",baseLayer:!0,displayInLayerSwitcher:!0});let Ev;var vW=new AB;fetch("https://geoportal.asig.gov.al/service/wmts?request=getCapabilities").then(function(i){return i.text()}).then(function(i){var t=vW.read(i),e=YI(t,{layer:"orthophoto_2015:OrthoImagery_20cm",matrixSet:"EPSG:6870"});const n=new Yn({name:"Ortofoto 2015 20cm",shortName:"2015 20cm",visible:!1,source:new HI(e),baseLayer:!0,displayInLayerSwitcher:!0});Ev.getLayers().push(n)}).catch(function(i){});new Pe({stroke:new si({color:"gray",width:1}),fill:new ke({color:"rgba(20,20,20,0.9)"})});const xW=new Yn({source:new Zo({url:su+"/akzm/wms",params:{LAYERS:"zonat_e_mbrojtura_natyrore_06042023",VERSION:"1.1.0"}}),visible:!1,title:"Zonat e Mbrojtura",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),bW=new Yn({source:new Zo({url:su+"/akzm/wms",params:{LAYERS:"monumentet_natyrore_07032023",VERSION:"1.1.0"}}),visible:!1,title:"Monumente Natyrore",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),wW=new Yn({source:new Zo({url:su+"/instituti_transportiti/wms",params:{LAYERS:"infrastruktura_rrugore_utm",VERSION:"1.1.0"}}),visible:!1,title:"Rrjeti Rrugor",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),SW=new Yn({source:new Zo({url:Sv,params:{LAYERS:"rendi_1_kufi_shteteror",VERSION:"1.1.0"}}),visible:!1,title:"Kufi Shteteror",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),EW=new Yn({source:new Zo({url:Sv,params:{LAYERS:"rendi_2_kufi_qarku_vkm360",VERSION:"1.1.0"}}),visible:!1,title:"Qark",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),CW=new Yn({source:new Zo({url:Sv,params:{LAYERS:"rendi_3_kufi_bashki_vkm360_1",VERSION:"1.1.0"}}),visible:!1,title:"Bashki",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),LW=new Yn({source:new Zo({url:su+"/adresar/wms",params:{LAYERS:"adr_ndertese",VERSION:"1.1.0"}}),visible:!1,title:"Ndërtesa",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),MW=new Yn({source:new Zo({url:su+"/adresar/wms",params:{LAYERS:"adr_numertim",VERSION:"1.1.0"}}),visible:!1,title:"Numërtim",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),TW=new Yn({source:new Zo({url:su+"/adresar/wms",params:{LAYERS:"adr_rruge",VERSION:"1.1.0"}}),visible:!1,title:"Rrugët",information:"Kufiri i tokësor i republikës së Shqipërisë",displayInLayerSwitcher:!0}),AW=`http://${Us}:8080/geoserver/${nu}/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=`,PW="&maxFeatures=50&outputFormat=application/json";let Fw,Ow;Ev=new Hn({layers:[yW,mW,_W],title:"Base Layers",information:"Këto shtresa shtresat bazë të hartës të cilat mund të aktivizohen veç e veç",displayInLayerSwitcher:!0});const f3=new Hn({layers:[SW,EW,CW,xW,bW,wW],title:"ASIG Layers",information:"Këto shtresa shtresat bazë të hartës të cilat mund të aktivizohen veç e veç",displayInLayerSwitcher:!0}),g3=new Hn({layers:[LW,MW,TW],title:"Sistemi i Adresave",information:"Sistemi i Adresave",displayInLayerSwitcher:!0}),zt=new vE({target:"map",controls:lE({attribution:!1}).extend(pW),layers:[Ev,f3,g3],view:new $r({projection:"EPSG:3857",center:[220618565e-2,506081015e-2],zoom:8,maxZoom:20})}),gf=new Ws,IW=new mE({condition:hE});zt.addInteraction(IW);const Sy=new MF({placeholder:"Kërko qytet/fshat...",collapsed:!1,collapsible:!1,url:"https://nominatim.openstreetmap.org/search?format=json&q={s}"});zt.addControl(Sy);Sy.on("select",function(i){const t=i.coordinate,e=new gi({geometry:new Qi(t)}),n=new Ws({features:[e]}),s=new Rr({source:n,style:new Pe({image:new Ir({radius:6,fill:new ke({color:"red"}),stroke:new si({color:"white",width:2})})})});zt.addLayer(s),setTimeout(()=>{n.removeFeature(e)},2e3),zt.getView().setCenter(t),zt.getView().setZoom(12),Df(),Sy.clearHistory()});document.querySelector(".ol-search");const RW=document.getElementById("graticuleButton"),NW=new Pe({stroke:new si({color:"rgba(128, 128, 128, 0.7)",width:1.25}),text:new qn({font:"12px Calibri,sans-serif",fill:new ke({color:"#000"}),stroke:new si({color:"#fff",width:3}),textAlign:"center",offsetY:-10})});let Ku;RW.addEventListener("click",function(){Ku?(zt.removeControl(Ku),Ku=void 0):(Ku=new rW({step:10,stepCoord:2,spacing:120,projection:wv,style:NW,showLabel:!0}),zt.addControl(Ku))});const pm=document.getElementById("getGeolocation");let Cv=!1;const Sa=new SS;let Ey;const kW=pm.innerHTML;pm.addEventListener("click",function(){Cv?OW():FW()});function FW(){const i=zt.getView().getProjection();Sa.setTrackingOptions({enableHighAccuracy:!0}),Sa.setProjection(i);const t=new gi;Sa.on("change:accuracyGeometry",function(){t.setGeometry(Sa.getAccuracyGeometry())});const e=new gi;Sa.on("change:position",function(){let n=Sa.getPosition();zt.getView().setCenter(n),zt.getView().setZoom(18),e.setGeometry(new Qi(n)),Df()}),Sa.setTracking(!0),Ey=new Rr({source:new Ws({features:[e,t]})}),zt.addLayer(Ey),Cv=!0,pm.textContent="Stop Geolocation"}function OW(){Sa.setTracking(!1),zt.removeLayer(Ey),Cv=!1,pm.innerHTML=kW}const DW=document.getElementById("measure-length"),BW=document.getElementById("measure-area"),p3=document.getElementById("segments"),m3=document.getElementById("clear"),jW=new Pe({fill:new ke({color:"rgba(255, 255, 255, 0.2)"}),stroke:new si({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new Ir({radius:5,stroke:new si({color:"rgba(0, 0, 0, 0.7)"}),fill:new ke({color:"rgba(255, 255, 255, 0.2)"})})}),g_=new Pe({text:new qn({font:"14px Calibri,sans-serif",fill:new ke({color:"rgba(255, 255, 255, 1)"}),backgroundFill:new ke({color:"rgba(0, 0, 0, 0.7)"}),padding:[3,3,3,3],textBaseline:"bottom",offsetY:-15}),image:new Jc({radius:8,points:3,angle:Math.PI,displacement:[0,10],fill:new ke({color:"rgba(0, 0, 0, 0.7)"})})}),Dw=new Pe({text:new qn({font:"12px Calibri,sans-serif",fill:new ke({color:"rgba(255, 255, 255, 1)"}),backgroundFill:new ke({color:"rgba(0, 0, 0, 0.4)"}),padding:[2,2,2,2],textAlign:"left",offsetX:15})}),pf=new Pe({image:new Ir({radius:5,stroke:new si({color:"rgba(0, 0, 0, 0.7)"}),fill:new ke({color:"rgba(0, 0, 0, 0.4)"})}),text:new qn({text:"Drag to modify",font:"12px Calibri,sans-serif",fill:new ke({color:"rgba(255, 255, 255, 1)"}),backgroundFill:new ke({color:"rgba(0, 0, 0, 0.7)"}),padding:[2,2,2,2],textAlign:"left",offsetX:15})}),_3=new Pe({text:new qn({font:"12px Calibri,sans-serif",fill:new ke({color:"rgba(255, 255, 255, 1)"}),backgroundFill:new ke({color:"rgba(0, 0, 0, 0.4)"}),padding:[2,2,2,2],textBaseline:"bottom",offsetY:-12}),image:new Jc({radius:6,points:3,angle:Math.PI,displacement:[0,8],fill:new ke({color:"rgba(0, 0, 0, 0.4)"})})}),Zu=[_3],Bw=function(i){const t=oS(i);let e;return t>100?e=Math.round(t/1e3*100)/100+" km":e=Math.round(t*100)/100+" m",e},zW=function(i){const t=aS(i);let e;return t>1e4?e=Math.round(t/1e6*100)/100+" km²":e=Math.round(t*100)/100+" m²",e},za=new lC({source:gf,style:pf});let Lv;function mm(i,t,e,n){const s=[jW],r=i.getGeometry(),o=r.getType();let a,l,h;if((!e||e===o)&&(o==="Polygon"?(a=r.getInteriorPoint(),l=zW(r),h=new cn(r.getCoordinates()[0])):o==="LineString"&&(a=new Qi(r.getLastCoordinate()),l=Bw(r),h=r)),t&&h){let c=0;h.forEachSegment(function(u,f){const d=new cn([u,f]),g=Bw(d);Zu.length-1<c&&Zu.push(_3.clone());const p=new Qi(d.getCoordinateAt(.5));Zu[c].setGeometry(p),Zu[c].getText().setText(g),s.push(Zu[c]),c++})}return l&&(g_.setGeometry(a),g_.getText().setText(l),s.push(g_)),n&&o==="Point"&&!za.getOverlay().getSource().getFeatures().length&&(Lv=r,Dw.getText().setText(n),s.push(Dw)),s}let Nl,kl;const A0=new Ws;DW.addEventListener("click",function(){zt.removeInteraction(kl),P0.clear();const i="LineString",t="Click to continue drawing the line",e="Click to start measuring";let n=e;Nl=new G2({source:gf,type:i,style:function(s){return mm(s,p3.checked,i,n)}}),Nl.on("drawstart",function(){zt.un("click",vm),zt.un("click",ym),m3.checked&&(gf.clear(),A0.clear()),za.setActive(!1),n=t}),Nl.on("drawend",function(s){const r=s.feature;A0.addFeature(r),pf.setGeometry(Lv),za.setActive(!0),zt.once("pointermove",function(){pf.setGeometry()}),n=e}),za.setActive(!0),zt.addInteraction(Nl)});const Mv=new Rr({title:"Measure Line ",source:A0,style:mm});zt.addLayer(Mv);const P0=new Ws;BW.addEventListener("click",function(){zt.removeInteraction(Nl),A0.clear();const i="Polygon",t="Click to continue drawing the polygon",e="Click to start measuring";let n=e;kl=new G2({source:gf,type:i,style:function(s){return mm(s,p3.checked,i,n)}}),kl.on("drawstart",function(){zt.un("click",vm),zt.un("click",ym),m3.checked&&(gf.clear(),P0.clear()),za.setActive(!1),n=t}),kl.on("drawend",function(s){const r=s.feature;P0.addFeature(r),pf.setGeometry(Lv),za.setActive(!0),zt.once("pointermove",function(){pf.setGeometry()}),n=e}),za.setActive(!0),zt.addInteraction(kl)});const Tv=new Rr({title:"Measure Polygon",source:P0,style:mm,displayInLayerSwitcher:!1});zt.addLayer(Tv);const GW=i=>i.get("displayInLayerSwitcher")===!0;let mf=[f3,g3];const UW=function(i){const t=i,e=WW(t);e&&t.getVisible()?e.setVisible(!0):e&&y3(e)&&e.setVisible(!1);const n=t.get("title")==="Base Layers";try{t instanceof Hn?t.getLayers().getArray().forEach(r=>{!n&&t.getVisible()?r.setVisible(!0):r.setVisible(!1)}):!n&&t.getVisible()?t.setVisible(!0):t.setVisible(!1),L3(),S3()}catch{}};function WW(i){let t=null;return zt.getLayers().forEach(e=>{if(e instanceof Hn&&e.getLayers().getArray().includes(i)){t=e;return}}),t}const y3=function(i){if(!(i instanceof Hn))return!1;const t=i.getLayers().getArray();let e=!1;t.forEach(n=>{n.getVisible()&&(e=!0)}),i.setVisible(e)};mf.forEach((i,t)=>{y3(i)});const _m=new sC({displayInLayerSwitcher:GW,trash:!0,onchangeCheck:UW,show_proress:!0,mouseover:!0,collapsed:!1,extent:!1,noScroll:!1,onextent:i=>{console.log(i)},oninfo:i=>{alert(i.values_.information)},selection:!0});zt.addControl(_m);const v3=document.createElement("header");v3.innerHTML="PANELI I SHTRESAVE";_m.setHeader(v3);const Av=_m.element;Av.style.position="absolute";Av.style.top="50px";Av.style.right="10px";const qW=document.getElementById("identify");function VW(i){const t=i.pixel;var e=zt.getCoordinateFromPixel(t);function n(l){const h=l.getLayers().getArray();return h.filter(c=>c.getVisible()).reverse(),h.filter(c=>c.getVisible()).reverse()}const s=10,r=[];for(let l=2;l<mf.length;l++){const h=n(mf[l]);r.push(...h)}if(r.length<1){const l=document.querySelector(".form-container");l.style.display="none";return}function o(l){return l.get("title")||""}function a(l){const h=l.getSource().getFeatureInfoUrl(e,zt.getView().getResolution(),zt.getView().getProjection(),{INFO_FORMAT:"application/json"});h&&fetch(h).then(function(c){return c.json()}).then(function(c){var u=c.features;if(u&&u.length>0)u.forEach((f,d)=>{var g=f.properties,p=document.createElement("div");p.classList.add("form-container-el");var y=document.createElement("div");y.classList.add("form-header");const _=o(l);_&&(y.innerHTML=`Layer name: <b>${_}</b>`),p.appendChild(y);var x=document.createElement("hr");p.appendChild(x);var b=Object.keys(g).slice(0,s);const L=document.createElement("div"),M=document.createElement("div"),k=document.createElement("div");b.forEach(function(T){var F=document.createElement("label");F.textContent=T,F.style.paddingBottom="7px",F.style.width="auto";var q=document.createElement("input");q.setAttribute("readonly","readonly"),q.value=g[T],q.style.width="auto",document.createElement("br"),M.appendChild(F),k.appendChild(q)}),L.style.display="flex",M.style.display="flex",M.style.flexDirection="column",k.style.display="flex",k.style.flexDirection="column",L.appendChild(M),L.appendChild(k),p.appendChild(L);const A=document.querySelector(".form-container");A.innerHTML="",A.appendChild(p),p.style.display="block",A.style.display="block"});else{const f=r.indexOf(l)+1;if(f<r.length)a(r[f]);else{const d=document.querySelector(".form-container");d.style.display="none"}}}).catch(function(c){console.error("Error:",c)})}r.length>0&&a(r[0])}function ym(i){VW(i)}function vm(i){JW(i)}qW.addEventListener("click",function(){zt.un("click",vm),zt.on("click",ym),zt.removeInteraction(kl),zt.removeInteraction(Nl),zt.removeLayer(Mv),zt.removeLayer(Tv)});const HW=document.getElementById("move-right"),YW=document.getElementById("move-left");function x3(i,t,e){const n=zt.getView().getCenter();if(zt.getView().getZoom()<5){const s=[n[0]+i,n[1]];zt.getView().setCenter(s)}else if(zt.getView().getZoom()>=5&&zt.getView().getZoom()<10){const s=[n[0]+t,n[1]];zt.getView().setCenter(s)}else if(zt.getView().getZoom()>=10){const s=[n[0]+e,n[1]];zt.getView().setCenter(s)}}HW.addEventListener("click",function(){x3(1e5,1e4,100)});YW.addEventListener("click",function(){x3(-1e5,-1e4,-100)});const XW=document.getElementById("zoom-in"),$W=document.getElementById("zoom-out");function b3(i){const t=zt.getView(),n=t.getZoom()+i;t.setZoom(n),Df()}XW.addEventListener("click",function(){b3(1)});$W.addEventListener("click",function(){b3(-1)});const KW=document.getElementById("coords"),I0=document.getElementById("myModal"),ZW=document.getElementsByClassName("close")[0];function jw(i){const t=Math.floor(i),e=(i-t)*60,n=Math.floor(e),s=(e-n)*60;return t+"° "+n+"' "+s.toFixed(2)+"''"}function JW(i){const t=i.coordinate,e="EPSG:4326",n="EPSG:32634",s=Zi(t,zt.getView().getProjection(),e),r=jw(s[0]),o=jw(s[1]),a=Zi(t,zt.getView().getProjection(),n);document.getElementById("easting").textContent=t[0].toFixed(2),document.getElementById("northing").textContent=t[1].toFixed(2),document.getElementById("easting1").textContent=r,document.getElementById("northing1").textContent=o,document.getElementById("easting2").textContent=a[0].toFixed(2),document.getElementById("northing2").textContent=a[1].toFixed(2),I0.style.display="block"}ZW.addEventListener("click",function(){I0.style.display="none"});window.onclick=function(i){i.target==I0&&(I0.style.display="none")};KW.addEventListener("click",function(){zt.removeInteraction(kl),zt.removeInteraction(Nl),zt.removeLayer(Mv),zt.removeLayer(Tv);const i=document.querySelector(".form-container");i.style.display="none",zt.un("click",ym),zt.on("click",vm)});function Df(){const i=zt.getView(),t=i.getResolution();i.getCenter();const n=i.getProjection().getMetersPerUnit();zt.getTargetElement().clientWidth;const o=t*n*39.3701*96,a=document.getElementById("scaleInput");a.value="1:"+o.toFixed(0)}function QW(){const t=document.getElementById("scaleInput").value.trim(),e=/^1:(\d+)$/,n=t.match(e);if(n){const s=parseInt(n[1]),o=zt.getView().getProjection().getMetersPerUnit(),a=zt.getView(),c=s/(39.3701*96*o);a.setResolution(c)}else console.error("Invalid scale format. Please use the format '1:xxxxx'.")}const tq=document.getElementById("scaleInput");tq.addEventListener("keyup",function(i){i.key==="Enter"&&QW()});const eq=zt.getView();eq.on("change",function(){Df()});Df();zt.addControl(new qF({canvas:!0}));zt.addControl(new cC({title:"my title",visible:!1,style:new Pe({text:new qn({font:'20px "Lucida Grande",Verdana,Geneva,Lucida,Arial,Helvetica,sans-serif'})})}));zt.addControl(new VF);const ru=new oh({immediate:!0,collapsed:!1});ru.setSize("A4");ru.setOrientation("landscape");ru.setMargin("5");ru.element.click();zt.addControl(ru);ru.on(["print","error"],function(i){if(i.image)if(i.pdf){var t=new pe({orientation:i.print.orientation,unit:i.print.unit,format:i.print.size});t.addImage(i.image,"JPEG",i.print.position[0],i.print.position[0],i.print.imageWidth,i.print.imageHeight),t.save(i.print.legend?"legend.pdf":"map.pdf")}else i.canvas.toBlob(function(e){var n=(i.print.legend?"legend.":"map.")+i.imageType.replace("image/","");iW.saveAs(e,n)},i.imageType,i.quality);else console.warn("No canvas to export")});const ea=document.querySelector(".ol-print"),iq=document.querySelector("#printContent"),Bf=document.querySelector(".ol-print button");Bf.style.display="inline";Bf.style.width="100%";Bf.style.height="100%";Bf.style.margin=0;Bf.style.opacity=0;ea.style.display="inline";ea.style.position="absolute";ea.style.top="-4px";ea.style.left=0;ea.style.bottom=0;ea.style.right=0;ea.style.width="100%";ea.style.height="100%";iq.appendChild(ea);async function nq(i){const t={};try{const e=await fetch(i);if(!e.ok)throw new Error("Network response was not ok");return(await e.json()).features.forEach(r=>{const o=r.properties;for(const a in o)o.hasOwnProperty(a)&&(t[a]||(t[a]=new Set),t[a].add(o[a]))}),t}catch(e){return console.error("There was a problem with the fetch operation:",e),null}}let zl;async function w3(){$o.innerHTML="",Fo.innerHTML="";let i=[];const t=parseInt(Gl.value);Ls[t]&&(zl=await nq(E3)),zl&&(Object.keys(zl).filter(r=>r!=="geometry").forEach(r=>{i.push(r)}),i.forEach(r=>{const o=document.createElement("option");o.value=r,o.textContent=r,$o.appendChild(o)}))}const Gl=document.getElementById("layerSelect");function S3(){Gl.innerHTML="";const i=document.createElement("option");i.value="",i.text="Select a layer...",Gl.appendChild(i),Ls.forEach((t,e)=>{if(t.getVisible()){const n=Ls[e],s=document.createElement("option");s.value=e,s.text=n.get("title"),Gl.appendChild(s)}})}let E3;Gl.addEventListener("change",function(){const i=this.value,n=Ls[i].getSource().getParams().LAYERS;E3=`http://${Us}:8080/geoserver/${nu}/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=${n}&outputFormat=json`,w3(),xm(),Iv()});const $o=document.getElementById("fieldSelect"),Fo=document.getElementById("attributeSelect"),Pv=document.getElementById("operator");Pv.addEventListener("change",()=>{$o.value,xm()});const sq=document.querySelector('option[value=">"]'),rq=document.querySelector('option[value="<"]');document.querySelector('option[value="="]');const oq=document.querySelector('option[value="LIKE"]');async function xm(){const i=$o.value,t=Pv.value,e=document.getElementById("attributeInput");if(e&&e.remove(),t==="LIKE"||t===">"||t==="<"){const n=document.createElement("input");n.type="text",n.id="attributeInput",n.placeholder="Enter a value",Fo.style.display="none",Fo.parentNode.insertBefore(n,Fo)}else{Fo.style.display="block",Fo.innerHTML="";const n=zl?zl[i]:null;if(n){const s=Array.from(n),r=document.createElement("option");r.value="",r.textContent="",Fo.appendChild(r),s.forEach(o=>{const a=document.createElement("option");a.value=o,a.textContent=o,Fo.appendChild(a)})}}}$o.addEventListener("change",function(){$o.value,xm(),Iv()});const aq=function(){const i=parseInt(Gl.value),t=Ls[i];console.log(t);const e=document.getElementById("attributeInput");let n=t.getSource();if(n){const s=n.getParams();console.log(s);const r=$o.value,o=Pv.value;let a;if(e){a=e.value.toUpperCase();const l=r+" "+o+" '"+a+"'";s.CQL_FILTER=l}else{a=Fo.value;const l=r+" "+o+" '"+a+"'";s.CQL_FILTER=l}console.log(n,a),n.updateParams(s)}},lq=function(){const i=parseInt(Gl.value),t=Ls[i];if(t){const e=t.getSource();if(e){const n=e.getParams();delete n.CQL_FILTER,e.updateParams(n)}}};function p_(i){if(!i||!zl[i])return!1;const t=zl[i];for(const e of t)if(isNaN(parseFloat(e)))return!1;return!0}function Iv(){const i=$o.value;sq.disabled=!p_(i),rq.disabled=!p_(i),oq.disabled=p_(i)}$o.addEventListener("change",function(){Iv(),xm()});const hq=document.querySelector("#selectControlButton"),zw=document.querySelector(".selectControl");hq.addEventListener("click",()=>{zw.hidden=!zw.hidden,S3(),w3()});const cq=document.getElementById("sumbmitBtn"),uq=document.getElementById("resetBtn");cq.addEventListener("click",i=>{i.preventDefault(),aq()});uq.addEventListener("click",i=>{i.preventDefault(),lq()});const dq=document.getElementById("selectControl");fq(dq);function fq(i){var t=0,e=0,n=0,s=0;document.getElementById(i.id+"header")?document.getElementById(i.id+"header").onmousedown=r:i.onmousedown=r;function r(l){l.target.tagName!=="SELECT"&&l.target.tagName!=="INPUT"&&l.preventDefault(),n=l.clientX,s=l.clientY,document.onmouseup=a,document.onmousemove=o}function o(l){l.preventDefault(),t=n-l.clientX,e=s-l.clientY,n=l.clientX,s=l.clientY,i.style.top=i.offsetTop-e+"px",i.style.left=i.offsetLeft-t+"px"}function a(){document.onmouseup=null,document.onmousemove=null}}let Fl,R0,Sr,gs,Qn,Xr,Oa,Cy,vr,N0,ac;const Rv=new aW({source:null,className:"ol-select"});_m.on("select",i=>{if(zt.removeInteraction(Oa),vr=i.layer,!(vr instanceof Hn))if(vr instanceof M2){let t=function(e){return zt.getLayers().forEach(function(n){n instanceof Hn&&n.getLayers().getArray().includes(e)&&(N0=n)}),N0};Cy=vr.get("title"),ac=vr.getSource().getParams().LAYERS,t(vr)}else{Cy=vr.get("title"),Sr=vr.getSource(),console.log(Sr.params_);const t=Sr.getUrl();console.log(t),R0=vr;const e=new URL(t);console.log(e),ac=e.searchParams.get("typeName"),[Qn,gs]=ac.split(":");const n=`http://${Us}:8080/geoserver/${Qn}/ows?service=WFS&version=1.1.0&request=DescribeFeatureType&typeName=${ac}`;fetch(n).then(s=>s.text()).then(s=>{console.log(s);const a=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("xsd:element");for(let l=0;l<a.length;l++){const h=a[l];if(h.getAttribute("name")==="geom"){const u=h.getAttribute("type"),[,f]=u.split(":");console.log(f),Xr=f,Xr==="PointPropertyType"||Xr==="MultiPointPropertyType"?Fl="Point":Xr==="GeometryPropertyType"?Fl="Polygon":Xr==="MultiLineStringPropertyType"&&(Fl="LineString"),console.log("Layer Param: ",ac),console.log("Layer Name: ",gs),console.log("Workspace: ",Qn),console.log("Geometry Type: ",Xr),console.log("Geometry (layertype):",Fl),console.log("Vector Layer: ",R0),console.log("Vector Source: ",Sr),Rv.setSources(Sr),console.log(t)}}}).catch(s=>{console.error("Error fetching DescribeFeatureType:",s)})}});const gq=new QP({element:document.getElementById("popup"),positioning:"bottom-center"});zt.addOverlay(gq);let _f,yp;const C3=i=>{i instanceof Hn?i.getLayers().getArray().forEach(e=>{e.getVisible()&&(yp={title:e.get("title"),typeGeom:"Point",style:new Pe({image:new Wa({src:e.getSource().getLegendUrl()})})},_f.addItem(yp))}):i instanceof Yn&&i.getVisible()&&(yp={title:i.get("title"),typeGeom:"Point",style:new Pe({image:new Wa({src:i.getSource().getLegendUrl()})})},_f.addItem(yp))};_f=new wl({title:"Legjenda",items:[C3()]});const pq=new hC({title:"Legend",margin:10,legend:_f});zt.addControl(pq);const L3=()=>{_f.getItems().clear(),mf.forEach(i=>{i.get("title")!=="ASIG Layers"&&i.get("title")!=="Sistemi i Adresave"&&C3(i)})};L3();document.getElementById("exportPDF");function mq(i){i[0]+(i[2]-i[0])/2,i[1]+(i[3]-i[1])/2}document.getElementById("logout").addEventListener("click",function(){fetch("/logout").then(i=>{i.ok?window.location.href="/login":alert("Failed to log out")}).catch(i=>console.error("Logout error:",i))});let Ju;class _q extends UC{constructor(t){const e=t||{};e.iconUrlFunction=vq,super(e)}getType(){return"arraybuffer"}readFeature(t,e){const n=Gw(t);return super.readFeature(n,e)}readFeatures(t,e){const n=Gw(t);return super.readFeatures(n,e)}}function yq(){Ju&&zt.removeInteraction(Ju),Ju=new PF({formatConstructors:[_q,x8,nm,nD,new UC,_B]}),Ju.on("addfeatures",function(i){const t=new Ws({features:i.features});zt.addLayer(new Rr({source:t})),zt.getView().fit(t.getExtent())}),zt.addInteraction(Ju)}yq();const Ly=new sW;function Gw(i){let t;Ly.load(i);const e=Ly.file(/\.kml$/i)[0];return e&&(t=e.asText()),t}function vq(i){const t=window.location.href.lastIndexOf("/");if(t!==-1){const e=Ly.file(i.slice(t+1));if(e)return URL.createObjectURL(new Blob([e.asArrayBuffer()]))}return i}const M3=function(i){zt.forEachFeatureAtPixel(i,function(t){})};zt.on("pointermove",function(i){if(i.dragging)return;const t=zt.getEventPixel(i.originalEvent);M3(t)});zt.on("click",function(i){M3(i.pixel)});const xq=document.getElementById("editButton");xq.addEventListener("click",i=>{if(!vr){alert("Please select a layer!");return}Ow=new Ws({url:AW+ac+PW,format:new nm,attributions:"@geoserver"}),Fw=new Rr({source:Ow,title:Cy,visible:!0,displayInLayerSwitcher:!0}),N0.getLayers().remove(vr),N0.getLayers().push(Fw)});const bq=document.getElementById("modifyFeature");let gd=null;bq.addEventListener("click",i=>{if(!R0){alert("Please select a layer first.");return}zt.removeInteraction(Oa);const t=new lC({source:Sr});zt.addInteraction(t),t.on("modifyend",function(e){const n=e.features.item(0);gd={feature:n,geometry:n.getGeometry().getCoordinates(),layerType:Fl},console.log("Feature modified. Click 'Save' to apply changes.")})});const wq=document.getElementById("selectFeature"),Sq=new Pe({image:new Ir({radius:6,fill:new ke({color:"red"}),stroke:new si({color:"rgba(254, 246, 0, 1)",width:2})})}),Uw=new Pe({fill:new ke({color:"rgba(254, 246, 0, 1)"}),stroke:new si({color:"rgba(254, 246, 0, 1)",width:2})});function Eq(i){if(i.getGeometry()instanceof Qi)return Sq;{const e=i.get("COLOR")||"#eeeeee";return Uw.getFill().setColor(e),Uw}}let Ac,Ww,qw,Vw,T3=!1;wq.addEventListener("click",i=>{T3=!0,zt.removeInteraction(Oa),zt.removeInteraction(za),Ac=new U2({style:Eq,hitTolerance:5}),zt.addInteraction(Ac),Ac.on("select",function(t){Vw=t.selected;var e=t.deselected;Vw.forEach(function(n){console.log("Selected feature:",n),qw=n.getGeometry().getExtent()}),e.forEach(function(n){console.log("Deselected feature:",n)}),mq(qw)})});let jp=!1,pd=null;const Cq=document.getElementById("addNewFeature");Cq.addEventListener("click",i=>{if(!gs){alert("Please select a layer first.");return}jp=!0,Oa=new G2({source:Sr,type:Fl}),zt.addInteraction(Oa),Oa.on("drawend",function(t){const e=t.feature,n=e.getGeometry().getCoordinates();pd={feature:e,geometry:n,layerType:Fl},console.log("New feature drawn. Click 'Save' to apply."),zt.removeInteraction(Oa)})});const Lq=document.getElementById("deleteFeature");let md=[];Lq.addEventListener("click",i=>{if(!R0){alert("Please select a layer first.");return}if(!Ac){alert("Please select a feature first.");return}const e=Ac.getFeatures().getArray();if(e.length===0){alert("No features selected for deletion.");return}e.forEach(n=>{const s=n.get("id");md.push({feature:n,featureID:s}),console.log("Marked for deletion:",s)}),alert("Feature(s) marked for deletion. Click 'Save' to confirm.")});const Mq=document.getElementById("saveFeature");Mq.addEventListener("click",()=>{if(!pd&&!gd&&md.length===0&&!Ac.getFeatures().getLength()){alert("No modifications or deletions to save.");return}let i="",t;if(md.length>0&&(md.forEach(({feature:n,featureID:s})=>{console.log("Deleting feature with ID:",s),i+=`<wfs:Transaction service="WFS" version="1.0.0"
                  xmlns:ogc="http://www.opengis.net/ogc"
                  xmlns:wfs="http://www.opengis.net/wfs">
                  <wfs:Delete typeName="${gs}">
                    <ogc:Filter>
                      <ogc:PropertyIsEqualTo>
                        <ogc:PropertyName>id</ogc:PropertyName>
                        <ogc:Literal>${s}</ogc:Literal>
                      </ogc:PropertyIsEqualTo>
                    </ogc:Filter>
                  </wfs:Delete>
                </wfs:Transaction>`,Sr.removeFeature(n)}),md=[]),jp&&pd){const{feature:n,geometry:s,layerType:r}=pd,o=n.getGeometry().getCoordinates();r==="LineString"?(t=o.map(a=>a.join(",")).join(" "),console.log("Line Coordinates:",t),i=`<wfs:Transaction service="WFS" version="1.1.0"
    xmlns:wfs="http://www.opengis.net/wfs"
    xmlns:test="http://www.openplans.org/test"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd http://www.openplans.org http://${Us}:8080/geoserver/wfs/DescribeFeatureType?typename=test:line">
    <wfs:Insert>
      <${gs}>
        <${Qn}:geom>
          <gml:MultiLineString srsName="http://www.opengis.net/gml/srs/epsg.xml#3857">
            <gml:lineStringMember>
              <gml:LineString>
                <gml:coordinates decimal="." cs="," ts=" ">
                ${t}
                </gml:coordinates>
              </gml:LineString>
            </gml:lineStringMember>
          </gml:MultiLineString>
        </${Qn}:geom>
        <${Qn}:TYPE>alley</${Qn}:TYPE>
      </${gs}>
    </wfs:Insert>
    </wfs:Transaction>`):r==="Polygon"?(t=o.map(l=>l.map(h=>h.join(",")).slice(0,-1).join(" ")).join(`
`),console.log("Polygon Coordinates:",t),i=`<wfs:Transaction service="WFS" version="1.1.0"
    xmlns:wfs="http://www.opengis.net/wfs"
    xmlns:test="http://www.openplans.org/test"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd http://www.openplans.org http://${Us}:8080/geoserver/wfs/DescribeFeatureType?typename=test:line">
    <wfs:Insert>
      <${gs}>
        <${Qn}:geom>
          <gml:MultiLineString srsName="http://www.opengis.net/gml/srs/epsg.xml#3857">
            <gml:lineStringMember>
              <gml:LineString>
                <gml:coordinates decimal="." cs="," ts=" ">
                ${t}
                </gml:coordinates>
              </gml:LineString>
            </gml:lineStringMember>
          </gml:MultiLineString>
        </${Qn}:geom>
        <${Qn}:TYPE>alley</${Qn}:TYPE>
      </${gs}>
    </wfs:Insert>
    </wfs:Transaction>`):r==="Point"&&(t=[o[0],o[1]].join(","),console.log("Point Coordinates:",t),i=`<wfs:Transaction service="WFS" version="1.1.0"
      xmlns:wfs="http://www.opengis.net/wfs"
      xmlns:test="http://www.openplans.org/test"
      xmlns:gml="http://www.opengis.net/gml"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd http://www.openplans.org http://${Us}:8080/geoserver/wfs/DescribeFeatureType?typename=test:line">
      <wfs:Insert>
        <${gs}>
          <${Qn}:geom>
          <gml:Point srsDimension="2" srsName="urn:x-ogc:def:crs:EPSG:3857">
          <gml:coordinates xmlns:gml="http://www.opengis.net/gml"
          decimal="." cs="," ts=" ">${t}</gml:coordinates>
          </gml:Point>
          </${Qn}:geom>
          <${Qn}:TYPE>alley</${Qn}:TYPE>
        </${gs}>
      </wfs:Insert>
      </wfs:Transaction>`),jp=!1,pd=null}if(!jp&&gd){const{feature:n,geometry:s,layerType:r}=gd;r==="Polygon"?(t=s[0][0].map(o=>`${o[0]},${o[1]}`).join(" "),i=`<wfs:Transaction service="WFS" version="1.0.0"
      xmlns:wfs="http://www.opengis.net/wfs"
      xmlns:ogc="http://www.opengis.net/ogc"
      xmlns:gml="http://www.opengis.net/gml"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd">
      <wfs:Update typeName="${gs}">
        <wfs:Property>
          <wfs:Name>geom</wfs:Name>
          <wfs:Value>
            <gml:Polygon srsName="EPSG:3857">
              <gml:outerBoundaryIs>
                <gml:LinearRing>
                  <gml:coordinates>${t}</gml:coordinates>
                </gml:LinearRing>
              </gml:outerBoundaryIs>
            </gml:Polygon>
          </wfs:Value>
        </wfs:Property>
        <ogc:Filter>
          <ogc:FeatureId fid="${n.getId()}"/>
        </ogc:Filter>
      </wfs:Update>
    </wfs:Transaction>`):r==="LineString"?(t=s.map(o=>o.map(a=>a.join(",")).join(" ")).join(" "),i=`<wfs:Transaction service="WFS" version="1.0.0"
        xmlns:topp="http://www.openplans.org/topp"
        xmlns:ogc="http://www.opengis.net/ogc"
        xmlns:wfs="http://www.opengis.net/wfs"
        xmlns:gml="http://www.opengis.net/gml"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd">
        <wfs:Update typeName="${gs}">
          <wfs:Property>
            <wfs:Name>geom</wfs:Name>
            <wfs:Value>
              <gml:MultiLineString srsName="http://www.opengis.net/gml/srs/epsg.xml#3857">
                <gml:lineStringMember>
                  <gml:LineString>
                    <gml:coordinates>${t}</gml:coordinates>
                  </gml:LineString>
                </gml:lineStringMember>
              </gml:MultiLineString>
            </wfs:Value>
          </wfs:Property>
          <ogc:Filter>
            <ogc:FeatureId fid="${n.getId()}"/>
          </ogc:Filter>
        </wfs:Update>
      </wfs:Transaction>`):r==="Point"&&(t=s.join(","),i=`<wfs:Transaction service="WFS" version="1.0.0"
      xmlns:wfs="http://www.opengis.net/wfs"
      xmlns:ogc="http://www.opengis.net/ogc"
      xmlns:gml="http://www.opengis.net/gml"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd">
      <wfs:Update typeName="${gs}">
        <wfs:Property>
          <wfs:Name>geom</wfs:Name>
          <wfs:Value>
            <gml:Point srsName="EPSG:3857">
              <gml:coordinates>${t}</gml:coordinates>
            </gml:Point>
          </wfs:Value>
        </wfs:Property>
        <ogc:Filter>
          <ogc:FeatureId fid="${n.getId()}"/>
        </ogc:Filter>
      </wfs:Update>
    </wfs:Transaction>`),gd=null}const e=`http://${Us}:8080/geoserver/test/ows`;fetch(e,{method:"POST",headers:{"Content-Type":"text/xml"},body:i}).then(n=>n.text()).then(n=>{console.log("Changes saved successfully:",n),alert("Changes saved successfully."),Sr.refresh(),setTimeout(()=>{Tq()},1e3)}).catch(n=>{console.error("Error saving changes:",n),alert("Error saving changes.")})});function Tq(){const i=Sr.getFeatures();i&&(i.forEach(t=>{const e=t.getId();if(console.log(t,e),e){let n;e.includes(".")?n=e.split(".")[1]:n=e,Aq(n)}}),Sr.refresh(),zt.removeInteraction(Oa))}function Aq(i){Ww=`http://${Us}:8080/geoserver/test/ows`;var t=`
      <wfs:Transaction service="WFS" version="1.1.0"
      xmlns:topp="http://www.openplans.org/topp"
      xmlns:ogc="http://www.opengis.net/ogc"
      xmlns:wfs="http://www.opengis.net/wfs">
      <wfs:Update typeName="${gs}">
      <wfs:Property>
      <wfs:Name>id</wfs:Name>
      <wfs:Value>${i}</wfs:Value>
      </wfs:Property>
        <ogc:Filter>
          <ogc:FeatureId fid="${i}"/>
        </ogc:Filter>
      </wfs:Update>
      </wfs:Transaction>
    `;fetch(Ww,{method:"POST",headers:{"Content-Type":"text/xml"},body:t}).then(n=>{if(!n.ok)throw new Error("Network response was not ok");return n.text()}).then(n=>{console.log("Property ID updated successfully:",n)}).catch(n=>{console.error("Error updating property ID:",n)})}const A3=new oW({zoom:14,projection:wv,label:"Search Coordinates",minLength:4,placeholder:"Enter coordinates..."});zt.addControl(A3);const Pq=new Pe({image:new Ir({radius:6,fill:new ke({color:"red"}),stroke:new si({color:"white",width:2})})}),My=new Ws,Iq=new Rr({source:My,style:Pq});zt.addLayer(Iq);A3.on("select",function(i){const t=i.search.gps;console.log(t);const e=zt.getView().getProjection();console.log(e);const n=Zi(t,wv,e);console.log(n);const s=new gi({geometry:new Qi(n)});My.clear(),My.addFeature(s),zt.getView().setCenter(n),zt.getView().setZoom(20),console.log("Zooming to coordinates:",n)});const Rq=new Pe({image:new Ir({radius:10,fill:new ke({color:"blue"}),stroke:new si({color:"yellow",width:2})})}),Nq=new Pe({stroke:new si({color:"blue",width:3}),fill:new ke({color:"rgba(0, 0, 255, 0.3)"})}),kq=new Pe({stroke:new si({color:"green",width:4,lineDash:[10,10]})});let Hw=[];Rv.on("select",function(i){const t=i.features;Hw.forEach(e=>{e.setStyle(null)}),t.forEach(e=>{console.log(Xr),Xr==="PointPropertyType"?e.setStyle(Rq):Xr==="GeometryPropertyType"?e.setStyle(Nq):Xr==="MultiLineStringPropertyType"&&e.setStyle(kq)}),Hw=[...t]});zt.addControl(Rv);const Pc=document.getElementById("layer-select"),Yw=document.getElementById("attribute-select");function Fq(){Pc.innerHTML="";const i=document.createElement("option");i.value="",i.text="Select a layer...",Pc.appendChild(i),Ls.forEach((t,e)=>{if(t.getVisible()){const n=Ls[e],s=document.createElement("option");s.value=e,s.text=n.get("title"),Pc.appendChild(s)}})}let Ty;async function P3(i){try{const e=Ls[i].getSource().getParams().LAYERS,n=`http://${Us}:8080/geoserver/${nu}/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=${e}&outputFormat=json`,r=await(await fetch(n)).json();Yw.innerHTML="",r.features&&r.features.length>0&&(Ty=Object.keys(r.features[0].properties),Ty.forEach(o=>{const a=document.createElement("option");a.value=o,a.text=o,Yw.appendChild(a)}))}catch(t){console.error("Error fetching fields:",t)}}Pc.addEventListener("change",i=>{const t=i.target.value;t&&P3(t)});const Oq=document.getElementById("searchControlButton"),m_=document.getElementById("search-container");Oq.addEventListener("click",()=>{m_.hasAttribute("hidden")?(m_.removeAttribute("hidden"),Fq()):m_.setAttribute("hidden","")});document.getElementById("search").addEventListener("click",async()=>{const i=Pc.value;if(!i){console.log("Please select a layer.");return}const t=document.getElementById("logical-operator").value,n=Array.from(I3.querySelectorAll(".rule")).map(a=>{const l=a.querySelector(".attribute-select").value,h=a.querySelector(".operator").value,c=a.querySelector(".value").value;return l&&h&&c?`${l} ${h} '${c}'`:null}).filter(Boolean).join(` ${t} `),r=Ls[i].getSource().getParams().LAYERS,o=`http://${Us}:8080/geoserver/${nu}/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=${r}&outputFormat=json&cql_filter=${n}`;try{const l=await(await fetch(o)).json();if(l.features&&l.features.length>0){const h=l.features.map(f=>new nm().readFeature(f)),c=new Ws({features:h});console.log(c.getFeatures());const u=c.getExtent();zt.getView().fit(u,{duration:1e3,padding:[50,50,50,50]})}else console.log("No matching features found.")}catch(a){console.error("Error fetching data:",a)}});const I3=document.getElementById("rules-container"),Dq=document.getElementById("add-rule");Dq.addEventListener("click",()=>{const i=document.createElement("div");i.classList.add("rule"),i.innerHTML=`
    <label>Attribute:</label>
    <select class="attribute-select"></select>
    <select class="operator">
      <option value="=">=</option>
      <option value="!=">≠</option>
      <option value="&lt;">&lt;</option>
      <option value="&gt;">&gt;</option>
      <option value="&lt;=">&#8804;</option>
      <option value="&gt;=">&#8805;</option>
    </select>
    <input type="text" class="value" placeholder="value" />
  `,I3.appendChild(i),Bq(i.querySelector(".attribute-select"))});function Bq(i){Ty.forEach(t=>{const e=document.createElement("option");e.value=t,e.text=t,i.appendChild(e)})}let Xw;const zp=document.getElementById("attribute-layer-select");Pc.addEventListener("change",i=>{const t=i.target.value;t&&P3(t)});function jq(){zp.innerHTML="";const i=document.createElement("option");i.value="",i.text="Select a layer...",zp.appendChild(i),Ls.forEach((t,e)=>{if(t.getVisible()){const n=Ls[e],s=document.createElement("option");s.value=e,s.text=n.get("title"),zp.appendChild(s)}})}let __,Od;document.getElementById("attributeTable").addEventListener("click",async()=>{const i=document.getElementById("attribute-table-container");i.hidden=!i.hidden,jq()});zp.addEventListener("change",i=>{__=i.target.value,console.log(__),Od=Ls[__],console.log(Od),zq(Od)});function zq(i){const t=i.getSource().getParams().LAYERS,e=`http://${Us}:8080/geoserver/${nu}/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=${t}&outputFormat=json`;async function n(){try{const s=await fetch(e);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const r=await s.json(),o=r.features;if(r.features&&r.features.length>0){const a=r.features.map(h=>new nm().readFeature(h));Xw=new Ws({features:a}).getFeatures()}Gq(Xw)}catch(s){console.error("Error fetching data:",s)}}n()}let Ic=null;function Gq(i){const t=document.getElementById("table-headers"),e=document.getElementById("table-body");if(t.innerHTML="",e.innerHTML="",i.length===0){const a=e.insertRow().insertCell();a.colSpan="100%",a.textContent="No attributes available.";return}const n=i[0],s=Object.keys(n.getProperties()).filter(o=>o!=="geometry");s.forEach(o=>{const a=document.createElement("th"),l=document.createElement("div");l.textContent=o;const h=document.createElement("input");h.type="text",h.placeholder=`Filter ${o}`,h.addEventListener("input",()=>Uq(i)),a.appendChild(l),a.appendChild(h),t.appendChild(a)});let r=null;i.forEach(o=>{const a=e.insertRow();s.forEach(l=>{const h=a.insertCell();h.textContent=o.get(l)||""}),a.addEventListener("click",()=>{r&&r.classList.remove("highlighted-row"),a.classList.add("highlighted-row"),r=a,s.forEach(l=>{o.get(l)}),R3(o)})})}function R3(i){const t=i.getGeometry().getExtent();zt.getView().fit(t,{duration:1e3,padding:[50,50,50,50]})}function Uq(i){const t=document.getElementById("table-body"),e=Array.from(document.querySelectorAll("#table-headers input")),n=e.map(r=>r.placeholder.replace("Filter ",""));t.innerHTML="",i.filter(r=>n.every((o,a)=>{const l=e[a].value.toLowerCase();return(r.get(o)||"").toString().toLowerCase().includes(l)})).forEach(r=>{const o=t.insertRow();n.forEach(a=>{const l=o.insertCell();l.textContent=r.get(a)||""}),o.addEventListener("click",()=>{Ic&&Ic.classList.remove("highlighted-row"),o.classList.add("highlighted-row"),Ic=o,R3(r)})})}zt.on("singleclick",function(i){if(T3){console.log("Single-click disabled while 'Select Feature' is active.");return}const t=zt.getView().getResolution();console.log(Od);const n=Od.getSource().getFeatureInfoUrl(i.coordinate,t,zt.getView().getProjection(),{INFO_FORMAT:"application/json",FEATURE_COUNT:1});n&&fetch(n).then(s=>s.json()).then(s=>{if(s.features&&s.features.length>0){const r=s.features[0].properties;console.log(r),Wq(r)}else console.log("No feature found at the clicked location.")}).catch(s=>console.error("Error fetching feature info:",s))});function Wq(i){const t=Array.from(document.querySelectorAll("#table-headers th")),e=document.getElementById("table-body");Array.from(e.rows).forEach(s=>{const r=s.cells[0],o=t[0].textContent,a=String(i[o]).trim(),l=String(r.textContent).trim();console.log(`Comparing feature "${a}" with table cell "${l}"`);const h=a===l;if(console.log("Row match result:",h),h){Ic&&Ic.classList.remove("highlighted-row"),s.classList.add("highlighted-row"),s.scrollIntoView({behavior:"smooth",block:"center"}),Ic=s;return}else s.classList.remove("highlighted-row")})}export{hi as _,Bo as c,CS as g};
//# sourceMappingURL=index-C8Agr74a.js.map
